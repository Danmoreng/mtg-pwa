(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();/**
* @vue/shared v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Td(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const mt={},yi=[],os=()=>{},Um=()=>!1,Yl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Rd=t=>t.startsWith("onUpdate:"),Bt=Object.assign,$d=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},H_=Object.prototype.hasOwnProperty,ft=(t,e)=>H_.call(t,e),qe=Array.isArray,vi=t=>na(t)==="[object Map]",Gl=t=>na(t)==="[object Set]",fh=t=>na(t)==="[object Date]",Ye=t=>typeof t=="function",Et=t=>typeof t=="string",Wn=t=>typeof t=="symbol",vt=t=>t!==null&&typeof t=="object",Wm=t=>(vt(t)||Ye(t))&&Ye(t.then)&&Ye(t.catch),Vm=Object.prototype.toString,na=t=>Vm.call(t),K_=t=>na(t).slice(8,-1),Hm=t=>na(t)==="[object Object]",Fd=t=>Et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_o=Td(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xl=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},Y_=/-(\w)/g,On=Xl(t=>t.replace(Y_,(e,n)=>n?n.toUpperCase():"")),G_=/\B([A-Z])/g,ar=Xl(t=>t.replace(G_,"-$1").toLowerCase()),Ql=Xl(t=>t.charAt(0).toUpperCase()+t.slice(1)),ul=Xl(t=>t?`on${Ql(t)}`:""),Qs=(t,e)=>!Object.is(t,e),dl=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Km=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},xl=t=>{const e=parseFloat(t);return isNaN(e)?t:e},X_=t=>{const e=Et(t)?Number(t):NaN;return isNaN(e)?t:e};let hh;const Jl=()=>hh||(hh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function En(t){if(qe(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=Et(s)?e0(s):En(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(Et(t)||vt(t))return t}const Q_=/;(?![^(]*\))/g,J_=/:([^]+)/,Z_=/\/\*[^]*?\*\//g;function e0(t){const e={};return t.replace(Z_,"").split(Q_).forEach(n=>{if(n){const s=n.split(J_);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function At(t){let e="";if(Et(t))e=t;else if(qe(t))for(let n=0;n<t.length;n++){const s=At(t[n]);s&&(e+=s+" ")}else if(vt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function t0(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Et(e)&&(t.class=At(e)),n&&(t.style=En(n)),t}const n0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",s0=Td(n0);function Ym(t){return!!t||t===""}function r0(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=Zl(t[s],e[s]);return n}function Zl(t,e){if(t===e)return!0;let n=fh(t),s=fh(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=Wn(t),s=Wn(e),n||s)return t===e;if(n=qe(t),s=qe(e),n||s)return n&&s?r0(t,e):!1;if(n=vt(t),s=vt(e),n||s){if(!n||!s)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Zl(t[o],e[o]))return!1}}return String(t)===String(e)}function i0(t,e){return t.findIndex(n=>Zl(n,e))}const Gm=t=>!!(t&&t.__v_isRef===!0),te=t=>Et(t)?t:t==null?"":qe(t)||vt(t)&&(t.toString===Vm||!Ye(t.toString))?Gm(t)?te(t.value):JSON.stringify(t,Xm,2):String(t),Xm=(t,e)=>Gm(e)?Xm(t,e.value):vi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r],i)=>(n[ru(s,i)+" =>"]=r,n),{})}:Gl(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>ru(n))}:Wn(e)?ru(e):vt(e)&&!qe(e)&&!Hm(e)?String(e):e,ru=(t,e="")=>{var n;return Wn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let on;class Qm{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=on,!e&&on&&(this.index=(on.scopes||(on.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=on;try{return on=this,e()}finally{on=n}}}on(){++this._on===1&&(this.prevScope=on,on=this)}off(){this._on>0&&--this._on===0&&(on=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function ec(t){return new Qm(t)}function Ld(){return on}function Jm(t,e=!1){on&&on.cleanups.push(t)}let bt;const iu=new WeakSet;class Zm{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,on&&on.active&&on.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,iu.has(this)&&(iu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ty(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ph(this),ny(this);const e=bt,n=Un;bt=this,Un=!0;try{return this.fn()}finally{sy(this),bt=e,Un=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Nd(e);this.deps=this.depsTail=void 0,ph(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?iu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Yu(this)&&this.run()}get dirty(){return Yu(this)}}let ey=0,wo,xo;function ty(t,e=!1){if(t.flags|=8,e){t.next=xo,xo=t;return}t.next=wo,wo=t}function Bd(){ey++}function jd(){if(--ey>0)return;if(xo){let e=xo;for(xo=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;wo;){let e=wo;for(wo=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function ny(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function sy(t){let e,n=t.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),Nd(s),o0(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=n}function Yu(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ry(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ry(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Lo)||(t.globalVersion=Lo,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Yu(t))))return;t.flags|=2;const e=t.dep,n=bt,s=Un;bt=t,Un=!0;try{ny(t);const r=t.fn(t._value);(e.version===0||Qs(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{bt=n,Un=s,sy(t),t.flags&=-3}}function Nd(t,e=!1){const{dep:n,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)Nd(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function o0(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Un=!0;const iy=[];function Is(){iy.push(Un),Un=!1}function Es(){const t=iy.pop();Un=t===void 0?!0:t}function ph(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=bt;bt=void 0;try{e()}finally{bt=n}}}let Lo=0;class a0{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class zd{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!bt||!Un||bt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==bt)n=this.activeLink=new a0(bt,this),bt.deps?(n.prevDep=bt.depsTail,bt.depsTail.nextDep=n,bt.depsTail=n):bt.deps=bt.depsTail=n,oy(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=bt.depsTail,n.nextDep=void 0,bt.depsTail.nextDep=n,bt.depsTail=n,bt.deps===n&&(bt.deps=s)}return n}trigger(e){this.version++,Lo++,this.notify(e)}notify(e){Bd();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{jd()}}}function oy(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)oy(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const kl=new WeakMap,Br=Symbol(""),Gu=Symbol(""),Bo=Symbol("");function an(t,e,n){if(Un&&bt){let s=kl.get(t);s||kl.set(t,s=new Map);let r=s.get(n);r||(s.set(n,r=new zd),r.map=s,r.key=n),r.track()}}function Ss(t,e,n,s,r,i){const o=kl.get(t);if(!o){Lo++;return}const a=l=>{l&&l.trigger()};if(Bd(),e==="clear")o.forEach(a);else{const l=qe(t),c=l&&Fd(n);if(l&&n==="length"){const u=Number(s);o.forEach((f,p)=>{(p==="length"||p===Bo||!Wn(p)&&p>=u)&&a(f)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),c&&a(o.get(Bo)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Br)),vi(t)&&a(o.get(Gu)));break;case"delete":l||(a(o.get(Br)),vi(t)&&a(o.get(Gu)));break;case"set":vi(t)&&a(o.get(Br));break}}jd()}function l0(t,e){const n=kl.get(t);return n&&n.get(e)}function oi(t){const e=tt(t);return e===t?e:(an(e,"iterate",Bo),zn(t)?e:e.map(Xt))}function tc(t){return an(t=tt(t),"iterate",Bo),t}const c0={__proto__:null,[Symbol.iterator](){return ou(this,Symbol.iterator,Xt)},concat(...t){return oi(this).concat(...t.map(e=>qe(e)?oi(e):e))},entries(){return ou(this,"entries",t=>(t[1]=Xt(t[1]),t))},every(t,e){return hs(this,"every",t,e,void 0,arguments)},filter(t,e){return hs(this,"filter",t,e,n=>n.map(Xt),arguments)},find(t,e){return hs(this,"find",t,e,Xt,arguments)},findIndex(t,e){return hs(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return hs(this,"findLast",t,e,Xt,arguments)},findLastIndex(t,e){return hs(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return hs(this,"forEach",t,e,void 0,arguments)},includes(...t){return au(this,"includes",t)},indexOf(...t){return au(this,"indexOf",t)},join(t){return oi(this).join(t)},lastIndexOf(...t){return au(this,"lastIndexOf",t)},map(t,e){return hs(this,"map",t,e,void 0,arguments)},pop(){return Xi(this,"pop")},push(...t){return Xi(this,"push",t)},reduce(t,...e){return gh(this,"reduce",t,e)},reduceRight(t,...e){return gh(this,"reduceRight",t,e)},shift(){return Xi(this,"shift")},some(t,e){return hs(this,"some",t,e,void 0,arguments)},splice(...t){return Xi(this,"splice",t)},toReversed(){return oi(this).toReversed()},toSorted(t){return oi(this).toSorted(t)},toSpliced(...t){return oi(this).toSpliced(...t)},unshift(...t){return Xi(this,"unshift",t)},values(){return ou(this,"values",Xt)}};function ou(t,e,n){const s=tc(t),r=s[e]();return s!==t&&!zn(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=n(i.value)),i}),r}const u0=Array.prototype;function hs(t,e,n,s,r,i){const o=tc(t),a=o!==t&&!zn(t),l=o[e];if(l!==u0[e]){const f=l.apply(t,i);return a?Xt(f):f}let c=n;o!==t&&(a?c=function(f,p){return n.call(this,Xt(f),p,t)}:n.length>2&&(c=function(f,p){return n.call(this,f,p,t)}));const u=l.call(o,c,s);return a&&r?r(u):u}function gh(t,e,n,s){const r=tc(t);let i=n;return r!==t&&(zn(t)?n.length>3&&(i=function(o,a,l){return n.call(this,o,a,l,t)}):i=function(o,a,l){return n.call(this,o,Xt(a),l,t)}),r[e](i,...s)}function au(t,e,n){const s=tt(t);an(s,"iterate",Bo);const r=s[e](...n);return(r===-1||r===!1)&&sa(n[0])?(n[0]=tt(n[0]),s[e](...n)):r}function Xi(t,e,n=[]){Is(),Bd();const s=tt(t)[e].apply(t,n);return jd(),Es(),s}const d0=Td("__proto__,__v_isRef,__isVue"),ay=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Wn));function f0(t){Wn(t)||(t=String(t));const e=tt(this);return an(e,"has",t),e.hasOwnProperty(t)}class ly{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(r?i?x0:fy:i?dy:uy).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=qe(e);if(!r){let l;if(o&&(l=c0[n]))return l;if(n==="hasOwnProperty")return f0}const a=Reflect.get(e,n,$t(e)?e:s);return(Wn(n)?ay.has(n):d0(n))||(r||an(e,"get",n),i)?a:$t(a)?o&&Fd(n)?a:a.value:vt(a)?r?py(a):Vr(a):a}}class cy extends ly{constructor(e=!1){super(!1,e)}set(e,n,s,r){let i=e[n];if(!this._isShallow){const l=rr(i);if(!zn(s)&&!rr(s)&&(i=tt(i),s=tt(s)),!qe(e)&&$t(i)&&!$t(s))return l||(i.value=s),!0}const o=qe(e)&&Fd(n)?Number(n)<e.length:ft(e,n),a=Reflect.set(e,n,s,$t(e)?e:r);return e===tt(r)&&(o?Qs(s,i)&&Ss(e,"set",n,s):Ss(e,"add",n,s)),a}deleteProperty(e,n){const s=ft(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&s&&Ss(e,"delete",n,void 0),r}has(e,n){const s=Reflect.has(e,n);return(!Wn(n)||!ay.has(n))&&an(e,"has",n),s}ownKeys(e){return an(e,"iterate",qe(e)?"length":Br),Reflect.ownKeys(e)}}class h0 extends ly{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const p0=new cy,g0=new h0,m0=new cy(!0);const Xu=t=>t,Na=t=>Reflect.getPrototypeOf(t);function y0(t,e,n){return function(...s){const r=this.__v_raw,i=tt(r),o=vi(i),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...s),u=n?Xu:e?Cl:Xt;return!e&&an(i,"iterate",l?Gu:Br),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:a?[u(f[0]),u(f[1])]:u(f),done:p}},[Symbol.iterator](){return this}}}}function za(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function v0(t,e){const n={get(r){const i=this.__v_raw,o=tt(i),a=tt(r);t||(Qs(r,a)&&an(o,"get",r),an(o,"get",a));const{has:l}=Na(o),c=e?Xu:t?Cl:Xt;if(l.call(o,r))return c(i.get(r));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&an(tt(r),"iterate",Br),r.size},has(r){const i=this.__v_raw,o=tt(i),a=tt(r);return t||(Qs(r,a)&&an(o,"has",r),an(o,"has",a)),r===a?i.has(r):i.has(r)||i.has(a)},forEach(r,i){const o=this,a=o.__v_raw,l=tt(a),c=e?Xu:t?Cl:Xt;return!t&&an(l,"iterate",Br),a.forEach((u,f)=>r.call(i,c(u),c(f),o))}};return Bt(n,t?{add:za("add"),set:za("set"),delete:za("delete"),clear:za("clear")}:{add(r){!e&&!zn(r)&&!rr(r)&&(r=tt(r));const i=tt(this);return Na(i).has.call(i,r)||(i.add(r),Ss(i,"add",r,r)),this},set(r,i){!e&&!zn(i)&&!rr(i)&&(i=tt(i));const o=tt(this),{has:a,get:l}=Na(o);let c=a.call(o,r);c||(r=tt(r),c=a.call(o,r));const u=l.call(o,r);return o.set(r,i),c?Qs(i,u)&&Ss(o,"set",r,i):Ss(o,"add",r,i),this},delete(r){const i=tt(this),{has:o,get:a}=Na(i);let l=o.call(i,r);l||(r=tt(r),l=o.call(i,r)),a&&a.call(i,r);const c=i.delete(r);return l&&Ss(i,"delete",r,void 0),c},clear(){const r=tt(this),i=r.size!==0,o=r.clear();return i&&Ss(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=y0(r,t,e)}),n}function qd(t,e){const n=v0(t,e);return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(ft(n,r)&&r in s?n:s,r,i)}const b0={get:qd(!1,!1)},_0={get:qd(!1,!0)},w0={get:qd(!0,!1)};const uy=new WeakMap,dy=new WeakMap,fy=new WeakMap,x0=new WeakMap;function k0(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function C0(t){return t.__v_skip||!Object.isExtensible(t)?0:k0(K_(t))}function Vr(t){return rr(t)?t:Ud(t,!1,p0,b0,uy)}function hy(t){return Ud(t,!1,m0,_0,dy)}function py(t){return Ud(t,!0,g0,w0,fy)}function Ud(t,e,n,s,r){if(!vt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=C0(t);if(i===0)return t;const o=r.get(t);if(o)return o;const a=new Proxy(t,i===2?s:n);return r.set(t,a),a}function Js(t){return rr(t)?Js(t.__v_raw):!!(t&&t.__v_isReactive)}function rr(t){return!!(t&&t.__v_isReadonly)}function zn(t){return!!(t&&t.__v_isShallow)}function sa(t){return t?!!t.__v_raw:!1}function tt(t){const e=t&&t.__v_raw;return e?tt(e):t}function Wd(t){return!ft(t,"__v_skip")&&Object.isExtensible(t)&&Km(t,"__v_skip",!0),t}const Xt=t=>vt(t)?Vr(t):t,Cl=t=>vt(t)?py(t):t;function $t(t){return t?t.__v_isRef===!0:!1}function fe(t){return gy(t,!1)}function nc(t){return gy(t,!0)}function gy(t,e){return $t(t)?t:new S0(t,e)}class S0{constructor(e,n){this.dep=new zd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:tt(e),this._value=n?e:Xt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||zn(e)||rr(e);e=s?e:tt(e),Qs(e,n)&&(this._rawValue=e,this._value=s?e:Xt(e),this.dep.trigger())}}function $e(t){return $t(t)?t.value:t}function as(t){return Ye(t)?t():$e(t)}const P0={get:(t,e,n)=>e==="__v_raw"?t:$e(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return $t(r)&&!$t(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function my(t){return Js(t)?t:new Proxy(t,P0)}function Vd(t){const e=qe(t)?new Array(t.length):{};for(const n in t)e[n]=I0(t,n);return e}class A0{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return l0(tt(this._object),this._key)}}function I0(t,e,n){const s=t[e];return $t(s)?s:new A0(t,e,n)}class E0{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new zd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Lo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&bt!==this)return ty(this,!0),!0}get value(){const e=this.dep.track();return ry(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function M0(t,e,n=!1){let s,r;return Ye(t)?s=t:(s=t.get,r=t.set),new E0(s,r,n)}const qa={},Sl=new WeakMap;let Ir;function O0(t,e=!1,n=Ir){if(n){let s=Sl.get(n);s||Sl.set(n,s=[]),s.push(t)}}function D0(t,e,n=mt){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:a,call:l}=n,c=D=>r?D:zn(D)||r===!1||r===0?Ps(D,1):Ps(D);let u,f,p,g,v=!1,w=!1;if($t(t)?(f=()=>t.value,v=zn(t)):Js(t)?(f=()=>c(t),v=!0):qe(t)?(w=!0,v=t.some(D=>Js(D)||zn(D)),f=()=>t.map(D=>{if($t(D))return D.value;if(Js(D))return c(D);if(Ye(D))return l?l(D,2):D()})):Ye(t)?e?f=l?()=>l(t,2):t:f=()=>{if(p){Is();try{p()}finally{Es()}}const D=Ir;Ir=u;try{return l?l(t,3,[g]):t(g)}finally{Ir=D}}:f=os,e&&r){const D=f,T=r===!0?1/0:r;f=()=>Ps(D(),T)}const x=Ld(),k=()=>{u.stop(),x&&x.active&&$d(x.effects,u)};if(i&&e){const D=e;e=(...T)=>{D(...T),k()}}let S=w?new Array(t.length).fill(qa):qa;const E=D=>{if(!(!(u.flags&1)||!u.dirty&&!D))if(e){const T=u.run();if(r||v||(w?T.some((P,A)=>Qs(P,S[A])):Qs(T,S))){p&&p();const P=Ir;Ir=u;try{const A=[T,S===qa?void 0:w&&S[0]===qa?[]:S,g];S=T,l?l(e,3,A):e(...A)}finally{Ir=P}}}else u.run()};return a&&a(E),u=new Zm(f),u.scheduler=o?()=>o(E,!1):E,g=D=>O0(D,!1,u),p=u.onStop=()=>{const D=Sl.get(u);if(D){if(l)l(D,4);else for(const T of D)T();Sl.delete(u)}},e?s?E(!0):S=u.run():o?o(E.bind(null,!0),!0):u.run(),k.pause=u.pause.bind(u),k.resume=u.resume.bind(u),k.stop=k,k}function Ps(t,e=1/0,n){if(e<=0||!vt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,$t(t))Ps(t.value,e,n);else if(qe(t))for(let s=0;s<t.length;s++)Ps(t[s],e,n);else if(Gl(t)||vi(t))t.forEach(s=>{Ps(s,e,n)});else if(Hm(t)){for(const s in t)Ps(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Ps(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ra(t,e,n,s){try{return s?t(...s):t()}catch(r){sc(r,e,n)}}function Vn(t,e,n,s){if(Ye(t)){const r=ra(t,e,n,s);return r&&Wm(r)&&r.catch(i=>{sc(i,e,n)}),r}if(qe(t)){const r=[];for(let i=0;i<t.length;i++)r.push(Vn(t[i],e,n,s));return r}}function sc(t,e,n,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||mt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const u=a.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,l,c)===!1)return}a=a.parent}if(i){Is(),ra(i,null,10,[t,l,c]),Es();return}}T0(t,n,r,s,o)}function T0(t,e,n,s=!0,r=!1){if(r)throw t;console.error(t)}const yn=[];let ns=-1;const bi=[];let Hs=null,di=0;const yy=Promise.resolve();let Pl=null;function un(t){const e=Pl||yy;return t?e.then(this?t.bind(this):t):e}function R0(t){let e=ns+1,n=yn.length;for(;e<n;){const s=e+n>>>1,r=yn[s],i=jo(r);i<t||i===t&&r.flags&2?e=s+1:n=s}return e}function Hd(t){if(!(t.flags&1)){const e=jo(t),n=yn[yn.length-1];!n||!(t.flags&2)&&e>=jo(n)?yn.push(t):yn.splice(R0(e),0,t),t.flags|=1,vy()}}function vy(){Pl||(Pl=yy.then(_y))}function $0(t){qe(t)?bi.push(...t):Hs&&t.id===-1?Hs.splice(di+1,0,t):t.flags&1||(bi.push(t),t.flags|=1),vy()}function mh(t,e,n=ns+1){for(;n<yn.length;n++){const s=yn[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;yn.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function by(t){if(bi.length){const e=[...new Set(bi)].sort((n,s)=>jo(n)-jo(s));if(bi.length=0,Hs){Hs.push(...e);return}for(Hs=e,di=0;di<Hs.length;di++){const n=Hs[di];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Hs=null,di=0}}const jo=t=>t.id==null?t.flags&2?-1:1/0:t.id;function _y(t){try{for(ns=0;ns<yn.length;ns++){const e=yn[ns];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ra(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ns<yn.length;ns++){const e=yn[ns];e&&(e.flags&=-2)}ns=-1,yn.length=0,by(),Pl=null,(yn.length||bi.length)&&_y()}}let Qt=null,wy=null;function Al(t){const e=Qt;return Qt=t,wy=t&&t.type.__scopeId||null,e}function rt(t,e=Qt,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&Eh(-1);const i=Al(e);let o;try{o=t(...r)}finally{Al(i),s._d&&Eh(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Zs(t,e){if(Qt===null)return t;const n=lc(Qt),s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,a,l=mt]=e[r];i&&(Ye(i)&&(i={mounted:i,updated:i}),i.deep&&Ps(o),s.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function mr(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let l=a.dir[s];l&&(Is(),Vn(l,n,8,[t.el,a,t,e]),Es())}}const xy=Symbol("_vte"),F0=t=>t.__isTeleport,ko=t=>t&&(t.disabled||t.disabled===""),yh=t=>t&&(t.defer||t.defer===""),vh=t=>typeof SVGElement<"u"&&t instanceof SVGElement,bh=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,Qu=(t,e)=>{const n=t&&t.to;return Et(n)?e?e(n):null:n},ky={name:"Teleport",__isTeleport:!0,process(t,e,n,s,r,i,o,a,l,c){const{mc:u,pc:f,pbc:p,o:{insert:g,querySelector:v,createText:w,createComment:x}}=c,k=ko(e.props);let{shapeFlag:S,children:E,dynamicChildren:D}=e;if(t==null){const T=e.el=w(""),P=e.anchor=w("");g(T,n,s),g(P,n,s);const A=(I,Y)=>{S&16&&(r&&r.isCE&&(r.ce._teleportTarget=I),u(E,I,Y,r,i,o,a,l))},$=()=>{const I=e.target=Qu(e.props,v),Y=Cy(I,e,w,g);I&&(o!=="svg"&&vh(I)?o="svg":o!=="mathml"&&bh(I)&&(o="mathml"),k||(A(I,Y),fl(e,!1)))};k&&(A(n,P),fl(e,!0)),yh(e.props)?(e.el.__isMounted=!1,mn(()=>{$(),delete e.el.__isMounted},i)):$()}else{if(yh(e.props)&&t.el.__isMounted===!1){mn(()=>{ky.process(t,e,n,s,r,i,o,a,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const T=e.anchor=t.anchor,P=e.target=t.target,A=e.targetAnchor=t.targetAnchor,$=ko(t.props),I=$?n:P,Y=$?T:A;if(o==="svg"||vh(P)?o="svg":(o==="mathml"||bh(P))&&(o="mathml"),D?(p(t.dynamicChildren,D,I,r,i,o,a),Gd(t,e,!0)):l||f(t,e,I,Y,r,i,o,a,!1),k)$?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Ua(e,n,T,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const U=e.target=Qu(e.props,v);U&&Ua(e,U,null,c,0)}else $&&Ua(e,P,A,c,1);fl(e,k)}},remove(t,e,n,{um:s,o:{remove:r}},i){const{shapeFlag:o,children:a,anchor:l,targetStart:c,targetAnchor:u,target:f,props:p}=t;if(f&&(r(c),r(u)),i&&r(l),o&16){const g=i||!ko(p);for(let v=0;v<a.length;v++){const w=a[v];s(w,e,n,g,!!w.dynamicChildren)}}},move:Ua,hydrate:L0};function Ua(t,e,n,{o:{insert:s},m:r},i=2){i===0&&s(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=t,f=i===2;if(f&&s(o,e,n),(!f||ko(u))&&l&16)for(let p=0;p<c.length;p++)r(c[p],e,n,2);f&&s(a,e,n)}function L0(t,e,n,s,r,i,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:c,createText:u}},f){const p=e.target=Qu(e.props,l);if(p){const g=ko(e.props),v=p._lpa||p.firstChild;if(e.shapeFlag&16)if(g)e.anchor=f(o(t),e,a(t),n,s,r,i),e.targetStart=v,e.targetAnchor=v&&o(v);else{e.anchor=o(t);let w=v;for(;w;){if(w&&w.nodeType===8){if(w.data==="teleport start anchor")e.targetStart=w;else if(w.data==="teleport anchor"){e.targetAnchor=w,p._lpa=e.targetAnchor&&o(e.targetAnchor);break}}w=o(w)}e.targetAnchor||Cy(p,e,u,c),f(v&&o(v),e,p,n,s,r,i)}fl(e,g)}return e.anchor&&o(e.anchor)}const B0=ky;function fl(t,e){const n=t.ctx;if(n&&n.ut){let s,r;for(e?(s=t.el,r=t.anchor):(s=t.targetStart,r=t.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function Cy(t,e,n,s){const r=e.targetStart=n(""),i=e.targetAnchor=n("");return r[xy]=i,t&&(s(r,t),s(i,t)),i}const Er=Symbol("_leaveCb"),Wa=Symbol("_enterCb");function j0(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Tn(()=>{t.isMounted=!0}),ic(()=>{t.isUnmounting=!0}),t}const $n=[Function,Array],N0={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$n,onEnter:$n,onAfterEnter:$n,onEnterCancelled:$n,onBeforeLeave:$n,onLeave:$n,onAfterLeave:$n,onLeaveCancelled:$n,onBeforeAppear:$n,onAppear:$n,onAfterAppear:$n,onAppearCancelled:$n};function z0(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function Ju(t,e,n,s,r){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:p,onLeave:g,onAfterLeave:v,onLeaveCancelled:w,onBeforeAppear:x,onAppear:k,onAfterAppear:S,onAppearCancelled:E}=e,D=String(t.key),T=z0(n,t),P=(I,Y)=>{I&&Vn(I,s,9,Y)},A=(I,Y)=>{const U=Y[1];P(I,Y),qe(I)?I.every(z=>z.length<=1)&&U():I.length<=1&&U()},$={mode:o,persisted:a,beforeEnter(I){let Y=l;if(!n.isMounted)if(i)Y=x||l;else return;I[Er]&&I[Er](!0);const U=T[D];U&&fi(t,U)&&U.el[Er]&&U.el[Er](),P(Y,[I])},enter(I){let Y=c,U=u,z=f;if(!n.isMounted)if(i)Y=k||c,U=S||u,z=E||f;else return;let pe=!1;const ye=I[Wa]=ue=>{pe||(pe=!0,ue?P(z,[I]):P(U,[I]),$.delayedLeave&&$.delayedLeave(),I[Wa]=void 0)};Y?A(Y,[I,ye]):ye()},leave(I,Y){const U=String(t.key);if(I[Wa]&&I[Wa](!0),n.isUnmounting)return Y();P(p,[I]);let z=!1;const pe=I[Er]=ye=>{z||(z=!0,Y(),ye?P(w,[I]):P(v,[I]),I[Er]=void 0,T[U]===t&&delete T[U])};T[U]=t,g?A(g,[I,pe]):pe()},clone(I){return Ju(I,e,n,s)}};return $}function No(t,e){t.shapeFlag&6&&t.component?(t.transition=e,No(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Sy(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Qe?(o.patchFlag&128&&r++,s=s.concat(Sy(o.children,e,a))):(e||o.type!==Hn)&&s.push(a!=null?ir(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function et(t,e){return Ye(t)?Bt({name:t.name},e,{setup:t}):t}function q0(){const t=cs();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function Py(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Co(t,e,n,s,r=!1){if(qe(t)){t.forEach((v,w)=>Co(v,e&&(qe(e)?e[w]:e),n,s,r));return}if(_i(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Co(t,e,n,s.component.subTree);return}const i=s.shapeFlag&4?lc(s.component):s.el,o=r?null:i,{i:a,r:l}=t,c=e&&e.r,u=a.refs===mt?a.refs={}:a.refs,f=a.setupState,p=tt(f),g=f===mt?Um:v=>ft(p,v);if(c!=null&&c!==l){if(Et(c))u[c]=null,g(c)&&(f[c]=null);else if($t(c)){c.value=null;const v=e;v.k&&(u[v.k]=null)}}if(Ye(l))ra(l,a,12,[o,u]);else{const v=Et(l),w=$t(l);if(v||w){const x=()=>{if(t.f){const k=v?g(l)?f[l]:u[l]:l.value;if(r)qe(k)&&$d(k,i);else if(qe(k))k.includes(i)||k.push(i);else if(v)u[l]=[i],g(l)&&(f[l]=u[l]);else{const S=[i];l.value=S,t.k&&(u[t.k]=S)}}else v?(u[l]=o,g(l)&&(f[l]=o)):w&&(l.value=o,t.k&&(u[t.k]=o))};o?(x.id=-1,mn(x,n)):x()}}}Jl().requestIdleCallback;Jl().cancelIdleCallback;const _i=t=>!!t.type.__asyncLoader,Ay=t=>t.type.__isKeepAlive;function U0(t,e){Iy(t,"a",e)}function W0(t,e){Iy(t,"da",e)}function Iy(t,e,n=cn){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(rc(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Ay(r.parent.vnode)&&V0(s,e,n,r),r=r.parent}}function V0(t,e,n,s){const r=rc(e,t,s,!0);Fi(()=>{$d(s[e],r)},n)}function rc(t,e,n=cn,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Is();const a=ia(n),l=Vn(e,n,t,o);return a(),Es(),l});return s?r.unshift(i):r.push(i),i}}const Os=t=>(e,n=cn)=>{(!Uo||t==="sp")&&rc(t,(...s)=>e(...s),n)},H0=Os("bm"),Tn=Os("m"),K0=Os("bu"),Ey=Os("u"),ic=Os("bum"),Fi=Os("um"),Y0=Os("sp"),G0=Os("rtg"),X0=Os("rtc");function Q0(t,e=cn){rc("ec",t,e)}const J0="components";function Si(t,e){return ew(J0,t,!0,e)||t}const Z0=Symbol.for("v-ndc");function ew(t,e,n=!0,s=!1){const r=Qt||cn;if(r){const i=r.type;{const a=jw(i,!1);if(a&&(a===e||a===On(e)||a===Ql(On(e))))return i}const o=_h(r[t]||i[t],e)||_h(r.appContext[t],e);return!o&&s?i:o}}function _h(t,e){return t&&(t[e]||t[On(e)]||t[Ql(On(e))])}function It(t,e,n,s){let r;const i=n,o=qe(t);if(o||Et(t)){const a=o&&Js(t);let l=!1,c=!1;a&&(l=!zn(t),c=rr(t),t=tc(t)),r=new Array(t.length);for(let u=0,f=t.length;u<f;u++)r[u]=e(l?c?Cl(Xt(t[u])):Xt(t[u]):t[u],u,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let a=0;a<t;a++)r[a]=e(a+1,a,void 0,i)}else if(vt(t))if(t[Symbol.iterator])r=Array.from(t,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(t);r=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];r[l]=e(t[u],u,l,i)}}else r=[];return r}function xn(t,e,n={},s,r){if(Qt.ce||Qt.parent&&_i(Qt.parent)&&Qt.parent.ce)return j(),en(Qe,null,[ze("slot",n,s)],64);let i=t[e];i&&i._c&&(i._d=!1),j();const o=i&&My(i(n)),a=n.key||o&&o.key,l=en(Qe,{key:(a&&!Wn(a)?a:`_${e}`)+(!o&&s?"_fb":"")},o||[],o&&t._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function My(t){return t.some(e=>qo(e)?!(e.type===Hn||e.type===Qe&&!My(e.children)):!0)?t:null}const Zu=t=>t?Xy(t)?lc(t):Zu(t.parent):null,So=Bt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Zu(t.parent),$root:t=>Zu(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Dy(t),$forceUpdate:t=>t.f||(t.f=()=>{Hd(t.update)}),$nextTick:t=>t.n||(t.n=un.bind(t.proxy)),$watch:t=>xw.bind(t)}),lu=(t,e)=>t!==mt&&!t.__isScriptSetup&&ft(t,e),tw={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const g=o[e];if(g!==void 0)switch(g){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(lu(s,e))return o[e]=1,s[e];if(r!==mt&&ft(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&ft(c,e))return o[e]=3,i[e];if(n!==mt&&ft(n,e))return o[e]=4,n[e];ed&&(o[e]=0)}}const u=So[e];let f,p;if(u)return e==="$attrs"&&an(t.attrs,"get",""),u(t);if((f=a.__cssModules)&&(f=f[e]))return f;if(n!==mt&&ft(n,e))return o[e]=4,n[e];if(p=l.config.globalProperties,ft(p,e))return p[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return lu(r,e)?(r[e]=n,!0):s!==mt&&ft(s,e)?(s[e]=n,!0):ft(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i,type:o}},a){let l,c;return!!(n[a]||t!==mt&&a[0]!=="$"&&ft(t,a)||lu(e,a)||(l=i[0])&&ft(l,a)||ft(s,a)||ft(So,a)||ft(r.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ft(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function wh(t){return qe(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let ed=!0;function nw(t){const e=Dy(t),n=t.proxy,s=t.ctx;ed=!1,e.beforeCreate&&xh(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:g,updated:v,activated:w,deactivated:x,beforeDestroy:k,beforeUnmount:S,destroyed:E,unmounted:D,render:T,renderTracked:P,renderTriggered:A,errorCaptured:$,serverPrefetch:I,expose:Y,inheritAttrs:U,components:z,directives:pe,filters:ye}=e;if(c&&sw(c,s,null),o)for(const ke in o){const Z=o[ke];Ye(Z)&&(s[ke]=Z.bind(n))}if(r){const ke=r.call(n,n);vt(ke)&&(t.data=Vr(ke))}if(ed=!0,i)for(const ke in i){const Z=i[ke],ne=Ye(Z)?Z.bind(n,n):Ye(Z.get)?Z.get.bind(n,n):os,X=!Ye(Z)&&Ye(Z.set)?Z.set.bind(n):os,Le=We({get:ne,set:X});Object.defineProperty(s,ke,{enumerable:!0,configurable:!0,get:()=>Le.value,set:Se=>Le.value=Se})}if(a)for(const ke in a)Oy(a[ke],s,n,ke);if(l){const ke=Ye(l)?l.call(n):l;Reflect.ownKeys(ke).forEach(Z=>{Po(Z,ke[Z])})}u&&xh(u,t,"c");function _e(ke,Z){qe(Z)?Z.forEach(ne=>ke(ne.bind(n))):Z&&ke(Z.bind(n))}if(_e(H0,f),_e(Tn,p),_e(K0,g),_e(Ey,v),_e(U0,w),_e(W0,x),_e(Q0,$),_e(X0,P),_e(G0,A),_e(ic,S),_e(Fi,D),_e(Y0,I),qe(Y))if(Y.length){const ke=t.exposed||(t.exposed={});Y.forEach(Z=>{Object.defineProperty(ke,Z,{get:()=>n[Z],set:ne=>n[Z]=ne,enumerable:!0})})}else t.exposed||(t.exposed={});T&&t.render===os&&(t.render=T),U!=null&&(t.inheritAttrs=U),z&&(t.components=z),pe&&(t.directives=pe),I&&Py(t)}function sw(t,e,n=os){qe(t)&&(t=td(t));for(const s in t){const r=t[s];let i;vt(r)?"default"in r?i=Mn(r.from||s,r.default,!0):i=Mn(r.from||s):i=Mn(r),$t(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function xh(t,e,n){Vn(qe(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function Oy(t,e,n,s){let r=s.includes(".")?Uy(n,s):()=>n[s];if(Et(t)){const i=e[t];Ye(i)&&Kt(r,i)}else if(Ye(t))Kt(r,t.bind(n));else if(vt(t))if(qe(t))t.forEach(i=>Oy(i,e,n,s));else{const i=Ye(t.handler)?t.handler.bind(n):e[t.handler];Ye(i)&&Kt(r,i,t)}}function Dy(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let l;return a?l=a:!r.length&&!n&&!s?l=e:(l={},r.length&&r.forEach(c=>Il(l,c,o,!0)),Il(l,e,o)),vt(e)&&i.set(e,l),l}function Il(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Il(t,i,n,!0),r&&r.forEach(o=>Il(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=rw[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const rw={data:kh,props:Ch,emits:Ch,methods:ho,computed:ho,beforeCreate:gn,created:gn,beforeMount:gn,mounted:gn,beforeUpdate:gn,updated:gn,beforeDestroy:gn,beforeUnmount:gn,destroyed:gn,unmounted:gn,activated:gn,deactivated:gn,errorCaptured:gn,serverPrefetch:gn,components:ho,directives:ho,watch:ow,provide:kh,inject:iw};function kh(t,e){return e?t?function(){return Bt(Ye(t)?t.call(this,this):t,Ye(e)?e.call(this,this):e)}:e:t}function iw(t,e){return ho(td(t),td(e))}function td(t){if(qe(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function gn(t,e){return t?[...new Set([].concat(t,e))]:e}function ho(t,e){return t?Bt(Object.create(null),t,e):e}function Ch(t,e){return t?qe(t)&&qe(e)?[...new Set([...t,...e])]:Bt(Object.create(null),wh(t),wh(e??{})):e}function ow(t,e){if(!t)return e;if(!e)return t;const n=Bt(Object.create(null),t);for(const s in e)n[s]=gn(t[s],e[s]);return n}function Ty(){return{app:null,config:{isNativeTag:Um,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let aw=0;function lw(t,e){return function(s,r=null){Ye(s)||(s=Bt({},s)),r!=null&&!vt(r)&&(r=null);const i=Ty(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:aw++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:Jy,get config(){return i.config},set config(u){},use(u,...f){return o.has(u)||(u&&Ye(u.install)?(o.add(u),u.install(c,...f)):Ye(u)&&(o.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,p){if(!l){const g=c._ceVNode||ze(s,r);return g.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),t(g,u,p),l=!0,c._container=u,u.__vue_app__=c,lc(g.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Vn(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=jr;jr=c;try{return u()}finally{jr=f}}};return c}}let jr=null;function Po(t,e){if(cn){let n=cn.provides;const s=cn.parent&&cn.parent.provides;s===n&&(n=cn.provides=Object.create(s)),n[t]=e}}function Mn(t,e,n=!1){const s=cs();if(s||jr){let r=jr?jr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&Ye(e)?e.call(s&&s.proxy):e}}function cw(){return!!(cs()||jr)}const Ry={},$y=()=>Object.create(Ry),Fy=t=>Object.getPrototypeOf(t)===Ry;function uw(t,e,n,s=!1){const r={},i=$y();t.propsDefaults=Object.create(null),Ly(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:hy(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function dw(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=tt(r),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let p=u[f];if(oc(t.emitsOptions,p))continue;const g=e[p];if(l)if(ft(i,p))g!==i[p]&&(i[p]=g,c=!0);else{const v=On(p);r[v]=nd(l,a,v,g,t,!1)}else g!==i[p]&&(i[p]=g,c=!0)}}}else{Ly(t,e,r,i)&&(c=!0);let u;for(const f in a)(!e||!ft(e,f)&&((u=ar(f))===f||!ft(e,u)))&&(l?n&&(n[f]!==void 0||n[u]!==void 0)&&(r[f]=nd(l,a,f,void 0,t,!0)):delete r[f]);if(i!==a)for(const f in i)(!e||!ft(e,f))&&(delete i[f],c=!0)}c&&Ss(t.attrs,"set","")}function Ly(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(_o(l))continue;const c=e[l];let u;r&&ft(r,u=On(l))?!i||!i.includes(u)?n[u]=c:(a||(a={}))[u]=c:oc(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(i){const l=tt(n),c=a||mt;for(let u=0;u<i.length;u++){const f=i[u];n[f]=nd(r,l,f,c[f],t,!ft(c,f))}}return o}function nd(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=ft(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ye(l)){const{propsDefaults:c}=r;if(n in c)s=c[n];else{const u=ia(r);s=c[n]=l.call(null,e),u()}}else s=l;r.ce&&r.ce._setProp(n,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===ar(n))&&(s=!0))}return s}const fw=new WeakMap;function By(t,e,n=!1){const s=n?fw:e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let l=!1;if(!Ye(t)){const u=f=>{l=!0;const[p,g]=By(f,e,!0);Bt(o,p),g&&a.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return vt(t)&&s.set(t,yi),yi;if(qe(i))for(let u=0;u<i.length;u++){const f=On(i[u]);Sh(f)&&(o[f]=mt)}else if(i)for(const u in i){const f=On(u);if(Sh(f)){const p=i[u],g=o[f]=qe(p)||Ye(p)?{type:p}:Bt({},p),v=g.type;let w=!1,x=!0;if(qe(v))for(let k=0;k<v.length;++k){const S=v[k],E=Ye(S)&&S.name;if(E==="Boolean"){w=!0;break}else E==="String"&&(x=!1)}else w=Ye(v)&&v.name==="Boolean";g[0]=w,g[1]=x,(w||ft(g,"default"))&&a.push(f)}}const c=[o,a];return vt(t)&&s.set(t,c),c}function Sh(t){return t[0]!=="$"&&!_o(t)}const Kd=t=>t==="_"||t==="_ctx"||t==="$stable",Yd=t=>qe(t)?t.map(is):[is(t)],hw=(t,e,n)=>{if(e._n)return e;const s=rt((...r)=>Yd(e(...r)),n);return s._c=!1,s},jy=(t,e,n)=>{const s=t._ctx;for(const r in t){if(Kd(r))continue;const i=t[r];if(Ye(i))e[r]=hw(r,i,s);else if(i!=null){const o=Yd(i);e[r]=()=>o}}},Ny=(t,e)=>{const n=Yd(e);t.slots.default=()=>n},zy=(t,e,n)=>{for(const s in e)(n||!Kd(s))&&(t[s]=e[s])},pw=(t,e,n)=>{const s=t.slots=$y();if(t.vnode.shapeFlag&32){const r=e._;r?(zy(s,e,n),n&&Km(s,"_",r,!0)):jy(e,s)}else e&&Ny(t,e)},gw=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=mt;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:zy(r,e,n):(i=!e.$stable,jy(e,r)),o=e}else e&&(Ny(t,e),o={default:1});if(i)for(const a in r)!Kd(a)&&o[a]==null&&delete r[a]},mn=Ew;function mw(t){return yw(t)}function yw(t,e){const n=Jl();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:p,setScopeId:g=os,insertStaticContent:v}=t,w=(O,L,ee,le=null,de=null,ce=null,Ie=void 0,Pe=null,xe=!!L.dynamicChildren)=>{if(O===L)return;O&&!fi(O,L)&&(le=ae(O),Se(O,de,ce,!0),O=null),L.patchFlag===-2&&(xe=!1,L.dynamicChildren=null);const{type:he,ref:Ne,shapeFlag:Ee}=L;switch(he){case ac:x(O,L,ee,le);break;case Hn:k(O,L,ee,le);break;case hl:O==null&&S(L,ee,le,Ie);break;case Qe:z(O,L,ee,le,de,ce,Ie,Pe,xe);break;default:Ee&1?T(O,L,ee,le,de,ce,Ie,Pe,xe):Ee&6?pe(O,L,ee,le,de,ce,Ie,Pe,xe):(Ee&64||Ee&128)&&he.process(O,L,ee,le,de,ce,Ie,Pe,xe,Fe)}Ne!=null&&de?Co(Ne,O&&O.ref,ce,L||O,!L):Ne==null&&O&&O.ref!=null&&Co(O.ref,null,ce,O,!0)},x=(O,L,ee,le)=>{if(O==null)s(L.el=a(L.children),ee,le);else{const de=L.el=O.el;L.children!==O.children&&c(de,L.children)}},k=(O,L,ee,le)=>{O==null?s(L.el=l(L.children||""),ee,le):L.el=O.el},S=(O,L,ee,le)=>{[O.el,O.anchor]=v(O.children,L,ee,le,O.el,O.anchor)},E=({el:O,anchor:L},ee,le)=>{let de;for(;O&&O!==L;)de=p(O),s(O,ee,le),O=de;s(L,ee,le)},D=({el:O,anchor:L})=>{let ee;for(;O&&O!==L;)ee=p(O),r(O),O=ee;r(L)},T=(O,L,ee,le,de,ce,Ie,Pe,xe)=>{L.type==="svg"?Ie="svg":L.type==="math"&&(Ie="mathml"),O==null?P(L,ee,le,de,ce,Ie,Pe,xe):I(O,L,de,ce,Ie,Pe,xe)},P=(O,L,ee,le,de,ce,Ie,Pe)=>{let xe,he;const{props:Ne,shapeFlag:Ee,transition:je,dirs:Ue}=O;if(xe=O.el=o(O.type,ce,Ne&&Ne.is,Ne),Ee&8?u(xe,O.children):Ee&16&&$(O.children,xe,null,le,de,cu(O,ce),Ie,Pe),Ue&&mr(O,null,le,"created"),A(xe,O,O.scopeId,Ie,le),Ne){for(const ot in Ne)ot!=="value"&&!_o(ot)&&i(xe,ot,null,Ne[ot],ce,le);"value"in Ne&&i(xe,"value",null,Ne.value,ce),(he=Ne.onVnodeBeforeMount)&&Jn(he,le,O)}Ue&&mr(O,null,le,"beforeMount");const Ge=vw(de,je);Ge&&je.beforeEnter(xe),s(xe,L,ee),((he=Ne&&Ne.onVnodeMounted)||Ge||Ue)&&mn(()=>{he&&Jn(he,le,O),Ge&&je.enter(xe),Ue&&mr(O,null,le,"mounted")},de)},A=(O,L,ee,le,de)=>{if(ee&&g(O,ee),le)for(let ce=0;ce<le.length;ce++)g(O,le[ce]);if(de){let ce=de.subTree;if(L===ce||Vy(ce.type)&&(ce.ssContent===L||ce.ssFallback===L)){const Ie=de.vnode;A(O,Ie,Ie.scopeId,Ie.slotScopeIds,de.parent)}}},$=(O,L,ee,le,de,ce,Ie,Pe,xe=0)=>{for(let he=xe;he<O.length;he++){const Ne=O[he]=Pe?Ks(O[he]):is(O[he]);w(null,Ne,L,ee,le,de,ce,Ie,Pe)}},I=(O,L,ee,le,de,ce,Ie)=>{const Pe=L.el=O.el;let{patchFlag:xe,dynamicChildren:he,dirs:Ne}=L;xe|=O.patchFlag&16;const Ee=O.props||mt,je=L.props||mt;let Ue;if(ee&&yr(ee,!1),(Ue=je.onVnodeBeforeUpdate)&&Jn(Ue,ee,L,O),Ne&&mr(L,O,ee,"beforeUpdate"),ee&&yr(ee,!0),(Ee.innerHTML&&je.innerHTML==null||Ee.textContent&&je.textContent==null)&&u(Pe,""),he?Y(O.dynamicChildren,he,Pe,ee,le,cu(L,de),ce):Ie||Z(O,L,Pe,null,ee,le,cu(L,de),ce,!1),xe>0){if(xe&16)U(Pe,Ee,je,ee,de);else if(xe&2&&Ee.class!==je.class&&i(Pe,"class",null,je.class,de),xe&4&&i(Pe,"style",Ee.style,je.style,de),xe&8){const Ge=L.dynamicProps;for(let ot=0;ot<Ge.length;ot++){const lt=Ge[ot],Ft=Ee[lt],jt=je[lt];(jt!==Ft||lt==="value")&&i(Pe,lt,Ft,jt,de,ee)}}xe&1&&O.children!==L.children&&u(Pe,L.children)}else!Ie&&he==null&&U(Pe,Ee,je,ee,de);((Ue=je.onVnodeUpdated)||Ne)&&mn(()=>{Ue&&Jn(Ue,ee,L,O),Ne&&mr(L,O,ee,"updated")},le)},Y=(O,L,ee,le,de,ce,Ie)=>{for(let Pe=0;Pe<L.length;Pe++){const xe=O[Pe],he=L[Pe],Ne=xe.el&&(xe.type===Qe||!fi(xe,he)||xe.shapeFlag&198)?f(xe.el):ee;w(xe,he,Ne,null,le,de,ce,Ie,!0)}},U=(O,L,ee,le,de)=>{if(L!==ee){if(L!==mt)for(const ce in L)!_o(ce)&&!(ce in ee)&&i(O,ce,L[ce],null,de,le);for(const ce in ee){if(_o(ce))continue;const Ie=ee[ce],Pe=L[ce];Ie!==Pe&&ce!=="value"&&i(O,ce,Pe,Ie,de,le)}"value"in ee&&i(O,"value",L.value,ee.value,de)}},z=(O,L,ee,le,de,ce,Ie,Pe,xe)=>{const he=L.el=O?O.el:a(""),Ne=L.anchor=O?O.anchor:a("");let{patchFlag:Ee,dynamicChildren:je,slotScopeIds:Ue}=L;Ue&&(Pe=Pe?Pe.concat(Ue):Ue),O==null?(s(he,ee,le),s(Ne,ee,le),$(L.children||[],ee,Ne,de,ce,Ie,Pe,xe)):Ee>0&&Ee&64&&je&&O.dynamicChildren?(Y(O.dynamicChildren,je,ee,de,ce,Ie,Pe),(L.key!=null||de&&L===de.subTree)&&Gd(O,L,!0)):Z(O,L,ee,Ne,de,ce,Ie,Pe,xe)},pe=(O,L,ee,le,de,ce,Ie,Pe,xe)=>{L.slotScopeIds=Pe,O==null?L.shapeFlag&512?de.ctx.activate(L,ee,le,Ie,xe):ye(L,ee,le,de,ce,Ie,xe):ue(O,L,xe)},ye=(O,L,ee,le,de,ce,Ie)=>{const Pe=O.component=Rw(O,le,de);if(Ay(O)&&(Pe.ctx.renderer=Fe),$w(Pe,!1,Ie),Pe.asyncDep){if(de&&de.registerDep(Pe,_e,Ie),!O.el){const xe=Pe.subTree=ze(Hn);k(null,xe,L,ee),O.placeholder=xe.el}}else _e(Pe,O,L,ee,de,ce,Ie)},ue=(O,L,ee)=>{const le=L.component=O.component;if(Aw(O,L,ee))if(le.asyncDep&&!le.asyncResolved){ke(le,L,ee);return}else le.next=L,le.update();else L.el=O.el,le.vnode=L},_e=(O,L,ee,le,de,ce,Ie)=>{const Pe=()=>{if(O.isMounted){let{next:Ee,bu:je,u:Ue,parent:Ge,vnode:ot}=O;{const Nt=qy(O);if(Nt){Ee&&(Ee.el=ot.el,ke(O,Ee,Ie)),Nt.asyncDep.then(()=>{O.isUnmounted||Pe()});return}}let lt=Ee,Ft;yr(O,!1),Ee?(Ee.el=ot.el,ke(O,Ee,Ie)):Ee=ot,je&&dl(je),(Ft=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&Jn(Ft,Ge,Ee,ot),yr(O,!0);const jt=Ah(O),hn=O.subTree;O.subTree=jt,w(hn,jt,f(hn.el),ae(hn),O,de,ce),Ee.el=jt.el,lt===null&&Iw(O,jt.el),Ue&&mn(Ue,de),(Ft=Ee.props&&Ee.props.onVnodeUpdated)&&mn(()=>Jn(Ft,Ge,Ee,ot),de)}else{let Ee;const{el:je,props:Ue}=L,{bm:Ge,m:ot,parent:lt,root:Ft,type:jt}=O,hn=_i(L);yr(O,!1),Ge&&dl(Ge),!hn&&(Ee=Ue&&Ue.onVnodeBeforeMount)&&Jn(Ee,lt,L),yr(O,!0);{Ft.ce&&Ft.ce._def.shadowRoot!==!1&&Ft.ce._injectChildStyle(jt);const Nt=O.subTree=Ah(O);w(null,Nt,ee,le,O,de,ce),L.el=Nt.el}if(ot&&mn(ot,de),!hn&&(Ee=Ue&&Ue.onVnodeMounted)){const Nt=L;mn(()=>Jn(Ee,lt,Nt),de)}(L.shapeFlag&256||lt&&_i(lt.vnode)&&lt.vnode.shapeFlag&256)&&O.a&&mn(O.a,de),O.isMounted=!0,L=ee=le=null}};O.scope.on();const xe=O.effect=new Zm(Pe);O.scope.off();const he=O.update=xe.run.bind(xe),Ne=O.job=xe.runIfDirty.bind(xe);Ne.i=O,Ne.id=O.uid,xe.scheduler=()=>Hd(Ne),yr(O,!0),he()},ke=(O,L,ee)=>{L.component=O;const le=O.vnode.props;O.vnode=L,O.next=null,dw(O,L.props,le,ee),gw(O,L.children,ee),Is(),mh(O),Es()},Z=(O,L,ee,le,de,ce,Ie,Pe,xe=!1)=>{const he=O&&O.children,Ne=O?O.shapeFlag:0,Ee=L.children,{patchFlag:je,shapeFlag:Ue}=L;if(je>0){if(je&128){X(he,Ee,ee,le,de,ce,Ie,Pe,xe);return}else if(je&256){ne(he,Ee,ee,le,de,ce,Ie,Pe,xe);return}}Ue&8?(Ne&16&&it(he,de,ce),Ee!==he&&u(ee,Ee)):Ne&16?Ue&16?X(he,Ee,ee,le,de,ce,Ie,Pe,xe):it(he,de,ce,!0):(Ne&8&&u(ee,""),Ue&16&&$(Ee,ee,le,de,ce,Ie,Pe,xe))},ne=(O,L,ee,le,de,ce,Ie,Pe,xe)=>{O=O||yi,L=L||yi;const he=O.length,Ne=L.length,Ee=Math.min(he,Ne);let je;for(je=0;je<Ee;je++){const Ue=L[je]=xe?Ks(L[je]):is(L[je]);w(O[je],Ue,ee,null,de,ce,Ie,Pe,xe)}he>Ne?it(O,de,ce,!0,!1,Ee):$(L,ee,le,de,ce,Ie,Pe,xe,Ee)},X=(O,L,ee,le,de,ce,Ie,Pe,xe)=>{let he=0;const Ne=L.length;let Ee=O.length-1,je=Ne-1;for(;he<=Ee&&he<=je;){const Ue=O[he],Ge=L[he]=xe?Ks(L[he]):is(L[he]);if(fi(Ue,Ge))w(Ue,Ge,ee,null,de,ce,Ie,Pe,xe);else break;he++}for(;he<=Ee&&he<=je;){const Ue=O[Ee],Ge=L[je]=xe?Ks(L[je]):is(L[je]);if(fi(Ue,Ge))w(Ue,Ge,ee,null,de,ce,Ie,Pe,xe);else break;Ee--,je--}if(he>Ee){if(he<=je){const Ue=je+1,Ge=Ue<Ne?L[Ue].el:le;for(;he<=je;)w(null,L[he]=xe?Ks(L[he]):is(L[he]),ee,Ge,de,ce,Ie,Pe,xe),he++}}else if(he>je)for(;he<=Ee;)Se(O[he],de,ce,!0),he++;else{const Ue=he,Ge=he,ot=new Map;for(he=Ge;he<=je;he++){const Mt=L[he]=xe?Ks(L[he]):is(L[he]);Mt.key!=null&&ot.set(Mt.key,he)}let lt,Ft=0;const jt=je-Ge+1;let hn=!1,Nt=0;const Yn=new Array(jt);for(he=0;he<jt;he++)Yn[he]=0;for(he=Ue;he<=Ee;he++){const Mt=O[he];if(Ft>=jt){Se(Mt,de,ce,!0);continue}let Re;if(Mt.key!=null)Re=ot.get(Mt.key);else for(lt=Ge;lt<=je;lt++)if(Yn[lt-Ge]===0&&fi(Mt,L[lt])){Re=lt;break}Re===void 0?Se(Mt,de,ce,!0):(Yn[Re-Ge]=he+1,Re>=Nt?Nt=Re:hn=!0,w(Mt,L[Re],ee,null,de,ce,Ie,Pe,xe),Ft++)}const Qr=hn?bw(Yn):yi;for(lt=Qr.length-1,he=jt-1;he>=0;he--){const Mt=Ge+he,Re=L[Mt],Ds=L[Mt+1],Gn=Mt+1<Ne?Ds.el||Ds.placeholder:le;Yn[he]===0?w(null,Re,ee,Gn,de,ce,Ie,Pe,xe):hn&&(lt<0||he!==Qr[lt]?Le(Re,ee,Gn,2):lt--)}}},Le=(O,L,ee,le,de=null)=>{const{el:ce,type:Ie,transition:Pe,children:xe,shapeFlag:he}=O;if(he&6){Le(O.component.subTree,L,ee,le);return}if(he&128){O.suspense.move(L,ee,le);return}if(he&64){Ie.move(O,L,ee,Fe);return}if(Ie===Qe){s(ce,L,ee);for(let Ee=0;Ee<xe.length;Ee++)Le(xe[Ee],L,ee,le);s(O.anchor,L,ee);return}if(Ie===hl){E(O,L,ee);return}if(le!==2&&he&1&&Pe)if(le===0)Pe.beforeEnter(ce),s(ce,L,ee),mn(()=>Pe.enter(ce),de);else{const{leave:Ee,delayLeave:je,afterLeave:Ue}=Pe,Ge=()=>{O.ctx.isUnmounted?r(ce):s(ce,L,ee)},ot=()=>{ce._isLeaving&&ce[Er](!0),Ee(ce,()=>{Ge(),Ue&&Ue()})};je?je(ce,Ge,ot):ot()}else s(ce,L,ee)},Se=(O,L,ee,le=!1,de=!1)=>{const{type:ce,props:Ie,ref:Pe,children:xe,dynamicChildren:he,shapeFlag:Ne,patchFlag:Ee,dirs:je,cacheIndex:Ue}=O;if(Ee===-2&&(de=!1),Pe!=null&&(Is(),Co(Pe,null,ee,O,!0),Es()),Ue!=null&&(L.renderCache[Ue]=void 0),Ne&256){L.ctx.deactivate(O);return}const Ge=Ne&1&&je,ot=!_i(O);let lt;if(ot&&(lt=Ie&&Ie.onVnodeBeforeUnmount)&&Jn(lt,L,O),Ne&6)gt(O.component,ee,le);else{if(Ne&128){O.suspense.unmount(ee,le);return}Ge&&mr(O,null,L,"beforeUnmount"),Ne&64?O.type.remove(O,L,ee,Fe,le):he&&!he.hasOnce&&(ce!==Qe||Ee>0&&Ee&64)?it(he,L,ee,!1,!0):(ce===Qe&&Ee&384||!de&&Ne&16)&&it(xe,L,ee),le&&Ve(O)}(ot&&(lt=Ie&&Ie.onVnodeUnmounted)||Ge)&&mn(()=>{lt&&Jn(lt,L,O),Ge&&mr(O,null,L,"unmounted")},ee)},Ve=O=>{const{type:L,el:ee,anchor:le,transition:de}=O;if(L===Qe){wt(ee,le);return}if(L===hl){D(O);return}const ce=()=>{r(ee),de&&!de.persisted&&de.afterLeave&&de.afterLeave()};if(O.shapeFlag&1&&de&&!de.persisted){const{leave:Ie,delayLeave:Pe}=de,xe=()=>Ie(ee,ce);Pe?Pe(O.el,ce,xe):xe()}else ce()},wt=(O,L)=>{let ee;for(;O!==L;)ee=p(O),r(O),O=ee;r(L)},gt=(O,L,ee)=>{const{bum:le,scope:de,job:ce,subTree:Ie,um:Pe,m:xe,a:he}=O;Ph(xe),Ph(he),le&&dl(le),de.stop(),ce&&(ce.flags|=8,Se(Ie,O,L,ee)),Pe&&mn(Pe,L),mn(()=>{O.isUnmounted=!0},L)},it=(O,L,ee,le=!1,de=!1,ce=0)=>{for(let Ie=ce;Ie<O.length;Ie++)Se(O[Ie],L,ee,le,de)},ae=O=>{if(O.shapeFlag&6)return ae(O.component.subTree);if(O.shapeFlag&128)return O.suspense.next();const L=p(O.anchor||O.el),ee=L&&L[xy];return ee?p(ee):L};let Oe=!1;const re=(O,L,ee)=>{O==null?L._vnode&&Se(L._vnode,null,null,!0):w(L._vnode||null,O,L,null,null,null,ee),L._vnode=O,Oe||(Oe=!0,mh(),by(),Oe=!1)},Fe={p:w,um:Se,m:Le,r:Ve,mt:ye,mc:$,pc:Z,pbc:Y,n:ae,o:t};return{render:re,hydrate:void 0,createApp:lw(re)}}function cu({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function yr({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function vw(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Gd(t,e,n=!1){const s=t.children,r=e.children;if(qe(s)&&qe(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Ks(r[i]),a.el=o.el),!n&&a.patchFlag!==-2&&Gd(o,a)),a.type===ac&&a.patchFlag!==-1&&(a.el=o.el),a.type===Hn&&!a.el&&(a.el=o.el)}}function bw(t){const e=t.slice(),n=[0];let s,r,i,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(r=n[n.length-1],t[r]<c){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<c?i=a+1:o=a;c<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function qy(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:qy(e)}function Ph(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const _w=Symbol.for("v-scx"),ww=()=>Mn(_w);function Pi(t,e){return Xd(t,null,e)}function Kt(t,e,n){return Xd(t,e,n)}function Xd(t,e,n=mt){const{immediate:s,deep:r,flush:i,once:o}=n,a=Bt({},n),l=e&&s||!e&&i!=="post";let c;if(Uo){if(i==="sync"){const g=ww();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=os,g.resume=os,g.pause=os,g}}const u=cn;a.call=(g,v,w)=>Vn(g,u,v,w);let f=!1;i==="post"?a.scheduler=g=>{mn(g,u&&u.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(g,v)=>{v?g():Hd(g)}),a.augmentJob=g=>{e&&(g.flags|=4),f&&(g.flags|=2,u&&(g.id=u.uid,g.i=u))};const p=D0(t,e,a);return Uo&&(c?c.push(p):l&&p()),p}function xw(t,e,n){const s=this.proxy,r=Et(t)?t.includes(".")?Uy(s,t):()=>s[t]:t.bind(s,s);let i;Ye(e)?i=e:(i=e.handler,n=e);const o=ia(this),a=Xd(r,i.bind(s),n);return o(),a}function Uy(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const kw=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${On(e)}Modifiers`]||t[`${ar(e)}Modifiers`];function Cw(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||mt;let r=n;const i=e.startsWith("update:"),o=i&&kw(s,e.slice(7));o&&(o.trim&&(r=n.map(u=>Et(u)?u.trim():u)),o.number&&(r=n.map(xl)));let a,l=s[a=ul(e)]||s[a=ul(On(e))];!l&&i&&(l=s[a=ul(ar(e))]),l&&Vn(l,t,6,r);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Vn(c,t,6,r)}}function Wy(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!Ye(t)){const l=c=>{const u=Wy(c,e,!0);u&&(a=!0,Bt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(vt(t)&&s.set(t,null),null):(qe(i)?i.forEach(l=>o[l]=null):Bt(o,i),vt(t)&&s.set(t,o),o)}function oc(t,e){return!t||!Yl(e)?!1:(e=e.slice(2).replace(/Once$/,""),ft(t,e[0].toLowerCase()+e.slice(1))||ft(t,ar(e))||ft(t,e))}function Ah(t){const{type:e,vnode:n,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:f,data:p,setupState:g,ctx:v,inheritAttrs:w}=t,x=Al(t);let k,S;try{if(n.shapeFlag&4){const D=r||s,T=D;k=is(c.call(T,D,u,f,g,p,v)),S=a}else{const D=e;k=is(D.length>1?D(f,{attrs:a,slots:o,emit:l}):D(f,null)),S=e.props?a:Sw(a)}}catch(D){Ao.length=0,sc(D,t,1),k=ze(Hn)}let E=k;if(S&&w!==!1){const D=Object.keys(S),{shapeFlag:T}=E;D.length&&T&7&&(i&&D.some(Rd)&&(S=Pw(S,i)),E=ir(E,S,!1,!0))}return n.dirs&&(E=ir(E,null,!1,!0),E.dirs=E.dirs?E.dirs.concat(n.dirs):n.dirs),n.transition&&No(E,n.transition),k=E,Al(x),k}const Sw=t=>{let e;for(const n in t)(n==="class"||n==="style"||Yl(n))&&((e||(e={}))[n]=t[n]);return e},Pw=(t,e)=>{const n={};for(const s in t)(!Rd(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function Aw(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?Ih(s,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const p=u[f];if(o[p]!==s[p]&&!oc(c,p))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Ih(s,o,c):!0:!!o;return!1}function Ih(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!oc(n,i))return!0}return!1}function Iw({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const Vy=t=>t.__isSuspense;function Ew(t,e){e&&e.pendingBranch?qe(t)?e.effects.push(...t):e.effects.push(t):$0(t)}const Qe=Symbol.for("v-fgt"),ac=Symbol.for("v-txt"),Hn=Symbol.for("v-cmt"),hl=Symbol.for("v-stc"),Ao=[];let In=null;function j(t=!1){Ao.push(In=t?null:[])}function Mw(){Ao.pop(),In=Ao[Ao.length-1]||null}let zo=1;function Eh(t,e=!1){zo+=t,t<0&&In&&e&&(In.hasOnce=!0)}function Hy(t){return t.dynamicChildren=zo>0?In||yi:null,Mw(),zo>0&&In&&In.push(t),t}function W(t,e,n,s,r,i){return Hy(b(t,e,n,s,r,i,!0))}function en(t,e,n,s,r){return Hy(ze(t,e,n,s,r,!0))}function qo(t){return t?t.__v_isVNode===!0:!1}function fi(t,e){return t.type===e.type&&t.key===e.key}const Ky=({key:t})=>t??null,pl=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Et(t)||$t(t)||Ye(t)?{i:Qt,r:t,k:e,f:!!n}:t:null);function b(t,e=null,n=null,s=0,r=null,i=t===Qe?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ky(e),ref:e&&pl(e),scopeId:wy,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Qt};return a?(Qd(l,n),i&128&&t.normalize(l)):n&&(l.shapeFlag|=Et(n)?8:16),zo>0&&!o&&In&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&In.push(l),l}const ze=Ow;function Ow(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===Z0)&&(t=Hn),qo(t)){const a=ir(t,e,!0);return n&&Qd(a,n),zo>0&&!i&&In&&(a.shapeFlag&6?In[In.indexOf(t)]=a:In.push(a)),a.patchFlag=-2,a}if(Nw(t)&&(t=t.__vccOpts),e){e=Yy(e);let{class:a,style:l}=e;a&&!Et(a)&&(e.class=At(a)),vt(l)&&(sa(l)&&!qe(l)&&(l=Bt({},l)),e.style=En(l))}const o=Et(t)?1:Vy(t)?128:F0(t)?64:vt(t)?4:Ye(t)?2:0;return b(t,e,n,s,r,o,i,!0)}function Yy(t){return t?sa(t)||Fy(t)?Bt({},t):t:null}function ir(t,e,n=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:a,transition:l}=t,c=e?ls(r||{},e):r,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&Ky(c),ref:e&&e.ref?n&&i?qe(i)?i.concat(pl(e)):[i,pl(e)]:pl(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Qe?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ir(t.ssContent),ssFallback:t.ssFallback&&ir(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&No(u,l.clone(u)),u}function yt(t=" ",e=0){return ze(ac,null,t,e)}function Gy(t,e){const n=ze(hl,null,t);return n.staticCount=e,n}function ve(t="",e=!1){return e?(j(),en(Hn,null,t)):ze(Hn,null,t)}function is(t){return t==null||typeof t=="boolean"?ze(Hn):qe(t)?ze(Qe,null,t.slice()):qo(t)?Ks(t):ze(ac,null,String(t))}function Ks(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ir(t)}function Qd(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(qe(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),Qd(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!Fy(e)?e._ctx=Qt:r===3&&Qt&&(Qt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ye(e)?(e={default:e,_ctx:Qt},n=32):(e=String(e),s&64?(n=16,e=[yt(e)]):n=8);t.children=e,t.shapeFlag|=n}function ls(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=At([e.class,s.class]));else if(r==="style")e.style=En([e.style,s.style]);else if(Yl(r)){const i=e[r],o=s[r];o&&i!==o&&!(qe(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Jn(t,e,n,s=null){Vn(t,e,7,[n,s])}const Dw=Ty();let Tw=0;function Rw(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||Dw,i={uid:Tw++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Qm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:By(s,r),emitsOptions:Wy(s,r),emit:null,emitted:null,propsDefaults:mt,inheritAttrs:s.inheritAttrs,ctx:mt,data:mt,props:mt,attrs:mt,slots:mt,refs:mt,setupState:mt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=Cw.bind(null,i),t.ce&&t.ce(i),i}let cn=null;const cs=()=>cn||Qt;let El,sd;{const t=Jl(),e=(n,s)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};El=e("__VUE_INSTANCE_SETTERS__",n=>cn=n),sd=e("__VUE_SSR_SETTERS__",n=>Uo=n)}const ia=t=>{const e=cn;return El(t),t.scope.on(),()=>{t.scope.off(),El(e)}},Mh=()=>{cn&&cn.scope.off(),El(null)};function Xy(t){return t.vnode.shapeFlag&4}let Uo=!1;function $w(t,e=!1,n=!1){e&&sd(e);const{props:s,children:r}=t.vnode,i=Xy(t);uw(t,s,i,e),pw(t,r,n||e);const o=i?Fw(t,e):void 0;return e&&sd(!1),o}function Fw(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,tw);const{setup:s}=n;if(s){Is();const r=t.setupContext=s.length>1?Bw(t):null,i=ia(t),o=ra(s,t,0,[t.props,r]),a=Wm(o);if(Es(),i(),(a||t.sp)&&!_i(t)&&Py(t),a){if(o.then(Mh,Mh),e)return o.then(l=>{Oh(t,l)}).catch(l=>{sc(l,t,0)});t.asyncDep=o}else Oh(t,o)}else Qy(t)}function Oh(t,e,n){Ye(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:vt(e)&&(t.setupState=my(e)),Qy(t)}function Qy(t,e,n){const s=t.type;t.render||(t.render=s.render||os);{const r=ia(t);Is();try{nw(t)}finally{Es(),r()}}}const Lw={get(t,e){return an(t,"get",""),t[e]}};function Bw(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Lw),slots:t.slots,emit:t.emit,expose:e}}function lc(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(my(Wd(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in So)return So[n](t)},has(e,n){return n in e||n in So}})):t.proxy}function jw(t,e=!0){return Ye(t)?t.displayName||t.name:t.name||e&&t.__name}function Nw(t){return Ye(t)&&"__vccOpts"in t}const We=(t,e)=>M0(t,e,Uo);function As(t,e,n){const s=arguments.length;return s===2?vt(e)&&!qe(e)?qo(e)?ze(t,null,[e]):ze(t,e):ze(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&qo(n)&&(n=[n]),ze(t,e,n))}const Jy="3.5.20";/**
* @vue/runtime-dom v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rd;const Dh=typeof window<"u"&&window.trustedTypes;if(Dh)try{rd=Dh.createPolicy("vue",{createHTML:t=>t})}catch{}const Zy=rd?t=>rd.createHTML(t):t=>t,zw="http://www.w3.org/2000/svg",qw="http://www.w3.org/1998/Math/MathML",ks=typeof document<"u"?document:null,Th=ks&&ks.createElement("template"),Uw={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e==="svg"?ks.createElementNS(zw,t):e==="mathml"?ks.createElementNS(qw,t):n?ks.createElement(t,{is:n}):ks.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>ks.createTextNode(t),createComment:t=>ks.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ks.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{Th.innerHTML=Zy(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=Th.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},js="transition",Qi="animation",Ai=Symbol("_vtc"),ev={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Ww=Bt({},N0,ev),vr=(t,e=[])=>{qe(t)?t.forEach(n=>n(...e)):t&&t(...e)},Rh=t=>t?qe(t)?t.some(e=>e.length>1):t.length>1:!1;function Vw(t){const e={};for(const z in t)z in ev||(e[z]=t[z]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,v=Hw(r),w=v&&v[0],x=v&&v[1],{onBeforeEnter:k,onEnter:S,onEnterCancelled:E,onLeave:D,onLeaveCancelled:T,onBeforeAppear:P=k,onAppear:A=S,onAppearCancelled:$=E}=e,I=(z,pe,ye,ue)=>{z._enterCancelled=ue,qs(z,pe?u:a),qs(z,pe?c:o),ye&&ye()},Y=(z,pe)=>{z._isLeaving=!1,qs(z,f),qs(z,g),qs(z,p),pe&&pe()},U=z=>(pe,ye)=>{const ue=z?A:S,_e=()=>I(pe,z,ye);vr(ue,[pe,_e]),$h(()=>{qs(pe,z?l:i),es(pe,z?u:a),Rh(ue)||Fh(pe,s,w,_e)})};return Bt(e,{onBeforeEnter(z){vr(k,[z]),es(z,i),es(z,o)},onBeforeAppear(z){vr(P,[z]),es(z,l),es(z,c)},onEnter:U(!1),onAppear:U(!0),onLeave(z,pe){z._isLeaving=!0;const ye=()=>Y(z,pe);es(z,f),z._enterCancelled?(es(z,p),id()):(id(),es(z,p)),$h(()=>{z._isLeaving&&(qs(z,f),es(z,g),Rh(D)||Fh(z,s,x,ye))}),vr(D,[z,ye])},onEnterCancelled(z){I(z,!1,void 0,!0),vr(E,[z])},onAppearCancelled(z){I(z,!0,void 0,!0),vr($,[z])},onLeaveCancelled(z){Y(z),vr(T,[z])}})}function Hw(t){if(t==null)return null;if(vt(t))return[uu(t.enter),uu(t.leave)];{const e=uu(t);return[e,e]}}function uu(t){return X_(t)}function es(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Ai]||(t[Ai]=new Set)).add(e)}function qs(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[Ai];n&&(n.delete(e),n.size||(t[Ai]=void 0))}function $h(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Kw=0;function Fh(t,e,n,s){const r=t._endId=++Kw,i=()=>{r===t._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:o,timeout:a,propCount:l}=tv(t,e);if(!o)return s();const c=o+"end";let u=0;const f=()=>{t.removeEventListener(c,p),i()},p=g=>{g.target===t&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},a+1),t.addEventListener(c,p)}function tv(t,e){const n=window.getComputedStyle(t),s=v=>(n[v]||"").split(", "),r=s(`${js}Delay`),i=s(`${js}Duration`),o=Lh(r,i),a=s(`${Qi}Delay`),l=s(`${Qi}Duration`),c=Lh(a,l);let u=null,f=0,p=0;e===js?o>0&&(u=js,f=o,p=i.length):e===Qi?c>0&&(u=Qi,f=c,p=l.length):(f=Math.max(o,c),u=f>0?o>c?js:Qi:null,p=u?u===js?i.length:l.length:0);const g=u===js&&/\b(transform|all)(,|$)/.test(s(`${js}Property`).toString());return{type:u,timeout:f,propCount:p,hasTransform:g}}function Lh(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Bh(n)+Bh(t[s])))}function Bh(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function id(){return document.body.offsetHeight}function Yw(t,e,n){const s=t[Ai];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ml=Symbol("_vod"),nv=Symbol("_vsh"),Gw={name:"show",beforeMount(t,{value:e},{transition:n}){t[Ml]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):Ji(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),Ji(t,!0),s.enter(t)):s.leave(t,()=>{Ji(t,!1)}):Ji(t,e))},beforeUnmount(t,{value:e}){Ji(t,e)}};function Ji(t,e){t.style.display=e?t[Ml]:"none",t[nv]=!e}const Xw=Symbol(""),Qw=/(^|;)\s*display\s*:/;function Jw(t,e,n){const s=t.style,r=Et(n);let i=!1;if(n&&!r){if(e)if(Et(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&gl(s,a,"")}else for(const o in e)n[o]==null&&gl(s,o,"");for(const o in n)o==="display"&&(i=!0),gl(s,o,n[o])}else if(r){if(e!==n){const o=s[Xw];o&&(n+=";"+o),s.cssText=n,i=Qw.test(n)}}else e&&t.removeAttribute("style");Ml in t&&(t[Ml]=i?s.display:"",t[nv]&&(s.display="none"))}const jh=/\s*!important$/;function gl(t,e,n){if(qe(n))n.forEach(s=>gl(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=Zw(t,e);jh.test(n)?t.setProperty(ar(s),n.replace(jh,""),"important"):t[s]=n}}const Nh=["Webkit","Moz","ms"],du={};function Zw(t,e){const n=du[e];if(n)return n;let s=On(e);if(s!=="filter"&&s in t)return du[e]=s;s=Ql(s);for(let r=0;r<Nh.length;r++){const i=Nh[r]+s;if(i in t)return du[e]=i}return e}const zh="http://www.w3.org/1999/xlink";function qh(t,e,n,s,r,i=s0(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(zh,e.slice(6,e.length)):t.setAttributeNS(zh,e,n):n==null||i&&!Ym(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Wn(n)?String(n):n)}function Uh(t,e,n,s,r){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Zy(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=Ym(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(r||e)}function Tr(t,e,n,s){t.addEventListener(e,n,s)}function ex(t,e,n,s){t.removeEventListener(e,n,s)}const Wh=Symbol("_vei");function tx(t,e,n,s,r=null){const i=t[Wh]||(t[Wh]={}),o=i[e];if(s&&o)o.value=s;else{const[a,l]=nx(e);if(s){const c=i[e]=ix(s,r);Tr(t,a,c,l)}else o&&(ex(t,a,o,l),i[e]=void 0)}}const Vh=/(?:Once|Passive|Capture)$/;function nx(t){let e;if(Vh.test(t)){e={};let s;for(;s=t.match(Vh);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ar(t.slice(2)),e]}let fu=0;const sx=Promise.resolve(),rx=()=>fu||(sx.then(()=>fu=0),fu=Date.now());function ix(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;Vn(ox(s,n.value),e,5,[s])};return n.value=t,n.attached=rx(),n}function ox(t,e){if(qe(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Hh=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,ax=(t,e,n,s,r,i)=>{const o=r==="svg";e==="class"?Yw(t,s,o):e==="style"?Jw(t,n,s):Yl(e)?Rd(e)||tx(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):lx(t,e,s,o))?(Uh(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&qh(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Et(s))?Uh(t,On(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),qh(t,e,s,o))};function lx(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Hh(e)&&Ye(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Hh(e)&&Et(n)?!1:e in t}const sv=new WeakMap,rv=new WeakMap,Ol=Symbol("_moveCb"),Kh=Symbol("_enterCb"),cx=t=>(delete t.props.mode,t),ux=cx({name:"TransitionGroup",props:Bt({},Ww,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=cs(),s=j0();let r,i;return Ey(()=>{if(!r.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!gx(r[0].el,n.vnode.el,o)){r=[];return}r.forEach(fx),r.forEach(hx);const a=r.filter(px);id(),a.forEach(l=>{const c=l.el,u=c.style;es(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[Ol]=p=>{p&&p.target!==c||(!p||/transform$/.test(p.propertyName))&&(c.removeEventListener("transitionend",f),c[Ol]=null,qs(c,o))};c.addEventListener("transitionend",f)}),r=[]}),()=>{const o=tt(t),a=Vw(o);let l=o.tag||Qe;if(r=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(r.push(u),No(u,Ju(u,a,s,n)),sv.set(u,u.el.getBoundingClientRect()))}i=e.default?Sy(e.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&No(u,Ju(u,a,s,n))}return ze(l,null,i)}}}),dx=ux;function fx(t){const e=t.el;e[Ol]&&e[Ol](),e[Kh]&&e[Kh]()}function hx(t){rv.set(t,t.el.getBoundingClientRect())}function px(t){const e=sv.get(t),n=rv.get(t),s=e.left-n.left,r=e.top-n.top;if(s||r){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${s}px,${r}px)`,i.transitionDuration="0s",t}}function gx(t,e,n){const s=t.cloneNode(),r=t[Ai];r&&r.forEach(a=>{a.split(/\s+/).forEach(l=>l&&s.classList.remove(l))}),n.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(s);const{hasTransform:o}=tv(s);return i.removeChild(s),o}const Dl=t=>{const e=t.props["onUpdate:modelValue"]||!1;return qe(e)?n=>dl(e,n):e};function mx(t){t.target.composing=!0}function Yh(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const wi=Symbol("_assign"),Wo={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t[wi]=Dl(r);const i=s||r.props&&r.props.type==="number";Tr(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=xl(a)),t[wi](a)}),n&&Tr(t,"change",()=>{t.value=t.value.trim()}),e||(Tr(t,"compositionstart",mx),Tr(t,"compositionend",Yh),Tr(t,"change",Yh))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:r,number:i}},o){if(t[wi]=Dl(o),t.composing)return;const a=(i||t.type==="number")&&!/^0\d/.test(t.value)?xl(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||r&&t.value.trim()===l)||(t.value=l))}},Gh={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const r=Gl(e);Tr(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?xl(Tl(o)):Tl(o));t[wi](t.multiple?r?new Set(i):i:i[0]),t._assigning=!0,un(()=>{t._assigning=!1})}),t[wi]=Dl(s)},mounted(t,{value:e}){Xh(t,e)},beforeUpdate(t,e,n){t[wi]=Dl(n)},updated(t,{value:e}){t._assigning||Xh(t,e)}};function Xh(t,e){const n=t.multiple,s=qe(e);if(!(n&&!s&&!Gl(e))){for(let r=0,i=t.options.length;r<i;r++){const o=t.options[r],a=Tl(o);if(n)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=i0(e,a)>-1}else o.selected=e.has(a);else if(Zl(Tl(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Tl(t){return"_value"in t?t._value:t.value}const yx=["ctrl","shift","alt","meta"],vx={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>yx.some(n=>t[`${n}Key`]&&!e.includes(n))},ml=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=((r,...i)=>{for(let o=0;o<e.length;o++){const a=vx[e[o]];if(a&&a(r,e))return}return t(r,...i)}))},bx={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qh=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=(r=>{if(!("key"in r))return;const i=ar(r.key);if(e.some(o=>o===i||bx[o]===i))return t(r)}))},_x=Bt({patchProp:ax},Uw);let Jh;function wx(){return Jh||(Jh=mw(_x))}const xx=((...t)=>{const e=wx().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=Cx(s);if(!r)return;const i=e._component;!Ye(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,kx(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e});function kx(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Cx(t){return Et(t)?document.querySelector(t):t}const Sx="/mtg-pwa/icons/icon-256.png";/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const hi=typeof document<"u";function iv(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Px(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&iv(t.default)}const dt=Object.assign;function hu(t,e){const n={};for(const s in e){const r=e[s];n[s]=Kn(r)?r.map(t):t(r)}return n}const Io=()=>{},Kn=Array.isArray,ov=/#/g,Ax=/&/g,Ix=/\//g,Ex=/=/g,Mx=/\?/g,av=/\+/g,Ox=/%5B/g,Dx=/%5D/g,lv=/%5E/g,Tx=/%60/g,cv=/%7B/g,Rx=/%7C/g,uv=/%7D/g,$x=/%20/g;function Jd(t){return encodeURI(""+t).replace(Rx,"|").replace(Ox,"[").replace(Dx,"]")}function Fx(t){return Jd(t).replace(cv,"{").replace(uv,"}").replace(lv,"^")}function od(t){return Jd(t).replace(av,"%2B").replace($x,"+").replace(ov,"%23").replace(Ax,"%26").replace(Tx,"`").replace(cv,"{").replace(uv,"}").replace(lv,"^")}function Lx(t){return od(t).replace(Ex,"%3D")}function Bx(t){return Jd(t).replace(ov,"%23").replace(Mx,"%3F")}function jx(t){return t==null?"":Bx(t).replace(Ix,"%2F")}function Vo(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const Nx=/\/$/,zx=t=>t.replace(Nx,"");function pu(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(s=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),r=t(i)),a>-1&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=Vx(s??e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:Vo(o)}}function qx(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Zh(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Ux(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&Ii(e.matched[s],n.matched[r])&&dv(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Ii(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function dv(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Wx(t[n],e[n]))return!1;return!0}function Wx(t,e){return Kn(t)?ep(t,e):Kn(e)?ep(e,t):t===e}function ep(t,e){return Kn(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function Vx(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=n.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const Ns={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ho;(function(t){t.pop="pop",t.push="push"})(Ho||(Ho={}));var Eo;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Eo||(Eo={}));function Hx(t){if(!t)if(hi){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),zx(t)}const Kx=/^[^#]+#/;function Yx(t,e){return t.replace(Kx,"#")+e}function Gx(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const cc=()=>({left:window.scrollX,top:window.scrollY});function Xx(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=Gx(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function tp(t,e){return(history.state?history.state.position-e:-1)+t}const ad=new Map;function Qx(t,e){ad.set(t,e)}function Jx(t){const e=ad.get(t);return ad.delete(t),e}let Zx=()=>location.protocol+"//"+location.host;function fv(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),Zh(l,"")}return Zh(n,t)+s+r}function e1(t,e,n,s){let r=[],i=[],o=null;const a=({state:p})=>{const g=fv(t,location),v=n.value,w=e.value;let x=0;if(p){if(n.value=g,e.value=p,o&&o===v){o=null;return}x=w?p.position-w.position:0}else s(g);r.forEach(k=>{k(n.value,v,{delta:x,type:Ho.pop,direction:x?x>0?Eo.forward:Eo.back:Eo.unknown})})};function l(){o=n.value}function c(p){r.push(p);const g=()=>{const v=r.indexOf(p);v>-1&&r.splice(v,1)};return i.push(g),g}function u(){const{history:p}=window;p.state&&p.replaceState(dt({},p.state,{scroll:cc()}),"")}function f(){for(const p of i)p();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function np(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?cc():null}}function t1(t){const{history:e,location:n}=window,s={value:fv(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=t.indexOf("#"),p=f>-1?(n.host&&document.querySelector("base")?t:t.slice(f))+l:Zx()+t+l;try{e[u?"replaceState":"pushState"](c,"",p),r.value=c}catch(g){console.error(g),n[u?"replace":"assign"](p)}}function o(l,c){const u=dt({},e.state,np(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});i(l,u,!0),s.value=l}function a(l,c){const u=dt({},r.value,e.state,{forward:l,scroll:cc()});i(u.current,u,!0);const f=dt({},np(s.value,l,null),{position:u.position+1},c);i(l,f,!1),s.value=l}return{location:s,state:r,push:a,replace:o}}function n1(t){t=Hx(t);const e=t1(t),n=e1(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=dt({location:"",base:t,go:s,createHref:Yx.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function s1(t){return typeof t=="string"||t&&typeof t=="object"}function hv(t){return typeof t=="string"||typeof t=="symbol"}const pv=Symbol("");var sp;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(sp||(sp={}));function Ei(t,e){return dt(new Error,{type:t,[pv]:!0},e)}function ps(t,e){return t instanceof Error&&pv in t&&(e==null||!!(t.type&e))}const rp="[^/]+?",r1={sensitive:!1,strict:!1,start:!0,end:!0},i1=/[.+*?^${}()[\]/\\]/g;function o1(t,e){const n=dt({},r1,e),s=[];let r=n.start?"^":"";const i=[];for(const c of t){const u=c.length?[]:[90];n.strict&&!c.length&&(r+="/");for(let f=0;f<c.length;f++){const p=c[f];let g=40+(n.sensitive?.25:0);if(p.type===0)f||(r+="/"),r+=p.value.replace(i1,"\\$&"),g+=40;else if(p.type===1){const{value:v,repeatable:w,optional:x,regexp:k}=p;i.push({name:v,repeatable:w,optional:x});const S=k||rp;if(S!==rp){g+=10;try{new RegExp(`(${S})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${v}" (${S}): `+D.message)}}let E=w?`((?:${S})(?:/(?:${S}))*)`:`(${S})`;f||(E=x&&c.length<2?`(?:/${E})`:"/"+E),x&&(E+="?"),r+=E,g+=20,x&&(g+=-8),w&&(g+=-20),S===".*"&&(g+=-50)}u.push(g)}s.push(u)}if(n.strict&&n.end){const c=s.length-1;s[c][s[c].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(c){const u=c.match(o),f={};if(!u)return null;for(let p=1;p<u.length;p++){const g=u[p]||"",v=i[p-1];f[v.name]=g&&v.repeatable?g.split("/"):g}return f}function l(c){let u="",f=!1;for(const p of t){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const g of p)if(g.type===0)u+=g.value;else if(g.type===1){const{value:v,repeatable:w,optional:x}=g,k=v in c?c[v]:"";if(Kn(k)&&!w)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const S=Kn(k)?k.join("/"):k;if(!S)if(x)p.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${v}"`);u+=S}}return u||"/"}return{re:o,score:s,keys:i,parse:a,stringify:l}}function a1(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function gv(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=a1(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(ip(s))return 1;if(ip(r))return-1}return r.length-s.length}function ip(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const l1={type:0,value:""},c1=/[a-zA-Z0-9_]/;function u1(t){if(!t)return[[]];if(t==="/")return[[l1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(g){throw new Error(`ERR (${n})/"${c}": ${g}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,l,c="",u="";function f(){c&&(n===0?i.push({type:0,value:c}):n===1||n===2||n===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function p(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),n=1):p();break;case 4:p(),n=s;break;case 1:l==="("?n=2:c1.test(l)?p():(f(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:f(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),r}function d1(t,e,n){const s=o1(u1(t.path),n),r=dt(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function f1(t,e){const n=[],s=new Map;e=cp({strict:!1,end:!0,sensitive:!1},e);function r(f){return s.get(f)}function i(f,p,g){const v=!g,w=ap(f);w.aliasOf=g&&g.record;const x=cp(e,f),k=[w];if("alias"in f){const D=typeof f.alias=="string"?[f.alias]:f.alias;for(const T of D)k.push(ap(dt({},w,{components:g?g.record.components:w.components,path:T,aliasOf:g?g.record:w})))}let S,E;for(const D of k){const{path:T}=D;if(p&&T[0]!=="/"){const P=p.record.path,A=P[P.length-1]==="/"?"":"/";D.path=p.record.path+(T&&A+T)}if(S=d1(D,p,x),g?g.alias.push(S):(E=E||S,E!==S&&E.alias.push(S),v&&f.name&&!lp(S)&&o(f.name)),mv(S)&&l(S),w.children){const P=w.children;for(let A=0;A<P.length;A++)i(P[A],S,g&&g.children[A])}g=g||S}return E?()=>{o(E)}:Io}function o(f){if(hv(f)){const p=s.get(f);p&&(s.delete(f),n.splice(n.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=n.indexOf(f);p>-1&&(n.splice(p,1),f.record.name&&s.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return n}function l(f){const p=g1(f,n);n.splice(p,0,f),f.record.name&&!lp(f)&&s.set(f.record.name,f)}function c(f,p){let g,v={},w,x;if("name"in f&&f.name){if(g=s.get(f.name),!g)throw Ei(1,{location:f});x=g.record.name,v=dt(op(p.params,g.keys.filter(E=>!E.optional).concat(g.parent?g.parent.keys.filter(E=>E.optional):[]).map(E=>E.name)),f.params&&op(f.params,g.keys.map(E=>E.name))),w=g.stringify(v)}else if(f.path!=null)w=f.path,g=n.find(E=>E.re.test(w)),g&&(v=g.parse(w),x=g.record.name);else{if(g=p.name?s.get(p.name):n.find(E=>E.re.test(p.path)),!g)throw Ei(1,{location:f,currentLocation:p});x=g.record.name,v=dt({},p.params,f.params),w=g.stringify(v)}const k=[];let S=g;for(;S;)k.unshift(S.record),S=S.parent;return{name:x,path:w,params:v,matched:k,meta:p1(k)}}t.forEach(f=>i(f));function u(){n.length=0,s.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:r}}function op(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function ap(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:h1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function h1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function lp(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function p1(t){return t.reduce((e,n)=>dt(e,n.meta),{})}function cp(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function g1(t,e){let n=0,s=e.length;for(;n!==s;){const i=n+s>>1;gv(t,e[i])<0?s=i:n=i+1}const r=m1(t);return r&&(s=e.lastIndexOf(r,s-1)),s}function m1(t){let e=t;for(;e=e.parent;)if(mv(e)&&gv(t,e)===0)return e}function mv({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function y1(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(av," "),o=i.indexOf("="),a=Vo(o<0?i:i.slice(0,o)),l=o<0?null:Vo(i.slice(o+1));if(a in e){let c=e[a];Kn(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function up(t){let e="";for(let n in t){const s=t[n];if(n=Lx(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Kn(s)?s.map(i=>i&&od(i)):[s&&od(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function v1(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Kn(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const b1=Symbol(""),dp=Symbol(""),uc=Symbol(""),Zd=Symbol(""),ld=Symbol("");function Zi(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ys(t,e,n,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((a,l)=>{const c=p=>{p===!1?l(Ei(4,{from:n,to:e})):p instanceof Error?l(p):s1(p)?l(Ei(2,{from:e,to:p})):(o&&s.enterCallbacks[r]===o&&typeof p=="function"&&o.push(p),a())},u=i(()=>t.call(s&&s.instances[r],e,n,c));let f=Promise.resolve(u);t.length<3&&(f=f.then(c)),f.catch(p=>l(p))})}function gu(t,e,n,s,r=i=>i()){const i=[];for(const o of t)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(iv(l)){const u=(l.__vccOpts||l)[e];u&&i.push(Ys(u,n,s,o,a,r))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=Px(u)?u.default:u;o.mods[a]=u,o.components[a]=f;const g=(f.__vccOpts||f)[e];return g&&Ys(g,n,s,o,a,r)()}))}}return i}function fp(t){const e=Mn(uc),n=Mn(Zd),s=We(()=>{const l=$e(t.to);return e.resolve(l)}),r=We(()=>{const{matched:l}=s.value,{length:c}=l,u=l[c-1],f=n.matched;if(!u||!f.length)return-1;const p=f.findIndex(Ii.bind(null,u));if(p>-1)return p;const g=hp(l[c-2]);return c>1&&hp(u)===g&&f[f.length-1].path!==g?f.findIndex(Ii.bind(null,l[c-2])):p}),i=We(()=>r.value>-1&&C1(n.params,s.value.params)),o=We(()=>r.value>-1&&r.value===n.matched.length-1&&dv(n.params,s.value.params));function a(l={}){if(k1(l)){const c=e[$e(t.replace)?"replace":"push"]($e(t.to)).catch(Io);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:s,href:We(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function _1(t){return t.length===1?t[0]:t}const w1=et({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:fp,setup(t,{slots:e}){const n=Vr(fp(t)),{options:s}=Mn(uc),r=We(()=>({[pp(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[pp(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&_1(e.default(n));return t.custom?i:As("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),x1=w1;function k1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function C1(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Kn(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function hp(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const pp=(t,e,n)=>t??e??n,S1=et({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=Mn(ld),r=We(()=>t.route||s.value),i=Mn(dp,0),o=We(()=>{let c=$e(i);const{matched:u}=r.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),a=We(()=>r.value.matched[o.value]);Po(dp,We(()=>o.value+1)),Po(b1,a),Po(ld,r);const l=fe();return Kt(()=>[l.value,a.value,t.name],([c,u,f],[p,g,v])=>{u&&(u.instances[f]=c,g&&g!==u&&c&&c===p&&(u.leaveGuards.size||(u.leaveGuards=g.leaveGuards),u.updateGuards.size||(u.updateGuards=g.updateGuards))),c&&u&&(!g||!Ii(u,g)||!p)&&(u.enterCallbacks[f]||[]).forEach(w=>w(c))},{flush:"post"}),()=>{const c=r.value,u=t.name,f=a.value,p=f&&f.components[u];if(!p)return gp(n.default,{Component:p,route:c});const g=f.props[u],v=g?g===!0?c.params:typeof g=="function"?g(c):g:null,x=As(p,dt({},v,e,{onVnodeUnmounted:k=>{k.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return gp(n.default,{Component:x,route:c})||x}}});function gp(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const P1=S1;function A1(t){const e=f1(t.routes,t),n=t.parseQuery||y1,s=t.stringifyQuery||up,r=t.history,i=Zi(),o=Zi(),a=Zi(),l=nc(Ns);let c=Ns;hi&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=hu.bind(null,ae=>""+ae),f=hu.bind(null,jx),p=hu.bind(null,Vo);function g(ae,Oe){let re,Fe;return hv(ae)?(re=e.getRecordMatcher(ae),Fe=Oe):Fe=ae,e.addRoute(Fe,re)}function v(ae){const Oe=e.getRecordMatcher(ae);Oe&&e.removeRoute(Oe)}function w(){return e.getRoutes().map(ae=>ae.record)}function x(ae){return!!e.getRecordMatcher(ae)}function k(ae,Oe){if(Oe=dt({},Oe||l.value),typeof ae=="string"){const ee=pu(n,ae,Oe.path),le=e.resolve({path:ee.path},Oe),de=r.createHref(ee.fullPath);return dt(ee,le,{params:p(le.params),hash:Vo(ee.hash),redirectedFrom:void 0,href:de})}let re;if(ae.path!=null)re=dt({},ae,{path:pu(n,ae.path,Oe.path).path});else{const ee=dt({},ae.params);for(const le in ee)ee[le]==null&&delete ee[le];re=dt({},ae,{params:f(ee)}),Oe.params=f(Oe.params)}const Fe=e.resolve(re,Oe),nt=ae.hash||"";Fe.params=u(p(Fe.params));const O=qx(s,dt({},ae,{hash:Fx(nt),path:Fe.path})),L=r.createHref(O);return dt({fullPath:O,hash:nt,query:s===up?v1(ae.query):ae.query||{}},Fe,{redirectedFrom:void 0,href:L})}function S(ae){return typeof ae=="string"?pu(n,ae,l.value.path):dt({},ae)}function E(ae,Oe){if(c!==ae)return Ei(8,{from:Oe,to:ae})}function D(ae){return A(ae)}function T(ae){return D(dt(S(ae),{replace:!0}))}function P(ae){const Oe=ae.matched[ae.matched.length-1];if(Oe&&Oe.redirect){const{redirect:re}=Oe;let Fe=typeof re=="function"?re(ae):re;return typeof Fe=="string"&&(Fe=Fe.includes("?")||Fe.includes("#")?Fe=S(Fe):{path:Fe},Fe.params={}),dt({query:ae.query,hash:ae.hash,params:Fe.path!=null?{}:ae.params},Fe)}}function A(ae,Oe){const re=c=k(ae),Fe=l.value,nt=ae.state,O=ae.force,L=ae.replace===!0,ee=P(re);if(ee)return A(dt(S(ee),{state:typeof ee=="object"?dt({},nt,ee.state):nt,force:O,replace:L}),Oe||re);const le=re;le.redirectedFrom=Oe;let de;return!O&&Ux(s,Fe,re)&&(de=Ei(16,{to:le,from:Fe}),Le(Fe,Fe,!0,!1)),(de?Promise.resolve(de):Y(le,Fe)).catch(ce=>ps(ce)?ps(ce,2)?ce:X(ce):Z(ce,le,Fe)).then(ce=>{if(ce){if(ps(ce,2))return A(dt({replace:L},S(ce.to),{state:typeof ce.to=="object"?dt({},nt,ce.to.state):nt,force:O}),Oe||le)}else ce=z(le,Fe,!0,L,nt);return U(le,Fe,ce),ce})}function $(ae,Oe){const re=E(ae,Oe);return re?Promise.reject(re):Promise.resolve()}function I(ae){const Oe=wt.values().next().value;return Oe&&typeof Oe.runWithContext=="function"?Oe.runWithContext(ae):ae()}function Y(ae,Oe){let re;const[Fe,nt,O]=I1(ae,Oe);re=gu(Fe.reverse(),"beforeRouteLeave",ae,Oe);for(const ee of Fe)ee.leaveGuards.forEach(le=>{re.push(Ys(le,ae,Oe))});const L=$.bind(null,ae,Oe);return re.push(L),it(re).then(()=>{re=[];for(const ee of i.list())re.push(Ys(ee,ae,Oe));return re.push(L),it(re)}).then(()=>{re=gu(nt,"beforeRouteUpdate",ae,Oe);for(const ee of nt)ee.updateGuards.forEach(le=>{re.push(Ys(le,ae,Oe))});return re.push(L),it(re)}).then(()=>{re=[];for(const ee of O)if(ee.beforeEnter)if(Kn(ee.beforeEnter))for(const le of ee.beforeEnter)re.push(Ys(le,ae,Oe));else re.push(Ys(ee.beforeEnter,ae,Oe));return re.push(L),it(re)}).then(()=>(ae.matched.forEach(ee=>ee.enterCallbacks={}),re=gu(O,"beforeRouteEnter",ae,Oe,I),re.push(L),it(re))).then(()=>{re=[];for(const ee of o.list())re.push(Ys(ee,ae,Oe));return re.push(L),it(re)}).catch(ee=>ps(ee,8)?ee:Promise.reject(ee))}function U(ae,Oe,re){a.list().forEach(Fe=>I(()=>Fe(ae,Oe,re)))}function z(ae,Oe,re,Fe,nt){const O=E(ae,Oe);if(O)return O;const L=Oe===Ns,ee=hi?history.state:{};re&&(Fe||L?r.replace(ae.fullPath,dt({scroll:L&&ee&&ee.scroll},nt)):r.push(ae.fullPath,nt)),l.value=ae,Le(ae,Oe,re,L),X()}let pe;function ye(){pe||(pe=r.listen((ae,Oe,re)=>{if(!gt.listening)return;const Fe=k(ae),nt=P(Fe);if(nt){A(dt(nt,{replace:!0,force:!0}),Fe).catch(Io);return}c=Fe;const O=l.value;hi&&Qx(tp(O.fullPath,re.delta),cc()),Y(Fe,O).catch(L=>ps(L,12)?L:ps(L,2)?(A(dt(S(L.to),{force:!0}),Fe).then(ee=>{ps(ee,20)&&!re.delta&&re.type===Ho.pop&&r.go(-1,!1)}).catch(Io),Promise.reject()):(re.delta&&r.go(-re.delta,!1),Z(L,Fe,O))).then(L=>{L=L||z(Fe,O,!1),L&&(re.delta&&!ps(L,8)?r.go(-re.delta,!1):re.type===Ho.pop&&ps(L,20)&&r.go(-1,!1)),U(Fe,O,L)}).catch(Io)}))}let ue=Zi(),_e=Zi(),ke;function Z(ae,Oe,re){X(ae);const Fe=_e.list();return Fe.length?Fe.forEach(nt=>nt(ae,Oe,re)):console.error(ae),Promise.reject(ae)}function ne(){return ke&&l.value!==Ns?Promise.resolve():new Promise((ae,Oe)=>{ue.add([ae,Oe])})}function X(ae){return ke||(ke=!ae,ye(),ue.list().forEach(([Oe,re])=>ae?re(ae):Oe()),ue.reset()),ae}function Le(ae,Oe,re,Fe){const{scrollBehavior:nt}=t;if(!hi||!nt)return Promise.resolve();const O=!re&&Jx(tp(ae.fullPath,0))||(Fe||!re)&&history.state&&history.state.scroll||null;return un().then(()=>nt(ae,Oe,O)).then(L=>L&&Xx(L)).catch(L=>Z(L,ae,Oe))}const Se=ae=>r.go(ae);let Ve;const wt=new Set,gt={currentRoute:l,listening:!0,addRoute:g,removeRoute:v,clearRoutes:e.clearRoutes,hasRoute:x,getRoutes:w,resolve:k,options:t,push:D,replace:T,go:Se,back:()=>Se(-1),forward:()=>Se(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:_e.add,isReady:ne,install(ae){const Oe=this;ae.component("RouterLink",x1),ae.component("RouterView",P1),ae.config.globalProperties.$router=Oe,Object.defineProperty(ae.config.globalProperties,"$route",{enumerable:!0,get:()=>$e(l)}),hi&&!Ve&&l.value===Ns&&(Ve=!0,D(r.location).catch(nt=>{}));const re={};for(const nt in Ns)Object.defineProperty(re,nt,{get:()=>l.value[nt],enumerable:!0});ae.provide(uc,Oe),ae.provide(Zd,hy(re)),ae.provide(ld,l);const Fe=ae.unmount;wt.add(ae),ae.unmount=function(){wt.delete(ae),wt.size<1&&(c=Ns,pe&&pe(),pe=null,l.value=Ns,Ve=!1,ke=!1),Fe()}}};function it(ae){return ae.reduce((Oe,re)=>Oe.then(()=>I(re)),Promise.resolve())}return gt}function I1(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(c=>Ii(c,a))?s.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(c=>Ii(c,l))||r.push(l))}return[n,s,r]}function yv(){return Mn(uc)}function ef(t){return Mn(Zd)}const E1=["aria-label"],M1={key:0,class:"icon-sun"},O1={key:1,class:"icon-moon"},D1=et({__name:"ThemeSwitcher",setup(t){const e=fe("light"),n=()=>{const s=e.value==="light"?"dark":"light";e.value=s,document.documentElement.setAttribute("data-theme",s),document.documentElement.setAttribute("data-bs-theme",s),localStorage.setItem("theme",s)};return Tn(()=>{const s=localStorage.getItem("theme"),r=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;let i="light";s?i=s:r&&(i="dark"),e.value=i,document.documentElement.setAttribute("data-theme",i),document.documentElement.setAttribute("data-bs-theme",i)}),(s,r)=>(j(),W("button",{type:"button",class:"btn-icon",onClick:n,"aria-label":`Switch to ${e.value==="light"?"dark":"light"} mode`},[e.value==="dark"?(j(),W("span",M1,[...r[0]||(r[0]=[Gy('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-e843c561><circle cx="12" cy="12" r="5" data-v-e843c561></circle><line x1="12" y1="1" x2="12" y2="3" data-v-e843c561></line><line x1="12" y1="21" x2="12" y2="23" data-v-e843c561></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-v-e843c561></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-v-e843c561></line><line x1="1" y1="12" x2="3" y2="12" data-v-e843c561></line><line x1="21" y1="12" x2="23" y2="12" data-v-e843c561></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-v-e843c561></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-v-e843c561></line></svg>',1)])])):(j(),W("span",O1,[...r[1]||(r[1]=[b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[b("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})],-1)])]))],8,E1))}}),fn=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n},T1=fn(D1,[["__scopeId","data-v-e843c561"]]);/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let vv;const dc=t=>vv=t,bv=Symbol();function cd(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Mo;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Mo||(Mo={}));function R1(){const t=ec(!0),e=t.run(()=>fe({}));let n=[],s=[];const r=Wd({install(i){dc(r),r._a=i,i.provide(bv,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const _v=()=>{};function mp(t,e,n,s=_v){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&Ld()&&Jm(r),r}function ai(t,...e){t.slice().forEach(n=>{n(...e)})}const $1=t=>t(),yp=Symbol(),mu=Symbol();function ud(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];cd(r)&&cd(s)&&t.hasOwnProperty(n)&&!$t(s)&&!Js(s)?t[n]=ud(r,s):t[n]=s}return t}const F1=Symbol();function L1(t){return!cd(t)||!Object.prototype.hasOwnProperty.call(t,F1)}const{assign:Us}=Object;function B1(t){return!!($t(t)&&t.effect)}function j1(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let l;function c(){a||(n.state.value[t]=r?r():{});const u=Vd(n.state.value[t]);return Us(u,i,Object.keys(o||{}).reduce((f,p)=>(f[p]=Wd(We(()=>{dc(n);const g=n._s.get(t);return o[p].call(g,g)})),f),{}))}return l=wv(t,c,e,n,s,!0),l}function wv(t,e,n={},s,r,i){let o;const a=Us({actions:{}},n),l={deep:!0};let c,u,f=[],p=[],g;const v=s.state.value[t];!i&&!v&&(s.state.value[t]={}),fe({});let w;function x($){let I;c=u=!1,typeof $=="function"?($(s.state.value[t]),I={type:Mo.patchFunction,storeId:t,events:g}):(ud(s.state.value[t],$),I={type:Mo.patchObject,payload:$,storeId:t,events:g});const Y=w=Symbol();un().then(()=>{w===Y&&(c=!0)}),u=!0,ai(f,I,s.state.value[t])}const k=i?function(){const{state:I}=n,Y=I?I():{};this.$patch(U=>{Us(U,Y)})}:_v;function S(){o.stop(),f=[],p=[],s._s.delete(t)}const E=($,I="")=>{if(yp in $)return $[mu]=I,$;const Y=function(){dc(s);const U=Array.from(arguments),z=[],pe=[];function ye(ke){z.push(ke)}function ue(ke){pe.push(ke)}ai(p,{args:U,name:Y[mu],store:T,after:ye,onError:ue});let _e;try{_e=$.apply(this&&this.$id===t?this:T,U)}catch(ke){throw ai(pe,ke),ke}return _e instanceof Promise?_e.then(ke=>(ai(z,ke),ke)).catch(ke=>(ai(pe,ke),Promise.reject(ke))):(ai(z,_e),_e)};return Y[yp]=!0,Y[mu]=I,Y},D={_p:s,$id:t,$onAction:mp.bind(null,p),$patch:x,$reset:k,$subscribe($,I={}){const Y=mp(f,$,I.detached,()=>U()),U=o.run(()=>Kt(()=>s.state.value[t],z=>{(I.flush==="sync"?u:c)&&$({storeId:t,type:Mo.direct,events:g},z)},Us({},l,I)));return Y},$dispose:S},T=Vr(D);s._s.set(t,T);const A=(s._a&&s._a.runWithContext||$1)(()=>s._e.run(()=>(o=ec()).run(()=>e({action:E}))));for(const $ in A){const I=A[$];if($t(I)&&!B1(I)||Js(I))i||(v&&L1(I)&&($t(I)?I.value=v[$]:ud(I,v[$])),s.state.value[t][$]=I);else if(typeof I=="function"){const Y=E(I,$);A[$]=Y,a.actions[$]=I}}return Us(T,A),Us(tt(T),A),Object.defineProperty(T,"$state",{get:()=>s.state.value[t],set:$=>{x(I=>{Us(I,$)})}}),s._p.forEach($=>{Us(T,o.run(()=>$({store:T,app:s._a,pinia:s,options:a})))}),v&&i&&n.hydrate&&n.hydrate(T.$state,v),c=!0,u=!0,T}/*! #__NO_SIDE_EFFECTS__ */function fc(t,e,n){let s;const r=typeof e=="function";s=r?n:e;function i(o,a){const l=cw();return o=o||(l?Mn(bv,null):null),o&&dc(o),o=vv,o._s.has(t)||(r?wv(t,e,s,o):j1(t,s,o)),o._s.get(t)}return i.$id=t,i}const Rr=fc("importStatus",()=>{const t=fe([]);return{imports:t,addImport:l=>{const c={...l,createdAt:new Date};return t.value.push(c),c.id},updateImport:(l,c)=>{const u=t.value.findIndex(f=>f.id===l);u!==-1&&(t.value[u]={...t.value[u],...c})},completeImport:(l,c)=>{const u=t.value.findIndex(f=>f.id===l);u!==-1&&(t.value[u]={...t.value[u],status:c?"failed":"completed",errorMessage:c,completedAt:new Date,progress:100})},removeImport:l=>{t.value=t.value.filter(c=>c.id!==l)},clearCompletedImports:()=>{t.value=t.value.filter(l=>l.status==="pending"||l.status==="processing")},getActiveImports:()=>t.value.filter(l=>l.status==="pending"||l.status==="processing"),getCompletedImports:()=>t.value.filter(l=>l.status==="completed"||l.status==="failed")}}),N1={key:0,class:"import-status-indicator",style:{width:"200px"}},z1={class:"d-flex justify-content-between align-items-baseline"},q1=["title"],U1={class:"small text-muted flex-shrink-0 ms-2"},W1={class:"progress mt-1"},V1=["aria-valuenow"],H1={class:"import-alerts position-fixed top-0 end-0 p-3",style:{"z-index":"1050"}},K1={class:"d-flex justify-content-between"},Y1={key:0,class:"small"},G1=["onClick"],X1=et({__name:"ImportStatusIndicator",setup(t){const e=Rr(),n=We(()=>e.getActiveImports()),s=We(()=>e.getCompletedImports()),r=We(()=>n.value.length>0?n.value[0]:null),i=a=>{e.removeImport(a)};let o=null;return Tn(()=>{o=window.setInterval(()=>{const a=new Date;e.imports.forEach(l=>{if((l.status==="completed"||l.status==="failed")&&l.completedAt){const c=new Date(l.completedAt);a.getTime()-c.getTime()>5e3&&e.removeImport(l.id)}})},1e3)}),Fi(()=>{o&&clearInterval(o)}),(a,l)=>(j(),W(Qe,null,[r.value?(j(),W("div",N1,[b("div",z1,[b("span",{class:"fw-medium small text-truncate",title:r.value.name},te(r.value.name),9,q1),b("span",U1,te(r.value.processedItems)+" / "+te(r.value.totalItems),1)]),b("div",W1,[b("div",{class:"progress-bar",role:"progressbar",style:En({width:r.value.progress+"%"}),"aria-valuenow":r.value.progress,"aria-valuemin":"0","aria-valuemax":"100"},null,12,V1)])])):ve("",!0),b("div",H1,[ze(dx,{name:"alert",tag:"div"},{default:rt(()=>[(j(!0),W(Qe,null,It(s.value,c=>(j(),W("div",{key:c.id,class:At(["alert",c.status==="completed"?"alert-success":"alert-danger"]),role:"alert"},[b("div",K1,[b("div",null,[b("strong",null,te(c.name),1),yt(" "+te(c.status==="completed"?"import completed successfully!":"import failed.")+" ",1),c.errorMessage?(j(),W("div",Y1,te(c.errorMessage),1)):ve("",!0)]),b("button",{type:"button",class:"btn-close",onClick:u=>i(c.id)},null,8,G1)])],2))),128))]),_:1})])],64))}}),Q1=fn(X1,[["__scopeId","data-v-0987b82f"]]),J1={class:"navbar navbar-expand-md navbar-light glass fixed-top"},Z1={class:"container-fluid"},ek=["aria-expanded"],tk={class:"nav-item"},nk={class:"nav-item"},sk={class:"nav-item"},rk={class:"nav-item"},ik={class:"d-flex align-items-center"},ok=et({__name:"Navigation",setup(t){const e=ef(),n=We(()=>e.name==="decks"||e.name==="deck-detail"||e.name==="deck-import"),s=fe(!1),r=()=>{s.value=!s.value},i=fe(null),o=fe(null);let a=null;function l(g){const v=i.value,w=o.value;if(!v||!w||!g)return;const x=v.getBoundingClientRect(),k=g.getBoundingClientRect(),S=12,E=Math.max(32,Math.round(k.height*.72)),D=Math.max(k.width+S*2,80),T=k.left-x.left+v.scrollLeft-S,P=k.top-x.top+v.scrollTop+(k.height-E)/2;w.style.setProperty("--_x",`${T}px`),w.style.setProperty("--_y",`${P}px`),w.style.setProperty("--_w",`${D}px`),w.style.setProperty("--_h",`${E}px`),w.style.opacity="1";const A=getComputedStyle(g).color||getComputedStyle(document.documentElement).getPropertyValue("--bs-primary")||"#0d6efd";w.style.setProperty("--nav-accent",A.trim())}function c(){return i.value?.querySelector(".nav-link.active")}function u(){const g=c();g&&l(g)}function f(g){const v=g.currentTarget;v&&l(v)}function p(){i.value&&(a=new ResizeObserver(()=>u()),a.observe(i.value),window.addEventListener("resize",u,{passive:!0}))}return Tn(async()=>{await un();const g=c()||i.value?.querySelector(".nav-link");g&&l(g),p()}),ic(()=>{a&&i.value&&a.unobserve(i.value),window.removeEventListener("resize",u)}),Kt(()=>e.fullPath,()=>un().then(u)),Kt(s,()=>un().then(u)),(g,v)=>{const w=Si("router-link");return j(),W("nav",J1,[b("div",Z1,[ze(w,{to:"/",class:"navbar-brand"},{default:rt(()=>[...v[0]||(v[0]=[b("img",{style:{"max-width":"48px"},src:Sx,alt:"logo"},null,-1),yt(" MTG Collection Tracker ",-1)])]),_:1}),b("button",{class:"navbar-toggler",type:"button",onClick:r,"aria-controls":"navbarNav","aria-expanded":s.value,"aria-label":"Toggle navigation"},[...v[1]||(v[1]=[b("span",{class:"navbar-toggler-icon"},null,-1)])],8,ek),b("div",{id:"navbarNav",class:At(["collapse navbar-collapse",{show:s.value}])},[b("ul",{class:"navbar-nav me-auto",ref_key:"navList",ref:i,onMouseleave:u},[b("div",{class:"nav-bubble",ref_key:"bubble",ref:o,"aria-hidden":"true"},null,512),b("li",tk,[ze(w,{to:"/",class:At(["nav-link",{active:$e(e).name==="home"}]),onMouseenter:f,onFocusin:f},{default:rt(()=>[...v[2]||(v[2]=[yt("Dashboard",-1)])]),_:1},8,["class"])]),b("li",nk,[ze(w,{to:"/decks",class:At(["nav-link",{active:n.value}]),onMouseenter:f,onFocusin:f},{default:rt(()=>[...v[3]||(v[3]=[yt("Decks",-1)])]),_:1},8,["class"])]),b("li",sk,[ze(w,{to:"/cards",class:At(["nav-link",{active:$e(e).name==="cards"}]),onMouseenter:f,onFocusin:f},{default:rt(()=>[...v[4]||(v[4]=[yt("Cards",-1)])]),_:1},8,["class"])]),b("li",rk,[ze(w,{to:"/import",class:At(["nav-link",{active:$e(e).path.startsWith("/import")}]),onMouseenter:f,onFocusin:f},{default:rt(()=>[...v[5]||(v[5]=[yt("Data Import",-1)])]),_:1},8,["class"])])],544),b("div",ik,[ze(Q1),ze(T1)])],2)])])}}}),ak={class:"noise-overlay","aria-hidden":"true"},lk=et({__name:"NoiseOverlay",setup(t){return(e,n)=>(j(),W("div",ak))}}),ck=fn(lk,[["__scopeId","data-v-63a7b15c"]]),uk={class:"container-lg",style:{"padding-top":"calc(var(--app-navbar-h) + 1.5rem)","padding-bottom":"1.5rem"}},dk=et({__name:"App",setup(t){return(e,n)=>{const s=Si("router-view");return j(),W(Qe,null,[ze(ck),ze(ok),b("main",uk,[ze(s)])],64)}}});var fk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function hk(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var yl={exports:{}},pk=yl.exports,vp;function gk(){return vp||(vp=1,(function(t,e){(function(n,s){t.exports=s()})(pk,function(){var n=function(d,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(m[_]=y[_])})(d,h)},s=function(){return(s=Object.assign||function(d){for(var h,m=1,y=arguments.length;m<y;m++)for(var _ in h=arguments[m])Object.prototype.hasOwnProperty.call(h,_)&&(d[_]=h[_]);return d}).apply(this,arguments)};function r(d,h,m){for(var y,_=0,C=h.length;_<C;_++)!y&&_ in h||((y=y||Array.prototype.slice.call(h,0,_))[_]=h[_]);return d.concat(y||Array.prototype.slice.call(h))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:fk,o=Object.keys,a=Array.isArray;function l(d,h){return typeof h!="object"||o(h).forEach(function(m){d[m]=h[m]}),d}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function f(d,h){return u.call(d,h)}function p(d,h){typeof h=="function"&&(h=h(c(d))),(typeof Reflect>"u"?o:Reflect.ownKeys)(h).forEach(function(m){v(d,m,h[m])})}var g=Object.defineProperty;function v(d,h,m,y){g(d,h,l(m&&f(m,"get")&&typeof m.get=="function"?{get:m.get,set:m.set,configurable:!0}:{value:m,configurable:!0,writable:!0},y))}function w(d){return{from:function(h){return d.prototype=Object.create(h.prototype),v(d.prototype,"constructor",d),{extend:p.bind(null,d.prototype)}}}}var x=Object.getOwnPropertyDescriptor,k=[].slice;function S(d,h,m){return k.call(d,h,m)}function E(d,h){return h(d)}function D(d){if(!d)throw new Error("Assertion Failed")}function T(d){i.setImmediate?setImmediate(d):setTimeout(d,0)}function P(d,h){if(typeof h=="string"&&f(d,h))return d[h];if(!h)return d;if(typeof h!="string"){for(var m=[],y=0,_=h.length;y<_;++y){var C=P(d,h[y]);m.push(C)}return m}var M=h.indexOf(".");if(M!==-1){var R=d[h.substr(0,M)];return R==null?void 0:P(R,h.substr(M+1))}}function A(d,h,m){if(d&&h!==void 0&&!("isFrozen"in Object&&Object.isFrozen(d)))if(typeof h!="string"&&"length"in h){D(typeof m!="string"&&"length"in m);for(var y=0,_=h.length;y<_;++y)A(d,h[y],m[y])}else{var C,M,R=h.indexOf(".");R!==-1?(C=h.substr(0,R),(M=h.substr(R+1))===""?m===void 0?a(d)&&!isNaN(parseInt(C))?d.splice(C,1):delete d[C]:d[C]=m:A(R=!(R=d[C])||!f(d,C)?d[C]={}:R,M,m)):m===void 0?a(d)&&!isNaN(parseInt(h))?d.splice(h,1):delete d[h]:d[h]=m}}function $(d){var h,m={};for(h in d)f(d,h)&&(m[h]=d[h]);return m}var I=[].concat;function Y(d){return I.apply([],d)}var Ge="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Y([8,16,32,64].map(function(d){return["Int","Uint","Float"].map(function(h){return h+d+"Array"})}))).filter(function(d){return i[d]}),U=new Set(Ge.map(function(d){return i[d]})),z=null;function pe(d){return z=new WeakMap,d=(function h(m){if(!m||typeof m!="object")return m;var y=z.get(m);if(y)return y;if(a(m)){y=[],z.set(m,y);for(var _=0,C=m.length;_<C;++_)y.push(h(m[_]))}else if(U.has(m.constructor))y=m;else{var M,R=c(m);for(M in y=R===Object.prototype?{}:Object.create(R),z.set(m,y),m)f(m,M)&&(y[M]=h(m[M]))}return y})(d),z=null,d}var ye={}.toString;function ue(d){return ye.call(d).slice(8,-1)}var _e=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ke=typeof _e=="symbol"?function(d){var h;return d!=null&&(h=d[_e])&&h.apply(d)}:function(){return null};function Z(d,h){return h=d.indexOf(h),0<=h&&d.splice(h,1),0<=h}var ne={};function X(d){var h,m,y,_;if(arguments.length===1){if(a(d))return d.slice();if(this===ne&&typeof d=="string")return[d];if(_=ke(d)){for(m=[];!(y=_.next()).done;)m.push(y.value);return m}if(d==null)return[d];if(typeof(h=d.length)!="number")return[d];for(m=new Array(h);h--;)m[h]=d[h];return m}for(h=arguments.length,m=new Array(h);h--;)m[h]=arguments[h];return m}var Le=typeof Symbol<"u"?function(d){return d[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ue=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Rn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ue),Se={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ve(d,h){this.name=d,this.message=h}function wt(d,h){return d+". Errors: "+Object.keys(h).map(function(m){return h[m].toString()}).filter(function(m,y,_){return _.indexOf(m)===y}).join(`
`)}function gt(d,h,m,y){this.failures=h,this.failedKeys=y,this.successCount=m,this.message=wt(d,h)}function it(d,h){this.name="BulkError",this.failures=Object.keys(h).map(function(m){return h[m]}),this.failuresByPos=h,this.message=wt(d,this.failures)}w(Ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),w(gt).from(Ve),w(it).from(Ve);var ae=Rn.reduce(function(d,h){return d[h]=h+"Error",d},{}),Oe=Ve,re=Rn.reduce(function(d,h){var m=h+"Error";function y(_,C){this.name=m,_?typeof _=="string"?(this.message="".concat(_).concat(C?`
 `+C:""),this.inner=C||null):typeof _=="object"&&(this.message="".concat(_.name," ").concat(_.message),this.inner=_):(this.message=Se[h]||m,this.inner=null)}return w(y).from(Oe),d[h]=y,d},{});re.Syntax=SyntaxError,re.Type=TypeError,re.Range=RangeError;var Fe=Ue.reduce(function(d,h){return d[h+"Error"]=re[h],d},{}),nt=Rn.reduce(function(d,h){return["Syntax","Type","Range"].indexOf(h)===-1&&(d[h+"Error"]=re[h]),d},{});function O(){}function L(d){return d}function ee(d,h){return d==null||d===L?h:function(m){return h(d(m))}}function le(d,h){return function(){d.apply(this,arguments),h.apply(this,arguments)}}function de(d,h){return d===O?h:function(){var m=d.apply(this,arguments);m!==void 0&&(arguments[0]=m);var y=this.onsuccess,_=this.onerror;this.onsuccess=null,this.onerror=null;var C=h.apply(this,arguments);return y&&(this.onsuccess=this.onsuccess?le(y,this.onsuccess):y),_&&(this.onerror=this.onerror?le(_,this.onerror):_),C!==void 0?C:m}}function ce(d,h){return d===O?h:function(){d.apply(this,arguments);var m=this.onsuccess,y=this.onerror;this.onsuccess=this.onerror=null,h.apply(this,arguments),m&&(this.onsuccess=this.onsuccess?le(m,this.onsuccess):m),y&&(this.onerror=this.onerror?le(y,this.onerror):y)}}function Ie(d,h){return d===O?h:function(m){var y=d.apply(this,arguments);l(m,y);var _=this.onsuccess,C=this.onerror;return this.onsuccess=null,this.onerror=null,m=h.apply(this,arguments),_&&(this.onsuccess=this.onsuccess?le(_,this.onsuccess):_),C&&(this.onerror=this.onerror?le(C,this.onerror):C),y===void 0?m===void 0?void 0:m:l(y,m)}}function Pe(d,h){return d===O?h:function(){return h.apply(this,arguments)!==!1&&d.apply(this,arguments)}}function xe(d,h){return d===O?h:function(){var m=d.apply(this,arguments);if(m&&typeof m.then=="function"){for(var y=this,_=arguments.length,C=new Array(_);_--;)C[_]=arguments[_];return m.then(function(){return h.apply(y,C)})}return h.apply(this,arguments)}}nt.ModifyError=gt,nt.DexieError=Ve,nt.BulkError=it;var he=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ne(d){he=d}var Ee={},je=100,Ge=typeof Promise>"u"?[]:(function(){var d=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[d,c(d),d];var h=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[h,c(h),d]})(),Ue=Ge[0],Rn=Ge[1],Ge=Ge[2],Rn=Rn&&Rn.then,ot=Ue&&Ue.constructor,lt=!!Ge,Ft=function(d,h){Ds.push([d,h]),hn&&(queueMicrotask(x_),hn=!1)},jt=!0,hn=!0,Nt=[],Yn=[],Qr=L,Mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:O,pgp:!1,env:{},finalize:O},Re=Mt,Ds=[],Gn=0,ma=[];function De(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var h=this._PSD=Re;if(typeof d!="function"){if(d!==Ee)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ic(this,this._value))}this._state=null,this._value=null,++h.ref,(function m(y,_){try{_(function(C){if(y._state===null){if(C===y)throw new TypeError("A promise cannot be resolved with itself.");var M=y._lib&&Jr();C&&typeof C.then=="function"?m(y,function(R,B){C instanceof De?C._then(R,B):C.then(R,B)}):(y._state=!0,y._value=C,$f(y)),M&&Zr()}},Ic.bind(null,y))}catch(C){Ic(y,C)}})(this,d)}var Ac={get:function(){var d=Re,h=_a;function m(y,_){var C=this,M=!d.global&&(d!==Re||h!==_a),R=M&&!Rs(),B=new De(function(q,H){Ec(C,new Rf(Lf(y,d,M,R),Lf(_,d,M,R),q,H,d))});return this._consoleTask&&(B._consoleTask=this._consoleTask),B}return m.prototype=Ee,m},set:function(d){v(this,"then",d&&d.prototype===Ee?Ac:{get:function(){return d},set:Ac.set})}};function Rf(d,h,m,y,_){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof h=="function"?h:null,this.resolve=m,this.reject=y,this.psd=_}function Ic(d,h){var m,y;Yn.push(h),d._state===null&&(m=d._lib&&Jr(),h=Qr(h),d._state=!1,d._value=h,y=d,Nt.some(function(_){return _._value===y._value})||Nt.push(y),$f(d),m&&Zr())}function $f(d){var h=d._listeners;d._listeners=[];for(var m=0,y=h.length;m<y;++m)Ec(d,h[m]);var _=d._PSD;--_.ref||_.finalize(),Gn===0&&(++Gn,Ft(function(){--Gn==0&&Mc()},[]))}function Ec(d,h){if(d._state!==null){var m=d._state?h.onFulfilled:h.onRejected;if(m===null)return(d._state?h.resolve:h.reject)(d._value);++h.psd.ref,++Gn,Ft(w_,[m,d,h])}else d._listeners.push(h)}function w_(d,h,m){try{var y,_=h._value;!h._state&&Yn.length&&(Yn=[]),y=he&&h._consoleTask?h._consoleTask.run(function(){return d(_)}):d(_),h._state||Yn.indexOf(_)!==-1||(function(C){for(var M=Nt.length;M;)if(Nt[--M]._value===C._value)return Nt.splice(M,1)})(h),m.resolve(y)}catch(C){m.reject(C)}finally{--Gn==0&&Mc(),--m.psd.ref||m.psd.finalize()}}function x_(){ur(Mt,function(){Jr()&&Zr()})}function Jr(){var d=jt;return hn=jt=!1,d}function Zr(){var d,h,m;do for(;0<Ds.length;)for(d=Ds,Ds=[],m=d.length,h=0;h<m;++h){var y=d[h];y[0].apply(null,y[1])}while(0<Ds.length);hn=jt=!0}function Mc(){var d=Nt;Nt=[],d.forEach(function(y){y._PSD.onunhandled.call(null,y._value,y)});for(var h=ma.slice(0),m=h.length;m;)h[--m]()}function ya(d){return new De(Ee,!1,d)}function Pt(d,h){var m=Re;return function(){var y=Jr(),_=Re;try{return $s(m,!0),d.apply(this,arguments)}catch(C){h&&h(C)}finally{$s(_,!1),y&&Zr()}}}p(De.prototype,{then:Ac,_then:function(d,h){Ec(this,new Rf(null,null,d,h,Re))},catch:function(d){if(arguments.length===1)return this.then(null,d);var h=d,m=arguments[1];return typeof h=="function"?this.then(null,function(y){return(y instanceof h?m:ya)(y)}):this.then(null,function(y){return(y&&y.name===h?m:ya)(y)})},finally:function(d){return this.then(function(h){return De.resolve(d()).then(function(){return h})},function(h){return De.resolve(d()).then(function(){return ya(h)})})},timeout:function(d,h){var m=this;return d<1/0?new De(function(y,_){var C=setTimeout(function(){return _(new re.Timeout(h))},d);m.then(y,_).finally(clearTimeout.bind(null,C))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&v(De.prototype,Symbol.toStringTag,"Dexie.Promise"),Mt.env=Ff(),p(De,{all:function(){var d=X.apply(null,arguments).map(wa);return new De(function(h,m){d.length===0&&h([]);var y=d.length;d.forEach(function(_,C){return De.resolve(_).then(function(M){d[C]=M,--y||h(d)},m)})})},resolve:function(d){return d instanceof De?d:d&&typeof d.then=="function"?new De(function(h,m){d.then(h,m)}):new De(Ee,!0,d)},reject:ya,race:function(){var d=X.apply(null,arguments).map(wa);return new De(function(h,m){d.map(function(y){return De.resolve(y).then(h,m)})})},PSD:{get:function(){return Re},set:function(d){return Re=d}},totalEchoes:{get:function(){return _a}},newPSD:Ts,usePSD:ur,scheduler:{get:function(){return Ft},set:function(d){Ft=d}},rejectionMapper:{get:function(){return Qr},set:function(d){Qr=d}},follow:function(d,h){return new De(function(m,y){return Ts(function(_,C){var M=Re;M.unhandleds=[],M.onunhandled=C,M.finalize=le(function(){var R,B=this;R=function(){B.unhandleds.length===0?_():C(B.unhandleds[0])},ma.push(function q(){R(),ma.splice(ma.indexOf(q),1)}),++Gn,Ft(function(){--Gn==0&&Mc()},[])},M.finalize),d()},h,m,y)})}}),ot&&(ot.allSettled&&v(De,"allSettled",function(){var d=X.apply(null,arguments).map(wa);return new De(function(h){d.length===0&&h([]);var m=d.length,y=new Array(m);d.forEach(function(_,C){return De.resolve(_).then(function(M){return y[C]={status:"fulfilled",value:M}},function(M){return y[C]={status:"rejected",reason:M}}).then(function(){return--m||h(y)})})})}),ot.any&&typeof AggregateError<"u"&&v(De,"any",function(){var d=X.apply(null,arguments).map(wa);return new De(function(h,m){d.length===0&&m(new AggregateError([]));var y=d.length,_=new Array(y);d.forEach(function(C,M){return De.resolve(C).then(function(R){return h(R)},function(R){_[M]=R,--y||m(new AggregateError(_))})})})}),ot.withResolvers&&(De.withResolvers=ot.withResolvers));var zt={awaits:0,echoes:0,id:0},k_=0,va=[],ba=0,_a=0,C_=0;function Ts(d,h,m,y){var _=Re,C=Object.create(_);return C.parent=_,C.ref=0,C.global=!1,C.id=++C_,Mt.env,C.env=lt?{Promise:De,PromiseProp:{value:De,configurable:!0,writable:!0},all:De.all,race:De.race,allSettled:De.allSettled,any:De.any,resolve:De.resolve,reject:De.reject}:{},h&&l(C,h),++_.ref,C.finalize=function(){--this.parent.ref||this.parent.finalize()},y=ur(C,d,m,y),C.ref===0&&C.finalize(),y}function ei(){return zt.id||(zt.id=++k_),++zt.awaits,zt.echoes+=je,zt.id}function Rs(){return!!zt.awaits&&(--zt.awaits==0&&(zt.id=0),zt.echoes=zt.awaits*je,!0)}function wa(d){return zt.echoes&&d&&d.constructor===ot?(ei(),d.then(function(h){return Rs(),h},function(h){return Rs(),Tt(h)})):d}function S_(){var d=va[va.length-1];va.pop(),$s(d,!1)}function $s(d,h){var m,y=Re;(h?!zt.echoes||ba++&&d===Re:!ba||--ba&&d===Re)||queueMicrotask(h?(function(_){++_a,zt.echoes&&--zt.echoes!=0||(zt.echoes=zt.awaits=zt.id=0),va.push(Re),$s(_,!0)}).bind(null,d):S_),d!==Re&&(Re=d,y===Mt&&(Mt.env=Ff()),lt&&(m=Mt.env.Promise,h=d.env,(y.global||d.global)&&(Object.defineProperty(i,"Promise",h.PromiseProp),m.all=h.all,m.race=h.race,m.resolve=h.resolve,m.reject=h.reject,h.allSettled&&(m.allSettled=h.allSettled),h.any&&(m.any=h.any))))}function Ff(){var d=i.Promise;return lt?{Promise:d,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:d.all,race:d.race,allSettled:d.allSettled,any:d.any,resolve:d.resolve,reject:d.reject}:{}}function ur(d,h,m,y,_){var C=Re;try{return $s(d,!0),h(m,y,_)}finally{$s(C,!1)}}function Lf(d,h,m,y){return typeof d!="function"?d:function(){var _=Re;m&&ei(),$s(h,!0);try{return d.apply(this,arguments)}finally{$s(_,!1),y&&queueMicrotask(Rs)}}}function Oc(d){Promise===ot&&zt.echoes===0?ba===0?d():enqueueNativeMicroTask(d):setTimeout(d,0)}(""+Rn).indexOf("[native code]")===-1&&(ei=Rs=O);var Tt=De.reject,dr="￿",ds="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Bf="String expected.",ti=[],xa="__dbnames",Dc="readonly",Tc="readwrite";function fr(d,h){return d?h?function(){return d.apply(this,arguments)&&h.apply(this,arguments)}:d:h}var jf={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ka(d){return typeof d!="string"||/\./.test(d)?function(h){return h}:function(h){return h[d]===void 0&&d in h&&delete(h=pe(h))[d],h}}function Nf(){throw re.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function st(d,h){try{var m=zf(d),y=zf(h);if(m!==y)return m==="Array"?1:y==="Array"?-1:m==="binary"?1:y==="binary"?-1:m==="string"?1:y==="string"?-1:m==="Date"?1:y!=="Date"?NaN:-1;switch(m){case"number":case"Date":case"string":return h<d?1:d<h?-1:0;case"binary":return(function(_,C){for(var M=_.length,R=C.length,B=M<R?M:R,q=0;q<B;++q)if(_[q]!==C[q])return _[q]<C[q]?-1:1;return M===R?0:M<R?-1:1})(qf(d),qf(h));case"Array":return(function(_,C){for(var M=_.length,R=C.length,B=M<R?M:R,q=0;q<B;++q){var H=st(_[q],C[q]);if(H!==0)return H}return M===R?0:M<R?-1:1})(d,h)}}catch{}return NaN}function zf(d){var h=typeof d;return h!="object"?h:ArrayBuffer.isView(d)?"binary":(d=ue(d),d==="ArrayBuffer"?"binary":d)}function qf(d){return d instanceof Uint8Array?d:ArrayBuffer.isView(d)?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):new Uint8Array(d)}function Ca(d,h,m){var y=d.schema.yProps;return y?(h&&0<m.numFailures&&(h=h.filter(function(_,C){return!m.failures[C]})),Promise.all(y.map(function(_){return _=_.updatesTable,h?d.db.table(_).where("k").anyOf(h).delete():d.db.table(_).clear()})).then(function(){return m})):m}var Uf=(xt.prototype._trans=function(d,h,m){var y=this._tx||Re.trans,_=this.name,C=he&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(d==="readonly"?"read":"write"," ").concat(this.name));function M(q,H,F){if(!F.schema[_])throw new re.NotFound("Table "+_+" not part of transaction");return h(F.idbtrans,F)}var R=Jr();try{var B=y&&y.db._novip===this.db._novip?y===Re.trans?y._promise(d,M,m):Ts(function(){return y._promise(d,M,m)},{trans:y,transless:Re.transless||Re}):(function q(H,F,Q,N){if(H.idbdb&&(H._state.openComplete||Re.letThrough||H._vip)){var V=H._createTransaction(F,Q,H._dbSchema);try{V.create(),H._state.PR1398_maxLoop=3}catch(G){return G.name===ae.InvalidState&&H.isOpen()&&0<--H._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),H.close({disableAutoOpen:!1}),H.open().then(function(){return q(H,F,Q,N)})):Tt(G)}return V._promise(F,function(G,K){return Ts(function(){return Re.trans=V,N(G,K,V)})}).then(function(G){if(F==="readwrite")try{V.idbtrans.commit()}catch{}return F==="readonly"?G:V._completion.then(function(){return G})})}if(H._state.openComplete)return Tt(new re.DatabaseClosed(H._state.dbOpenError));if(!H._state.isBeingOpened){if(!H._state.autoOpen)return Tt(new re.DatabaseClosed);H.open().catch(O)}return H._state.dbReadyPromise.then(function(){return q(H,F,Q,N)})})(this.db,d,[this.name],M);return C&&(B._consoleTask=C,B=B.catch(function(q){return console.trace(q),Tt(q)})),B}finally{R&&Zr()}},xt.prototype.get=function(d,h){var m=this;return d&&d.constructor===Object?this.where(d).first(h):d==null?Tt(new re.Type("Invalid argument to Table.get()")):this._trans("readonly",function(y){return m.core.get({trans:y,key:d}).then(function(_){return m.hook.reading.fire(_)})}).then(h)},xt.prototype.where=function(d){if(typeof d=="string")return new this.db.WhereClause(this,d);if(a(d))return new this.db.WhereClause(this,"[".concat(d.join("+"),"]"));var h=o(d);if(h.length===1)return this.where(h[0]).equals(d[h[0]]);var m=this.schema.indexes.concat(this.schema.primKey).filter(function(R){if(R.compound&&h.every(function(q){return 0<=R.keyPath.indexOf(q)})){for(var B=0;B<h.length;++B)if(h.indexOf(R.keyPath[B])===-1)return!1;return!0}return!1}).sort(function(R,B){return R.keyPath.length-B.keyPath.length})[0];if(m&&this.db._maxKey!==dr){var C=m.keyPath.slice(0,h.length);return this.where(C).equals(C.map(function(B){return d[B]}))}!m&&he&&console.warn("The query ".concat(JSON.stringify(d)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(h.join("+"),"]"));var y=this.schema.idxByName;function _(R,B){return st(R,B)===0}var M=h.reduce(function(F,B){var q=F[0],H=F[1],F=y[B],Q=d[B];return[q||F,q||!F?fr(H,F&&F.multi?function(N){return N=P(N,B),a(N)&&N.some(function(V){return _(Q,V)})}:function(N){return _(Q,P(N,B))}):H]},[null,null]),C=M[0],M=M[1];return C?this.where(C.name).equals(d[C.keyPath]).filter(M):m?this.filter(M):this.where(h).equals("")},xt.prototype.filter=function(d){return this.toCollection().and(d)},xt.prototype.count=function(d){return this.toCollection().count(d)},xt.prototype.offset=function(d){return this.toCollection().offset(d)},xt.prototype.limit=function(d){return this.toCollection().limit(d)},xt.prototype.each=function(d){return this.toCollection().each(d)},xt.prototype.toArray=function(d){return this.toCollection().toArray(d)},xt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},xt.prototype.orderBy=function(d){return new this.db.Collection(new this.db.WhereClause(this,a(d)?"[".concat(d.join("+"),"]"):d))},xt.prototype.reverse=function(){return this.toCollection().reverse()},xt.prototype.mapToClass=function(d){var h,m=this.db,y=this.name;function _(){return h!==null&&h.apply(this,arguments)||this}(this.schema.mappedClass=d).prototype instanceof Nf&&((function(B,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");function H(){this.constructor=B}n(B,q),B.prototype=q===null?Object.create(q):(H.prototype=q.prototype,new H)})(_,h=d),Object.defineProperty(_.prototype,"db",{get:function(){return m},enumerable:!1,configurable:!0}),_.prototype.table=function(){return y},d=_);for(var C=new Set,M=d.prototype;M;M=c(M))Object.getOwnPropertyNames(M).forEach(function(B){return C.add(B)});function R(B){if(!B)return B;var q,H=Object.create(d.prototype);for(q in B)if(!C.has(q))try{H[q]=B[q]}catch{}return H}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=R,this.hook("reading",R),d},xt.prototype.defineClass=function(){return this.mapToClass(function(d){l(this,d)})},xt.prototype.add=function(d,h){var m=this,y=this.schema.primKey,_=y.auto,C=y.keyPath,M=d;return C&&_&&(M=ka(C)(d)),this._trans("readwrite",function(R){return m.core.mutate({trans:R,type:"add",keys:h!=null?[h]:null,values:[M]})}).then(function(R){return R.numFailures?De.reject(R.failures[0]):R.lastResult}).then(function(R){if(C)try{A(d,C,R)}catch{}return R})},xt.prototype.update=function(d,h){return typeof d!="object"||a(d)?this.where(":id").equals(d).modify(h):(d=P(d,this.schema.primKey.keyPath),d===void 0?Tt(new re.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(d).modify(h))},xt.prototype.put=function(d,h){var m=this,y=this.schema.primKey,_=y.auto,C=y.keyPath,M=d;return C&&_&&(M=ka(C)(d)),this._trans("readwrite",function(R){return m.core.mutate({trans:R,type:"put",values:[M],keys:h!=null?[h]:null})}).then(function(R){return R.numFailures?De.reject(R.failures[0]):R.lastResult}).then(function(R){if(C)try{A(d,C,R)}catch{}return R})},xt.prototype.delete=function(d){var h=this;return this._trans("readwrite",function(m){return h.core.mutate({trans:m,type:"delete",keys:[d]}).then(function(y){return Ca(h,[d],y)}).then(function(y){return y.numFailures?De.reject(y.failures[0]):void 0})})},xt.prototype.clear=function(){var d=this;return this._trans("readwrite",function(h){return d.core.mutate({trans:h,type:"deleteRange",range:jf}).then(function(m){return Ca(d,null,m)})}).then(function(h){return h.numFailures?De.reject(h.failures[0]):void 0})},xt.prototype.bulkGet=function(d){var h=this;return this._trans("readonly",function(m){return h.core.getMany({keys:d,trans:m}).then(function(y){return y.map(function(_){return h.hook.reading.fire(_)})})})},xt.prototype.bulkAdd=function(d,h,m){var y=this,_=Array.isArray(h)?h:void 0,C=(m=m||(_?void 0:h))?m.allKeys:void 0;return this._trans("readwrite",function(M){var q=y.schema.primKey,R=q.auto,q=q.keyPath;if(q&&_)throw new re.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(_&&_.length!==d.length)throw new re.InvalidArgument("Arguments objects and keys must have the same length");var B=d.length,q=q&&R?d.map(ka(q)):d;return y.core.mutate({trans:M,type:"add",keys:_,values:q,wantResults:C}).then(function(V){var F=V.numFailures,Q=V.results,N=V.lastResult,V=V.failures;if(F===0)return C?Q:N;throw new it("".concat(y.name,".bulkAdd(): ").concat(F," of ").concat(B," operations failed"),V)})})},xt.prototype.bulkPut=function(d,h,m){var y=this,_=Array.isArray(h)?h:void 0,C=(m=m||(_?void 0:h))?m.allKeys:void 0;return this._trans("readwrite",function(M){var q=y.schema.primKey,R=q.auto,q=q.keyPath;if(q&&_)throw new re.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(_&&_.length!==d.length)throw new re.InvalidArgument("Arguments objects and keys must have the same length");var B=d.length,q=q&&R?d.map(ka(q)):d;return y.core.mutate({trans:M,type:"put",keys:_,values:q,wantResults:C}).then(function(V){var F=V.numFailures,Q=V.results,N=V.lastResult,V=V.failures;if(F===0)return C?Q:N;throw new it("".concat(y.name,".bulkPut(): ").concat(F," of ").concat(B," operations failed"),V)})})},xt.prototype.bulkUpdate=function(d){var h=this,m=this.core,y=d.map(function(M){return M.key}),_=d.map(function(M){return M.changes}),C=[];return this._trans("readwrite",function(M){return m.getMany({trans:M,keys:y,cache:"clone"}).then(function(R){var B=[],q=[];d.forEach(function(F,Q){var N=F.key,V=F.changes,G=R[Q];if(G){for(var K=0,J=Object.keys(V);K<J.length;K++){var se=J[K],ie=V[se];if(se===h.schema.primKey.keyPath){if(st(ie,N)!==0)throw new re.Constraint("Cannot update primary key in bulkUpdate()")}else A(G,se,ie)}C.push(Q),B.push(N),q.push(G)}});var H=B.length;return m.mutate({trans:M,type:"put",keys:B,values:q,updates:{keys:y,changeSpecs:_}}).then(function(F){var Q=F.numFailures,N=F.failures;if(Q===0)return H;for(var V=0,G=Object.keys(N);V<G.length;V++){var K,J=G[V],se=C[Number(J)];se!=null&&(K=N[J],delete N[J],N[se]=K)}throw new it("".concat(h.name,".bulkUpdate(): ").concat(Q," of ").concat(H," operations failed"),N)})})})},xt.prototype.bulkDelete=function(d){var h=this,m=d.length;return this._trans("readwrite",function(y){return h.core.mutate({trans:y,type:"delete",keys:d}).then(function(_){return Ca(h,d,_)})}).then(function(M){var _=M.numFailures,C=M.lastResult,M=M.failures;if(_===0)return C;throw new it("".concat(h.name,".bulkDelete(): ").concat(_," of ").concat(m," operations failed"),M)})},xt);function xt(){}function zi(d){function h(M,R){if(R){for(var B=arguments.length,q=new Array(B-1);--B;)q[B-1]=arguments[B];return m[M].subscribe.apply(null,q),d}if(typeof M=="string")return m[M]}var m={};h.addEventType=C;for(var y=1,_=arguments.length;y<_;++y)C(arguments[y]);return h;function C(M,R,B){if(typeof M!="object"){var q;R=R||Pe;var H={subscribers:[],fire:B=B||O,subscribe:function(F){H.subscribers.indexOf(F)===-1&&(H.subscribers.push(F),H.fire=R(H.fire,F))},unsubscribe:function(F){H.subscribers=H.subscribers.filter(function(Q){return Q!==F}),H.fire=H.subscribers.reduce(R,B)}};return m[M]=h[M]=H}o(q=M).forEach(function(F){var Q=q[F];if(a(Q))C(F,q[F][0],q[F][1]);else{if(Q!=="asap")throw new re.InvalidArgument("Invalid event config");var N=C(F,L,function(){for(var V=arguments.length,G=new Array(V);V--;)G[V]=arguments[V];N.subscribers.forEach(function(K){T(function(){K.apply(null,G)})})})}})}}function qi(d,h){return w(h).from({prototype:d}),h}function ni(d,h){return!(d.filter||d.algorithm||d.or)&&(h?d.justLimit:!d.replayFilter)}function Rc(d,h){d.filter=fr(d.filter,h)}function $c(d,h,m){var y=d.replayFilter;d.replayFilter=y?function(){return fr(y(),h())}:h,d.justLimit=m&&!y}function Sa(d,h){if(d.isPrimKey)return h.primaryKey;var m=h.getIndexByKeyPath(d.index);if(!m)throw new re.Schema("KeyPath "+d.index+" on object store "+h.name+" is not indexed");return m}function Wf(d,h,m){var y=Sa(d,h.schema);return h.openCursor({trans:m,values:!d.keysOnly,reverse:d.dir==="prev",unique:!!d.unique,query:{index:y,range:d.range}})}function Pa(d,h,m,y){var _=d.replayFilter?fr(d.filter,d.replayFilter()):d.filter;if(d.or){var C={},M=function(R,B,q){var H,F;_&&!_(B,q,function(Q){return B.stop(Q)},function(Q){return B.fail(Q)})||((F=""+(H=B.primaryKey))=="[object ArrayBuffer]"&&(F=""+new Uint8Array(H)),f(C,F)||(C[F]=!0,h(R,B,q)))};return Promise.all([d.or._iterate(M,m),Vf(Wf(d,y,m),d.algorithm,M,!d.keysOnly&&d.valueMapper)])}return Vf(Wf(d,y,m),fr(d.algorithm,_),h,!d.keysOnly&&d.valueMapper)}function Vf(d,h,m,y){var _=Pt(y?function(C,M,R){return m(y(C),M,R)}:m);return d.then(function(C){if(C)return C.start(function(){var M=function(){return C.continue()};h&&!h(C,function(R){return M=R},function(R){C.stop(R),M=O},function(R){C.fail(R),M=O})||_(C.value,C,function(R){return M=R}),M()})})}var Ui=(Hf.prototype.execute=function(d){var h=this["@@propmod"];if(h.add!==void 0){var m=h.add;if(a(m))return r(r([],a(d)?d:[],!0),m).sort();if(typeof m=="number")return(Number(d)||0)+m;if(typeof m=="bigint")try{return BigInt(d)+m}catch{return BigInt(0)+m}throw new TypeError("Invalid term ".concat(m))}if(h.remove!==void 0){var y=h.remove;if(a(y))return a(d)?d.filter(function(_){return!y.includes(_)}).sort():[];if(typeof y=="number")return Number(d)-y;if(typeof y=="bigint")try{return BigInt(d)-y}catch{return BigInt(0)-y}throw new TypeError("Invalid subtrahend ".concat(y))}return m=(m=h.replacePrefix)===null||m===void 0?void 0:m[0],m&&typeof d=="string"&&d.startsWith(m)?h.replacePrefix[1]+d.substring(m.length):d},Hf);function Hf(d){this["@@propmod"]=d}var P_=(ct.prototype._read=function(d,h){var m=this._ctx;return m.error?m.table._trans(null,Tt.bind(null,m.error)):m.table._trans("readonly",d).then(h)},ct.prototype._write=function(d){var h=this._ctx;return h.error?h.table._trans(null,Tt.bind(null,h.error)):h.table._trans("readwrite",d,"locked")},ct.prototype._addAlgorithm=function(d){var h=this._ctx;h.algorithm=fr(h.algorithm,d)},ct.prototype._iterate=function(d,h){return Pa(this._ctx,d,h,this._ctx.table.core)},ct.prototype.clone=function(d){var h=Object.create(this.constructor.prototype),m=Object.create(this._ctx);return d&&l(m,d),h._ctx=m,h},ct.prototype.raw=function(){return this._ctx.valueMapper=null,this},ct.prototype.each=function(d){var h=this._ctx;return this._read(function(m){return Pa(h,d,m,h.table.core)})},ct.prototype.count=function(d){var h=this;return this._read(function(m){var y=h._ctx,_=y.table.core;if(ni(y,!0))return _.count({trans:m,query:{index:Sa(y,_.schema),range:y.range}}).then(function(M){return Math.min(M,y.limit)});var C=0;return Pa(y,function(){return++C,!1},m,_).then(function(){return C})}).then(d)},ct.prototype.sortBy=function(d,h){var m=d.split(".").reverse(),y=m[0],_=m.length-1;function C(B,q){return q?C(B[m[q]],q-1):B[y]}var M=this._ctx.dir==="next"?1:-1;function R(B,q){return st(C(B,_),C(q,_))*M}return this.toArray(function(B){return B.sort(R)}).then(h)},ct.prototype.toArray=function(d){var h=this;return this._read(function(m){var y=h._ctx;if(y.dir==="next"&&ni(y,!0)&&0<y.limit){var _=y.valueMapper,C=Sa(y,y.table.core.schema);return y.table.core.query({trans:m,limit:y.limit,values:!0,query:{index:C,range:y.range}}).then(function(R){return R=R.result,_?R.map(_):R})}var M=[];return Pa(y,function(R){return M.push(R)},m,y.table.core).then(function(){return M})},d)},ct.prototype.offset=function(d){var h=this._ctx;return d<=0||(h.offset+=d,ni(h)?$c(h,function(){var m=d;return function(y,_){return m===0||(m===1?--m:_(function(){y.advance(m),m=0}),!1)}}):$c(h,function(){var m=d;return function(){return--m<0}})),this},ct.prototype.limit=function(d){return this._ctx.limit=Math.min(this._ctx.limit,d),$c(this._ctx,function(){var h=d;return function(m,y,_){return--h<=0&&y(_),0<=h}},!0),this},ct.prototype.until=function(d,h){return Rc(this._ctx,function(m,y,_){return!d(m.value)||(y(_),h)}),this},ct.prototype.first=function(d){return this.limit(1).toArray(function(h){return h[0]}).then(d)},ct.prototype.last=function(d){return this.reverse().first(d)},ct.prototype.filter=function(d){var h;return Rc(this._ctx,function(m){return d(m.value)}),(h=this._ctx).isMatch=fr(h.isMatch,d),this},ct.prototype.and=function(d){return this.filter(d)},ct.prototype.or=function(d){return new this.db.WhereClause(this._ctx.table,d,this)},ct.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ct.prototype.desc=function(){return this.reverse()},ct.prototype.eachKey=function(d){var h=this._ctx;return h.keysOnly=!h.isMatch,this.each(function(m,y){d(y.key,y)})},ct.prototype.eachUniqueKey=function(d){return this._ctx.unique="unique",this.eachKey(d)},ct.prototype.eachPrimaryKey=function(d){var h=this._ctx;return h.keysOnly=!h.isMatch,this.each(function(m,y){d(y.primaryKey,y)})},ct.prototype.keys=function(d){var h=this._ctx;h.keysOnly=!h.isMatch;var m=[];return this.each(function(y,_){m.push(_.key)}).then(function(){return m}).then(d)},ct.prototype.primaryKeys=function(d){var h=this._ctx;if(h.dir==="next"&&ni(h,!0)&&0<h.limit)return this._read(function(y){var _=Sa(h,h.table.core.schema);return h.table.core.query({trans:y,values:!1,limit:h.limit,query:{index:_,range:h.range}})}).then(function(y){return y.result}).then(d);h.keysOnly=!h.isMatch;var m=[];return this.each(function(y,_){m.push(_.primaryKey)}).then(function(){return m}).then(d)},ct.prototype.uniqueKeys=function(d){return this._ctx.unique="unique",this.keys(d)},ct.prototype.firstKey=function(d){return this.limit(1).keys(function(h){return h[0]}).then(d)},ct.prototype.lastKey=function(d){return this.reverse().firstKey(d)},ct.prototype.distinct=function(){var d=this._ctx,d=d.index&&d.table.schema.idxByName[d.index];if(!d||!d.multi)return this;var h={};return Rc(this._ctx,function(_){var y=_.primaryKey.toString(),_=f(h,y);return h[y]=!0,!_}),this},ct.prototype.modify=function(d){var h=this,m=this._ctx;return this._write(function(y){var _,C,M;M=typeof d=="function"?d:(_=o(d),C=_.length,function(J){for(var se=!1,ie=0;ie<C;++ie){var oe=_[ie],me=d[oe],Ce=P(J,oe);me instanceof Ui?(A(J,oe,me.execute(Ce)),se=!0):Ce!==me&&(A(J,oe,me),se=!0)}return se});var R=m.table.core,F=R.schema.primaryKey,B=F.outbound,q=F.extractKey,H=200,F=h.db._options.modifyChunkSize;F&&(H=typeof F=="object"?F[R.name]||F["*"]||200:F);function Q(J,oe){var ie=oe.failures,oe=oe.numFailures;V+=J-oe;for(var me=0,Ce=o(ie);me<Ce.length;me++){var be=Ce[me];N.push(ie[be])}}var N=[],V=0,G=[],K=d===Kf;return h.clone().primaryKeys().then(function(J){function se(oe){var me=Math.min(H,J.length-oe),Ce=J.slice(oe,oe+me);return(K?Promise.resolve([]):R.getMany({trans:y,keys:Ce,cache:"immutable"})).then(function(be){var we=[],Me=[],Ae=B?[]:null,Te=K?Ce:[];if(!K)for(var Xe=0;Xe<me;++Xe){var at=be[Xe],Ke={value:pe(at),primKey:J[oe+Xe]};M.call(Ke,Ke.value,Ke)!==!1&&(Ke.value==null?Te.push(J[oe+Xe]):B||st(q(at),q(Ke.value))===0?(Me.push(Ke.value),B&&Ae.push(J[oe+Xe])):(Te.push(J[oe+Xe]),we.push(Ke.value)))}return Promise.resolve(0<we.length&&R.mutate({trans:y,type:"add",values:we}).then(function(Ot){for(var He in Ot.failures)Te.splice(parseInt(He),1);Q(we.length,Ot)})).then(function(){return(0<Me.length||ie&&typeof d=="object")&&R.mutate({trans:y,type:"put",keys:Ae,values:Me,criteria:ie,changeSpec:typeof d!="function"&&d,isAdditionalChunk:0<oe}).then(function(Ot){return Q(Me.length,Ot)})}).then(function(){return(0<Te.length||ie&&K)&&R.mutate({trans:y,type:"delete",keys:Te,criteria:ie,isAdditionalChunk:0<oe}).then(function(Ot){return Ca(m.table,Te,Ot)}).then(function(Ot){return Q(Te.length,Ot)})}).then(function(){return J.length>oe+me&&se(oe+H)})})}var ie=ni(m)&&m.limit===1/0&&(typeof d!="function"||K)&&{index:m.index,range:m.range};return se(0).then(function(){if(0<N.length)throw new gt("Error modifying one or more objects",N,V,G);return J.length})})})},ct.prototype.delete=function(){var d=this._ctx,h=d.range;return!ni(d)||d.table.schema.yProps||!d.isPrimKey&&h.type!==3?this.modify(Kf):this._write(function(m){var y=d.table.core.schema.primaryKey,_=h;return d.table.core.count({trans:m,query:{index:y,range:_}}).then(function(C){return d.table.core.mutate({trans:m,type:"deleteRange",range:_}).then(function(B){var R=B.failures,B=B.numFailures;if(B)throw new gt("Could not delete some values",Object.keys(R).map(function(q){return R[q]}),C-B);return C-B})})})},ct);function ct(){}var Kf=function(d,h){return h.value=null};function A_(d,h){return d<h?-1:d===h?0:1}function I_(d,h){return h<d?-1:d===h?0:1}function Cn(d,h,m){return d=d instanceof Gf?new d.Collection(d):d,d._ctx.error=new(m||TypeError)(h),d}function si(d){return new d.Collection(d,function(){return Yf("")}).limit(0)}function Aa(d,h,m,y){var _,C,M,R,B,q,H,F=m.length;if(!m.every(function(V){return typeof V=="string"}))return Cn(d,Bf);function Q(V){_=V==="next"?function(K){return K.toUpperCase()}:function(K){return K.toLowerCase()},C=V==="next"?function(K){return K.toLowerCase()}:function(K){return K.toUpperCase()},M=V==="next"?A_:I_;var G=m.map(function(K){return{lower:C(K),upper:_(K)}}).sort(function(K,J){return M(K.lower,J.lower)});R=G.map(function(K){return K.upper}),B=G.map(function(K){return K.lower}),H=(q=V)==="next"?"":y}Q("next"),d=new d.Collection(d,function(){return Fs(R[0],B[F-1]+y)}),d._ondirectionchange=function(V){Q(V)};var N=0;return d._addAlgorithm(function(V,G,K){var J=V.key;if(typeof J!="string")return!1;var se=C(J);if(h(se,B,N))return!0;for(var ie=null,oe=N;oe<F;++oe){var me=(function(Ce,be,we,Me,Ae,Te){for(var Xe=Math.min(Ce.length,Me.length),at=-1,Ke=0;Ke<Xe;++Ke){var Ot=be[Ke];if(Ot!==Me[Ke])return Ae(Ce[Ke],we[Ke])<0?Ce.substr(0,Ke)+we[Ke]+we.substr(Ke+1):Ae(Ce[Ke],Me[Ke])<0?Ce.substr(0,Ke)+Me[Ke]+we.substr(Ke+1):0<=at?Ce.substr(0,at)+be[at]+we.substr(at+1):null;Ae(Ce[Ke],Ot)<0&&(at=Ke)}return Xe<Me.length&&Te==="next"?Ce+we.substr(Ce.length):Xe<Ce.length&&Te==="prev"?Ce.substr(0,we.length):at<0?null:Ce.substr(0,at)+Me[at]+we.substr(at+1)})(J,se,R[oe],B[oe],M,q);me===null&&ie===null?N=oe+1:(ie===null||0<M(ie,me))&&(ie=me)}return G(ie!==null?function(){V.continue(ie+H)}:K),!1}),d}function Fs(d,h,m,y){return{type:2,lower:d,upper:h,lowerOpen:m,upperOpen:y}}function Yf(d){return{type:1,lower:d,upper:d}}var Gf=(Object.defineProperty(qt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),qt.prototype.between=function(d,h,m,y){m=m!==!1,y=y===!0;try{return 0<this._cmp(d,h)||this._cmp(d,h)===0&&(m||y)&&(!m||!y)?si(this):new this.Collection(this,function(){return Fs(d,h,!m,!y)})}catch{return Cn(this,ds)}},qt.prototype.equals=function(d){return d==null?Cn(this,ds):new this.Collection(this,function(){return Yf(d)})},qt.prototype.above=function(d){return d==null?Cn(this,ds):new this.Collection(this,function(){return Fs(d,void 0,!0)})},qt.prototype.aboveOrEqual=function(d){return d==null?Cn(this,ds):new this.Collection(this,function(){return Fs(d,void 0,!1)})},qt.prototype.below=function(d){return d==null?Cn(this,ds):new this.Collection(this,function(){return Fs(void 0,d,!1,!0)})},qt.prototype.belowOrEqual=function(d){return d==null?Cn(this,ds):new this.Collection(this,function(){return Fs(void 0,d)})},qt.prototype.startsWith=function(d){return typeof d!="string"?Cn(this,Bf):this.between(d,d+dr,!0,!0)},qt.prototype.startsWithIgnoreCase=function(d){return d===""?this.startsWith(d):Aa(this,function(h,m){return h.indexOf(m[0])===0},[d],dr)},qt.prototype.equalsIgnoreCase=function(d){return Aa(this,function(h,m){return h===m[0]},[d],"")},qt.prototype.anyOfIgnoreCase=function(){var d=X.apply(ne,arguments);return d.length===0?si(this):Aa(this,function(h,m){return m.indexOf(h)!==-1},d,"")},qt.prototype.startsWithAnyOfIgnoreCase=function(){var d=X.apply(ne,arguments);return d.length===0?si(this):Aa(this,function(h,m){return m.some(function(y){return h.indexOf(y)===0})},d,dr)},qt.prototype.anyOf=function(){var d=this,h=X.apply(ne,arguments),m=this._cmp;try{h.sort(m)}catch{return Cn(this,ds)}if(h.length===0)return si(this);var y=new this.Collection(this,function(){return Fs(h[0],h[h.length-1])});y._ondirectionchange=function(C){m=C==="next"?d._ascending:d._descending,h.sort(m)};var _=0;return y._addAlgorithm(function(C,M,R){for(var B=C.key;0<m(B,h[_]);)if(++_===h.length)return M(R),!1;return m(B,h[_])===0||(M(function(){C.continue(h[_])}),!1)}),y},qt.prototype.notEqual=function(d){return this.inAnyRange([[-1/0,d],[d,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},qt.prototype.noneOf=function(){var d=X.apply(ne,arguments);if(d.length===0)return new this.Collection(this);try{d.sort(this._ascending)}catch{return Cn(this,ds)}var h=d.reduce(function(m,y){return m?m.concat([[m[m.length-1][1],y]]):[[-1/0,y]]},null);return h.push([d[d.length-1],this.db._maxKey]),this.inAnyRange(h,{includeLowers:!1,includeUppers:!1})},qt.prototype.inAnyRange=function(J,h){var m=this,y=this._cmp,_=this._ascending,C=this._descending,M=this._min,R=this._max;if(J.length===0)return si(this);if(!J.every(function(se){return se[0]!==void 0&&se[1]!==void 0&&_(se[0],se[1])<=0}))return Cn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",re.InvalidArgument);var B=!h||h.includeLowers!==!1,q=h&&h.includeUppers===!0,H,F=_;function Q(se,ie){return F(se[0],ie[0])}try{(H=J.reduce(function(se,ie){for(var oe=0,me=se.length;oe<me;++oe){var Ce=se[oe];if(y(ie[0],Ce[1])<0&&0<y(ie[1],Ce[0])){Ce[0]=M(Ce[0],ie[0]),Ce[1]=R(Ce[1],ie[1]);break}}return oe===me&&se.push(ie),se},[])).sort(Q)}catch{return Cn(this,ds)}var N=0,V=q?function(se){return 0<_(se,H[N][1])}:function(se){return 0<=_(se,H[N][1])},G=B?function(se){return 0<C(se,H[N][0])}:function(se){return 0<=C(se,H[N][0])},K=V,J=new this.Collection(this,function(){return Fs(H[0][0],H[H.length-1][1],!B,!q)});return J._ondirectionchange=function(se){F=se==="next"?(K=V,_):(K=G,C),H.sort(Q)},J._addAlgorithm(function(se,ie,oe){for(var me,Ce=se.key;K(Ce);)if(++N===H.length)return ie(oe),!1;return!V(me=Ce)&&!G(me)||(m._cmp(Ce,H[N][1])===0||m._cmp(Ce,H[N][0])===0||ie(function(){F===_?se.continue(H[N][0]):se.continue(H[N][1])}),!1)}),J},qt.prototype.startsWithAnyOf=function(){var d=X.apply(ne,arguments);return d.every(function(h){return typeof h=="string"})?d.length===0?si(this):this.inAnyRange(d.map(function(h){return[h,h+dr]})):Cn(this,"startsWithAnyOf() only works with strings")},qt);function qt(){}function Xn(d){return Pt(function(h){return Wi(h),d(h.target.error),!1})}function Wi(d){d.stopPropagation&&d.stopPropagation(),d.preventDefault&&d.preventDefault()}var Vi="storagemutated",Fc="x-storagemutated-1",Ls=zi(null,Vi),E_=(Qn.prototype._lock=function(){return D(!Re.global),++this._reculock,this._reculock!==1||Re.global||(Re.lockOwnerFor=this),this},Qn.prototype._unlock=function(){if(D(!Re.global),--this._reculock==0)for(Re.global||(Re.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var d=this._blockedFuncs.shift();try{ur(d[1],d[0])}catch{}}return this},Qn.prototype._locked=function(){return this._reculock&&Re.lockOwnerFor!==this},Qn.prototype.create=function(d){var h=this;if(!this.mode)return this;var m=this.db.idbdb,y=this.db._state.dbOpenError;if(D(!this.idbtrans),!d&&!m)switch(y&&y.name){case"DatabaseClosedError":throw new re.DatabaseClosed(y);case"MissingAPIError":throw new re.MissingAPI(y.message,y);default:throw new re.OpenFailed(y)}if(!this.active)throw new re.TransactionInactive;return D(this._completion._state===null),(d=this.idbtrans=d||(this.db.core||m).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Pt(function(_){Wi(_),h._reject(d.error)}),d.onabort=Pt(function(_){Wi(_),h.active&&h._reject(new re.Abort(d.error)),h.active=!1,h.on("abort").fire(_)}),d.oncomplete=Pt(function(){h.active=!1,h._resolve(),"mutatedParts"in d&&Ls.storagemutated.fire(d.mutatedParts)}),this},Qn.prototype._promise=function(d,h,m){var y=this;if(d==="readwrite"&&this.mode!=="readwrite")return Tt(new re.ReadOnly("Transaction is readonly"));if(!this.active)return Tt(new re.TransactionInactive);if(this._locked())return new De(function(C,M){y._blockedFuncs.push([function(){y._promise(d,h,m).then(C,M)},Re])});if(m)return Ts(function(){var C=new De(function(M,R){y._lock();var B=h(M,R,y);B&&B.then&&B.then(M,R)});return C.finally(function(){return y._unlock()}),C._lib=!0,C});var _=new De(function(C,M){var R=h(C,M,y);R&&R.then&&R.then(C,M)});return _._lib=!0,_},Qn.prototype._root=function(){return this.parent?this.parent._root():this},Qn.prototype.waitFor=function(d){var h,m=this._root(),y=De.resolve(d);m._waitingFor?m._waitingFor=m._waitingFor.then(function(){return y}):(m._waitingFor=y,m._waitingQueue=[],h=m.idbtrans.objectStore(m.storeNames[0]),(function C(){for(++m._spinCount;m._waitingQueue.length;)m._waitingQueue.shift()();m._waitingFor&&(h.get(-1/0).onsuccess=C)})());var _=m._waitingFor;return new De(function(C,M){y.then(function(R){return m._waitingQueue.push(Pt(C.bind(null,R)))},function(R){return m._waitingQueue.push(Pt(M.bind(null,R)))}).finally(function(){m._waitingFor===_&&(m._waitingFor=null)})})},Qn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new re.Abort))},Qn.prototype.table=function(d){var h=this._memoizedTables||(this._memoizedTables={});if(f(h,d))return h[d];var m=this.schema[d];if(!m)throw new re.NotFound("Table "+d+" not part of transaction");return m=new this.db.Table(d,m,this),m.core=this.db.core.table(d),h[d]=m},Qn);function Qn(){}function Lc(d,h,m,y,_,C,M,R){return{name:d,keyPath:h,unique:m,multi:y,auto:_,compound:C,src:(m&&!M?"&":"")+(y?"*":"")+(_?"++":"")+Xf(h),type:R}}function Xf(d){return typeof d=="string"?d:d?"["+[].join.call(d,"+")+"]":""}function Bc(d,h,m){return{name:d,primKey:h,indexes:m,mappedClass:null,idxByName:(y=function(_){return[_.name,_]},m.reduce(function(_,C,M){return M=y(C,M),M&&(_[M[0]]=M[1]),_},{}))};var y}var Hi=function(d){try{return d.only([[]]),Hi=function(){return[[]]},[[]]}catch{return Hi=function(){return dr},dr}};function jc(d){return d==null?function(){}:typeof d=="string"?(h=d).split(".").length===1?function(m){return m[h]}:function(m){return P(m,h)}:function(m){return P(m,d)};var h}function Qf(d){return[].slice.call(d)}var M_=0;function Ki(d){return d==null?":id":typeof d=="string"?d:"[".concat(d.join("+"),"]")}function O_(d,h,B){function y(K){if(K.type===3)return null;if(K.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var N=K.lower,V=K.upper,G=K.lowerOpen,K=K.upperOpen;return N===void 0?V===void 0?null:h.upperBound(V,!!K):V===void 0?h.lowerBound(N,!!G):h.bound(N,V,!!G,!!K)}function _(Q){var N,V=Q.name;return{name:V,schema:Q,mutate:function(G){var K=G.trans,J=G.type,se=G.keys,ie=G.values,oe=G.range;return new Promise(function(me,Ce){me=Pt(me);var be=K.objectStore(V),we=be.keyPath==null,Me=J==="put"||J==="add";if(!Me&&J!=="delete"&&J!=="deleteRange")throw new Error("Invalid operation type: "+J);var Ae,Te=(se||ie||{length:1}).length;if(se&&ie&&se.length!==ie.length)throw new Error("Given keys array must have same length as given values array.");if(Te===0)return me({numFailures:0,failures:{},results:[],lastResult:void 0});function Xe(pn){++Ot,Wi(pn)}var at=[],Ke=[],Ot=0;if(J==="deleteRange"){if(oe.type===4)return me({numFailures:Ot,failures:Ke,results:[],lastResult:void 0});oe.type===3?at.push(Ae=be.clear()):at.push(Ae=be.delete(y(oe)))}else{var we=Me?we?[ie,se]:[ie,null]:[se,null],He=we[0],nn=we[1];if(Me)for(var sn=0;sn<Te;++sn)at.push(Ae=nn&&nn[sn]!==void 0?be[J](He[sn],nn[sn]):be[J](He[sn])),Ae.onerror=Xe;else for(sn=0;sn<Te;++sn)at.push(Ae=be[J](He[sn])),Ae.onerror=Xe}function ja(pn){pn=pn.target.result,at.forEach(function(gr,su){return gr.error!=null&&(Ke[su]=gr.error)}),me({numFailures:Ot,failures:Ke,results:J==="delete"?se:at.map(function(gr){return gr.result}),lastResult:pn})}Ae.onerror=function(pn){Xe(pn),ja(pn)},Ae.onsuccess=ja})},getMany:function(G){var K=G.trans,J=G.keys;return new Promise(function(se,ie){se=Pt(se);for(var oe,me=K.objectStore(V),Ce=J.length,be=new Array(Ce),we=0,Me=0,Ae=function(at){at=at.target,be[at._pos]=at.result,++Me===we&&se(be)},Te=Xn(ie),Xe=0;Xe<Ce;++Xe)J[Xe]!=null&&((oe=me.get(J[Xe]))._pos=Xe,oe.onsuccess=Ae,oe.onerror=Te,++we);we===0&&se(be)})},get:function(G){var K=G.trans,J=G.key;return new Promise(function(se,ie){se=Pt(se);var oe=K.objectStore(V).get(J);oe.onsuccess=function(me){return se(me.target.result)},oe.onerror=Xn(ie)})},query:(N=q,function(G){return new Promise(function(K,J){K=Pt(K);var se,ie,oe,we=G.trans,me=G.values,Ce=G.limit,Ae=G.query,be=Ce===1/0?void 0:Ce,Me=Ae.index,Ae=Ae.range,we=we.objectStore(V),Me=Me.isPrimaryKey?we:we.index(Me.name),Ae=y(Ae);if(Ce===0)return K({result:[]});N?((be=me?Me.getAll(Ae,be):Me.getAllKeys(Ae,be)).onsuccess=function(Te){return K({result:Te.target.result})},be.onerror=Xn(J)):(se=0,ie=!me&&"openKeyCursor"in Me?Me.openKeyCursor(Ae):Me.openCursor(Ae),oe=[],ie.onsuccess=function(Te){var Xe=ie.result;return Xe?(oe.push(me?Xe.value:Xe.primaryKey),++se===Ce?K({result:oe}):void Xe.continue()):K({result:oe})},ie.onerror=Xn(J))})}),openCursor:function(G){var K=G.trans,J=G.values,se=G.query,ie=G.reverse,oe=G.unique;return new Promise(function(me,Ce){me=Pt(me);var Me=se.index,be=se.range,we=K.objectStore(V),we=Me.isPrimaryKey?we:we.index(Me.name),Me=ie?oe?"prevunique":"prev":oe?"nextunique":"next",Ae=!J&&"openKeyCursor"in we?we.openKeyCursor(y(be),Me):we.openCursor(y(be),Me);Ae.onerror=Xn(Ce),Ae.onsuccess=Pt(function(Te){var Xe,at,Ke,Ot,He=Ae.result;He?(He.___id=++M_,He.done=!1,Xe=He.continue.bind(He),at=(at=He.continuePrimaryKey)&&at.bind(He),Ke=He.advance.bind(He),Ot=function(){throw new Error("Cursor not stopped")},He.trans=K,He.stop=He.continue=He.continuePrimaryKey=He.advance=function(){throw new Error("Cursor not started")},He.fail=Pt(Ce),He.next=function(){var nn=this,sn=1;return this.start(function(){return sn--?nn.continue():nn.stop()}).then(function(){return nn})},He.start=function(nn){function sn(){if(Ae.result)try{nn()}catch(pn){He.fail(pn)}else He.done=!0,He.start=function(){throw new Error("Cursor behind last entry")},He.stop()}var ja=new Promise(function(pn,gr){pn=Pt(pn),Ae.onerror=Xn(gr),He.fail=gr,He.stop=function(su){He.stop=He.continue=He.continuePrimaryKey=He.advance=Ot,pn(su)}});return Ae.onsuccess=Pt(function(pn){Ae.onsuccess=sn,sn()}),He.continue=Xe,He.continuePrimaryKey=at,He.advance=Ke,sn(),ja},me(He)):me(null)},Ce)})},count:function(G){var K=G.query,J=G.trans,se=K.index,ie=K.range;return new Promise(function(oe,me){var Ce=J.objectStore(V),be=se.isPrimaryKey?Ce:Ce.index(se.name),Ce=y(ie),be=Ce?be.count(Ce):be.count();be.onsuccess=Pt(function(we){return oe(we.target.result)}),be.onerror=Xn(me)})}}}var C,M,R,H=(M=B,R=Qf((C=d).objectStoreNames),{schema:{name:C.name,tables:R.map(function(Q){return M.objectStore(Q)}).map(function(Q){var N=Q.keyPath,K=Q.autoIncrement,V=a(N),G={},K={name:Q.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:N==null,compound:V,keyPath:N,autoIncrement:K,unique:!0,extractKey:jc(N)},indexes:Qf(Q.indexNames).map(function(J){return Q.index(J)}).map(function(oe){var se=oe.name,ie=oe.unique,me=oe.multiEntry,oe=oe.keyPath,me={name:se,compound:a(oe),keyPath:oe,unique:ie,multiEntry:me,extractKey:jc(oe)};return G[Ki(oe)]=me}),getIndexByKeyPath:function(J){return G[Ki(J)]}};return G[":id"]=K.primaryKey,N!=null&&(G[Ki(N)]=K.primaryKey),K})},hasGetAll:0<R.length&&"getAll"in M.objectStore(R[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),B=H.schema,q=H.hasGetAll,H=B.tables.map(_),F={};return H.forEach(function(Q){return F[Q.name]=Q}),{stack:"dbcore",transaction:d.transaction.bind(d),table:function(Q){if(!F[Q])throw new Error("Table '".concat(Q,"' not found"));return F[Q]},MIN_KEY:-1/0,MAX_KEY:Hi(h),schema:B}}function D_(d,h,m,y){var _=m.IDBKeyRange;return m.indexedDB,{dbcore:(y=O_(h,_,y),d.dbcore.reduce(function(C,M){return M=M.create,s(s({},C),M(C))},y))}}function Ia(d,y){var m=y.db,y=D_(d._middlewares,m,d._deps,y);d.core=y.dbcore,d.tables.forEach(function(_){var C=_.name;d.core.schema.tables.some(function(M){return M.name===C})&&(_.core=d.core.table(C),d[C]instanceof d.Table&&(d[C].core=_.core))})}function Ea(d,h,m,y){m.forEach(function(_){var C=y[_];h.forEach(function(M){var R=(function B(q,H){return x(q,H)||(q=c(q))&&B(q,H)})(M,_);(!R||"value"in R&&R.value===void 0)&&(M===d.Transaction.prototype||M instanceof d.Transaction?v(M,_,{get:function(){return this.table(_)},set:function(B){g(this,_,{value:B,writable:!0,configurable:!0,enumerable:!0})}}):M[_]=new d.Table(_,C))})})}function Nc(d,h){h.forEach(function(m){for(var y in m)m[y]instanceof d.Table&&delete m[y]})}function T_(d,h){return d._cfg.version-h._cfg.version}function R_(d,h,m,y){var _=d._dbSchema;m.objectStoreNames.contains("$meta")&&!_.$meta&&(_.$meta=Bc("$meta",Zf("")[0],[]),d._storeNames.push("$meta"));var C=d._createTransaction("readwrite",d._storeNames,_);C.create(m),C._completion.catch(y);var M=C._reject.bind(C),R=Re.transless||Re;Ts(function(){return Re.trans=C,Re.transless=R,h!==0?(Ia(d,m),q=h,((B=C).storeNames.includes("$meta")?B.table("$meta").get("version").then(function(H){return H??q}):De.resolve(q)).then(function(H){return Q=H,N=C,V=m,G=[],H=(F=d)._versions,K=F._dbSchema=Oa(0,F.idbdb,V),(H=H.filter(function(J){return J._cfg.version>=Q})).length!==0?(H.forEach(function(J){G.push(function(){var se=K,ie=J._cfg.dbschema;Da(F,se,V),Da(F,ie,V),K=F._dbSchema=ie;var oe=zc(se,ie);oe.add.forEach(function(Me){qc(V,Me[0],Me[1].primKey,Me[1].indexes)}),oe.change.forEach(function(Me){if(Me.recreate)throw new re.Upgrade("Not yet support for changing primary key");var Ae=V.objectStore(Me.name);Me.add.forEach(function(Te){return Ma(Ae,Te)}),Me.change.forEach(function(Te){Ae.deleteIndex(Te.name),Ma(Ae,Te)}),Me.del.forEach(function(Te){return Ae.deleteIndex(Te)})});var me=J._cfg.contentUpgrade;if(me&&J._cfg.version>Q){Ia(F,V),N._memoizedTables={};var Ce=$(ie);oe.del.forEach(function(Me){Ce[Me]=se[Me]}),Nc(F,[F.Transaction.prototype]),Ea(F,[F.Transaction.prototype],o(Ce),Ce),N.schema=Ce;var be,we=Le(me);return we&&ei(),oe=De.follow(function(){var Me;(be=me(N))&&we&&(Me=Rs.bind(null,null),be.then(Me,Me))}),be&&typeof be.then=="function"?De.resolve(be):oe.then(function(){return be})}}),G.push(function(se){var ie,oe,me=J._cfg.dbschema;ie=me,oe=se,[].slice.call(oe.db.objectStoreNames).forEach(function(Ce){return ie[Ce]==null&&oe.db.deleteObjectStore(Ce)}),Nc(F,[F.Transaction.prototype]),Ea(F,[F.Transaction.prototype],F._storeNames,F._dbSchema),N.schema=F._dbSchema}),G.push(function(se){F.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(F.idbdb.version/10)===J._cfg.version?(F.idbdb.deleteObjectStore("$meta"),delete F._dbSchema.$meta,F._storeNames=F._storeNames.filter(function(ie){return ie!=="$meta"})):se.objectStore("$meta").put(J._cfg.version,"version"))})}),(function J(){return G.length?De.resolve(G.shift()(N.idbtrans)).then(J):De.resolve()})().then(function(){Jf(K,V)})):De.resolve();var F,Q,N,V,G,K}).catch(M)):(o(_).forEach(function(H){qc(m,H,_[H].primKey,_[H].indexes)}),Ia(d,m),void De.follow(function(){return d.on.populate.fire(C)}).catch(M));var B,q})}function $_(d,h){Jf(d._dbSchema,h),h.db.version%10!=0||h.objectStoreNames.contains("$meta")||h.db.createObjectStore("$meta").add(Math.ceil(h.db.version/10-1),"version");var m=Oa(0,d.idbdb,h);Da(d,d._dbSchema,h);for(var y=0,_=zc(m,d._dbSchema).change;y<_.length;y++){var C=(function(M){if(M.change.length||M.recreate)return console.warn("Unable to patch indexes of table ".concat(M.name," because it has changes on the type of index or primary key.")),{value:void 0};var R=h.objectStore(M.name);M.add.forEach(function(B){he&&console.debug("Dexie upgrade patch: Creating missing index ".concat(M.name,".").concat(B.src)),Ma(R,B)})})(_[y]);if(typeof C=="object")return C.value}}function zc(d,h){var m,y={del:[],add:[],change:[]};for(m in d)h[m]||y.del.push(m);for(m in h){var _=d[m],C=h[m];if(_){var M={name:m,def:C,recreate:!1,del:[],add:[],change:[]};if(""+(_.primKey.keyPath||"")!=""+(C.primKey.keyPath||"")||_.primKey.auto!==C.primKey.auto)M.recreate=!0,y.change.push(M);else{var R=_.idxByName,B=C.idxByName,q=void 0;for(q in R)B[q]||M.del.push(q);for(q in B){var H=R[q],F=B[q];H?H.src!==F.src&&M.change.push(F):M.add.push(F)}(0<M.del.length||0<M.add.length||0<M.change.length)&&y.change.push(M)}}else y.add.push([m,C])}return y}function qc(d,h,m,y){var _=d.db.createObjectStore(h,m.keyPath?{keyPath:m.keyPath,autoIncrement:m.auto}:{autoIncrement:m.auto});return y.forEach(function(C){return Ma(_,C)}),_}function Jf(d,h){o(d).forEach(function(m){h.db.objectStoreNames.contains(m)||(he&&console.debug("Dexie: Creating missing table",m),qc(h,m,d[m].primKey,d[m].indexes))})}function Ma(d,h){d.createIndex(h.name,h.keyPath,{unique:h.unique,multiEntry:h.multi})}function Oa(d,h,m){var y={};return S(h.objectStoreNames,0).forEach(function(_){for(var C=m.objectStore(_),M=Lc(Xf(q=C.keyPath),q||"",!0,!1,!!C.autoIncrement,q&&typeof q!="string",!0),R=[],B=0;B<C.indexNames.length;++B){var H=C.index(C.indexNames[B]),q=H.keyPath,H=Lc(H.name,q,!!H.unique,!!H.multiEntry,!1,q&&typeof q!="string",!1);R.push(H)}y[_]=Bc(_,M,R)}),y}function Da(d,h,m){for(var y=m.db.objectStoreNames,_=0;_<y.length;++_){var C=y[_],M=m.objectStore(C);d._hasGetAll="getAll"in M;for(var R=0;R<M.indexNames.length;++R){var B=M.indexNames[R],q=M.index(B).keyPath,H=typeof q=="string"?q:"["+S(q).join("+")+"]";!h[C]||(q=h[C].idxByName[H])&&(q.name=B,delete h[C].idxByName[H],h[C].idxByName[B]=q)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(d._hasGetAll=!1)}function Zf(d){return d.split(",").map(function(h,m){var C=h.split(":"),y=(_=C[1])===null||_===void 0?void 0:_.trim(),_=(h=C[0].trim()).replace(/([&*]|\+\+)/g,""),C=/^\[/.test(_)?_.match(/^\[(.*)\]$/)[1].split("+"):_;return Lc(_,C||null,/\&/.test(h),/\*/.test(h),/\+\+/.test(h),a(C),m===0,y)})}var F_=(ri.prototype._createTableSchema=Bc,ri.prototype._parseIndexSyntax=Zf,ri.prototype._parseStoresSpec=function(d,h){var m=this;o(d).forEach(function(y){if(d[y]!==null){var _=m._parseIndexSyntax(d[y]),C=_.shift();if(!C)throw new re.Schema("Invalid schema for table "+y+": "+d[y]);if(C.unique=!0,C.multi)throw new re.Schema("Primary key cannot be multiEntry*");_.forEach(function(M){if(M.auto)throw new re.Schema("Only primary key can be marked as autoIncrement (++)");if(!M.keyPath)throw new re.Schema("Index must have a name and cannot be an empty string")}),_=m._createTableSchema(y,C,_),h[y]=_}})},ri.prototype.stores=function(m){var h=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,m):m;var m=h._versions,y={},_={};return m.forEach(function(C){l(y,C._cfg.storesSource),_=C._cfg.dbschema={},C._parseStoresSpec(y,_)}),h._dbSchema=_,Nc(h,[h._allTables,h,h.Transaction.prototype]),Ea(h,[h._allTables,h,h.Transaction.prototype,this._cfg.tables],o(_),_),h._storeNames=o(_),this},ri.prototype.upgrade=function(d){return this._cfg.contentUpgrade=xe(this._cfg.contentUpgrade||O,d),this},ri);function ri(){}function Uc(d,h){var m=d._dbNamesDB;return m||(m=d._dbNamesDB=new fs(xa,{addons:[],indexedDB:d,IDBKeyRange:h})).version(1).stores({dbnames:"name"}),m.table("dbnames")}function Wc(d){return d&&typeof d.databases=="function"}function Vc(d){return Ts(function(){return Re.letThrough=!0,d()})}function Hc(d){return!("from"in d)}var tn=function(d,h){if(!this){var m=new tn;return d&&"d"in d&&l(m,d),m}l(this,arguments.length?{d:1,from:d,to:1<arguments.length?h:d}:{d:0})};function Yi(d,h,m){var y=st(h,m);if(!isNaN(y)){if(0<y)throw RangeError();if(Hc(d))return l(d,{from:h,to:m,d:1});var _=d.l,y=d.r;if(st(m,d.from)<0)return _?Yi(_,h,m):d.l={from:h,to:m,d:1,l:null,r:null},th(d);if(0<st(h,d.to))return y?Yi(y,h,m):d.r={from:h,to:m,d:1,l:null,r:null},th(d);st(h,d.from)<0&&(d.from=h,d.l=null,d.d=y?y.d+1:1),0<st(m,d.to)&&(d.to=m,d.r=null,d.d=d.l?d.l.d+1:1),m=!d.r,_&&!d.l&&Gi(d,_),y&&m&&Gi(d,y)}}function Gi(d,h){Hc(h)||(function m(y,B){var C=B.from,M=B.to,R=B.l,B=B.r;Yi(y,C,M),R&&m(y,R),B&&m(y,B)})(d,h)}function eh(d,h){var m=Ta(h),y=m.next();if(y.done)return!1;for(var _=y.value,C=Ta(d),M=C.next(_.from),R=M.value;!y.done&&!M.done;){if(st(R.from,_.to)<=0&&0<=st(R.to,_.from))return!0;st(_.from,R.from)<0?_=(y=m.next(R.from)).value:R=(M=C.next(_.from)).value}return!1}function Ta(d){var h=Hc(d)?null:{s:0,n:d};return{next:function(m){for(var y=0<arguments.length;h;)switch(h.s){case 0:if(h.s=1,y)for(;h.n.l&&st(m,h.n.from)<0;)h={up:h,n:h.n.l,s:1};else for(;h.n.l;)h={up:h,n:h.n.l,s:1};case 1:if(h.s=2,!y||st(m,h.n.to)<=0)return{value:h.n,done:!1};case 2:if(h.n.r){h.s=3,h={up:h,n:h.n.r,s:0};continue}case 3:h=h.up}return{done:!0}}}}function th(d){var h,m,y=(((h=d.r)===null||h===void 0?void 0:h.d)||0)-(((m=d.l)===null||m===void 0?void 0:m.d)||0),_=1<y?"r":y<-1?"l":"";_&&(h=_=="r"?"l":"r",m=s({},d),y=d[_],d.from=y.from,d.to=y.to,d[_]=y[_],m[_]=y[h],(d[h]=m).d=nh(m)),d.d=nh(d)}function nh(m){var h=m.r,m=m.l;return(h?m?Math.max(h.d,m.d):h.d:m?m.d:0)+1}function Ra(d,h){return o(h).forEach(function(m){d[m]?Gi(d[m],h[m]):d[m]=(function y(_){var C,M,R={};for(C in _)f(_,C)&&(M=_[C],R[C]=!M||typeof M!="object"||U.has(M.constructor)?M:y(M));return R})(h[m])}),d}function Kc(d,h){return d.all||h.all||Object.keys(d).some(function(m){return h[m]&&eh(h[m],d[m])})}p(tn.prototype,((Rn={add:function(d){return Gi(this,d),this},addKey:function(d){return Yi(this,d,d),this},addKeys:function(d){var h=this;return d.forEach(function(m){return Yi(h,m,m)}),this},hasKey:function(d){var h=Ta(this).next(d).value;return h&&st(h.from,d)<=0&&0<=st(h.to,d)}})[_e]=function(){return Ta(this)},Rn));var hr={},Yc={},Gc=!1;function $a(d){Ra(Yc,d),Gc||(Gc=!0,setTimeout(function(){Gc=!1,Xc(Yc,!(Yc={}))},0))}function Xc(d,h){h===void 0&&(h=!1);var m=new Set;if(d.all)for(var y=0,_=Object.values(hr);y<_.length;y++)sh(M=_[y],d,m,h);else for(var C in d){var M,R=/^idb\:\/\/(.*)\/(.*)\//.exec(C);R&&(C=R[1],R=R[2],(M=hr["idb://".concat(C,"/").concat(R)])&&sh(M,d,m,h))}m.forEach(function(B){return B()})}function sh(d,h,m,y){for(var _=[],C=0,M=Object.entries(d.queries.query);C<M.length;C++){for(var R=M[C],B=R[0],q=[],H=0,F=R[1];H<F.length;H++){var Q=F[H];Kc(h,Q.obsSet)?Q.subscribers.forEach(function(K){return m.add(K)}):y&&q.push(Q)}y&&_.push([B,q])}if(y)for(var N=0,V=_;N<V.length;N++){var G=V[N],B=G[0],q=G[1];d.queries.query[B]=q}}function L_(d){var h=d._state,m=d._deps.indexedDB;if(h.isBeingOpened||d.idbdb)return h.dbReadyPromise.then(function(){return h.dbOpenError?Tt(h.dbOpenError):d});h.isBeingOpened=!0,h.dbOpenError=null,h.openComplete=!1;var y=h.openCanceller,_=Math.round(10*d.verno),C=!1;function M(){if(h.openCanceller!==y)throw new re.DatabaseClosed("db.open() was cancelled")}function R(){return new De(function(Q,N){if(M(),!m)throw new re.MissingAPI;var V=d.name,G=h.autoSchema||!_?m.open(V):m.open(V,_);if(!G)throw new re.MissingAPI;G.onerror=Xn(N),G.onblocked=Pt(d._fireOnBlocked),G.onupgradeneeded=Pt(function(K){var J;H=G.transaction,h.autoSchema&&!d._options.allowEmptyDB?(G.onerror=Wi,H.abort(),G.result.close(),(J=m.deleteDatabase(V)).onsuccess=J.onerror=Pt(function(){N(new re.NoSuchDatabase("Database ".concat(V," doesnt exist")))})):(H.onerror=Xn(N),K=K.oldVersion>Math.pow(2,62)?0:K.oldVersion,F=K<1,d.idbdb=G.result,C&&$_(d,H),R_(d,K/10,H,N))},N),G.onsuccess=Pt(function(){H=null;var K,J,se,ie,oe,me=d.idbdb=G.result,Ce=S(me.objectStoreNames);if(0<Ce.length)try{var be=me.transaction((ie=Ce).length===1?ie[0]:ie,"readonly");if(h.autoSchema)J=me,se=be,(K=d).verno=J.version/10,se=K._dbSchema=Oa(0,J,se),K._storeNames=S(J.objectStoreNames,0),Ea(K,[K._allTables],o(se),se);else if(Da(d,d._dbSchema,be),((oe=zc(Oa(0,(oe=d).idbdb,be),oe._dbSchema)).add.length||oe.change.some(function(we){return we.add.length||we.change.length}))&&!C)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),me.close(),_=me.version+1,C=!0,Q(R());Ia(d,be)}catch{}ti.push(d),me.onversionchange=Pt(function(we){h.vcFired=!0,d.on("versionchange").fire(we)}),me.onclose=Pt(function(we){d.on("close").fire(we)}),F&&(oe=d._deps,be=V,me=oe.indexedDB,oe=oe.IDBKeyRange,Wc(me)||be===xa||Uc(me,oe).put({name:be}).catch(O)),Q()},N)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<h.PR1398_maxLoop)return h.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),R();break;case"VersionError":if(0<_)return _=0,R()}return De.reject(Q)})}var B,q=h.dbReadyResolve,H=null,F=!1;return De.race([y,(typeof navigator>"u"?De.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function N(){return indexedDB.databases().finally(Q)}B=setInterval(N,100),N()}).finally(function(){return clearInterval(B)}):Promise.resolve()).then(R)]).then(function(){return M(),h.onReadyBeingFired=[],De.resolve(Vc(function(){return d.on.ready.fire(d.vip)})).then(function Q(){if(0<h.onReadyBeingFired.length){var N=h.onReadyBeingFired.reduce(xe,O);return h.onReadyBeingFired=[],De.resolve(Vc(function(){return N(d.vip)})).then(Q)}})}).finally(function(){h.openCanceller===y&&(h.onReadyBeingFired=null,h.isBeingOpened=!1)}).catch(function(Q){h.dbOpenError=Q;try{H&&H.abort()}catch{}return y===h.openCanceller&&d._close(),Tt(Q)}).finally(function(){h.openComplete=!0,q()}).then(function(){var Q;return F&&(Q={},d.tables.forEach(function(N){N.schema.indexes.forEach(function(V){V.name&&(Q["idb://".concat(d.name,"/").concat(N.name,"/").concat(V.name)]=new tn(-1/0,[[[]]]))}),Q["idb://".concat(d.name,"/").concat(N.name,"/")]=Q["idb://".concat(d.name,"/").concat(N.name,"/:dels")]=new tn(-1/0,[[[]]])}),Ls(Vi).fire(Q),Xc(Q,!0)),d})}function Qc(d){function h(C){return d.next(C)}var m=_(h),y=_(function(C){return d.throw(C)});function _(C){return function(B){var R=C(B),B=R.value;return R.done?B:B&&typeof B.then=="function"?B.then(m,y):a(B)?Promise.all(B).then(m,y):m(B)}}return _(h)()}function Fa(d,h,m){for(var y=a(d)?d.slice():[d],_=0;_<m;++_)y.push(h);return y}var B_={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(d){return s(s({},d),{table:function(h){var m=d.table(h),y=m.schema,_={},C=[];function M(F,Q,N){var V=Ki(F),G=_[V]=_[V]||[],K=F==null?0:typeof F=="string"?1:F.length,J=0<Q,J=s(s({},N),{name:J?"".concat(V,"(virtual-from:").concat(N.name,")"):N.name,lowLevelIndex:N,isVirtual:J,keyTail:Q,keyLength:K,extractKey:jc(F),unique:!J&&N.unique});return G.push(J),J.isPrimaryKey||C.push(J),1<K&&M(K===2?F[0]:F.slice(0,K-1),Q+1,N),G.sort(function(se,ie){return se.keyTail-ie.keyTail}),J}h=M(y.primaryKey.keyPath,0,y.primaryKey),_[":id"]=[h];for(var R=0,B=y.indexes;R<B.length;R++){var q=B[R];M(q.keyPath,0,q)}function H(F){var Q,N=F.query.index;return N.isVirtual?s(s({},F),{query:{index:N.lowLevelIndex,range:(Q=F.query.range,N=N.keyTail,{type:Q.type===1?2:Q.type,lower:Fa(Q.lower,Q.lowerOpen?d.MAX_KEY:d.MIN_KEY,N),lowerOpen:!0,upper:Fa(Q.upper,Q.upperOpen?d.MIN_KEY:d.MAX_KEY,N),upperOpen:!0})}}):F}return s(s({},m),{schema:s(s({},y),{primaryKey:h,indexes:C,getIndexByKeyPath:function(F){return(F=_[Ki(F)])&&F[0]}}),count:function(F){return m.count(H(F))},query:function(F){return m.query(H(F))},openCursor:function(F){var Q=F.query.index,N=Q.keyTail,V=Q.isVirtual,G=Q.keyLength;return V?m.openCursor(H(F)).then(function(J){return J&&K(J)}):m.openCursor(F);function K(J){return Object.create(J,{continue:{value:function(se){se!=null?J.continue(Fa(se,F.reverse?d.MAX_KEY:d.MIN_KEY,N)):F.unique?J.continue(J.key.slice(0,G).concat(F.reverse?d.MIN_KEY:d.MAX_KEY,N)):J.continue()}},continuePrimaryKey:{value:function(se,ie){J.continuePrimaryKey(Fa(se,d.MAX_KEY,N),ie)}},primaryKey:{get:function(){return J.primaryKey}},key:{get:function(){var se=J.key;return G===1?se[0]:se.slice(0,G)}},value:{get:function(){return J.value}}})}}})}})}};function Jc(d,h,m,y){return m=m||{},y=y||"",o(d).forEach(function(_){var C,M,R;f(h,_)?(C=d[_],M=h[_],typeof C=="object"&&typeof M=="object"&&C&&M?(R=ue(C))!==ue(M)?m[y+_]=h[_]:R==="Object"?Jc(C,M,m,y+_+"."):C!==M&&(m[y+_]=h[_]):C!==M&&(m[y+_]=h[_])):m[y+_]=void 0}),o(h).forEach(function(_){f(d,_)||(m[y+_]=h[_])}),m}function Zc(d,h){return h.type==="delete"?h.keys:h.keys||h.values.map(d.extractKey)}var j_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(d){return s(s({},d),{table:function(h){var m=d.table(h),y=m.schema.primaryKey;return s(s({},m),{mutate:function(_){var C=Re.trans,M=C.table(h).hook,R=M.deleting,B=M.creating,q=M.updating;switch(_.type){case"add":if(B.fire===O)break;return C._promise("readwrite",function(){return H(_)},!0);case"put":if(B.fire===O&&q.fire===O)break;return C._promise("readwrite",function(){return H(_)},!0);case"delete":if(R.fire===O)break;return C._promise("readwrite",function(){return H(_)},!0);case"deleteRange":if(R.fire===O)break;return C._promise("readwrite",function(){return(function F(Q,N,V){return m.query({trans:Q,values:!1,query:{index:y,range:N},limit:V}).then(function(G){var K=G.result;return H({type:"delete",keys:K,trans:Q}).then(function(J){return 0<J.numFailures?Promise.reject(J.failures[0]):K.length<V?{failures:[],numFailures:0,lastResult:void 0}:F(Q,s(s({},N),{lower:K[K.length-1],lowerOpen:!0}),V)})})})(_.trans,_.range,1e4)},!0)}return m.mutate(_);function H(F){var Q,N,V,G=Re.trans,K=F.keys||Zc(y,F);if(!K)throw new Error("Keys missing");return(F=F.type==="add"||F.type==="put"?s(s({},F),{keys:K}):s({},F)).type!=="delete"&&(F.values=r([],F.values)),F.keys&&(F.keys=r([],F.keys)),Q=m,V=K,((N=F).type==="add"?Promise.resolve([]):Q.getMany({trans:N.trans,keys:V,cache:"immutable"})).then(function(J){var se=K.map(function(ie,oe){var me,Ce,be,we=J[oe],Me={onerror:null,onsuccess:null};return F.type==="delete"?R.fire.call(Me,ie,we,G):F.type==="add"||we===void 0?(me=B.fire.call(Me,ie,F.values[oe],G),ie==null&&me!=null&&(F.keys[oe]=ie=me,y.outbound||A(F.values[oe],y.keyPath,ie))):(me=Jc(we,F.values[oe]),(Ce=q.fire.call(Me,me,ie,we,G))&&(be=F.values[oe],Object.keys(Ce).forEach(function(Ae){f(be,Ae)?be[Ae]=Ce[Ae]:A(be,Ae,Ce[Ae])}))),Me});return m.mutate(F).then(function(ie){for(var oe=ie.failures,me=ie.results,Ce=ie.numFailures,ie=ie.lastResult,be=0;be<K.length;++be){var we=(me||K)[be],Me=se[be];we==null?Me.onerror&&Me.onerror(oe[be]):Me.onsuccess&&Me.onsuccess(F.type==="put"&&J[be]?F.values[be]:we)}return{failures:oe,results:me,numFailures:Ce,lastResult:ie}}).catch(function(ie){return se.forEach(function(oe){return oe.onerror&&oe.onerror(ie)}),Promise.reject(ie)})})}}})}})}};function rh(d,h,m){try{if(!h||h.keys.length<d.length)return null;for(var y=[],_=0,C=0;_<h.keys.length&&C<d.length;++_)st(h.keys[_],d[C])===0&&(y.push(m?pe(h.values[_]):h.values[_]),++C);return y.length===d.length?y:null}catch{return null}}var N_={stack:"dbcore",level:-1,create:function(d){return{table:function(h){var m=d.table(h);return s(s({},m),{getMany:function(y){if(!y.cache)return m.getMany(y);var _=rh(y.keys,y.trans._cache,y.cache==="clone");return _?De.resolve(_):m.getMany(y).then(function(C){return y.trans._cache={keys:y.keys,values:y.cache==="clone"?pe(C):C},C})},mutate:function(y){return y.type!=="add"&&(y.trans._cache=null),m.mutate(y)}})}}}};function ih(d,h){return d.trans.mode==="readonly"&&!!d.subscr&&!d.trans.explicit&&d.trans.db._options.cache!=="disabled"&&!h.schema.primaryKey.outbound}function oh(d,h){switch(d){case"query":return h.values&&!h.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var z_={stack:"dbcore",level:0,name:"Observability",create:function(d){var h=d.schema.name,m=new tn(d.MIN_KEY,d.MAX_KEY);return s(s({},d),{transaction:function(y,_,C){if(Re.subscr&&_!=="readonly")throw new re.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Re.querier));return d.transaction(y,_,C)},table:function(y){var _=d.table(y),C=_.schema,M=C.primaryKey,F=C.indexes,R=M.extractKey,B=M.outbound,q=M.autoIncrement&&F.filter(function(N){return N.compound&&N.keyPath.includes(M.keyPath)}),H=s(s({},_),{mutate:function(N){function V(Ae){return Ae="idb://".concat(h,"/").concat(y,"/").concat(Ae),ie[Ae]||(ie[Ae]=new tn)}var G,K,J,se=N.trans,ie=N.mutatedParts||(N.mutatedParts={}),oe=V(""),me=V(":dels"),Ce=N.type,Me=N.type==="deleteRange"?[N.range]:N.type==="delete"?[N.keys]:N.values.length<50?[Zc(M,N).filter(function(Ae){return Ae}),N.values]:[],be=Me[0],we=Me[1],Me=N.trans._cache;return a(be)?(oe.addKeys(be),(Me=Ce==="delete"||be.length===we.length?rh(be,Me):null)||me.addKeys(be),(Me||we)&&(G=V,K=Me,J=we,C.indexes.forEach(function(Ae){var Te=G(Ae.name||"");function Xe(Ke){return Ke!=null?Ae.extractKey(Ke):null}function at(Ke){return Ae.multiEntry&&a(Ke)?Ke.forEach(function(Ot){return Te.addKey(Ot)}):Te.addKey(Ke)}(K||J).forEach(function(Ke,nn){var He=K&&Xe(K[nn]),nn=J&&Xe(J[nn]);st(He,nn)!==0&&(He!=null&&at(He),nn!=null&&at(nn))})}))):be?(we={from:(we=be.lower)!==null&&we!==void 0?we:d.MIN_KEY,to:(we=be.upper)!==null&&we!==void 0?we:d.MAX_KEY},me.add(we),oe.add(we)):(oe.add(m),me.add(m),C.indexes.forEach(function(Ae){return V(Ae.name).add(m)})),_.mutate(N).then(function(Ae){return!be||N.type!=="add"&&N.type!=="put"||(oe.addKeys(Ae.results),q&&q.forEach(function(Te){for(var Xe=N.values.map(function(He){return Te.extractKey(He)}),at=Te.keyPath.findIndex(function(He){return He===M.keyPath}),Ke=0,Ot=Ae.results.length;Ke<Ot;++Ke)Xe[Ke][at]=Ae.results[Ke];V(Te.name).addKeys(Xe)})),se.mutatedParts=Ra(se.mutatedParts||{},ie),Ae})}}),F=function(V){var G=V.query,V=G.index,G=G.range;return[V,new tn((V=G.lower)!==null&&V!==void 0?V:d.MIN_KEY,(G=G.upper)!==null&&G!==void 0?G:d.MAX_KEY)]},Q={get:function(N){return[M,new tn(N.key)]},getMany:function(N){return[M,new tn().addKeys(N.keys)]},count:F,query:F,openCursor:F};return o(Q).forEach(function(N){H[N]=function(V){var G=Re.subscr,K=!!G,J=ih(Re,_)&&oh(N,V)?V.obsSet={}:G;if(K){var se=function(we){return we="idb://".concat(h,"/").concat(y,"/").concat(we),J[we]||(J[we]=new tn)},ie=se(""),oe=se(":dels"),G=Q[N](V),K=G[0],G=G[1];if((N==="query"&&K.isPrimaryKey&&!V.values?oe:se(K.name||"")).add(G),!K.isPrimaryKey){if(N!=="count"){var me=N==="query"&&B&&V.values&&_.query(s(s({},V),{values:!1}));return _[N].apply(this,arguments).then(function(we){if(N==="query"){if(B&&V.values)return me.then(function(Xe){return Xe=Xe.result,ie.addKeys(Xe),we});var Me=V.values?we.result.map(R):we.result;(V.values?ie:oe).addKeys(Me)}else if(N==="openCursor"){var Ae=we,Te=V.values;return Ae&&Object.create(Ae,{key:{get:function(){return oe.addKey(Ae.primaryKey),Ae.key}},primaryKey:{get:function(){var Xe=Ae.primaryKey;return oe.addKey(Xe),Xe}},value:{get:function(){return Te&&ie.addKey(Ae.primaryKey),Ae.value}}})}return we})}oe.add(m)}}return _[N].apply(this,arguments)}}),H}})}};function ah(d,h,m){if(m.numFailures===0)return h;if(h.type==="deleteRange")return null;var y=h.keys?h.keys.length:"values"in h&&h.values?h.values.length:1;return m.numFailures===y?null:(h=s({},h),a(h.keys)&&(h.keys=h.keys.filter(function(_,C){return!(C in m.failures)})),"values"in h&&a(h.values)&&(h.values=h.values.filter(function(_,C){return!(C in m.failures)})),h)}function eu(d,h){return m=d,((y=h).lower===void 0||(y.lowerOpen?0<st(m,y.lower):0<=st(m,y.lower)))&&(d=d,(h=h).upper===void 0||(h.upperOpen?st(d,h.upper)<0:st(d,h.upper)<=0));var m,y}function lh(d,h,Q,y,_,C){if(!Q||Q.length===0)return d;var M=h.query.index,R=M.multiEntry,B=h.query.range,q=y.schema.primaryKey.extractKey,H=M.extractKey,F=(M.lowLevelIndex||M).extractKey,Q=Q.reduce(function(N,V){var G=N,K=[];if(V.type==="add"||V.type==="put")for(var J=new tn,se=V.values.length-1;0<=se;--se){var ie,oe=V.values[se],me=q(oe);J.hasKey(me)||(ie=H(oe),(R&&a(ie)?ie.some(function(Ae){return eu(Ae,B)}):eu(ie,B))&&(J.addKey(me),K.push(oe)))}switch(V.type){case"add":var Ce=new tn().addKeys(h.values?N.map(function(Te){return q(Te)}):N),G=N.concat(h.values?K.filter(function(Te){return Te=q(Te),!Ce.hasKey(Te)&&(Ce.addKey(Te),!0)}):K.map(function(Te){return q(Te)}).filter(function(Te){return!Ce.hasKey(Te)&&(Ce.addKey(Te),!0)}));break;case"put":var be=new tn().addKeys(V.values.map(function(Te){return q(Te)}));G=N.filter(function(Te){return!be.hasKey(h.values?q(Te):Te)}).concat(h.values?K:K.map(function(Te){return q(Te)}));break;case"delete":var we=new tn().addKeys(V.keys);G=N.filter(function(Te){return!we.hasKey(h.values?q(Te):Te)});break;case"deleteRange":var Me=V.range;G=N.filter(function(Te){return!eu(q(Te),Me)})}return G},d);return Q===d?d:(Q.sort(function(N,V){return st(F(N),F(V))||st(q(N),q(V))}),h.limit&&h.limit<1/0&&(Q.length>h.limit?Q.length=h.limit:d.length===h.limit&&Q.length<h.limit&&(_.dirty=!0)),C?Object.freeze(Q):Q)}function ch(d,h){return st(d.lower,h.lower)===0&&st(d.upper,h.upper)===0&&!!d.lowerOpen==!!h.lowerOpen&&!!d.upperOpen==!!h.upperOpen}function q_(d,h){return(function(m,y,_,C){if(m===void 0)return y!==void 0?-1:0;if(y===void 0)return 1;if((y=st(m,y))===0){if(_&&C)return 0;if(_)return 1;if(C)return-1}return y})(d.lower,h.lower,d.lowerOpen,h.lowerOpen)<=0&&0<=(function(m,y,_,C){if(m===void 0)return y!==void 0?1:0;if(y===void 0)return-1;if((y=st(m,y))===0){if(_&&C)return 0;if(_)return-1;if(C)return 1}return y})(d.upper,h.upper,d.upperOpen,h.upperOpen)}function U_(d,h,m,y){d.subscribers.add(m),y.addEventListener("abort",function(){var _,C;d.subscribers.delete(m),d.subscribers.size===0&&(_=d,C=h,setTimeout(function(){_.subscribers.size===0&&Z(C,_)},3e3))})}var W_={stack:"dbcore",level:0,name:"Cache",create:function(d){var h=d.schema.name;return s(s({},d),{transaction:function(m,y,_){var C,M,R=d.transaction(m,y,_);return y==="readwrite"&&(M=(C=new AbortController).signal,_=function(B){return function(){if(C.abort(),y==="readwrite"){for(var q=new Set,H=0,F=m;H<F.length;H++){var Q=F[H],N=hr["idb://".concat(h,"/").concat(Q)];if(N){var V=d.table(Q),G=N.optimisticOps.filter(function(Te){return Te.trans===R});if(R._explicit&&B&&R.mutatedParts)for(var K=0,J=Object.values(N.queries.query);K<J.length;K++)for(var se=0,ie=(Ce=J[K]).slice();se<ie.length;se++)Kc((be=ie[se]).obsSet,R.mutatedParts)&&(Z(Ce,be),be.subscribers.forEach(function(Te){return q.add(Te)}));else if(0<G.length){N.optimisticOps=N.optimisticOps.filter(function(Te){return Te.trans!==R});for(var oe=0,me=Object.values(N.queries.query);oe<me.length;oe++)for(var Ce,be,we,Me=0,Ae=(Ce=me[oe]).slice();Me<Ae.length;Me++)(be=Ae[Me]).res!=null&&R.mutatedParts&&(B&&!be.dirty?(we=Object.isFrozen(be.res),we=lh(be.res,be.req,G,V,be,we),be.dirty?(Z(Ce,be),be.subscribers.forEach(function(Te){return q.add(Te)})):we!==be.res&&(be.res=we,be.promise=De.resolve({result:we}))):(be.dirty&&Z(Ce,be),be.subscribers.forEach(function(Te){return q.add(Te)})))}}}q.forEach(function(Te){return Te()})}}},R.addEventListener("abort",_(!1),{signal:M}),R.addEventListener("error",_(!1),{signal:M}),R.addEventListener("complete",_(!0),{signal:M})),R},table:function(m){var y=d.table(m),_=y.schema.primaryKey;return s(s({},y),{mutate:function(C){var M=Re.trans;if(_.outbound||M.db._options.cache==="disabled"||M.explicit||M.idbtrans.mode!=="readwrite")return y.mutate(C);var R=hr["idb://".concat(h,"/").concat(m)];return R?(M=y.mutate(C),C.type!=="add"&&C.type!=="put"||!(50<=C.values.length||Zc(_,C).some(function(B){return B==null}))?(R.optimisticOps.push(C),C.mutatedParts&&$a(C.mutatedParts),M.then(function(B){0<B.numFailures&&(Z(R.optimisticOps,C),(B=ah(0,C,B))&&R.optimisticOps.push(B),C.mutatedParts&&$a(C.mutatedParts))}),M.catch(function(){Z(R.optimisticOps,C),C.mutatedParts&&$a(C.mutatedParts)})):M.then(function(B){var q=ah(0,s(s({},C),{values:C.values.map(function(H,F){var Q;return B.failures[F]?H:(H=(Q=_.keyPath)!==null&&Q!==void 0&&Q.includes(".")?pe(H):s({},H),A(H,_.keyPath,B.results[F]),H)})}),B);R.optimisticOps.push(q),queueMicrotask(function(){return C.mutatedParts&&$a(C.mutatedParts)})}),M):y.mutate(C)},query:function(C){if(!ih(Re,y)||!oh("query",C))return y.query(C);var M=((q=Re.trans)===null||q===void 0?void 0:q.db._options.cache)==="immutable",F=Re,R=F.requery,B=F.signal,q=(function(V,G,K,J){var se=hr["idb://".concat(V,"/").concat(G)];if(!se)return[];if(!(G=se.queries[K]))return[null,!1,se,null];var ie=G[(J.query?J.query.index.name:null)||""];if(!ie)return[null,!1,se,null];switch(K){case"query":var oe=ie.find(function(me){return me.req.limit===J.limit&&me.req.values===J.values&&ch(me.req.query.range,J.query.range)});return oe?[oe,!0,se,ie]:[ie.find(function(me){return("limit"in me.req?me.req.limit:1/0)>=J.limit&&(!J.values||me.req.values)&&q_(me.req.query.range,J.query.range)}),!1,se,ie];case"count":return oe=ie.find(function(me){return ch(me.req.query.range,J.query.range)}),[oe,!!oe,se,ie]}})(h,m,"query",C),H=q[0],F=q[1],Q=q[2],N=q[3];return H&&F?H.obsSet=C.obsSet:(F=y.query(C).then(function(V){var G=V.result;if(H&&(H.res=G),M){for(var K=0,J=G.length;K<J;++K)Object.freeze(G[K]);Object.freeze(G)}else V.result=pe(G);return V}).catch(function(V){return N&&H&&Z(N,H),Promise.reject(V)}),H={obsSet:C.obsSet,promise:F,subscribers:new Set,type:"query",req:C,dirty:!1},N?N.push(H):(N=[H],(Q=Q||(hr["idb://".concat(h,"/").concat(m)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[C.query.index.name||""]=N)),U_(H,N,R,B),H.promise.then(function(V){return{result:lh(V.result,C,Q?.optimisticOps,y,H,M)}})}})}})}};function La(d,h){return new Proxy(d,{get:function(m,y,_){return y==="db"?h:Reflect.get(m,y,_)}})}var fs=(Rt.prototype.version=function(d){if(isNaN(d)||d<.1)throw new re.Type("Given version is not a positive number");if(d=Math.round(10*d)/10,this.idbdb||this._state.isBeingOpened)throw new re.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,d);var h=this._versions,m=h.filter(function(y){return y._cfg.version===d})[0];return m||(m=new this.Version(d),h.push(m),h.sort(T_),m.stores({}),this._state.autoSchema=!1,m)},Rt.prototype._whenReady=function(d){var h=this;return this.idbdb&&(this._state.openComplete||Re.letThrough||this._vip)?d():new De(function(m,y){if(h._state.openComplete)return y(new re.DatabaseClosed(h._state.dbOpenError));if(!h._state.isBeingOpened){if(!h._state.autoOpen)return void y(new re.DatabaseClosed);h.open().catch(O)}h._state.dbReadyPromise.then(m,y)}).then(d)},Rt.prototype.use=function(d){var h=d.stack,m=d.create,y=d.level,_=d.name;return _&&this.unuse({stack:h,name:_}),d=this._middlewares[h]||(this._middlewares[h]=[]),d.push({stack:h,create:m,level:y??10,name:_}),d.sort(function(C,M){return C.level-M.level}),this},Rt.prototype.unuse=function(d){var h=d.stack,m=d.name,y=d.create;return h&&this._middlewares[h]&&(this._middlewares[h]=this._middlewares[h].filter(function(_){return y?_.create!==y:!!m&&_.name!==m})),this},Rt.prototype.open=function(){var d=this;return ur(Mt,function(){return L_(d)})},Rt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var d=this._state,h=ti.indexOf(this);if(0<=h&&ti.splice(h,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}d.isBeingOpened||(d.dbReadyPromise=new De(function(m){d.dbReadyResolve=m}),d.openCanceller=new De(function(m,y){d.cancelOpen=y}))},Rt.prototype.close=function(m){var h=(m===void 0?{disableAutoOpen:!0}:m).disableAutoOpen,m=this._state;h?(m.isBeingOpened&&m.cancelOpen(new re.DatabaseClosed),this._close(),m.autoOpen=!1,m.dbOpenError=new re.DatabaseClosed):(this._close(),m.autoOpen=this._options.autoOpen||m.isBeingOpened,m.openComplete=!1,m.dbOpenError=null)},Rt.prototype.delete=function(d){var h=this;d===void 0&&(d={disableAutoOpen:!0});var m=0<arguments.length&&typeof arguments[0]!="object",y=this._state;return new De(function(_,C){function M(){h.close(d);var R=h._deps.indexedDB.deleteDatabase(h.name);R.onsuccess=Pt(function(){var B,q,H;B=h._deps,q=h.name,H=B.indexedDB,B=B.IDBKeyRange,Wc(H)||q===xa||Uc(H,B).delete(q).catch(O),_()}),R.onerror=Xn(C),R.onblocked=h._fireOnBlocked}if(m)throw new re.InvalidArgument("Invalid closeOptions argument to db.delete()");y.isBeingOpened?y.dbReadyPromise.then(M):M()})},Rt.prototype.backendDB=function(){return this.idbdb},Rt.prototype.isOpen=function(){return this.idbdb!==null},Rt.prototype.hasBeenClosed=function(){var d=this._state.dbOpenError;return d&&d.name==="DatabaseClosed"},Rt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Rt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Rt.prototype,"tables",{get:function(){var d=this;return o(this._allTables).map(function(h){return d._allTables[h]})},enumerable:!1,configurable:!0}),Rt.prototype.transaction=function(){var d=(function(h,m,y){var _=arguments.length;if(_<2)throw new re.InvalidArgument("Too few arguments");for(var C=new Array(_-1);--_;)C[_-1]=arguments[_];return y=C.pop(),[h,Y(C),y]}).apply(this,arguments);return this._transaction.apply(this,d)},Rt.prototype._transaction=function(d,h,m){var y=this,_=Re.trans;_&&_.db===this&&d.indexOf("!")===-1||(_=null);var C,M,R=d.indexOf("?")!==-1;d=d.replace("!","").replace("?","");try{if(M=h.map(function(q){if(q=q instanceof y.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),d=="r"||d===Dc)C=Dc;else{if(d!="rw"&&d!=Tc)throw new re.InvalidArgument("Invalid transaction mode: "+d);C=Tc}if(_){if(_.mode===Dc&&C===Tc){if(!R)throw new re.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");_=null}_&&M.forEach(function(q){if(_&&_.storeNames.indexOf(q)===-1){if(!R)throw new re.SubTransaction("Table "+q+" not included in parent transaction.");_=null}}),R&&_&&!_.active&&(_=null)}}catch(q){return _?_._promise(null,function(H,F){F(q)}):Tt(q)}var B=(function q(H,F,Q,N,V){return De.resolve().then(function(){var G=Re.transless||Re,K=H._createTransaction(F,Q,H._dbSchema,N);if(K.explicit=!0,G={trans:K,transless:G},N)K.idbtrans=N.idbtrans;else try{K.create(),K.idbtrans._explicit=!0,H._state.PR1398_maxLoop=3}catch(ie){return ie.name===ae.InvalidState&&H.isOpen()&&0<--H._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),H.close({disableAutoOpen:!1}),H.open().then(function(){return q(H,F,Q,null,V)})):Tt(ie)}var J,se=Le(V);return se&&ei(),G=De.follow(function(){var ie;(J=V.call(K,K))&&(se?(ie=Rs.bind(null,null),J.then(ie,ie)):typeof J.next=="function"&&typeof J.throw=="function"&&(J=Qc(J)))},G),(J&&typeof J.then=="function"?De.resolve(J).then(function(ie){return K.active?ie:Tt(new re.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):G.then(function(){return J})).then(function(ie){return N&&K._resolve(),K._completion.then(function(){return ie})}).catch(function(ie){return K._reject(ie),Tt(ie)})})}).bind(null,this,C,M,_,m);return _?_._promise(C,B,"lock"):Re.trans?ur(Re.transless,function(){return y._whenReady(B)}):this._whenReady(B)},Rt.prototype.table=function(d){if(!f(this._allTables,d))throw new re.InvalidTable("Table ".concat(d," does not exist"));return this._allTables[d]},Rt);function Rt(d,h){var m=this;this._middlewares={},this.verno=0;var y=Rt.dependencies;this._options=h=s({addons:Rt.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},h),this._deps={indexedDB:h.indexedDB,IDBKeyRange:h.IDBKeyRange},y=h.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var _,C,M,R,B,q={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:O,dbReadyPromise:null,cancelOpen:O,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:h.autoOpen};q.dbReadyPromise=new De(function(F){q.dbReadyResolve=F}),q.openCanceller=new De(function(F,Q){q.cancelOpen=Q}),this._state=q,this.name=d,this.on=zi(this,"populate","blocked","versionchange","close",{ready:[xe,O]}),this.once=function(F,Q){var N=function(){for(var V=[],G=0;G<arguments.length;G++)V[G]=arguments[G];m.on(F).unsubscribe(N),Q.apply(m,V)};return m.on(F,N)},this.on.ready.subscribe=E(this.on.ready.subscribe,function(F){return function(Q,N){Rt.vip(function(){var V,G=m._state;G.openComplete?(G.dbOpenError||De.resolve().then(Q),N&&F(Q)):G.onReadyBeingFired?(G.onReadyBeingFired.push(Q),N&&F(Q)):(F(Q),V=m,N||F(function K(){V.on.ready.unsubscribe(Q),V.on.ready.unsubscribe(K)}))})}}),this.Collection=(_=this,qi(P_.prototype,function(J,K){this.db=_;var N=jf,V=null;if(K)try{N=K()}catch(se){V=se}var G=J._ctx,K=G.table,J=K.hook.reading.fire;this._ctx={table:K,index:G.index,isPrimKey:!G.index||K.schema.primKey.keyPath&&G.index===K.schema.primKey.name,range:N,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:V,or:G.or,valueMapper:J!==L?J:null}})),this.Table=(C=this,qi(Uf.prototype,function(F,Q,N){this.db=C,this._tx=N,this.name=F,this.schema=Q,this.hook=C._allTables[F]?C._allTables[F].hook:zi(null,{creating:[de,O],reading:[ee,L],updating:[Ie,O],deleting:[ce,O]})})),this.Transaction=(M=this,qi(E_.prototype,function(F,Q,N,V,G){var K=this;F!=="readonly"&&Q.forEach(function(J){J=(J=N[J])===null||J===void 0?void 0:J.yProps,J&&(Q=Q.concat(J.map(function(se){return se.updatesTable})))}),this.db=M,this.mode=F,this.storeNames=Q,this.schema=N,this.chromeTransactionDurability=V,this.idbtrans=null,this.on=zi(this,"complete","error","abort"),this.parent=G||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new De(function(J,se){K._resolve=J,K._reject=se}),this._completion.then(function(){K.active=!1,K.on.complete.fire()},function(J){var se=K.active;return K.active=!1,K.on.error.fire(J),K.parent?K.parent._reject(J):se&&K.idbtrans&&K.idbtrans.abort(),Tt(J)})})),this.Version=(R=this,qi(F_.prototype,function(F){this.db=R,this._cfg={version:F,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(B=this,qi(Gf.prototype,function(F,Q,N){if(this.db=B,this._ctx={table:F,index:Q===":id"?null:Q,or:N},this._cmp=this._ascending=st,this._descending=function(V,G){return st(G,V)},this._max=function(V,G){return 0<st(V,G)?V:G},this._min=function(V,G){return st(V,G)<0?V:G},this._IDBKeyRange=B._deps.IDBKeyRange,!this._IDBKeyRange)throw new re.MissingAPI})),this.on("versionchange",function(F){0<F.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(F){!F.newVersion||F.newVersion<F.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(F.oldVersion/10))}),this._maxKey=Hi(h.IDBKeyRange),this._createTransaction=function(F,Q,N,V){return new m.Transaction(F,Q,N,m._options.chromeTransactionDurability,V)},this._fireOnBlocked=function(F){m.on("blocked").fire(F),ti.filter(function(Q){return Q.name===m.name&&Q!==m&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(F)})},this.use(N_),this.use(W_),this.use(z_),this.use(B_),this.use(j_);var H=new Proxy(this,{get:function(F,Q,N){if(Q==="_vip")return!0;if(Q==="table")return function(G){return La(m.table(G),H)};var V=Reflect.get(F,Q,N);return V instanceof Uf?La(V,H):Q==="tables"?V.map(function(G){return La(G,H)}):Q==="_createTransaction"?function(){return La(V.apply(this,arguments),H)}:V}});this.vip=H,y.forEach(function(F){return F(m)})}var Ba,Rn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",V_=(tu.prototype.subscribe=function(d,h,m){return this._subscribe(d&&typeof d!="function"?d:{next:d,error:h,complete:m})},tu.prototype[Rn]=function(){return this},tu);function tu(d){this._subscribe=d}try{Ba={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Ba={indexedDB:null,IDBKeyRange:null}}function uh(d){var h,m=!1,y=new V_(function(_){var C=Le(d),M,R=!1,B={},q={},H={get closed(){return R},unsubscribe:function(){R||(R=!0,M&&M.abort(),F&&Ls.storagemutated.unsubscribe(N))}};_.start&&_.start(H);var F=!1,Q=function(){return Oc(V)},N=function(G){Ra(B,G),Kc(q,B)&&Q()},V=function(){var G,K,J;!R&&Ba.indexedDB&&(B={},G={},M&&M.abort(),M=new AbortController,J=(function(se){var ie=Jr();try{C&&ei();var oe=Ts(d,se);return oe=C?oe.finally(Rs):oe}finally{ie&&Zr()}})(K={subscr:G,signal:M.signal,requery:Q,querier:d,trans:null}),Promise.resolve(J).then(function(se){m=!0,h=se,R||K.signal.aborted||(B={},(function(ie){for(var oe in ie)if(f(ie,oe))return;return 1})(q=G)||F||(Ls(Vi,N),F=!0),Oc(function(){return!R&&_.next&&_.next(se)}))},function(se){m=!1,["DatabaseClosedError","AbortError"].includes(se?.name)||R||Oc(function(){R||_.error&&_.error(se)})}))};return setTimeout(Q,0),H});return y.hasValue=function(){return m},y.getValue=function(){return h},y}var pr=fs;function nu(d){var h=Bs;try{Bs=!0,Ls.storagemutated.fire(d),Xc(d,!0)}finally{Bs=h}}p(pr,s(s({},nt),{delete:function(d){return new pr(d,{addons:[]}).delete()},exists:function(d){return new pr(d,{addons:[]}).open().then(function(h){return h.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(d){try{return h=pr.dependencies,m=h.indexedDB,h=h.IDBKeyRange,(Wc(m)?Promise.resolve(m.databases()).then(function(y){return y.map(function(_){return _.name}).filter(function(_){return _!==xa})}):Uc(m,h).toCollection().primaryKeys()).then(d)}catch{return Tt(new re.MissingAPI)}var h,m},defineClass:function(){return function(d){l(this,d)}},ignoreTransaction:function(d){return Re.trans?ur(Re.transless,d):d()},vip:Vc,async:function(d){return function(){try{var h=Qc(d.apply(this,arguments));return h&&typeof h.then=="function"?h:De.resolve(h)}catch(m){return Tt(m)}}},spawn:function(d,h,m){try{var y=Qc(d.apply(m,h||[]));return y&&typeof y.then=="function"?y:De.resolve(y)}catch(_){return Tt(_)}},currentTransaction:{get:function(){return Re.trans||null}},waitFor:function(d,h){return h=De.resolve(typeof d=="function"?pr.ignoreTransaction(d):d).timeout(h||6e4),Re.trans?Re.trans.waitFor(h):h},Promise:De,debug:{get:function(){return he},set:function(d){Ne(d)}},derive:w,extend:l,props:p,override:E,Events:zi,on:Ls,liveQuery:uh,extendObservabilitySet:Ra,getByKeyPath:P,setByKeyPath:A,delByKeyPath:function(d,h){typeof h=="string"?A(d,h,void 0):"length"in h&&[].map.call(h,function(m){A(d,m,void 0)})},shallowClone:$,deepClone:pe,getObjectDiff:Jc,cmp:st,asap:T,minKey:-1/0,addons:[],connections:ti,errnames:ae,dependencies:Ba,cache:hr,semVer:"4.2.0",version:"4.2.0".split(".").map(function(d){return parseInt(d)}).reduce(function(d,h,m){return d+h/Math.pow(10,2*m)})})),pr.maxKey=Hi(pr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ls(Vi,function(d){Bs||(d=new CustomEvent(Fc,{detail:d}),Bs=!0,dispatchEvent(d),Bs=!1)}),addEventListener(Fc,function(d){d=d.detail,Bs||nu(d)}));var ii,Bs=!1,dh=function(){};return typeof BroadcastChannel<"u"&&((dh=function(){(ii=new BroadcastChannel(Fc)).onmessage=function(d){return d.data&&nu(d.data)}})(),typeof ii.unref=="function"&&ii.unref(),Ls(Vi,function(d){Bs||ii.postMessage(d)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(d){if(!fs.disableBfCache&&d.persisted){he&&console.debug("Dexie: handling persisted pagehide"),ii?.close();for(var h=0,m=ti;h<m.length;h++)m[h].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(d){!fs.disableBfCache&&d.persisted&&(he&&console.debug("Dexie: handling persisted pageshow"),dh(),nu({all:new tn(-1/0,[[]])}))})),De.rejectionMapper=function(d,h){return!d||d instanceof Ve||d instanceof TypeError||d instanceof SyntaxError||!d.name||!Fe[d.name]?d:(h=new Fe[d.name](h||d.message,d),"stack"in d&&v(h,"stack",{get:function(){return this.inner.stack}}),h)},Ne(he),s(fs,Object.freeze({__proto__:null,Dexie:fs,liveQuery:uh,Entity:Nf,cmp:st,PropModification:Ui,replacePrefix:function(d,h){return new Ui({replacePrefix:[d,h]})},add:function(d){return new Ui({add:d})},remove:function(d){return new Ui({remove:d})},default:fs,RangeSet:tn,mergeRanges:Gi,rangesOverlap:eh}),{default:fs}),fs})})(yl)),yl.exports}var mk=gk();const dd=xv(mk),bp=Symbol.for("Dexie"),Ko=globalThis[bp]||(globalThis[bp]=dd);if(dd.semVer!==Ko.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${dd.semVer} and ${Ko.semVer}`);const{liveQuery:EB,mergeRanges:MB,rangesOverlap:OB,RangeSet:DB,cmp:TB,Entity:RB,PropModification:$B,replacePrefix:FB,add:LB,remove:BB,DexieYProvider:jB}=Ko;class yk extends Ko{cards;card_lots;acquisitions;transactions;scans;decks;deck_cards;price_points;valuations;settings;scan_sale_links;constructor(){super("MtgTrackerDb"),this.version(1).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish",transactions:"id, kind, cardId, source, externalRef, happenedAt",scans:"id, cardFingerprint, cardId, source, scannedAt",decks:"id, platform, name, importedAt",deck_cards:"id, [deckId+cardId], deckId, cardId",price_points:"id, cardId, provider, asOf",valuations:"id, asOf",settings:"k"}),this.version(2).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, createdAt, updatedAt",transactions:"id, kind, cardId, source, externalRef, happenedAt, createdAt, updatedAt",scans:"id, cardFingerprint, cardId, source, scannedAt, createdAt, updatedAt",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, [deckId+cardId], deckId, cardId, createdAt",price_points:"id, cardId, provider, asOf, createdAt",valuations:"id, asOf, createdAt",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, matchedAt, createdAt"}).upgrade(async e=>{const n=new Date;await e.table("cards").toCollection().modify(s=>{s.createdAt=s.createdAt||n,s.updatedAt=s.updatedAt||n}),await e.table("transactions").toCollection().modify(s=>{s.createdAt=s.createdAt||n,s.updatedAt=s.updatedAt||n}),await e.table("scans").toCollection().modify(s=>{s.createdAt=s.createdAt||n,s.updatedAt=s.updatedAt||n}),await e.table("decks").toCollection().modify(s=>{s.createdAt=s.createdAt||n,s.updatedAt=s.updatedAt||n}),await e.table("deck_cards").toCollection().modify(s=>{s.createdAt=s.createdAt||n}),await e.table("price_points").toCollection().modify(s=>{s.createdAt=s.createdAt||n}),await e.table("valuations").toCollection().modify(s=>{s.createdAt=s.createdAt||n}),await e.table("settings").toCollection().modify(s=>{s.createdAt=s.createdAt||n,s.updatedAt=s.updatedAt||n})}),this.version(3).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, createdAt, updatedAt",transactions:"id, kind, cardId, source, externalRef, happenedAt, createdAt, updatedAt",scans:"id, cardFingerprint, cardId, source, scannedAt, createdAt, updatedAt",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, [deckId+cardId], deckId, cardId, createdAt",price_points:"id, cardId, provider, currency, asOf, createdAt, [cardId+asOf], [provider+asOf]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, matchedAt, createdAt"}),this.version(4).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, createdAt, updatedAt",card_lots:"id, cardId, acquisitionId, source, purchasedAt, disposedAt, createdAt, updatedAt, [cardId+purchasedAt], [acquisitionId+cardId]",transactions:"id, kind, cardId, lotId, source, externalRef, happenedAt, relatedTransactionId, createdAt, updatedAt, [lotId+kind]",scans:"id, cardFingerprint, cardId, lotId, source, scannedAt, boosterPackId, createdAt, updatedAt, [lotId+scannedAt]",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, deckId, cardId, lotId, addedAt, removedAt, createdAt, [deckId+cardId], [lotId+addedAt]",price_points:"id, cardId, provider, currency, asOf, source, createdAt, [cardId+asOf], [provider+asOf]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, quantity, matchedAt, createdAt"}).upgrade(async e=>{}),this.version(5).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, createdAt, updatedAt",card_lots:"id, cardId, acquisitionId, source, purchasedAt, disposedAt, createdAt, updatedAt, externalRef, [cardId+purchasedAt], [acquisitionId+cardId], [externalRef]",transactions:"id, kind, cardId, lotId, source, externalRef, happenedAt, relatedTransactionId, createdAt, updatedAt, [lotId+kind]",scans:"id, cardFingerprint, cardId, lotId, source, scannedAt, boosterPackId, createdAt, updatedAt, [lotId+scannedAt]",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, deckId, cardId, lotId, addedAt, removedAt, createdAt, [deckId+cardId], [lotId+addedAt]",price_points:"id, cardId, provider, currency, asOf, source, createdAt, [cardId+asOf], [provider+asOf]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, quantity, matchedAt, createdAt"}),this.version(6).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, layout, imageUrl, imageUrlBack, createdAt, updatedAt",card_lots:"id, cardId, acquisitionId, source, purchasedAt, disposedAt, createdAt, updatedAt, externalRef, [cardId+purchasedAt], [acquisitionId+cardId], [externalRef]",transactions:"id, kind, cardId, lotId, source, externalRef, happenedAt, relatedTransactionId, createdAt, updatedAt, [lotId+kind]",scans:"id, cardFingerprint, cardId, lotId, source, scannedAt, boosterPackId, createdAt, updatedAt, [lotId+scannedAt]",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, deckId, cardId, lotId, addedAt, removedAt, createdAt, [deckId+cardId], [lotId+addedAt]",price_points:"id, cardId, provider, currency, asOf, source, createdAt, [cardId+asOf], [provider+asOf]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, quantity, matchedAt, createdAt"}).upgrade(async e=>{await e.table("cards").toCollection().modify(n=>{n.layout=n.layout||"normal"})}),this.version(7).stores({holdings:null}),this.version(8).stores({cards:"id, oracleId, name, set, setCode, number, lang, finish, layout, imageUrl, imageUrlBack, cardmarketId, createdAt, updatedAt",card_lots:"id, cardId, acquisitionId, source, purchasedAt, disposedAt, createdAt, updatedAt, externalRef, [cardId+purchasedAt], [acquisitionId+cardId], [externalRef]",transactions:"id, kind, cardId, lotId, source, externalRef, happenedAt, relatedTransactionId, createdAt, updatedAt, [lotId+kind]",scans:"id, cardFingerprint, cardId, lotId, source, scannedAt, boosterPackId, createdAt, updatedAt, [lotId+scannedAt]",decks:"id, platform, name, importedAt, createdAt, updatedAt",deck_cards:"id, deckId, cardId, lotId, addedAt, removedAt, createdAt, [deckId+cardId], [lotId+addedAt]",price_points:"id, cardId, provider, finish, date, currency, priceCent, asOf, createdAt, [cardId+date], [cardId+asOf], [provider+asOf], [cardId+provider+finish+date]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, quantity, matchedAt, createdAt"}).upgrade(async e=>{const n=e.table("price_points"),s=await n.toArray();for(const r of s){if(r.priceCent==null&&r.price!=null){const f=typeof r.price=="number"&&r.price<1e3;r.priceCent=f?Math.round(r.price*100):r.price,delete r.price}let i=r.finish??"nonfoil",o=r.date??(r.asOf?new Date(r.asOf).toISOString().slice(0,10):void 0);const a=String(r.id??"").split(":"),l=a[2],c=a[3]??a[2];(l==="foil"||l==="etched")&&(i=l),/^\d{4}-\d{2}-\d{2}$/.test(c)&&(o=c);let u="scryfall";r.source&&(r.source==="mtgjson"?u="mtgjson.cardmarket":r.source==="cardmarket"?u="cardmarket.priceguide":u="scryfall"),r.finish=i,r.provider=u,r.date=o??new Date().toISOString().slice(0,10),r.currency=r.currency??"EUR",r.createdAt=r.createdAt??new Date,r.asOf=r.asOf??new Date,r.id=`${r.cardId}:${u}:${i}:${r.date}`,await n.put(r)}}),this.version(9).stores({acquisitions:"id, kind, source, externalRef, currency, happenedAt, createdAt, updatedAt, [source+externalRef]",cards:"id, oracleId, name, set, setCode, number, lang, finish, layout, imageUrl, imageUrlBack, cardmarketId, createdAt, updatedAt",card_lots:"id, cardId, acquisitionId, source, purchasedAt, disposedAt, createdAt, updatedAt, externalRef, [cardId+purchasedAt], [acquisitionId+purchasedAt], [externalRef]",transactions:"id, kind, cardId, lotId, source, externalRef, happenedAt, relatedTransactionId, createdAt, updatedAt, finish, language, [lotId+kind], [cardId+kind], [source+externalRef]",scans:"id, cardFingerprint, cardId, lotId, acquisitionId, source, scannedAt, boosterPackId, externalRef, createdAt, updatedAt, finish, language, [lotId+scannedAt], [acquisitionId+scannedAt], [cardId+scannedAt], [acquisitionId+externalRef]",deck_cards:"[deckId+cardId], lotId, addedAt, removedAt, createdAt, [lotId+addedAt]",price_points:"id, cardId, provider, finish, date, currency, priceCent, asOf, createdAt, [cardId+date], [cardId+asOf], [provider+asOf], [cardId+provider+finish+date]",valuations:"id, asOf, createdAt, [asOf+createdAt]",settings:"k, createdAt, updatedAt",scan_sale_links:"id, scanId, transactionId, quantity, matchedAt, createdAt, strategy, score"}).upgrade(async e=>{})}}let Oo=null;const vk=async()=>{if(Oo)return Oo;const t=new yk;return await t.open(),Oo=t,t},_p=vk(),ge=()=>{if(!Oo)throw new Error("Database not initialized");return Oo},Ut={async add(t){return await ge().cards.add(t)},async getById(t){return await ge().cards.get(t)},async getAll(){return await ge().cards.toArray()},async getByCardmarketIds(t){return await ge().cards.where("cardmarketId").anyOf(t).toArray()},async update(t,e){return await ge().cards.update(t,e)},async delete(t){await ge().cards.delete(t)}},kt={async add(t){return await ge().card_lots.add(t)},async getById(t){return await ge().card_lots.get(t)},async getAll(){return await ge().card_lots.toArray()},async getByCardId(t){return await ge().card_lots.where("cardId").equals(t).toArray()},async getByExternalRef(t){return await ge().card_lots.where("externalRef").equals(t).toArray()},async getByAcquisitionId(t){return await ge().card_lots.where("acquisitionId").equals(t).toArray()},async getActiveLotsByCardId(t){return await ge().card_lots.where("cardId").equals(t).and(e=>!e.disposedAt).toArray()},async update(t,e){return await ge().card_lots.update(t,e)},async delete(t){await ge().card_lots.delete(t)}},Jt={async add(t){return await ge().transactions.add(t)},async getById(t){return await ge().transactions.get(t)},async getAll(){return await ge().transactions.toArray()},async getByCardId(t){return await ge().transactions.where("cardId").equals(t).toArray()},async getByLotId(t){return await ge().transactions.where("lotId").equals(t).toArray()},async getByKind(t){return await ge().transactions.where("kind").equals(t).toArray()},async getBuyTransactionsByCardId(t){return await ge().transactions.where("cardId").equals(t).and(e=>e.kind==="BUY").toArray()},async getSellTransactionsByCardId(t){return await ge().transactions.where("cardId").equals(t).and(e=>e.kind==="SELL").toArray()},async getBySourceRef(t,e){return await ge().transactions.where("[source+externalRef]").equals([t,e]).toArray()},async update(t,e){return await ge().transactions.update(t,e)},async delete(t){await ge().transactions.delete(t)}},Rl={async add(t){return await ge().scans.add(t)},async getById(t){return await ge().scans.get(t)},async getAll(){return await ge().scans.toArray()},async getByCardId(t){return await ge().scans.where("cardId").equals(t).toArray()},async getByLotId(t){return await ge().scans.where("lotId").equals(t).toArray()},async getByAcquisitionId(t){return await ge().scans.where("acquisitionId").equals(t).toArray()},async getByAcquisitionAndExternalRef(t,e){return await ge().scans.where("[acquisitionId+externalRef]").equals([t,e]).first()},async update(t,e){return await ge().scans.update(t,e)},async delete(t){await ge().scans.delete(t)}},wp={async add(t){return await ge().decks.add(t)},async getById(t){return await ge().decks.get(t)},async getAll(){return await ge().decks.toArray()},async update(t,e){return await ge().decks.update(t,e)},async delete(t){await ge().decks.delete(t)}},xp={async add(t){if(!t.deckId)throw new Error("DeckCard deckId is required");if(!t.cardId)throw new Error("DeckCard cardId is required");if(typeof t.quantity!="number"||t.quantity<=0)throw new Error("DeckCard quantity must be a positive number");if(!t.role)throw new Error("DeckCard role is required");if(!t.addedAt)throw new Error("DeckCard addedAt is required");if(!t.createdAt)throw new Error("DeckCard createdAt is required");return await ge().deck_cards.add(t)},async getById(t){return await ge().deck_cards.get(t)},async getByDeckId(t){return await ge().deck_cards.where("deckId").equals(t).toArray()},async getByCardId(t){return await ge().deck_cards.where("cardId").equals(t).toArray()},async getByDeckIdAndCardId(t,e){return await ge().deck_cards.where("[deckId+cardId]").equals([t,e]).first()},async getByLotId(t){return await ge().deck_cards.where("lotId").equals(t).toArray()},async deleteByDeckId(t){await ge().deck_cards.where("deckId").equals(t).delete()},async update(t,e){return await ge().deck_cards.update(t,e)},async delete(t){await ge().deck_cards.delete(t)}},$r={async add(t){return await ge().price_points.add(t)},async getById(t){return await ge().price_points.get(t)},async getByCardId(t){return await ge().price_points.where("cardId").equals(t).toArray()},async getByCardIdAndDate(t,e){return await ge().price_points.where("[cardId+date]").equals([t,e]).toArray()},async getByCardIdAndProviderAndFinishAndDate(t,e,n,s){return await ge().price_points.where("[cardId+provider+finish+date]").equals([t,e,n,s]).toArray()},async update(t,e){return await ge().price_points.update(t,e)},async bulkPut(t){await ge().price_points.bulkPut(t)},async delete(t){await ge().price_points.delete(t)}},fd={async add(t){return await ge().valuations.add(t)},async getById(t){return await ge().valuations.get(t)},async getAll(){return await ge().valuations.toArray()},async update(t,e){return await ge().valuations.update(t,e)},async delete(t){await ge().valuations.delete(t)}},Yo={async add(t){return ge().acquisitions.add(t)},async getById(t){return ge().acquisitions.get(t)},async getByExternalRef(t,e){return ge().acquisitions.where("[source+externalRef]").equals([t,e]).first()},async update(t,e){return ge().acquisitions.update(t,e)}},Nr={async set(t,e){const n={k:t,v:e,createdAt:new Date,updatedAt:new Date};return await ge().settings.put(n)},async get(t){return(await ge().settings.get(t))?.v},async getAll(){return await ge().settings.toArray()},async delete(t){await ge().settings.delete(t)}};class Be{cents;currency;constructor(e,n="EUR"){this.cents=Math.round(e),this.currency=n}static parse(e,n="EUR"){if(typeof e=="number")return new Be(e*100,n);const s=e.replace(/[€$£\s]/g,"").replace(",","."),r=parseFloat(s);return new Be(isNaN(r)?0:r*100,n)}getCents(){return this.cents}getDecimal(){return this.cents/100}getCurrency(){return this.currency}add(e){if(this.currency!==e.currency)throw new Error("Cannot add Money values with different currencies");return new Be(this.cents+e.cents,this.currency)}subtract(e){if(this.currency!==e.currency)throw new Error("Cannot subtract Money values with different currencies");return new Be(this.cents-e.cents,this.currency)}multiply(e){return new Be(this.cents*e,this.currency)}divide(e){return new Be(this.cents/e,this.currency)}format(e="de-DE"){return new Intl.NumberFormat(e,{style:"currency",currency:this.currency,minimumFractionDigits:2,maximumFractionDigits:2}).format(this.getDecimal())}isZero(){return this.cents===0}isPositive(){return this.cents>0}isNegative(){return this.cents<0}}const bk="mtgjson.idMap.v1",_k={"mtgjson.cardmarket":3,"cardmarket.priceguide":2,scryfall:1},tf=fc("cards",{state:()=>({cards:{},cardPrices:{},cardLatest:{},idMap:null,loading:!1,loadingPrices:!1,error:null}),getters:{getCardById:t=>e=>t.cards[e],getAllCards:t=>Object.values(t.cards),getCardsBySet:t=>e=>Object.values(t.cards).filter(n=>n.setCode===e),getCardPrice:t=>e=>t.cardPrices[e]||null,getLatestNonfoil:t=>e=>t.cardLatest[e]?.nonfoil||null,getLatestFoil:t=>e=>t.cardLatest[e]?.foil||null},actions:{async loadCards(){this.loading=!0,this.error=null;try{const t=await Ut.getAll();this.cards=t.reduce((e,n)=>(e[n.id]=n,e),{})}catch(t){this.error=t instanceof Error?t.message:"Failed to load cards",console.error("Error loading cards:",t)}finally{this.loading=!1}},async ensureIdMap(){if(!this.idMap)try{this.idMap=await Nr.get(bk)??null}catch(t){console.warn("[cardsStore] Could not load id map",t),this.idMap=null}},uuidForCard(t){const e=this.idMap;if(!e)return null;const n=e[t.id]||(t.oracleId?e[t.oracleId]:void 0);return n?String(n).toLowerCase():null},_pickLatestForFinish(t,e){const n=a=>{try{return new Date(a).toISOString().slice(0,10)}catch{return}},s={};for(const a of t){if((a.finish??"nonfoil")!==e)continue;const c=a.date??(a.asOf?n(a.asOf):void 0);if(!c)continue;const u=_k[a.provider??""]??0,f=a.asOf?new Date(a.asOf).getTime():0,p=s[c];(!p||u>p.rank||u===p.rank&&f>p.asOfTs)&&(s[c]={priceCent:a.priceCent,currency:a.currency??"EUR",rank:u,asOfTs:f})}const r=Object.keys(s);if(!r.length)return null;const i=r.sort((a,l)=>a.localeCompare(l)).at(-1),o=s[i];return new Be(o.priceCent,o.currency)},async loadLatestForCard(t){const e=this.cards[t];if(!e)return;const s=(await $r.getByCardId(t)).map(a=>({date:a.date,asOf:a.asOf,provider:a.provider,finish:a.finish??"nonfoil",priceCent:a.priceCent,currency:a.currency??"EUR"})),r=this._pickLatestForFinish(s,"nonfoil"),i=this._pickLatestForFinish(s,"foil");this.cardLatest[t]={nonfoil:r||void 0,foil:i||void 0};const o=(e.finish==="foil"?i:r)||i||r||null;o?this.cardPrices[t]=o:delete this.cardPrices[t]},async loadCardPrices(){this.loadingPrices=!0,this.error=null;try{Object.keys(this.cards).length||await this.loadCards(),await this.ensureIdMap();const t=Object.values(this.cards),e=8;for(let n=0;n<t.length;n+=e){const s=t.slice(n,n+e);await Promise.all(s.map(r=>this.loadLatestForCard(r.id)))}}catch(t){this.error=t instanceof Error?t.message:"Failed to load card prices",console.error("Error loading card prices:",t)}finally{this.loadingPrices=!1}},async getPriceHistory(t){if(!this.cards[t])return[];const n=r=>{try{return new Date(r).toISOString().slice(0,10)}catch{return}};return(await $r.getByCardId(t)).map(r=>({...r,date:r.date??(r.asOf?n(r.asOf):void 0)})).filter(r=>typeof r.date=="string").sort((r,i)=>r.date.localeCompare(i.date))},async loadCardsAndPrices(){await this.loadCards(),await this.loadCardPrices()},async addCard(t){await Ut.add(t),this.cards[t.id]=t},async updateCard(t,e){await Ut.update(t,e),this.cards[t]&&(this.cards[t]={...this.cards[t],...e})},async removeCard(t){await Ut.delete(t),delete this.cards[t],delete this.cardPrices[t],delete this.cardLatest[t]}}}),wk=fc("holdings",{state:()=>({holdings:{},loading:!1,error:null}),getters:{getHoldingByCardId:t=>e=>t.holdings[e],getAllHoldings:t=>Object.values(t.holdings),getTotalQuantityByCardId:t=>e=>t.holdings[e]?.quantity||0},actions:{async loadHoldings(){this.loading=!0,this.error=null;try{const t=await kt.getAll(),n=(await Ut.getAll()).reduce((r,i)=>(r[i.id]=i,r),{}),s={};for(const r of t){if(r.disposedAt)continue;const i=s[r.cardId],o=r.quantity-(r.disposedQuantity||0);i?(i.quantity+=o,i.totalCost+=r.totalAcquisitionCostCent||r.unitCost*o,i.averageCost=i.totalCost/i.quantity):s[r.cardId]={cardId:r.cardId,quantity:o,totalCost:r.totalAcquisitionCostCent||r.unitCost*o,averageCost:r.totalAcquisitionCostCent?r.totalAcquisitionCostCent/r.quantity:r.unitCost,card:n[r.cardId]}}this.holdings=s}catch(t){this.error=t instanceof Error?t.message:"Failed to load holdings",console.error("Error loading holdings:",t)}finally{this.loading=!1}}}}),xk=fc("transactions",{state:()=>({transactions:{},loading:!1,error:null}),getters:{getTransactionById:t=>e=>t.transactions[e],getAllTransactions:t=>Object.values(t.transactions),getTransactionsByCardId:t=>e=>Object.values(t.transactions).filter(n=>n.cardId===e),getTransactionsByKind:t=>e=>Object.values(t.transactions).filter(n=>n.kind===e),getTotalValueByKind:t=>e=>Object.values(t.transactions).filter(n=>n.kind===e).reduce((n,s)=>{const r=s.unitPrice*s.quantity,i=s.fees||0,o=s.shipping||0;return e==="BUY"?n+r+i+o:n+r-i-o},0)},actions:{async loadTransactions(){this.loading=!0,this.error=null;try{const t=await Jt.getAll();this.transactions=t.reduce((e,n)=>(e[n.id]=n,e),{})}catch(t){this.error=t instanceof Error?t.message:"Failed to load transactions",console.error("Error loading transactions:",t)}finally{this.loading=!1}},async addTransaction(t){try{await Jt.add(t),this.transactions[t.id]=t}catch(e){throw this.error=e instanceof Error?e.message:"Failed to add transaction",console.error("Error adding transaction:",e),e}},async updateTransaction(t,e){try{await Jt.update(t,e),this.transactions[t]&&(this.transactions[t]={...this.transactions[t],...e})}catch(n){throw this.error=n instanceof Error?n.message:"Failed to update transaction",console.error("Error updating transaction:",n),n}},async removeTransaction(t){try{await Jt.delete(t),delete this.transactions[t]}catch(e){throw this.error=e instanceof Error?e.message:"Failed to remove transaction",console.error("Error removing transaction:",e),e}}}});class $l{static PROVIDER_PRECEDENCE=["cardmarket.priceguide","mtgjson.cardmarket","scryfall"];static async getLatestPriceForCard(e){try{const n=await $r.getByCardId(e);if(n.length===0)return null;const s=this.sortPricePointsByPrecedence(n);if(s.length===0)return null;const r=s[0];return{price:new Be(r.priceCent,r.currency),asOf:r.asOf,provider:r.provider}}catch(n){return console.error(`Error getting latest price for card ${e}:`,n),null}}static async getPricePointsForCard(e,n){try{let s=await $r.getByCardId(e);return n?.source&&(s=s.filter(r=>r.provider===n.source)),n?.finish&&(s=s.filter(r=>r.finish===n.finish)),n?.startDate&&(s=s.filter(r=>new Date(r.asOf)>=n.startDate)),n?.endDate&&(s=s.filter(r=>new Date(r.asOf)<=n.endDate)),s=this.sortPricePointsByPrecedence(s),n?.limit&&(s=s.slice(0,n.limit)),s}catch(s){return console.error(`Error getting price points for card ${e}:`,s),[]}}static async getPriceForDate(e,n){try{const s=n.toISOString().split("T")[0];let r=await $r.getByCardIdAndDate(e,s);if(r.length===0||(r=this.sortPricePointsByPrecedence(r),r.length===0))return null;const i=r[0];return{price:new Be(i.priceCent,i.currency),provider:i.provider,finish:i.finish}}catch(s){return console.error(`Error getting price for card ${e} on date ${n.toISOString().split("T")[0]}:`,s),null}}static async getPriceForDateAndFinish(e,n,s){try{const r=n.toISOString().split("T")[0];let i=await $r.getByCardIdAndDate(e,r);if(i.length===0||(i=i.filter(a=>a.finish===s),i.length===0)||(i=this.sortPricePointsByPrecedence(i),i.length===0))return null;const o=i[0];return{price:new Be(o.priceCent,o.currency),provider:o.provider}}catch(r){return console.error(`Error getting price for card ${e} on date ${n.toISOString().split("T")[0]} with finish ${s}:`,r),null}}static sortPricePointsByPrecedence(e){return e.sort((n,s)=>{const r=this.PROVIDER_PRECEDENCE.indexOf(n.provider),i=this.PROVIDER_PRECEDENCE.indexOf(s.provider),o=r===-1?1/0:r,a=i===-1?1/0:i;return o!==a?o-a:new Date(s.asOf).getTime()-new Date(n.asOf).getTime()})}static getSourcePrecedence(e){const n=this.PROVIDER_PRECEDENCE.indexOf(e);return n===-1?1/0:n}}async function kk(t,e=new Date){const n=await Yo.getById(t);if(!n)throw new Error("Acquisition not found");const s=(n.totalPriceCent??0)+(n.totalFeesCent??0)+(n.totalShippingCent??0),r=await kt.getByAcquisitionId(t);let i=0,o=0,a=0;const l=[];for(const c of r){const f=(await Jt.getByLotId(c.id)).filter(S=>S.kind==="SELL"&&S.happenedAt<=e);let p=0,g=0,v=0,w=0,x=0;for(const S of f){p+=S.quantity*S.unitPrice-(S.fees||0)+(S.shipping||0);const E=c.totalAcquisitionCostCent||c.unitCost*c.quantity;g+=E/c.quantity*S.quantity,v+=S.fees||0,w+=S.shipping||0}x=p-g,i+=p,o+=x;const k=c.quantity-f.reduce((S,E)=>S+E.quantity,0);if(k>0){const S=await $l.getLatestPriceForCard(c.cardId),E=S?S.price.getCents():0,D=k*E,P=(c.totalAcquisitionCostCent||c.unitCost*c.quantity)/c.quantity,A=D-k*P;a+=A}l.push({lotId:c.id,cardId:c.cardId,quantity:c.quantity,acquisitionCostCent:c.totalAcquisitionCostCent||c.unitCost*c.quantity,saleRevenueCent:p,feesCent:v,shippingCent:w,realizedPnLCent:x})}return{totalCostCent:s,totalRevenueCent:i,realizedPnLCent:o,unrealizedPnLCent:a,lots:l}}async function Ck(t,e,n){const s=[];switch(e){case"equal_per_card":for(const o of t)s.push(o.quantity);break;case"by_market_price":const r=n?.provider||"scryfall",i=n?.date||new Date().toISOString().slice(0,10);for(const o of t){const a=await $r.getByCardIdAndProviderAndFinishAndDate(o.cardId,r,o.finish||"nonfoil",i);if(a.length>0){const l=a[0];s.push(l.priceCent*o.quantity)}else s.push(o.quantity)}break;case"by_rarity":for(const o of t)s.push(o.quantity*1);break;case"manual":for(const o of t)s.push(o.quantity);break}return s}async function Sk(t,e,n){const s=ge();return s.transaction("rw",s.card_lots,s.acquisitions,s.price_points,async()=>{const r=await Yo.getById(t);if(!r)throw new Error("Acquisition not found");const i=(r.totalPriceCent??0)+(r.totalFeesCent??0)+(r.totalShippingCent??0),o=await kt.getByAcquisitionId(t),a=await Ck(o,e,n),l=a.reduce((x,k)=>x+k,0)||1,c=o.map((x,k)=>i*(a[k]/l)),u=c.map(x=>Math.floor(x)),f=u.reduce((x,k)=>x+k,0);let p=i-f;const g=c.map((x,k)=>x-u[k]),v=o.map((x,k)=>({lot:x,remainder:g[k],originalIndex:k})).sort((x,k)=>k.remainder-x.remainder),w=[...u];for(let x=0;x<p;x++){const k=v[x];k&&w[k.originalIndex]++}for(let x=0;x<o.length;x++){const k=w[x],S=Math.floor(k/Math.max(1,o[x].quantity));await kt.update(o[x].id,{totalAcquisitionCostCent:k,unitCost:S,acquisitionPriceCent:k,updatedAt:new Date})}await Yo.update(t,{totalCostCent:i,allocationMethod:e,allocationAsOf:new Date,allocationSourceRev:n?.provider?`${n.provider}:${n?.date??""}`:void 0,updatedAt:new Date})})}class Gs{static async calculateLotValue(e){if(e.cardId){const n=await $l.getLatestPriceForCard(e.cardId);if(n){const s=n.price,r=e.disposedQuantity?e.quantity-e.disposedQuantity:e.quantity;return s.multiply(r)}}return new Be(0,"EUR")}static async calculateLotCostBasis(e){if(e.totalAcquisitionCostCent){const i=(e.disposedQuantity?e.quantity-e.disposedQuantity:e.quantity)/e.quantity;return new Be(e.totalAcquisitionCostCent*i,e.currency||"EUR")}const n=new Be(e.unitCost,e.currency||"EUR"),s=e.disposedQuantity?e.quantity-e.disposedQuantity:e.quantity;return n.multiply(s)}static async calculateRealizedPnL(){const e=await Jt.getByKind("SELL");let n=new Be(0,"EUR");for(const s of e){const r=new Be(s.unitPrice,s.currency).multiply(s.quantity);let i=new Be(0,"EUR");if(s.lotId){const c=await kt.getById(s.lotId);c&&(i=(c.totalAcquisitionCostCent?new Be(c.totalAcquisitionCostCent,c.currency||"EUR"):new Be(c.unitCost,c.currency||"EUR").multiply(c.quantity)).multiply(s.quantity/c.quantity))}else s.cardId&&(i=await this.calculateFIFOCostForCard(s.cardId,s.quantity));const o=new Be(s.fees,s.currency),a=new Be(s.shipping,s.currency),l=r.subtract(i).subtract(o).subtract(a);n=n.add(l)}return n}static async calculateFIFOCostForCard(e,n){const r=(await kt.getByCardId(e)).filter(a=>!a.disposedAt||a.disposedQuantity&&a.disposedQuantity<a.quantity).sort((a,l)=>a.purchasedAt.getTime()-l.purchasedAt.getTime());let i=n,o=new Be(0,"EUR");for(const a of r){if(i<=0)break;const l=a.disposedQuantity?a.quantity-a.disposedQuantity:a.quantity,c=Math.min(i,l),f=new Be(a.unitCost,a.currency||"EUR").multiply(c);o=o.add(f),i-=c}return o}static async calculatePortfolioValue(){const e=await kt.getAll();let n=new Be(0,"EUR");for(const s of e)if(!s.disposedAt||s.disposedQuantity&&s.disposedQuantity<s.quantity){const r=await this.calculateLotValue(s);n=n.add(r)}return n}static async calculateTotalCostBasis(){const e=await kt.getAll();let n=new Be(0,"EUR");for(const s of e)if(!s.disposedAt||s.disposedQuantity&&s.disposedQuantity<s.quantity){const r=await this.calculateLotCostBasis(s);n=n.add(r)}return n}static async calculateUnrealizedPnL(){const e=await this.calculatePortfolioValue(),n=await this.calculateTotalCostBasis();return e.subtract(n)}static async getActiveLots(){return(await kt.getAll()).filter(n=>!n.disposedAt||n.disposedQuantity&&n.disposedQuantity<n.quantity)}static async getOwnedQuantity(e){const n=await kt.getByCardId(e);let s=0;for(const r of n)r.disposedAt?r.disposedQuantity&&r.disposedQuantity<r.quantity&&(s+=r.quantity-r.disposedQuantity):s+=r.quantity;return s}static async createValuationSnapshot(){try{const e=new Date;if(e.setHours(0,0,0,0),(await fd.getAll()).find(l=>{const c=new Date(l.asOf);return c.setHours(0,0,0,0),c.getTime()===e.getTime()})){console.log("Valuation snapshot for today already exists");return}const r=await this.calculatePortfolioValue(),i=await this.calculateTotalCostBasis(),o=await this.calculateRealizedPnL(),a={id:`valuation-${Date.now()}`,asOf:new Date,totalValue:r.getCents(),totalCostBasis:i.getCents(),realizedPnLToDate:o.getCents(),createdAt:new Date};await fd.add(a),console.log("Valuation snapshot created:",a)}catch(e){throw console.error("Error creating valuation snapshot:",e),e}}static async getAcquisitionPnL(e,n=new Date){return await kk(e,n)}static async allocateAcquisitionCosts(e,n,s){return await Sk(e,n,s)}}class Mr{static calculateTrueAcquisitionCost(e,n,s,r){const i=e+n+s;return Math.round(i/r*100)}static calculateNetRevenuePerCard(e,n,s,r){const i=e-n-s;return Math.round(i/r*100)}static async getTotalFees(e,n){const s=await Jt.getAll();let r=new Be(0,"EUR");for(const i of s)e&&new Date(i.happenedAt)<e||n&&new Date(i.happenedAt)>n||(r=r.add(new Be(i.fees||0,"EUR")));return r}static async getTotalShippingCosts(e,n,s){const r=await Jt.getAll();let i=new Be(0,"EUR");for(const o of r)e==="purchase"&&o.kind!=="BUY"||e==="sale"&&o.kind!=="SELL"||n&&new Date(o.happenedAt)<n||s&&new Date(o.happenedAt)>s||(i=i.add(new Be(o.shipping||0,o.currency||"EUR")));return i}static calculateLotNetProfit(e){if(!e.disposedAt||!e.salePriceCent)return 0;const n=e.totalAcquisitionCostCent||e.unitCost*e.quantity;return(e.totalSaleRevenueCent||e.salePriceCent*e.quantity-(e.saleFeesCent||0)+(e.saleShippingCent||0))-n}static async getTotalNetProfit(){const e=await kt.getAll();let n=new Be(0,"EUR");for(const s of e)if(s.disposedAt&&s.totalNetProfitCent!==void 0)n=n.add(new Be(s.totalNetProfitCent,"EUR"));else if(s.disposedAt&&s.salePriceCent){const r=this.calculateLotNetProfit(s);n=n.add(new Be(r,"EUR"))}return n}static async getTotalRevenue(){const e=await Jt.getByKind("SELL");let n=new Be(0,"EUR");for(const s of e){const r=new Be(s.unitPrice*s.quantity,s.currency);n=n.add(r)}return n}static async getTotalCosts(){const e=await Jt.getByKind("BUY");let n=new Be(0,"EUR");for(const s of e){const r=new Be(s.unitPrice*s.quantity,s.currency),i=new Be(s.fees||0,s.currency),o=new Be(s.shipping||0,s.currency);n=n.add(r).add(i).add(o)}return n}}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function oa(t){return t+.5|0}const Xs=(t,e,n)=>Math.max(Math.min(t,n),e);function po(t){return Xs(oa(t*2.55),0,255)}function er(t){return Xs(oa(t*255),0,255)}function Cs(t){return Xs(oa(t/2.55)/100,0,1)}function kp(t){return Xs(oa(t*100),0,100)}const Fn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hd=[..."0123456789ABCDEF"],Pk=t=>hd[t&15],Ak=t=>hd[(t&240)>>4]+hd[t&15],Va=t=>(t&240)>>4===(t&15),Ik=t=>Va(t.r)&&Va(t.g)&&Va(t.b)&&Va(t.a);function Ek(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Fn[t[1]]*17,g:255&Fn[t[2]]*17,b:255&Fn[t[3]]*17,a:e===5?Fn[t[4]]*17:255}:(e===7||e===9)&&(n={r:Fn[t[1]]<<4|Fn[t[2]],g:Fn[t[3]]<<4|Fn[t[4]],b:Fn[t[5]]<<4|Fn[t[6]],a:e===9?Fn[t[7]]<<4|Fn[t[8]]:255})),n}const Mk=(t,e)=>t<255?e(t):"";function Ok(t){var e=Ik(t)?Pk:Ak;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Mk(t.a,e):void 0}const Dk=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function kv(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function Tk(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function Rk(t,e,n){const s=kv(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function $k(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function nf(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,c,u;return i!==o&&(u=i-o,c=a>.5?u/(2-i-o):u/(i+o),l=$k(n,s,r,u,i),l=l*60+.5),[l|0,c||0,a]}function sf(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(er)}function rf(t,e,n){return sf(kv,t,e,n)}function Fk(t,e,n){return sf(Rk,t,e,n)}function Lk(t,e,n){return sf(Tk,t,e,n)}function Cv(t){return(t%360+360)%360}function Bk(t){const e=Dk.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?po(+e[5]):er(+e[5]));const r=Cv(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=Fk(r,i,o):e[1]==="hsv"?s=Lk(r,i,o):s=rf(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function jk(t,e){var n=nf(t);n[0]=Cv(n[0]+e),n=rf(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Nk(t){if(!t)return;const e=nf(t),n=e[0],s=kp(e[1]),r=kp(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Cs(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const Cp={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Sp={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function zk(){const t={},e=Object.keys(Sp),n=Object.keys(Cp);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,Cp[i]);i=parseInt(Sp[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Ha;function qk(t){Ha||(Ha=zk(),Ha.transparent=[0,0,0,0]);const e=Ha[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Uk=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Wk(t){const e=Uk.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?po(o):Xs(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?po(s):Xs(s,0,255)),r=255&(e[4]?po(r):Xs(r,0,255)),i=255&(e[6]?po(i):Xs(i,0,255)),{r:s,g:r,b:i,a:n}}}function Vk(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Cs(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const yu=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,li=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Hk(t,e,n){const s=li(Cs(t.r)),r=li(Cs(t.g)),i=li(Cs(t.b));return{r:er(yu(s+n*(li(Cs(e.r))-s))),g:er(yu(r+n*(li(Cs(e.g))-r))),b:er(yu(i+n*(li(Cs(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Ka(t,e,n){if(t){let s=nf(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=rf(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function Sv(t,e){return t&&Object.assign(e||{},t)}function Pp(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=er(t[3]))):(e=Sv(t,{r:0,g:0,b:0,a:1}),e.a=er(e.a)),e}function Kk(t){return t.charAt(0)==="r"?Wk(t):Bk(t)}class Go{constructor(e){if(e instanceof Go)return e;const n=typeof e;let s;n==="object"?s=Pp(e):n==="string"&&(s=Ek(e)||qk(e)||Kk(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=Sv(this._rgb);return e&&(e.a=Cs(e.a)),e}set rgb(e){this._rgb=Pp(e)}rgbString(){return this._valid?Vk(this._rgb):void 0}hexString(){return this._valid?Ok(this._rgb):void 0}hslString(){return this._valid?Nk(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,s.r=255&c*s.r+i*r.r+.5,s.g=255&c*s.g+i*r.g+.5,s.b=255&c*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=Hk(this._rgb,e._rgb,n)),this}clone(){return new Go(this.rgb)}alpha(e){return this._rgb.a=er(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=oa(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ka(this._rgb,2,e),this}darken(e){return Ka(this._rgb,2,-e),this}saturate(e){return Ka(this._rgb,1,e),this}desaturate(e){return Ka(this._rgb,1,-e),this}rotate(e){return jk(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function gs(){}const Yk=(()=>{let t=0;return()=>t++})();function _t(t){return t==null}function Ct(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ze(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Yt(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Zn(t,e){return Yt(t)?t:e}function Je(t,e){return typeof t>"u"?e:t}const Gk=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Pv=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function pt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function ht(t,e,n,s){let r,i,o;if(Ct(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(Ze(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function Fl(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Ll(t){if(Ct(t))return t.map(Ll);if(Ze(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=Ll(t[n[r]]);return e}return t}function Av(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Xk(t,e,n,s){if(!Av(t))return;const r=e[t],i=n[t];Ze(r)&&Ze(i)?Xo(r,i,s):e[t]=Ll(i)}function Xo(t,e,n){const s=Ct(e)?e:[e],r=s.length;if(!Ze(t))return t;n=n||{};const i=n.merger||Xk;let o;for(let a=0;a<r;++a){if(o=s[a],!Ze(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],t,o,n)}return t}function Do(t,e){return Xo(t,e,{merger:Qk})}function Qk(t,e,n){if(!Av(t))return;const s=e[t],r=n[t];Ze(s)&&Ze(r)?Do(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Ll(r))}const Ap={"":t=>t,x:t=>t.x,y:t=>t.y};function Jk(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Zk(t){const e=Jk(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Qo(t,e){return(Ap[e]||(Ap[e]=Zk(e)))(t)}function of(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Dn=t=>typeof t<"u",wn=t=>typeof t=="function",Ip=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function eC(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ut=Math.PI,Wt=2*ut,tC=Wt+ut,Bl=Number.POSITIVE_INFINITY,af=ut/180,Zt=ut/2,Bn=ut/4,jl=ut*2/3,Iv=Math.log10,Mi=Math.sign;function To(t,e,n){return Math.abs(t-e)<n}function Ep(t){const e=Math.round(t);t=To(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Iv(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function nC(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function sC(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function qr(t){return!sC(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function rC(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function iC(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Vt(t){return t*(ut/180)}function Ev(t){return t*(180/ut)}function Mp(t){if(!Yt(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function pd(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*ut&&(i+=Wt),{angle:i,distance:r}}function Oi(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function oC(t,e){return(t-e+tC)%Wt-ut}function rs(t){return(t%Wt+Wt)%Wt}function Nl(t,e,n,s){const r=rs(t),i=rs(e),o=rs(n),a=rs(i-r),l=rs(o-r),c=rs(r-i),u=rs(r-o);return r===i||r===o||s&&i===o||a>l&&c<u}function jn(t,e,n){return Math.max(e,Math.min(n,t))}function aC(t){return jn(t,-32768,32767)}function gi(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function lf(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Fr=(t,e,n,s)=>lf(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),lC=(t,e,n)=>lf(t,n,s=>t[s][e]>=n);function cC(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const Mv=["push","pop","shift","splice","unshift"];function uC(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Mv.forEach(n=>{const s="_onData"+of(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function Op(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(Mv.forEach(i=>{delete t[i]}),delete t._chartjs)}function dC(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Ov=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function Dv(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,Ov.call(window,()=>{s=!1,t.apply(e,n)}))}}function fC(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const cf=t=>t==="start"?"left":t==="end"?"right":"center",rn=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,hC=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function pC(t,e,n){const s=e.length;let r=0,i=s;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,u=o.axis,{min:f,max:p,minDefined:g,maxDefined:v}=o.getUserBounds();if(g){if(r=Math.min(Fr(l,u,f).lo,n?s:Fr(e,u,o.getPixelForValue(f)).lo),c){const w=l.slice(0,r+1).reverse().findIndex(x=>!_t(x[a.axis]));r-=Math.max(0,w)}r=jn(r,0,s-1)}if(v){let w=Math.max(Fr(l,o.axis,p,!0).hi+1,n?0:Fr(e,u,o.getPixelForValue(p),!0).hi+1);if(c){const x=l.slice(w-1).findIndex(k=>!_t(k[a.axis]));w+=Math.max(0,x)}i=jn(w,r,s)-r}else i=s-r}return{start:r,count:i}}function gC(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const i=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const Ya=t=>t===0||t===1,Dp=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Wt/n)),Tp=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Wt/n)+1,Ro={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Zt)+1,easeOutSine:t=>Math.sin(t*Zt),easeInOutSine:t=>-.5*(Math.cos(ut*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Ya(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Ya(t)?t:Dp(t,.075,.3),easeOutElastic:t=>Ya(t)?t:Tp(t,.075,.3),easeInOutElastic(t){return Ya(t)?t:t<.5?.5*Dp(t*2,.1125,.45):.5+.5*Tp(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Ro.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Ro.easeInBounce(t*2)*.5:Ro.easeOutBounce(t*2-1)*.5+.5};function uf(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Rp(t){return uf(t)?t:new Go(t)}function vu(t){return uf(t)?t:new Go(t).saturate(.5).darken(.1).hexString()}const mC=["x","y","borderWidth","radius","tension"],yC=["color","borderColor","backgroundColor"];function vC(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:yC},numbers:{type:"number",properties:mC}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function bC(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const $p=new Map;function _C(t,e){e=e||{};const n=t+JSON.stringify(e);let s=$p.get(n);return s||(s=new Intl.NumberFormat(t,e),$p.set(n,s)),s}function df(t,e,n){return _C(e,n).format(t)}const wC={values(t){return Ct(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),i=xC(t,n)}const o=Iv(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),df(t,s,l)}};function xC(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Tv={formatters:wC};function kC(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Tv.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ur=Object.create(null),gd=Object.create(null);function $o(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function bu(t,e,n){return typeof e=="string"?Xo($o(t,e),n):Xo($o(t,""),e)}class CC{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>vu(r.backgroundColor),this.hoverBorderColor=(s,r)=>vu(r.borderColor),this.hoverColor=(s,r)=>vu(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return bu(this,e,n)}get(e){return $o(this,e)}describe(e,n){return bu(gd,e,n)}override(e,n){return bu(Ur,e,n)}route(e,n,s,r){const i=$o(this,e),o=$o(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return Ze(l)?Object.assign({},c,l):Je(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Dt=new CC({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[vC,bC,kC]);function SC(t){return!t||_t(t.size)||_t(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Fp(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function br(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function Lp(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function md(t,e,n,s){Rv(t,e,n,s,null)}function Rv(t,e,n,s,r){let i,o,a,l,c,u,f,p;const g=e.pointStyle,v=e.rotation,w=e.radius;let x=(v||0)*af;if(g&&typeof g=="object"&&(i=g.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(x),t.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),t.restore();return}if(!(isNaN(w)||w<=0)){switch(t.beginPath(),g){default:r?t.ellipse(n,s,r/2,w,0,0,Wt):t.arc(n,s,w,0,Wt),t.closePath();break;case"triangle":u=r?r/2:w,t.moveTo(n+Math.sin(x)*u,s-Math.cos(x)*w),x+=jl,t.lineTo(n+Math.sin(x)*u,s-Math.cos(x)*w),x+=jl,t.lineTo(n+Math.sin(x)*u,s-Math.cos(x)*w),t.closePath();break;case"rectRounded":c=w*.516,l=w-c,o=Math.cos(x+Bn)*l,f=Math.cos(x+Bn)*(r?r/2-c:l),a=Math.sin(x+Bn)*l,p=Math.sin(x+Bn)*(r?r/2-c:l),t.arc(n-f,s-a,c,x-ut,x-Zt),t.arc(n+p,s-o,c,x-Zt,x),t.arc(n+f,s+a,c,x,x+Zt),t.arc(n-p,s+o,c,x+Zt,x+ut),t.closePath();break;case"rect":if(!v){l=Math.SQRT1_2*w,u=r?r/2:l,t.rect(n-u,s-l,2*u,2*l);break}x+=Bn;case"rectRot":f=Math.cos(x)*(r?r/2:w),o=Math.cos(x)*w,a=Math.sin(x)*w,p=Math.sin(x)*(r?r/2:w),t.moveTo(n-f,s-a),t.lineTo(n+p,s-o),t.lineTo(n+f,s+a),t.lineTo(n-p,s+o),t.closePath();break;case"crossRot":x+=Bn;case"cross":f=Math.cos(x)*(r?r/2:w),o=Math.cos(x)*w,a=Math.sin(x)*w,p=Math.sin(x)*(r?r/2:w),t.moveTo(n-f,s-a),t.lineTo(n+f,s+a),t.moveTo(n+p,s-o),t.lineTo(n-p,s+o);break;case"star":f=Math.cos(x)*(r?r/2:w),o=Math.cos(x)*w,a=Math.sin(x)*w,p=Math.sin(x)*(r?r/2:w),t.moveTo(n-f,s-a),t.lineTo(n+f,s+a),t.moveTo(n+p,s-o),t.lineTo(n-p,s+o),x+=Bn,f=Math.cos(x)*(r?r/2:w),o=Math.cos(x)*w,a=Math.sin(x)*w,p=Math.sin(x)*(r?r/2:w),t.moveTo(n-f,s-a),t.lineTo(n+f,s+a),t.moveTo(n+p,s-o),t.lineTo(n-p,s+o);break;case"line":o=r?r/2:Math.cos(x)*w,a=Math.sin(x)*w,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(x)*(r?r/2:w),s+Math.sin(x)*w);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Jo(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function aa(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function la(t){t.restore()}function PC(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function AC(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function IC(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),_t(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function EC(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function MC(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Zo(t,e,n,s,r,i={}){const o=Ct(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,IC(t,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&MC(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),_t(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(c,n,s,i.maxWidth)),t.fillText(c,n,s,i.maxWidth),EC(t,n,s,c,i),s+=Number(r.lineHeight);t.restore()}function zl(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*ut,ut,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,ut,Zt,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,Zt,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-Zt,!0),t.lineTo(n+o.topLeft,s)}const OC=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,DC=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function TC(t,e){const n=(""+t).match(OC);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const RC=t=>+t||0;function $v(t,e){const n={},s=Ze(e),r=s?Object.keys(e):e,i=Ze(t)?s?o=>Je(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=RC(i(o));return n}function $C(t){return $v(t,{top:"y",right:"x",bottom:"y",left:"x"})}function xi(t){return $v(t,["topLeft","topRight","bottomLeft","bottomRight"])}function dn(t){const e=$C(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Lt(t,e){t=t||{},e=e||Dt.font;let n=Je(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Je(t.style,e.style);s&&!(""+s).match(DC)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Je(t.family,e.family),lineHeight:TC(Je(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Je(t.weight,e.weight),string:""};return r.string=SC(r),r}function Ga(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function FC(t,e,n){const{min:s,max:r}=t,i=Pv(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function Hr(t,e){return Object.assign(Object.create(t),e)}function ff(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=jv("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>ff([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return Lv(a,l,()=>WC(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return jp(a).includes(l)},ownKeys(a){return jp(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function Di(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Fv(t,s),setContext:i=>Di(t,i,n,s),override:i=>Di(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return Lv(i,o,()=>BC(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function Fv(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:wn(n)?n:()=>n,isIndexable:wn(s)?s:()=>s}}const LC=(t,e)=>t?t+of(e):e,hf=(t,e)=>Ze(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Lv(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function BC(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return wn(a)&&o.isScriptable(e)&&(a=jC(e,a,t,n)),Ct(a)&&a.length&&(a=NC(e,a,t,o.isIndexable)),hf(e,a)&&(a=Di(a,r,i&&i[e],o)),a}function jC(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),hf(t,l)&&(l=pf(r._scopes,r,t,l)),l}function NC(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(Ze(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const f=pf(c,r,t,u);e.push(Di(f,i,o&&o[t],a))}}return e}function Bv(t,e,n){return wn(t)?t(e,n):t}const zC=(t,e)=>t===!0?e:typeof t=="string"?Qo(e,t):void 0;function qC(t,e,n,s,r){for(const i of e){const o=zC(n,i);if(o){t.add(o);const a=Bv(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function pf(t,e,n,s){const r=e._rootScopes,i=Bv(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=Bp(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=Bp(a,o,i,l,s),l===null)?!1:ff(Array.from(a),[""],r,i,()=>UC(e,n,s))}function Bp(t,e,n,s,r){for(;n;)n=qC(t,e,n,s,r);return n}function UC(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Ct(r)&&Ze(n)?n:r||{}}function WC(t,e,n,s){let r;for(const i of e)if(r=jv(LC(i,t),n),typeof r<"u")return hf(t,r)?pf(n,s,t,r):r}function jv(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function jp(t){let e=t._keys;return e||(e=t._keys=VC(t._scopes)),e}function VC(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const HC=Number.EPSILON||1e-14,Ti=(t,e)=>e<t.length&&!t[e].skip&&t[e],Nv=t=>t==="x"?"y":"x";function KC(t,e,n,s){const r=t.skip?e:t,i=e,o=n.skip?e:n,a=Oi(i,r),l=Oi(o,i);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const f=s*c,p=s*u;return{previous:{x:i.x-f*(o.x-r.x),y:i.y-f*(o.y-r.y)},next:{x:i.x+p*(o.x-r.x),y:i.y+p*(o.y-r.y)}}}function YC(t,e,n){const s=t.length;let r,i,o,a,l,c=Ti(t,0);for(let u=0;u<s-1;++u)if(l=c,c=Ti(t,u+1),!(!l||!c)){if(To(e[u],0,HC)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],i=n[u+1]/e[u],a=Math.pow(r,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[u]=r*o*e[u],n[u+1]=i*o*e[u])}}function GC(t,e,n="x"){const s=Nv(n),r=t.length;let i,o,a,l=Ti(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=Ti(t,c+1),!a)continue;const u=a[n],f=a[s];o&&(i=(u-o[n])/3,a[`cp1${n}`]=u-i,a[`cp1${s}`]=f-i*e[c]),l&&(i=(l[n]-u)/3,a[`cp2${n}`]=u+i,a[`cp2${s}`]=f+i*e[c])}}function XC(t,e="x"){const n=Nv(e),s=t.length,r=Array(s).fill(0),i=Array(s);let o,a,l,c=Ti(t,0);for(o=0;o<s;++o)if(a=l,l=c,c=Ti(t,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[n]-l[n])/u:0}i[o]=a?c?Mi(r[o-1])!==Mi(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}YC(t,r,i),GC(t,i,e)}function Xa(t,e,n){return Math.max(Math.min(t,n),e)}function QC(t,e){let n,s,r,i,o,a=Jo(t[0],e);for(n=0,s=t.length;n<s;++n)o=i,i=a,a=n<s-1&&Jo(t[n+1],e),i&&(r=t[n],o&&(r.cp1x=Xa(r.cp1x,e.left,e.right),r.cp1y=Xa(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=Xa(r.cp2x,e.left,e.right),r.cp2y=Xa(r.cp2y,e.top,e.bottom)))}function JC(t,e,n,s,r){let i,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")XC(t,r);else{let c=s?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)a=t[i],l=KC(c,a,t[Math.min(i+1,o-(s?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&QC(t,n)}function gf(){return typeof window<"u"&&typeof document<"u"}function mf(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function ql(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const hc=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function ZC(t,e){return hc(t).getPropertyValue(e)}const eS=["top","right","bottom","left"];function zr(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=eS[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const tS=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function nS(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(tS(r,i,t.target))a=r,l=i;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Or(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=hc(n),i=r.boxSizing==="border-box",o=zr(r,"padding"),a=zr(r,"border","width"),{x:l,y:c,box:u}=nS(t,n),f=o.left+(u&&a.left),p=o.top+(u&&a.top);let{width:g,height:v}=e;return i&&(g-=o.width+a.width,v-=o.height+a.height),{x:Math.round((l-f)/g*n.width/s),y:Math.round((c-p)/v*n.height/s)}}function sS(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&mf(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=hc(i),l=zr(a,"border","width"),c=zr(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,s=ql(a.maxWidth,i,"clientWidth"),r=ql(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||Bl,maxHeight:r||Bl}}const Qa=t=>Math.round(t*10)/10;function rS(t,e,n,s){const r=hc(t),i=zr(r,"margin"),o=ql(r.maxWidth,t,"clientWidth")||Bl,a=ql(r.maxHeight,t,"clientHeight")||Bl,l=sS(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const p=zr(r,"border","width"),g=zr(r,"padding");c-=g.width+p.width,u-=g.height+p.height}return c=Math.max(0,c-i.width),u=Math.max(0,s?c/s:u-i.height),c=Qa(Math.min(c,o,l.maxWidth)),u=Qa(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Qa(c/2)),(e!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=Qa(Math.floor(u*s))),{width:c,height:u}}function Np(t,e,n){const s=e||1,r=Math.floor(t.height*s),i=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const iS=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};gf()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function zp(t,e){const n=ZC(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Dr(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function oS(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function aS(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},o=Dr(t,r,n),a=Dr(r,i,n),l=Dr(i,e,n),c=Dr(o,a,n),u=Dr(a,l,n);return Dr(c,u,n)}const lS=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},cS=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function ki(t,e,n){return t?lS(e,n):cS()}function zv(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function qv(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Uv(t){return t==="angle"?{between:Nl,compare:oC,normalize:rs}:{between:gi,compare:(e,n)=>e-n,normalize:e=>e}}function qp({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function uS(t,e,n){const{property:s,start:r,end:i}=n,{between:o,normalize:a}=Uv(s),l=e.length;let{start:c,end:u,loop:f}=t,p,g;if(f){for(c+=l,u+=l,p=0,g=l;p<g&&o(a(e[c%l][s]),r,i);++p)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:f,style:t.style}}function Wv(t,e,n){if(!n)return[t];const{property:s,start:r,end:i}=n,o=e.length,{compare:a,between:l,normalize:c}=Uv(s),{start:u,end:f,loop:p,style:g}=uS(t,e,n),v=[];let w=!1,x=null,k,S,E;const D=()=>l(r,E,k)&&a(r,E)!==0,T=()=>a(i,k)===0||l(i,E,k),P=()=>w||D(),A=()=>!w||T();for(let $=u,I=u;$<=f;++$)S=e[$%o],!S.skip&&(k=c(S[s]),k!==E&&(w=l(k,r,i),x===null&&P()&&(x=a(k,r)===0?$:I),x!==null&&A()&&(v.push(qp({start:x,end:$,loop:p,count:o,style:g})),x=null),I=$,E=k));return x!==null&&v.push(qp({start:x,end:f,loop:p,count:o,style:g})),v}function Vv(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const i=Wv(s[r],t.points,e);i.length&&n.push(...i)}return n}function dS(t,e,n,s){let r=0,i=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(i+=r);i>r&&t[i%e].skip;)i--;return i%=e,{start:r,end:i}}function fS(t,e,n,s){const r=t.length,i=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%r];c.skip||c.stop?a.skip||(s=!1,i.push({start:e%r,end:(l-1)%r,loop:s}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&i.push({start:e%r,end:o%r,loop:s}),i}function hS(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const i=!!t._loop,{start:o,end:a}=dS(n,r,i,s);if(s===!0)return Up(t,[{start:o,end:a,loop:i}],n,e);const l=a<o?a+r:a,c=!!t._fullLoop&&o===0&&a===r-1;return Up(t,fS(n,o,l,c),n,e)}function Up(t,e,n,s){return!s||!s.setContext||!n?e:pS(t,e,n,s)}function pS(t,e,n,s){const r=t._chart.getContext(),i=Wp(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let u=i,f=e[0].start,p=f;function g(v,w,x,k){const S=a?-1:1;if(v!==w){for(v+=l;n[v%l].skip;)v-=S;for(;n[w%l].skip;)w+=S;v%l!==w%l&&(c.push({start:v%l,end:w%l,loop:x,style:k}),u=k,f=w%l)}}for(const v of e){f=a?f:v.start;let w=n[f%l],x;for(p=f+1;p<=v.end;p++){const k=n[p%l];x=Wp(s.setContext(Hr(r,{type:"segment",p0:w,p1:k,p0DataIndex:(p-1)%l,p1DataIndex:p%l,datasetIndex:o}))),gS(x,u)&&g(f,p-1,v.loop,u),w=k,u=x}f<p-1&&g(f,p-1,v.loop,u)}return c}function Wp(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function gS(t,e){if(!e)return!1;const n=[],s=function(r,i){return uf(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function Ja(t,e,n){return t.options.clip?t[n]:e[n]}function mS(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Ja(n,e,"left"),right:Ja(n,e,"right"),top:Ja(s,e,"top"),bottom:Ja(s,e,"bottom")}:e}function Hv(t,e){const n=e._clip;if(n.disabled)return!1;const s=mS(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class yS{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Ov.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ws=new yS;const Vp="transparent",vS={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=Rp(t||Vp),r=s.valid&&Rp(e||Vp);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class bS{constructor(e,n,s,r){const i=n[s];r=Ga([e.to,r,i,e.from]);const o=Ga([e.from,i,r]);this._active=!0,this._fn=e.fn||vS[e.type||typeof o],this._easing=Ro[e.easing]||Ro.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Ga([e.to,n,r,e.from]),this._from=Ga([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class yf{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Ze(e))return;const n=Object.keys(Dt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!Ze(i))return;const o={};for(const a of n)o[a]=i[a];(Ct(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=wS(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&_S(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let f=i[c];const p=s.get(c);if(f)if(p&&f.active()){f.update(p,u,a);continue}else f.cancel();if(!p||!p.duration){e[c]=u;continue}i[c]=f=new bS(p,e,c,u),r.push(f)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return ws.add(this._chart,s),!0}}function _S(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function wS(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Hp(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function xS(t,e,n){if(n===!1)return!1;const s=Hp(t,n),r=Hp(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function kS(t){let e,n,s,r;return Ze(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function Kv(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function Kp(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(u=!0,s.all)continue;break}c=t.values[l],Yt(c)&&(i||e===0||Mi(e)===Mi(c))&&(e+=c)}return!u&&!s.all?0:e}function CS(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[i]:t[u]};return a}function _u(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function SS(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function PS(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function AS(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function Yp(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function Gp(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,c=o.axis,u=SS(i,o,s),f=e.length;let p;for(let g=0;g<f;++g){const v=e[g],{[l]:w,[c]:x}=v,k=v._stacks||(v._stacks={});p=k[c]=AS(r,u,w),p[a]=x,p._top=Yp(p,o,!0,s.type),p._bottom=Yp(p,o,!1,s.type);const S=p._visualValues||(p._visualValues={});S[a]=x}}function wu(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function IS(t,e){return Hr(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ES(t,e,n){return Hr(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function eo(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const xu=t=>t==="reset"||t==="none",Xp=(t,e)=>e?t:Object.assign({},t),MS=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Kv(n,!0),values:null};class vf{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=_u(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&eo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(f,p,g,v)=>f==="x"?p:f==="r"?v:g,i=n.xAxisID=Je(s.xAxisID,wu(e,"x")),o=n.yAxisID=Je(s.yAxisID,wu(e,"y")),a=n.rAxisID=Je(s.rAxisID,wu(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,i,o,a),u=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Op(this._data,this),e._stacked&&eo(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Ze(n)){const r=this._cachedMeta;this._data=CS(n,r)}else if(s!==n){if(s){Op(s,this);const r=this._cachedMeta;eo(r),r._parsed=[]}n&&Object.isExtensible(n)&&uC(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=_u(n.vScale,n),n.stack!==s.stack&&(r=!0,eo(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(Gp(this,n._parsed),n._stacked=_u(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,c=e>0&&s._parsed[e-1],u,f,p;if(this._parsing===!1)s._parsed=r,s._sorted=!0,p=r;else{Ct(r[e])?p=this.parseArrayData(s,r,e,n):Ze(r[e])?p=this.parseObjectData(s,r,e,n):p=this.parsePrimitiveData(s,r,e,n);const g=()=>f[a]===null||c&&f[a]<c[a];for(u=0;u<n;++u)s._parsed[u+e]=f=p[u],l&&(g()&&(l=!1),c=f);s._sorted=l}o&&Gp(this,p)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,f=new Array(r);let p,g,v;for(p=0,g=r;p<g;++p)v=p+s,f[p]={[a]:u||i.parse(c[v],v),[l]:o.parse(n[v],v)};return f}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,c,u,f;for(l=0,c=r;l<c;++l)u=l+s,f=n[u],a[l]={x:i.parse(f[0],u),y:o.parse(f[1],u)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,f,p,g;for(u=0,f=r;u<f;++u)p=u+s,g=n[p],c[u]={x:i.parse(Qo(g,a),p),y:o.parse(Qo(g,l),p)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:Kv(r,!0),values:n._stacks[e.axis]._visualValues};return Kp(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=Kp(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=MS(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:f}=PS(a);let p,g;function v(){g=r[p];const w=g[a.axis];return!Yt(g[e.axis])||u>w||f<w}for(p=0;p<o&&!(!v()&&(this.updateRangeFromParsed(c,e,g,l),i));++p);if(i){for(p=o-1;p>=0;--p)if(!v()){this.updateRangeFromParsed(c,e,g,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Yt(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=kS(Je(this.options.clip,xS(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,i,a,l),u=a;u<a+l;++u){const f=r[u];f.hidden||(f.active&&c?o.push(f):f.draw(e,i))}for(u=0;u<o.length;++u)o[u].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=ES(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=IS(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&Dn(s);if(a)return Xp(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),f=r?[`${e}Hover`,"hover",e,""]:[e,""],p=c.getOptionScopes(this.getDataset(),u),g=Object.keys(Dt.elements[e]),v=()=>this.getContext(s,r,n),w=c.resolveNamedOptions(p,g,v,f);return w.$shared&&(w.$shared=l,i[o]=Object.freeze(Xp(w,l))),w}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,f=u.datasetAnimationScopeKeys(this._type,n),p=u.getOptionScopes(this.getDataset(),f);l=u.createResolver(p,this.getContext(e,s,n))}const c=new yf(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||xu(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){xu(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!xu(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&eo(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function OS(t,e,n){let s=1,r=1,i=0,o=0;if(e<Wt){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),f=Math.cos(l),p=Math.sin(l),g=(E,D,T)=>Nl(E,a,l,!0)?1:Math.max(D,D*n,T,T*n),v=(E,D,T)=>Nl(E,a,l,!0)?-1:Math.min(D,D*n,T,T*n),w=g(0,c,f),x=g(Zt,u,p),k=v(ut,c,f),S=v(ut+Zt,u,p);s=(w-k)/2,r=(x-S)/2,i=-(w+k)/2,o=-(x+S)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class DS extends vf{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(Ze(s[e])){const{key:l="value"}=this._parsing;i=c=>+Qo(s[c],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return Vt(this.options.rotation-90)}_getCircumference(){return Vt(this.options.circumference)}_getRotationExtents(){let e=Wt,n=-Wt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(Gk(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:f}=this._getRotationExtents(),{ratioX:p,ratioY:g,offsetX:v,offsetY:w}=OS(f,u,l),x=(s.width-o)/p,k=(s.height-o)/g,S=Math.max(Math.min(x,k)/2,0),E=Pv(this.options.radius,S),D=Math.max(E*l,0),T=(E-D)/this._getVisibleDatasetWeightTotal();this.offsetX=v*E,this.offsetY=w*E,r.total=this.calculateTotal(),this.outerRadius=E-T*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-T*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/Wt)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,f=(a.top+a.bottom)/2,p=i&&c.animateScale,g=p?0:this.innerRadius,v=p?0:this.outerRadius,{sharedOptions:w,includeOptions:x}=this._getSharedOptions(n,r);let k=this._getRotation(),S;for(S=0;S<n;++S)k+=this._circumference(S,i);for(S=n;S<n+s;++S){const E=this._circumference(S,i),D=e[S],T={x:u+this.offsetX,y:f+this.offsetY,startAngle:k,endAngle:k+E,circumference:E,outerRadius:v,innerRadius:g};x&&(T.options=w||this.resolveDataElementOptions(S,D.active?"active":r)),k+=E,this.updateElement(D,S,T,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Wt*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=df(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Je(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class TS extends vf{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=pC(n,r,o);this._drawStart=a,this._drawCount=l,gC(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:f}=this._getSharedOptions(n,r),p=o.axis,g=a.axis,{spanGaps:v,segment:w}=this.options,x=qr(v)?v:Number.POSITIVE_INFINITY,k=this.chart._animationsDisabled||i||r==="none",S=n+s,E=e.length;let D=n>0&&this.getParsed(n-1);for(let T=0;T<E;++T){const P=e[T],A=k?P:{};if(T<n||T>=S){A.skip=!0;continue}const $=this.getParsed(T),I=_t($[g]),Y=A[p]=o.getPixelForValue($[p],T),U=A[g]=i||I?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,$,l):$[g],T);A.skip=isNaN(Y)||isNaN(U)||I,A.stop=T>0&&Math.abs($[p]-D[p])>x,w&&(A.parsed=$,A.raw=c.data[T]),f&&(A.options=u||this.resolveDataElementOptions(T,P.active?"active":r)),k||this.updateElement(P,T,A,r),D=$}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function _r(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class bf{static override(e){Object.assign(bf.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return _r()}parse(){return _r()}format(){return _r()}add(){return _r()}diff(){return _r()}startOf(){return _r()}endOf(){return _r()}}var RS={_date:bf};function $S(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const c=a._reversePixels?lC:Fr;if(s){if(r._sharedOptions){const u=i[0],f=typeof u.getRange=="function"&&u.getRange(e);if(f){const p=c(i,e,n-f),g=c(i,e,n+f);return{lo:p.lo,hi:g.hi}}}}else{const u=c(i,e,n);if(l){const{vScale:f}=r._cachedMeta,{_parsed:p}=t,g=p.slice(0,u.lo+1).reverse().findIndex(w=>!_t(w[f.axis]));u.lo-=Math.max(0,g);const v=p.slice(u.hi).findIndex(w=>!_t(w[f.axis]));u.hi+=Math.max(0,v)}return u}}return{lo:0,hi:i.length-1}}function pc(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:f,hi:p}=$S(i[a],e,o,r);for(let g=f;g<=p;++g){const v=u[g];v.skip||s(v,c,g)}}}function FS(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function ku(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||pc(t,n,e,function(a,l,c){!r&&!Jo(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function LS(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],s),{angle:f}=pd(o,{x:e.x,y:e.y});Nl(f,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return pc(t,n,e,i),r}function BS(t,e,n,s,r,i){let o=[];const a=FS(n);let l=Number.POSITIVE_INFINITY;function c(u,f,p){const g=u.inRange(e.x,e.y,r);if(s&&!g)return;const v=u.getCenterPoint(r);if(!(!!i||t.isPointInArea(v))&&!g)return;const x=a(e,v);x<l?(o=[{element:u,datasetIndex:f,index:p}],l=x):x===l&&o.push({element:u,datasetIndex:f,index:p})}return pc(t,n,e,c),o}function Cu(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?LS(t,e,n,r):BS(t,e,n,s,r,i)}function Qp(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return pc(t,n,e,(l,c,u)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var jS={modes:{index(t,e,n,s){const r=Or(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?ku(t,r,i,s,o):Cu(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,f=c.data[u];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,s){const r=Or(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?ku(t,r,i,s,o):Cu(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,s){const r=Or(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return ku(t,r,i,s,o)},nearest(t,e,n,s){const r=Or(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Cu(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Or(e,t);return Qp(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Or(e,t);return Qp(t,r,"y",n.intersect,s)}}};const Yv=["left","top","right","bottom"];function to(t,e){return t.filter(n=>n.pos===e)}function Jp(t,e){return t.filter(n=>Yv.indexOf(n.pos)===-1&&n.box.axis===e)}function no(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function NS(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function zS(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!Yv.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function qS(t,e){const n=zS(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&e.availableHeight)}return n}function US(t){const e=NS(t),n=no(e.filter(c=>c.box.fullSize),!0),s=no(to(e,"left"),!0),r=no(to(e,"right")),i=no(to(e,"top"),!0),o=no(to(e,"bottom")),a=Jp(e,"x"),l=Jp(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:to(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function Zp(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function Gv(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function WS(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!Ze(r)){n.size&&(t[r]-=n.size);const f=s[n.stack]||{size:0,count:1};f.size=Math.max(f.size,n.horizontal?i.height:i.width),n.size=f.size/f.count,t[r]+=n.size}i.getPadding&&Gv(o,i.getPadding());const a=Math.max(0,e.outerWidth-Zp(o,t,"left","right")),l=Math.max(0,e.outerHeight-Zp(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function VS(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function HS(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function go(t,e,n,s){const r=[];let i,o,a,l,c,u;for(i=0,o=t.length,c=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,HS(a.horizontal,e));const{same:f,other:p}=WS(e,n,a,s);c|=f&&r.length,u=u||p,l.fullSize||r.push(a)}return c&&go(r,e,n,s)||u}function Za(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function eg(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,c=s[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const f=e.w*u,p=c.size||l.height;Dn(c.start)&&(o=c.start),l.fullSize?Za(l,r.left,o,n.outerWidth-r.right-r.left,p):Za(l,e.left+c.placed,o,f,p),c.start=o,c.placed+=f,o=l.bottom}else{const f=e.h*u,p=c.size||l.width;Dn(c.start)&&(i=c.start),l.fullSize?Za(l,i,r.top,p,n.outerHeight-r.bottom-r.top):Za(l,i,e.top+c.placed,p,f),c.start=i,c.placed+=f,i=l.right}}e.x=i,e.y=o}var Nn={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=dn(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=US(t.boxes),l=a.vertical,c=a.horizontal;ht(t.boxes,w=>{typeof w.beforeLayout=="function"&&w.beforeLayout()});const u=l.reduce((w,x)=>x.box.options&&x.box.options.display===!1?w:w+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),p=Object.assign({},r);Gv(p,dn(s));const g=Object.assign({maxPadding:p,w:i,h:o,x:r.left,y:r.top},r),v=qS(l.concat(c),f);go(a.fullSize,g,f,v),go(l,g,f,v),go(c,g,f,v)&&go(l,g,f,v),VS(g),eg(a.leftAndTop,g,f,v),g.x+=g.w,g.y+=g.h,eg(a.rightAndBottom,g,f,v),t.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},ht(a.chartArea,w=>{const x=w.box;Object.assign(x,t.chartArea),x.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class Xv{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class KS extends Xv{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const vl="$chartjs",YS={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},tg=t=>t===null||t==="";function GS(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[vl]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",tg(r)){const i=zp(t,"width");i!==void 0&&(t.width=i)}if(tg(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=zp(t,"height");i!==void 0&&(t.height=i)}return t}const Qv=iS?{passive:!0}:!1;function XS(t,e,n){t&&t.addEventListener(e,n,Qv)}function QS(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Qv)}function JS(t,e){const n=YS[t.type]||t.type,{x:s,y:r}=Or(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Ul(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function ZS(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ul(a.addedNodes,s),o=o&&!Ul(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function eP(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ul(a.removedNodes,s),o=o&&!Ul(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const ea=new Map;let ng=0;function Jv(){const t=window.devicePixelRatio;t!==ng&&(ng=t,ea.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function tP(t,e){ea.size||window.addEventListener("resize",Jv),ea.set(t,e)}function nP(t){ea.delete(t),ea.size||window.removeEventListener("resize",Jv)}function sP(t,e,n){const s=t.canvas,r=s&&mf(s);if(!r)return;const i=Dv((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(r),tP(t,i),o}function Su(t,e,n){n&&n.disconnect(),e==="resize"&&nP(t)}function rP(t,e,n){const s=t.canvas,r=Dv(i=>{t.ctx!==null&&n(JS(i,t))},t);return XS(s,e,r),r}class iP extends Xv{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(GS(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[vl])return!1;const s=n[vl].initial;["height","width"].forEach(i=>{const o=s[i];_t(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[vl],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:ZS,detach:eP,resize:sP}[n]||rP;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Su,detach:Su,resize:Su}[n]||QS)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return rS(e,n,s,r)}isAttached(e){const n=e&&mf(e);return!!(n&&n.isConnected)}}function oP(t){return!gf()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?KS:iP}let kn=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return qr(this.x)&&qr(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}};function aP(t,e){const n=t.options.ticks,s=lP(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?uP(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>r)return dP(e,c,i,o/r),c;const u=cP(i,e,r);if(o>0){let f,p;const g=o>1?Math.round((l-a)/(o-1)):null;for(el(e,c,u,_t(g)?0:a-g,a),f=0,p=o-1;f<p;f++)el(e,c,u,i[f],i[f+1]);return el(e,c,u,l,_t(g)?e.length:l+g),c}return el(e,c,u),c}function lP(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function cP(t,e,n){const s=fP(t),r=e.length/n;if(!s)return Math.max(r,1);const i=nC(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function uP(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function dP(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function el(t,e,n,s,r){const i=Je(s,0),o=Math.min(Je(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=i;u<0;)a++,u=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(i+a*n))}function fP(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const hP=t=>t==="left"?"right":t==="right"?"left":t,sg=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,rg=(t,e)=>Math.min(e||t,t);function ig(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function pP(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-i,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<i-a||l>o+a)))return l}function gP(t,e){ht(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function so(t){return t.drawTicks?t.tickLength:0}function og(t,e){if(!t.display)return 0;const n=Lt(t.font,e),s=dn(t.padding);return(Ct(t.text)?t.text.length:1)*n.lineHeight+s.height}function mP(t,e){return Hr(t,{scale:e,type:"scale"})}function yP(t,e,n){return Hr(t,{tick:n,index:e,type:"tick"})}function vP(t,e,n){let s=cf(t);return(n&&e!=="right"||!n&&e==="right")&&(s=hP(s)),s}function bP(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let f=0,p,g,v;const w=o-r,x=a-i;if(t.isHorizontal()){if(g=rn(s,i,a),Ze(n)){const k=Object.keys(n)[0],S=n[k];v=u[k].getPixelForValue(S)+w-e}else n==="center"?v=(c.bottom+c.top)/2+w-e:v=sg(t,n,e);p=a-i}else{if(Ze(n)){const k=Object.keys(n)[0],S=n[k];g=u[k].getPixelForValue(S)-x+e}else n==="center"?g=(c.left+c.right)/2-x+e:g=sg(t,n,e);v=rn(s,o,r),f=n==="left"?-Zt:Zt}return{titleX:g,titleY:v,maxWidth:p,rotation:f}}class Li extends kn{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=Zn(e,Number.POSITIVE_INFINITY),n=Zn(n,Number.NEGATIVE_INFINITY),s=Zn(s,Number.POSITIVE_INFINITY),r=Zn(r,Number.NEGATIVE_INFINITY),{min:Zn(e,s),max:Zn(n,r),minDefined:Yt(e),maxDefined:Yt(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:Zn(n,Zn(s,n)),max:Zn(s,Zn(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){pt(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=FC(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?ig(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=aP(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){pt(this.options.afterUpdate,[this])}beforeSetDimensions(){pt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){pt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),pt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){pt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=pt(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){pt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){pt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=rg(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),f=u.widest.width,p=u.highest.height,g=jn(this.chart.width-f,0,this.maxWidth);a=e.offset?this.maxWidth/s:g/(s-1),f+6>a&&(a=g/(s-(e.offset?.5:1)),l=this.maxHeight-so(e.grid)-n.padding-og(e.title,this.chart.options.font),c=Math.sqrt(f*f+p*p),o=Ev(Math.min(Math.asin(jn((u.highest.height+6)/a,-1,1)),Math.asin(jn(l/c,-1,1))-Math.asin(jn(p/c,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){pt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){pt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=og(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=so(i)+l):(e.height=this.maxHeight,e.width=so(i)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:f,highest:p}=this._getLabelSizes(),g=s.padding*2,v=Vt(this.labelRotation),w=Math.cos(v),x=Math.sin(v);if(a){const k=s.mirror?0:x*f.width+w*p.height;e.height=Math.min(this.maxHeight,e.height+k+g)}else{const k=s.mirror?0:w*f.width+x*p.height;e.width=Math.min(this.maxWidth,e.width+k+g)}this._calculatePadding(c,u,x,w)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,g=0;l?c?(p=r*e.width,g=s*n.height):(p=s*e.height,g=r*n.width):i==="start"?g=n.width:i==="end"?p=e.width:i!=="inner"&&(p=e.width/2,g=n.width/2),this.paddingLeft=Math.max((p-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((g-f+o)*this.width/(this.width-f),0)}else{let u=n.height/2,f=e.height/2;i==="start"?(u=0,f=e.height):i==="end"&&(u=n.height,f=0),this.paddingTop=u+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){pt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)_t(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=ig(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/rg(n,s));let c=0,u=0,f,p,g,v,w,x,k,S,E,D,T;for(f=0;f<n;f+=l){if(v=e[f].label,w=this._resolveTickFontOptions(f),r.font=x=w.string,k=i[x]=i[x]||{data:{},gc:[]},S=w.lineHeight,E=D=0,!_t(v)&&!Ct(v))E=Fp(r,k.data,k.gc,E,v),D=S;else if(Ct(v))for(p=0,g=v.length;p<g;++p)T=v[p],!_t(T)&&!Ct(T)&&(E=Fp(r,k.data,k.gc,E,T),D+=S);o.push(E),a.push(D),c=Math.max(E,c),u=Math.max(D,u)}gP(i,n);const P=o.indexOf(c),A=a.indexOf(u),$=I=>({width:o[I]||0,height:a[I]||0});return{first:$(0),last:$(n-1),widest:$(P),highest:$(A),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return aC(this._alignToPixels?br(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=yP(this.getContext(),e,s))}return this.$context||(this.$context=mP(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Vt(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),p=so(i),g=[],v=a.setContext(this.getContext()),w=v.display?v.width:0,x=w/2,k=function(_e){return br(s,_e,w)};let S,E,D,T,P,A,$,I,Y,U,z,pe;if(o==="top")S=k(this.bottom),A=this.bottom-p,I=S-x,U=k(e.top)+x,pe=e.bottom;else if(o==="bottom")S=k(this.top),U=e.top,pe=k(e.bottom)-x,A=S+x,I=this.top+p;else if(o==="left")S=k(this.right),P=this.right-p,$=S-x,Y=k(e.left)+x,z=e.right;else if(o==="right")S=k(this.left),Y=e.left,z=k(e.right)-x,P=S+x,$=this.left+p;else if(n==="x"){if(o==="center")S=k((e.top+e.bottom)/2+.5);else if(Ze(o)){const _e=Object.keys(o)[0],ke=o[_e];S=k(this.chart.scales[_e].getPixelForValue(ke))}U=e.top,pe=e.bottom,A=S+x,I=A+p}else if(n==="y"){if(o==="center")S=k((e.left+e.right)/2);else if(Ze(o)){const _e=Object.keys(o)[0],ke=o[_e];S=k(this.chart.scales[_e].getPixelForValue(ke))}P=S-x,$=P-p,Y=e.left,z=e.right}const ye=Je(r.ticks.maxTicksLimit,f),ue=Math.max(1,Math.ceil(f/ye));for(E=0;E<f;E+=ue){const _e=this.getContext(E),ke=i.setContext(_e),Z=a.setContext(_e),ne=ke.lineWidth,X=ke.color,Le=Z.dash||[],Se=Z.dashOffset,Ve=ke.tickWidth,wt=ke.tickColor,gt=ke.tickBorderDash||[],it=ke.tickBorderDashOffset;D=pP(this,E,l),D!==void 0&&(T=br(s,D,ne),c?P=$=Y=z=T:A=I=U=pe=T,g.push({tx1:P,ty1:A,tx2:$,ty2:I,x1:Y,y1:U,x2:z,y2:pe,width:ne,color:X,borderDash:Le,borderDashOffset:Se,tickWidth:Ve,tickColor:wt,tickBorderDash:gt,tickBorderDashOffset:it}))}return this._ticksLength=f,this._borderValue=S,g}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:f}=i,p=so(s.grid),g=p+u,v=f?-u:g,w=-Vt(this.labelRotation),x=[];let k,S,E,D,T,P,A,$,I,Y,U,z,pe="middle";if(r==="top")P=this.bottom-v,A=this._getXAxisLabelAlignment();else if(r==="bottom")P=this.top+v,A=this._getXAxisLabelAlignment();else if(r==="left"){const ue=this._getYAxisLabelAlignment(p);A=ue.textAlign,T=ue.x}else if(r==="right"){const ue=this._getYAxisLabelAlignment(p);A=ue.textAlign,T=ue.x}else if(n==="x"){if(r==="center")P=(e.top+e.bottom)/2+g;else if(Ze(r)){const ue=Object.keys(r)[0],_e=r[ue];P=this.chart.scales[ue].getPixelForValue(_e)+g}A=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")T=(e.left+e.right)/2-g;else if(Ze(r)){const ue=Object.keys(r)[0],_e=r[ue];T=this.chart.scales[ue].getPixelForValue(_e)}A=this._getYAxisLabelAlignment(p).textAlign}n==="y"&&(l==="start"?pe="top":l==="end"&&(pe="bottom"));const ye=this._getLabelSizes();for(k=0,S=a.length;k<S;++k){E=a[k],D=E.label;const ue=i.setContext(this.getContext(k));$=this.getPixelForTick(k)+i.labelOffset,I=this._resolveTickFontOptions(k),Y=I.lineHeight,U=Ct(D)?D.length:1;const _e=U/2,ke=ue.color,Z=ue.textStrokeColor,ne=ue.textStrokeWidth;let X=A;o?(T=$,A==="inner"&&(k===S-1?X=this.options.reverse?"left":"right":k===0?X=this.options.reverse?"right":"left":X="center"),r==="top"?c==="near"||w!==0?z=-U*Y+Y/2:c==="center"?z=-ye.highest.height/2-_e*Y+Y:z=-ye.highest.height+Y/2:c==="near"||w!==0?z=Y/2:c==="center"?z=ye.highest.height/2-_e*Y:z=ye.highest.height-U*Y,f&&(z*=-1),w!==0&&!ue.showLabelBackdrop&&(T+=Y/2*Math.sin(w))):(P=$,z=(1-U)*Y/2);let Le;if(ue.showLabelBackdrop){const Se=dn(ue.backdropPadding),Ve=ye.heights[k],wt=ye.widths[k];let gt=z-Se.top,it=0-Se.left;switch(pe){case"middle":gt-=Ve/2;break;case"bottom":gt-=Ve;break}switch(A){case"center":it-=wt/2;break;case"right":it-=wt;break;case"inner":k===S-1?it-=wt:k>0&&(it-=wt/2);break}Le={left:it,top:gt,width:wt+Se.width,height:Ve+Se.height,color:ue.backdropColor}}x.push({label:D,font:I,textOffset:z,options:{rotation:w,color:ke,strokeColor:Z,strokeWidth:ne,textAlign:X,textBaseline:pe,translation:[T,P],backdrop:Le}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Vt(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+i,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,f,p;this.isHorizontal()?(c=br(e,this.left,o)-o/2,u=br(e,this.right,a)+a/2,f=p=l):(f=br(e,this.top,o)-o/2,p=br(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,f),n.lineTo(u,p),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&aa(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Zo(s,c,0,u,l,a)}r&&la(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=Lt(s.font),o=dn(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||Ze(n)?(l+=o.bottom,Ct(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:f,rotation:p}=bP(this,l,n,a);Zo(e,s.text,0,0,i,{color:s.color,maxWidth:f,rotation:p,textAlign:vP(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Je(e.grid&&e.grid.z,-1),r=Je(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Li.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Lt(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class tl{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;xP(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,_P(e,o,s),this.override&&Dt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Dt[r]&&(delete Dt[r][s],this.override&&delete Ur[s])}}function _P(t,e,n){const s=Xo(Object.create(null),[n?Dt.get(n):{},Dt.get(e),t.defaults]);Dt.set(e,s),t.defaultRoutes&&wP(e,t.defaultRoutes),t.descriptors&&Dt.describe(e,t.descriptors)}function wP(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Dt.route(i,r,l,a)})}function xP(t){return"id"in t&&"defaults"in t}class kP{constructor(){this.controllers=new tl(vf,"datasets",!0),this.elements=new tl(kn,"elements"),this.plugins=new tl(Object,"plugins"),this.scales=new tl(Li,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):ht(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=of(e);pt(s["before"+r],[],s),n[e](s),pt(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var ss=new kP;class CP{constructor(){this._init=[]}notify(e,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(pt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){_t(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Je(s.options&&s.options.plugins,{}),i=SP(s);return r===!1&&!n?[]:AP(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function SP(t){const e={},n=[],s=Object.keys(ss.plugins.items);for(let i=0;i<s.length;i++)n.push(ss.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function PP(t,e){return!e&&t===!1?null:t===!0?{}:t}function AP(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,c=PP(s[l],r);c!==null&&i.push({plugin:a,options:IP(t.config,{plugin:a,local:n[l]},c,o)})}return i}function IP(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function yd(t,e){const n=Dt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function EP(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function MP(t,e){return t===e?"_index_":"_value_"}function ag(t){if(t==="x"||t==="y"||t==="r")return t}function OP(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function vd(t,...e){if(ag(t))return t;for(const n of e){const s=n.axis||OP(n.position)||t.length>1&&ag(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function lg(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function DP(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return lg(t,"x",n[0])||lg(t,"y",n[0])}return{}}function TP(t,e){const n=Ur[t.type]||{scales:{}},s=e.scales||{},r=yd(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Ze(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=vd(o,a,DP(o,t),Dt.scales[a.type]),c=MP(l,r),u=n.scales||{};i[o]=Do(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||yd(a,e),u=(Ur[a]||{}).scales||{};Object.keys(u).forEach(f=>{const p=EP(f,l),g=o[p+"AxisID"]||p;i[g]=i[g]||Object.create(null),Do(i[g],[{axis:p},s[g],u[f]])})}),Object.keys(i).forEach(o=>{const a=i[o];Do(a,[Dt.scales[a.type],Dt.scale])}),i}function Zv(t){const e=t.options||(t.options={});e.plugins=Je(e.plugins,{}),e.scales=TP(t,e)}function eb(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function RP(t){return t=t||{},t.data=eb(t.data),Zv(t),t}const cg=new Map,tb=new Set;function nl(t,e){let n=cg.get(t);return n||(n=e(),cg.set(t,n),tb.add(n)),n}const ro=(t,e,n)=>{const s=Qo(e,n);s!==void 0&&t.add(s)};class $P{constructor(e){this._config=RP(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=eb(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Zv(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return nl(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return nl(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return nl(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return nl(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(f=>ro(l,e,f))),u.forEach(f=>ro(l,r,f)),u.forEach(f=>ro(l,Ur[i]||{},f)),u.forEach(f=>ro(l,Dt,f)),u.forEach(f=>ro(l,gd,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),tb.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ur[n]||{},Dt.datasets[n]||{},{type:n},Dt,gd]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=ug(this._resolverCache,e,r);let l=o;if(LP(o,n)){i.$shared=!1,s=wn(s)?s():s;const c=this.createResolver(e,s,a);l=Di(o,s,c)}for(const c of n)i[c]=l[c];return i}createResolver(e,n,s=[""],r){const{resolver:i}=ug(this._resolverCache,e,s);return Ze(n)?Di(i,n,void 0,r):i}}function ug(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:ff(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const FP=t=>Ze(t)&&Object.getOwnPropertyNames(t).some(e=>wn(t[e]));function LP(t,e){const{isScriptable:n,isIndexable:s}=Fv(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(wn(a)||FP(a))||o&&Ct(a))return!0}return!1}var BP="4.5.0";const jP=["top","bottom","left","right","chartArea"];function dg(t,e){return t==="top"||t==="bottom"||jP.indexOf(t)===-1&&e==="x"}function fg(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function hg(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),pt(n&&n.onComplete,[t],e)}function NP(t){const e=t.chart,n=e.options.animation;pt(n&&n.onProgress,[t],e)}function nb(t){return gf()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const bl={},pg=t=>{const e=nb(t);return Object.values(bl).filter(n=>n.canvas===e).pop()};function zP(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function qP(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}let tr=class{static defaults=Dt;static instances=bl;static overrides=Ur;static registry=ss;static version=BP;static getChart=pg;static register(...e){ss.add(...e),gg()}static unregister(...e){ss.remove(...e),gg()}constructor(e,n){const s=this.config=new $P(n),r=nb(e),i=pg(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||oP(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Yk(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new CP,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=fC(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],bl[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ws.listen(this,"complete",hg),ws.listen(this,"progress",NP),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return _t(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ss}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Np(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Lp(this.canvas,this.ctx),this}stop(){return ws.stop(this),this}resize(e,n){ws.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Np(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),pt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};ht(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=vd(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),ht(i,o=>{const a=o.options,l=a.id,c=vd(l,a),u=Je(a.type,o.dtype);(a.position===void 0||dg(a.position,c)!==dg(o.dposition))&&(a.position=o.dposition),r[l]=!0;let f=null;if(l in s&&s[l].type===u)f=s[l];else{const p=ss.getScale(u);f=new p({id:l,type:u,ctx:this.ctx,chart:this}),s[f.id]=f}f.init(a,e)}),ht(r,(o,a)=>{o||delete s[a]}),ht(s,o=>{Nn.configure(this,o,o.options),Nn.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(fg("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||yd(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=ss.getController(a),{datasetElementType:c,dataElementType:u}=Dt.datasets[a];Object.assign(l,{dataElementType:ss.getElement(u),datasetElementType:c&&ss.getElement(c)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){ht(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:f}=this.getDatasetMeta(c),p=!r&&i.indexOf(f)===-1;f.buildOrUpdateElements(p),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||ht(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(fg("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){ht(this.scales,e=>{Nn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!Ip(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;zP(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!Ip(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Nn.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],ht(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,wn(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ws.has(this)?this.attached&&!ws.running(this)&&ws.start(this):(this.draw(),hg({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Hv(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&aa(n,r),e.controller.draw(),r&&la(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return Jo(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=jS.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Hr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);Dn(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),ws.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Lp(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete bl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};ht(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){ht(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},ht(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!Fl(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(f=>u.datasetIndex===f.datasetIndex&&u.index===f.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=eC(e),c=qP(e,this._lastEvent,s,l);s&&(this._lastEvent=null,pt(i.onHover,[e,a,this],this),l&&pt(i.onClick,[e,a,this],this));const u=!Fl(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}};function gg(){return ht(tr.instances,t=>t._plugins.invalidate())}function sb(t,e,n=e){t.lineCap=Je(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Je(n.borderDash,e.borderDash)),t.lineDashOffset=Je(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Je(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Je(n.borderWidth,e.borderWidth),t.strokeStyle=Je(n.borderColor,e.borderColor)}function UP(t,e,n){t.lineTo(n.x,n.y)}function WP(t){return t.stepped?PC:t.tension||t.cubicInterpolationMode==="monotone"?AC:UP}function rb(t,e,n={}){const s=t.length,{start:r=0,end:i=s-1}=n,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(i,a),u=r<o&&i<o||r>a&&i>a;return{count:s,start:l,loop:e.loop,ilen:c<l&&!u?s+c-l:c-l}}function VP(t,e,n,s){const{points:r,options:i}=e,{count:o,start:a,loop:l,ilen:c}=rb(r,n,s),u=WP(i);let{move:f=!0,reverse:p}=s||{},g,v,w;for(g=0;g<=c;++g)v=r[(a+(p?c-g:g))%o],!v.skip&&(f?(t.moveTo(v.x,v.y),f=!1):u(t,w,v,p,i.stepped),w=v);return l&&(v=r[(a+(p?c:0))%o],u(t,w,v,p,i.stepped)),!!l}function HP(t,e,n,s){const r=e.points,{count:i,start:o,ilen:a}=rb(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,f=0,p,g,v,w,x,k;const S=D=>(o+(c?a-D:D))%i,E=()=>{w!==x&&(t.lineTo(u,x),t.lineTo(u,w),t.lineTo(u,k))};for(l&&(g=r[S(0)],t.moveTo(g.x,g.y)),p=0;p<=a;++p){if(g=r[S(p)],g.skip)continue;const D=g.x,T=g.y,P=D|0;P===v?(T<w?w=T:T>x&&(x=T),u=(f*u+D)/++f):(E(),t.lineTo(D,T),v=P,f=0,w=x=T),k=T}E()}function bd(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?HP:VP}function KP(t){return t.stepped?oS:t.tension||t.cubicInterpolationMode==="monotone"?aS:Dr}function YP(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),sb(t,e.options),t.stroke(r)}function GP(t,e,n,s){const{segments:r,options:i}=e,o=bd(e);for(const a of r)sb(t,i,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const XP=typeof Path2D=="function";function QP(t,e,n,s){XP&&!e.options.segment?YP(t,e,n,s):GP(t,e,n,s)}class ca extends kn{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;JC(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=hS(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],i=this.points,o=Vv(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=KP(s);let c,u;for(c=0,u=o.length;c<u;++c){const{start:f,end:p}=o[c],g=i[f],v=i[p];if(g===v){a.push(g);continue}const w=Math.abs((r-g[n])/(v[n]-g[n])),x=l(g,v,w,s.stepped);x[n]=e[n],a.push(x)}return a.length===1?a[0]:a}pathSegment(e,n,s){return bd(this)(e,this,n,s)}path(e,n,s){const r=this.segments,i=bd(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)o&=i(e,this,a,{start:n,end:n+s-1});return!!o}draw(e,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),QP(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function mg(t,e,n,s){const r=t.options,{[n]:i}=t.getProps([n],s);return Math.abs(e-i)<r.radius+r.hitRadius}class ib extends kn{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],s);return Math.pow(e-i,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return mg(this,e,"x",n)}inYRange(e,n){return mg(this,e,"y",n)}getCenterPoint(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const s=n&&e.borderWidth||0;return(n+s)*2}draw(e,n){const s=this.options;this.skip||s.radius<.1||!Jo(this,n,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,md(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function JP(t,e,n){const s=t.segments,r=t.points,i=e.points,o=[];for(const a of s){let{start:l,end:c}=a;c=gc(l,c,r);const u=_d(n,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const f=Vv(e,u);for(const p of f){const g=_d(n,i[p.start],i[p.end],p.loop),v=Wv(a,r,g);for(const w of v)o.push({source:w,target:p,start:{[n]:yg(u,g,"start",Math.max)},end:{[n]:yg(u,g,"end",Math.min)}})}}return o}function _d(t,e,n,s){if(s)return;let r=e[t],i=n[t];return t==="angle"&&(r=rs(r),i=rs(i)),{property:t,start:r,end:i}}function ZP(t,e){const{x:n=null,y:s=null}=t||{},r=e.points,i=[];return e.segments.forEach(({start:o,end:a})=>{a=gc(o,a,r);const l=r[o],c=r[a];s!==null?(i.push({x:l.x,y:s}),i.push({x:c.x,y:s})):n!==null&&(i.push({x:n,y:l.y}),i.push({x:n,y:c.y}))}),i}function gc(t,e,n){for(;e>t;e--){const s=n[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function yg(t,e,n,s){return t&&e?s(t[n],e[n]):t?t[n]:e?e[n]:0}function ob(t,e){let n=[],s=!1;return Ct(t)?(s=!0,n=t):n=ZP(t,e),n.length?new ca({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function vg(t){return t&&t.fill!==!1}function eA(t,e,n){let r=t[e].fill;const i=[e];let o;if(!n)return r;for(;r!==!1&&i.indexOf(r)===-1;){if(!Yt(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function tA(t,e,n){const s=iA(t);if(Ze(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return Yt(r)&&Math.floor(r)===r?nA(s[0],e,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function nA(t,e,n,s){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=s?!1:n}function sA(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:Ze(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function rA(t,e,n){let s;return t==="start"?s=n:t==="end"?s=e.options.reverse?e.min:e.max:Ze(t)?s=t.value:s=e.getBaseValue(),s}function iA(t){const e=t.options,n=e.fill;let s=Je(n&&n.target,n);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function oA(t){const{scale:e,index:n,line:s}=t,r=[],i=s.segments,o=s.points,a=aA(e,n);a.push(ob({x:null,y:e.bottom},s));for(let l=0;l<i.length;l++){const c=i[l];for(let u=c.start;u<=c.end;u++)lA(r,o[u],a)}return new ca({points:r,options:{}})}function aA(t,e){const n=[],s=t.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const i=s[r];if(i.index===e)break;i.hidden||n.unshift(i.dataset)}return n}function lA(t,e,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],{first:o,last:a,point:l}=cA(i,e,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(t.push(l),!a)break}}t.push(...s)}function cA(t,e,n){const s=t.interpolate(e,n);if(!s)return{};const r=s[n],i=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<i.length;c++){const u=i[c],f=o[u.start][n],p=o[u.end][n];if(gi(r,f,p)){a=r===f,l=r===p;break}}return{first:a,last:l,point:s}}class ab{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,s){const{x:r,y:i,radius:o}=this;return n=n||{start:0,end:Wt},e.arc(r,i,o,n.end,n.start,!0),!s.bounds}interpolate(e){const{x:n,y:s,radius:r}=this,i=e.angle;return{x:n+Math.cos(i)*r,y:s+Math.sin(i)*r,angle:i}}}function uA(t){const{chart:e,fill:n,line:s}=t;if(Yt(n))return dA(e,n);if(n==="stack")return oA(t);if(n==="shape")return!0;const r=fA(t);return r instanceof ab?r:ob(r,s)}function dA(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function fA(t){return(t.scale||{}).getPointPositionForValue?pA(t):hA(t)}function hA(t){const{scale:e={},fill:n}=t,s=sA(n,e);if(Yt(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function pA(t){const{scale:e,fill:n}=t,s=e.options,r=e.getLabels().length,i=s.reverse?e.max:e.min,o=rA(n,e,i),a=[];if(s.grid.circular){const l=e.getPointPositionForValue(0,i);return new ab({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function Pu(t,e,n){const s=uA(e),{chart:r,index:i,line:o,scale:a,axis:l}=e,c=o.options,u=c.fill,f=c.backgroundColor,{above:p=f,below:g=f}=u||{},v=r.getDatasetMeta(i),w=Hv(r,v);s&&o.points.length&&(aa(t,n),gA(t,{line:o,target:s,above:p,below:g,area:n,scale:a,axis:l,clip:w}),la(t))}function gA(t,e){const{line:n,target:s,above:r,below:i,area:o,scale:a,clip:l}=e,c=n._loop?"angle":e.axis;t.save();let u=i;i!==r&&(c==="x"?(bg(t,s,o.top),Au(t,{line:n,target:s,color:r,scale:a,property:c,clip:l}),t.restore(),t.save(),bg(t,s,o.bottom)):c==="y"&&(_g(t,s,o.left),Au(t,{line:n,target:s,color:i,scale:a,property:c,clip:l}),t.restore(),t.save(),_g(t,s,o.right),u=r)),Au(t,{line:n,target:s,color:u,scale:a,property:c,clip:l}),t.restore()}function bg(t,e,n){const{segments:s,points:r}=e;let i=!0,o=!1;t.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],f=r[gc(l,c,r)];i?(t.moveTo(u.x,u.y),i=!1):(t.lineTo(u.x,n),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(f.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function _g(t,e,n){const{segments:s,points:r}=e;let i=!0,o=!1;t.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],f=r[gc(l,c,r)];i?(t.moveTo(u.x,u.y),i=!1):(t.lineTo(n,u.y),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(n,f.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function Au(t,e){const{line:n,target:s,property:r,color:i,scale:o,clip:a}=e,l=JP(n,s,r);for(const{source:c,target:u,start:f,end:p}of l){const{style:{backgroundColor:g=i}={}}=c,v=s!==!0;t.save(),t.fillStyle=g,mA(t,o,a,v&&_d(r,f,p)),t.beginPath();const w=!!n.pathSegment(t,c);let x;if(v){w?t.closePath():wg(t,s,p,r);const k=!!s.pathSegment(t,u,{move:w,reverse:!0});x=w&&k,x||wg(t,s,f,r)}t.closePath(),t.fill(x?"evenodd":"nonzero"),t.restore()}}function mA(t,e,n,s){const r=e.chart.chartArea,{property:i,start:o,end:a}=s||{};if(i==="x"||i==="y"){let l,c,u,f;i==="x"?(l=o,c=r.top,u=a,f=r.bottom):(l=r.left,c=o,u=r.right,f=a),t.beginPath(),n&&(l=Math.max(l,n.left),u=Math.min(u,n.right),c=Math.max(c,n.top),f=Math.min(f,n.bottom)),t.rect(l,c,u-l,f-c),t.clip()}}function wg(t,e,n,s){const r=e.interpolate(n,s);r&&t.lineTo(r.x,r.y)}var yA={id:"filler",afterDatasetsUpdate(t,e,n){const s=(t.data.datasets||[]).length,r=[];let i,o,a,l;for(o=0;o<s;++o)i=t.getDatasetMeta(o),a=i.dataset,l=null,a&&a.options&&a instanceof ca&&(l={visible:t.isDatasetVisible(o),index:o,fill:tA(a,o,s),chart:t,axis:i.controller.options.indexAxis,scale:i.vScale,line:a}),i.$filler=l,r.push(l);for(o=0;o<s;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=eA(r,o,n.propagate))},beforeDraw(t,e,n){const s=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),i=t.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(i,a.axis),s&&a.fill&&Pu(t.ctx,a,i))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const i=s[r].$filler;vg(i)&&Pu(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,n){const s=e.meta.$filler;!vg(s)||n.drawTime!=="beforeDatasetDraw"||Pu(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const xg=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},vA=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class kg extends kn{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=pt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Lt(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=xg(s,i);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let f=e;i.textAlign="left",i.textBaseline="middle";let p=-1,g=-u;return this.legendItems.forEach((v,w)=>{const x=s+n/2+i.measureText(v.text).width;(w===0||c[c.length-1]+x+2*a>o)&&(f+=u,c[c.length-(w>0?0:1)]=0,g+=u,p++),l[w]={left:0,top:g,row:p,width:x,height:r},c[c.length-1]+=x+a}),f}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let f=a,p=0,g=0,v=0,w=0;return this.legendItems.forEach((x,k)=>{const{itemWidth:S,itemHeight:E}=bA(s,n,i,x,r);k>0&&g+E+2*a>u&&(f+=p+a,c.push({width:p,height:g}),v+=p+a,w++,p=g=0),l[k]={left:v,top:g,col:w,width:S,height:E},p=Math.max(p,S),g+=E+a}),f+=p,c.push({width:p,height:g}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=ki(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=rn(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=rn(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=rn(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=rn(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;aa(e,this),this._draw(),la(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Dt.color,l=ki(e.rtl,this.left,this.width),c=Lt(o.font),{padding:u}=o,f=c.size,p=f/2;let g;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:v,boxHeight:w,itemHeight:x}=xg(o,f),k=function(P,A,$){if(isNaN(v)||v<=0||isNaN(w)||w<0)return;r.save();const I=Je($.lineWidth,1);if(r.fillStyle=Je($.fillStyle,a),r.lineCap=Je($.lineCap,"butt"),r.lineDashOffset=Je($.lineDashOffset,0),r.lineJoin=Je($.lineJoin,"miter"),r.lineWidth=I,r.strokeStyle=Je($.strokeStyle,a),r.setLineDash(Je($.lineDash,[])),o.usePointStyle){const Y={radius:w*Math.SQRT2/2,pointStyle:$.pointStyle,rotation:$.rotation,borderWidth:I},U=l.xPlus(P,v/2),z=A+p;Rv(r,Y,U,z,o.pointStyleWidth&&v)}else{const Y=A+Math.max((f-w)/2,0),U=l.leftForLtr(P,v),z=xi($.borderRadius);r.beginPath(),Object.values(z).some(pe=>pe!==0)?zl(r,{x:U,y:Y,w:v,h:w,radius:z}):r.rect(U,Y,v,w),r.fill(),I!==0&&r.stroke()}r.restore()},S=function(P,A,$){Zo(r,$.text,P,A+x/2,c,{strikethrough:$.hidden,textAlign:l.textAlign($.textAlign)})},E=this.isHorizontal(),D=this._computeTitleHeight();E?g={x:rn(i,this.left+u,this.right-s[0]),y:this.top+u+D,line:0}:g={x:this.left+u,y:rn(i,this.top+D+u,this.bottom-n[0].height),line:0},zv(this.ctx,e.textDirection);const T=x+u;this.legendItems.forEach((P,A)=>{r.strokeStyle=P.fontColor,r.fillStyle=P.fontColor;const $=r.measureText(P.text).width,I=l.textAlign(P.textAlign||(P.textAlign=o.textAlign)),Y=v+p+$;let U=g.x,z=g.y;l.setWidth(this.width),E?A>0&&U+Y+u>this.right&&(z=g.y+=T,g.line++,U=g.x=rn(i,this.left+u,this.right-s[g.line])):A>0&&z+T>this.bottom&&(U=g.x=U+n[g.line].width+u,g.line++,z=g.y=rn(i,this.top+D+u,this.bottom-n[g.line].height));const pe=l.x(U);if(k(pe,z,P),U=hC(I,U+v+p,E?U+Y:this.right,e.rtl),S(l.x(U),z,P),E)g.x+=Y+u;else if(typeof P.text!="string"){const ye=c.lineHeight;g.y+=lb(P,ye)+u}else g.y+=T}),qv(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Lt(n.font),r=dn(n.padding);if(!n.display)return;const i=ki(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,f=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),u=this.top+c,f=rn(e.align,f,this.right-p);else{const v=this.columnSizes.reduce((w,x)=>Math.max(w,x.height),0);u=c+rn(e.align,this.top,this.bottom-v-e.labels.padding-this._computeTitleHeight())}const g=rn(a,f,f+p);o.textAlign=i.textAlign(cf(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,Zo(o,n.text,g,u,s)}_computeTitleHeight(){const e=this.options.title,n=Lt(e.font),s=dn(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(gi(e,this.left,this.right)&&gi(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],gi(e,r.left,r.left+r.width)&&gi(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!xA(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=vA(r,s);r&&!i&&pt(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&pt(n.onHover,[e,s,this],this)}else s&&pt(n.onClick,[e,s,this],this)}}function bA(t,e,n,s,r){const i=_A(s,t,e,n),o=wA(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function _A(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function wA(t,e,n){let s=t;return typeof e.text!="string"&&(s=lb(e,n)),s}function lb(t,e){const n=t.text?t.text.length:0;return e*n}function xA(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var cb={id:"legend",_element:kg,start(t,e,n){const s=t.legend=new kg({ctx:t.ctx,options:n,chart:t});Nn.configure(t,s,n),Nn.addBox(t,s)},stop(t){Nn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Nn.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=dn(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class ub extends kn{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=Ct(s.text)?s.text.length:1;this._padding=dn(s.padding);const i=r*Lt(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:i,options:o}=this,a=o.align;let l=0,c,u,f;return this.isHorizontal()?(u=rn(a,s,i),f=n+e,c=i-s):(o.position==="left"?(u=s+e,f=rn(a,r,n),l=ut*-.5):(u=i-e,f=rn(a,n,r),l=ut*.5),c=r-n),{titleX:u,titleY:f,maxWidth:c,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=Lt(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(i);Zo(e,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:c,textAlign:cf(n.align),textBaseline:"middle",translation:[o,a]})}}function kA(t,e){const n=new ub({ctx:t.ctx,options:e,chart:t});Nn.configure(t,n,e),Nn.addBox(t,n),t.titleBlock=n}var db={id:"title",_element:ub,start(t,e,n){kA(t,n)},stop(t){const e=t.titleBlock;Nn.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;Nn.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const mo={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Oi(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function ts(t,e){return e&&(Ct(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function xs(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function CA(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function Cg(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=Lt(e.bodyFont),c=Lt(e.titleFont),u=Lt(e.footerFont),f=i.length,p=r.length,g=s.length,v=dn(e.padding);let w=v.height,x=0,k=s.reduce((D,T)=>D+T.before.length+T.lines.length+T.after.length,0);if(k+=t.beforeBody.length+t.afterBody.length,f&&(w+=f*c.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),k){const D=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;w+=g*D+(k-g)*l.lineHeight+(k-1)*e.bodySpacing}p&&(w+=e.footerMarginTop+p*u.lineHeight+(p-1)*e.footerSpacing);let S=0;const E=function(D){x=Math.max(x,n.measureText(D).width+S)};return n.save(),n.font=c.string,ht(t.title,E),n.font=l.string,ht(t.beforeBody.concat(t.afterBody),E),S=e.displayColors?o+2+e.boxPadding:0,ht(s,D=>{ht(D.before,E),ht(D.lines,E),ht(D.after,E)}),S=0,n.font=u.string,ht(t.footer,E),n.restore(),x+=v.width,{width:x,height:w}}function SA(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function PA(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function AA(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=i/2?c="left":r>=o-i/2&&(c="right"),PA(c,t,e,n)&&(c="center"),c}function Sg(t,e,n){const s=n.yAlign||e.yAlign||SA(t,n);return{xAlign:n.xAlign||e.xAlign||AA(t,e,n,s),yAlign:s}}function IA(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function EA(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function Pg(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=r+i,{topLeft:u,topRight:f,bottomLeft:p,bottomRight:g}=xi(o);let v=IA(e,a);const w=EA(e,l,c);return l==="center"?a==="left"?v+=c:a==="right"&&(v-=c):a==="left"?v-=Math.max(u,p)+r:a==="right"&&(v+=Math.max(f,g)+r),{x:jn(v,0,s.width-e.width),y:jn(w,0,s.height-e.height)}}function sl(t,e,n){const s=dn(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function Ag(t){return ts([],xs(t))}function MA(t,e,n){return Hr(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function Ig(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const fb={beforeTitle:gs,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:gs,beforeBody:gs,beforeLabel:gs,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return _t(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:gs,afterBody:gs,beforeFooter:gs,footer:gs,afterFooter:gs};function vn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?fb[e].call(n,s):r}class Eg extends kn{static positioners=mo;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new yf(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=MA(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=vn(s,"beforeTitle",this,e),i=vn(s,"title",this,e),o=vn(s,"afterTitle",this,e);let a=[];return a=ts(a,xs(r)),a=ts(a,xs(i)),a=ts(a,xs(o)),a}getBeforeBody(e,n){return Ag(vn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return ht(e,i=>{const o={before:[],lines:[],after:[]},a=Ig(s,i);ts(o.before,xs(vn(a,"beforeLabel",this,i))),ts(o.lines,vn(a,"label",this,i)),ts(o.after,xs(vn(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return Ag(vn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=vn(s,"beforeFooter",this,e),i=vn(s,"footer",this,e),o=vn(s,"afterFooter",this,e);let a=[];return a=ts(a,xs(r)),a=ts(a,xs(i)),a=ts(a,xs(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(CA(this.chart,n[l]));return e.filter&&(a=a.filter((u,f,p)=>e.filter(u,f,p,s))),e.itemSort&&(a=a.sort((u,f)=>e.itemSort(u,f,s))),ht(a,u=>{const f=Ig(e.callbacks,u);r.push(vn(f,"labelColor",this,u)),i.push(vn(f,"labelPointStyle",this,u)),o.push(vn(f,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=mo[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=Cg(this,s),c=Object.assign({},a,l),u=Sg(this.chart,s,c),f=Pg(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:f}=xi(a),{x:p,y:g}=e,{width:v,height:w}=n;let x,k,S,E,D,T;return i==="center"?(D=g+w/2,r==="left"?(x=p,k=x-o,E=D+o,T=D-o):(x=p+v,k=x+o,E=D-o,T=D+o),S=x):(r==="left"?k=p+Math.max(l,u)+o:r==="right"?k=p+v-Math.max(c,f)-o:k=this.caretX,i==="top"?(E=g,D=E-o,x=k-o,S=k+o):(E=g+w,D=E+o,x=k+o,S=k-o),T=E),{x1:x,x2:k,x3:S,y1:E,y2:D,y3:T}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const c=ki(s.rtl,this.x,this.width);for(e.x=sl(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",o=Lt(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=i,u=Lt(i.bodyFont),f=sl(this,"left",i),p=r.x(f),g=l<u.lineHeight?(u.lineHeight-l)/2:0,v=n.y+g;if(i.usePointStyle){const w={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},x=r.leftForLtr(p,c)+c/2,k=v+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,md(e,w,x,k),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,md(e,w,x,k)}else{e.lineWidth=Ze(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const w=r.leftForLtr(p,c),x=r.leftForLtr(r.xPlus(p,1),c-2),k=xi(o.borderRadius);Object.values(k).some(S=>S!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,zl(e,{x:w,y:v,w:c,h:l,radius:k}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),zl(e,{x,y:v+1,w:c-2,h:l-2,radius:k}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(w,v,c,l),e.strokeRect(w,v,c,l),e.fillStyle=o.backgroundColor,e.fillRect(x,v+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,f=Lt(s.bodyFont);let p=f.lineHeight,g=0;const v=ki(s.rtl,this.x,this.width),w=function($){n.fillText($,v.x(e.x+g),e.y+p/2),e.y+=p+i},x=v.textAlign(o);let k,S,E,D,T,P,A;for(n.textAlign=o,n.textBaseline="middle",n.font=f.string,e.x=sl(this,x,s),n.fillStyle=s.bodyColor,ht(this.beforeBody,w),g=a&&x!=="right"?o==="center"?c/2+u:c+2+u:0,D=0,P=r.length;D<P;++D){for(k=r[D],S=this.labelTextColors[D],n.fillStyle=S,ht(k.before,w),E=k.lines,a&&E.length&&(this._drawColorBox(n,e,D,v,s),p=Math.max(f.lineHeight,l)),T=0,A=E.length;T<A;++T)w(E[T]),p=f.lineHeight;ht(k.after,w)}g=0,p=f.lineHeight,ht(this.afterBody,w),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=ki(s.rtl,this.x,this.width);for(e.x=sl(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=Lt(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=s,{topLeft:f,topRight:p,bottomLeft:g,bottomRight:v}=xi(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+f,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+c-p,l),n.quadraticCurveTo(a+c,l,a+c,l+p),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+c,l+u-v),n.quadraticCurveTo(a+c,l+u,a+c-v,l+u),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+g,l+u),n.quadraticCurveTo(a,l+u,a,l+u-g),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+f),n.quadraticCurveTo(a,l,a+f,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=mo[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Cg(this,e),l=Object.assign({},o,this._size),c=Sg(n,e,l),u=Pg(e,l,c,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=dn(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),zv(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),qv(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!Fl(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!Fl(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=mo[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}var hb={id:"tooltip",_element:Eg,positioners:mo,afterInit(t,e,n){n&&(t.tooltip=new Eg({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const OA=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function DA(t,e,n,s){const r=t.indexOf(e);if(r===-1)return OA(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const TA=(t,e)=>t===null?null:jn(Math.round(t),0,e);function Mg(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class pb extends Li{static id="category";static defaults={ticks:{callback:Mg}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(_t(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:DA(s,e,Je(n,e),this._addedLabels),TA(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return Mg.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function RA(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:f,includeBounds:p}=t,g=i||1,v=u-1,{min:w,max:x}=e,k=!_t(o),S=!_t(a),E=!_t(c),D=(x-w)/(f+1);let T=Ep((x-w)/v/g)*g,P,A,$,I;if(T<1e-14&&!k&&!S)return[{value:w},{value:x}];I=Math.ceil(x/T)-Math.floor(w/T),I>v&&(T=Ep(I*T/v/g)*g),_t(l)||(P=Math.pow(10,l),T=Math.ceil(T*P)/P),r==="ticks"?(A=Math.floor(w/T)*T,$=Math.ceil(x/T)*T):(A=w,$=x),k&&S&&i&&rC((a-o)/i,T/1e3)?(I=Math.round(Math.min((a-o)/T,u)),T=(a-o)/I,A=o,$=a):E?(A=k?o:A,$=S?a:$,I=c-1,T=($-A)/I):(I=($-A)/T,To(I,Math.round(I),T/1e3)?I=Math.round(I):I=Math.ceil(I));const Y=Math.max(Mp(T),Mp(A));P=Math.pow(10,_t(l)?Y:l),A=Math.round(A*P)/P,$=Math.round($*P)/P;let U=0;for(k&&(p&&A!==o?(n.push({value:o}),A<o&&U++,To(Math.round((A+U*T)*P)/P,o,Og(o,D,t))&&U++):A<o&&U++);U<I;++U){const z=Math.round((A+U*T)*P)/P;if(S&&z>a)break;n.push({value:z})}return S&&p&&$!==a?n.length&&To(n[n.length-1].value,a,Og(a,D,t))?n[n.length-1].value=a:n.push({value:a}):(!S||$===a)&&n.push({value:$}),n}function Og(t,e,{horizontal:n,minRotation:s}){const r=Vt(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class $A extends Li{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return _t(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=Mi(r),c=Mi(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=RA(r,i);return e.bounds==="ticks"&&iC(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return df(e,this.chart.options.locale,this.options.ticks.format)}}class gb extends $A{static id="linear";static defaults={ticks:{callback:Tv.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Yt(e)?e:0,this.max=Yt(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Vt(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const mc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},_n=Object.keys(mc);function Dg(t,e){return t-e}function Tg(t,e){if(_t(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Yt(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(qr(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function Rg(t,e,n,s){const r=_n.length;for(let i=_n.indexOf(t);i<r-1;++i){const o=mc[_n[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return _n[i]}return _n[r-1]}function FA(t,e,n,s,r){for(let i=_n.length-1;i>=_n.indexOf(n);i--){const o=_n[i];if(mc[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return _n[n?_n.indexOf(n):0]}function LA(t){for(let e=_n.indexOf(t)+1,n=_n.length;e<n;++e)if(mc[_n[e]].common)return _n[e]}function $g(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=lf(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function BA(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function Fg(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:BA(t,s,r,n)}class Lg extends Li{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new RS._date(e.adapters.date);r.init(n),Do(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:Tg(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Yt(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Yt(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=cC(r,i,o);return this._unit=n.unit||(s.autoSkip?Rg(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):FA(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:LA(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),Fg(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=jn(n,0,o),s=jn(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||Rg(i.minUnit,n,s,this._getLabelCapacity(n)),a=Je(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=qr(l)||l===!0,u={};let f=n,p,g;if(c&&(f=+e.startOf(f,"isoWeek",l)),f=+e.startOf(f,c?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const v=r.ticks.source==="data"&&this.getDataTimestamps();for(p=f,g=0;p<s;p=+e.add(p,a,o),g++)$g(u,p,v);return(p===s||r.bounds==="ticks"||g===1)&&$g(u,p,v),Object.keys(u).sort(Dg).map(w=>+w)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return pt(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],f=c&&a[c],p=s[n],g=c&&f&&p&&p.major;return this._adapter.format(e,r||(g?f:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Vt(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,Fg(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(Tg(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return dC(e.sort(Dg))}}function rl(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Fr(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Fr(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class qB extends Lg{static id="timeseries";static defaults=Lg.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=rl(n,this.min),this._tableRange=rl(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(rl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return rl(this._table,s*this._tableRange+this._minPos,!0)}}const mb={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},jA={ariaLabel:{type:String},ariaDescribedby:{type:String}},NA={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...mb,...jA},zA=Jy[0]==="2"?(t,e)=>Object.assign(t,{attrs:e}):(t,e)=>Object.assign(t,e);function ci(t){return sa(t)?tt(t):t}function qA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return sa(e)?new Proxy(t,{}):t}function UA(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function yb(t,e){t.labels=e}function vb(t,e,n){const s=[];t.datasets=e.map(r=>{const i=t.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function WA(t,e){const n={labels:[],datasets:[]};return yb(n,t.labels),vb(n,t.datasets,e),n}const VA=et({props:NA,setup(t,e){let{expose:n,slots:s}=e;const r=fe(null),i=nc(null);n({chart:i});const o=()=>{if(!r.value)return;const{type:c,data:u,options:f,plugins:p,datasetIdKey:g}=t,v=WA(u,g),w=qA(v,u);i.value=new tr(r.value,{type:c,data:w,options:{...f},plugins:p})},a=()=>{const c=tt(i.value);c&&(t.destroyDelay>0?setTimeout(()=>{c.destroy(),i.value=null},t.destroyDelay):(c.destroy(),i.value=null))},l=c=>{c.update(t.updateMode)};return Tn(o),Fi(a),Kt([()=>t.options,()=>t.data],(c,u)=>{let[f,p]=c,[g,v]=u;const w=tt(i.value);if(!w)return;let x=!1;if(f){const k=ci(f),S=ci(g);k&&k!==S&&(UA(w,k),x=!0)}if(p){const k=ci(p.labels),S=ci(v.labels),E=ci(p.datasets),D=ci(v.datasets);k!==S&&(yb(w.config.data,k),x=!0),E&&E!==D&&(vb(w.config.data,E,t.datasetIdKey),x=!0)}x&&un(()=>{l(w)})},{deep:!0}),()=>As("canvas",{role:"img",ariaLabel:t.ariaLabel,ariaDescribedby:t.ariaDescribedby,ref:r},[As("p",{},[s.default?s.default():""])])}});function HA(t,e){return tr.register(e),et({props:mb,setup(n,s){let{expose:r}=s;const i=nc(null),o=a=>{i.value=a?.chart};return r({chart:i}),()=>As(VA,zA({ref:o},{type:t,...n}))}})}const bb=HA("line",TS),KA={class:"chart-container"},YA=et({__name:"PortfolioValueChart",setup(t){tr.register(pb,gb,ib,ca,db,hb,cb,yA);const e=fe([]),n=We(()=>{const r=[...e.value].sort((a,l)=>new Date(a.asOf).getTime()-new Date(l.asOf).getTime()),i=r.map(a=>new Date(a.asOf).toLocaleDateString()),o=r.map(a=>new Be(a.totalValue,"EUR").getDecimal());return{labels:i,datasets:[{label:"Portfolio Value",backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",data:o,fill:!0,tension:.4}]}}),s={responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:function(r){return typeof r=="number"?new Be(r*100,"EUR").format("de-DE"):r}}}},plugins:{legend:{display:!1}}};return Tn(async()=>{try{e.value=await fd.getAll()}catch(r){console.error("Error fetching valuation data:",r)}}),(r,i)=>(j(),W("div",KA,[ze($e(bb),{data:n.value,options:s},null,8,["data"])]))}}),GA=fn(YA,[["__scopeId","data-v-7346e7bf"]]);class ln{static BASE_URL="https://api.scryfall.com";static lastRequestTime=0;static RATE_LIMIT_DELAY=100;static async enforceRateLimit(){const n=Date.now()-this.lastRequestTime;if(n<this.RATE_LIMIT_DELAY){const s=this.RATE_LIMIT_DELAY-n;await new Promise(r=>setTimeout(r,s))}this.lastRequestTime=Date.now()}static async getPriceById(e){try{await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/${e}`);if(!n.ok)return null;const r=(await n.json()).prices?.eur;return r?Be.parse(r,"EUR"):null}catch(n){return console.error("Error fetching price from Scryfall:",n),null}}static async getPriceBySetAndNumber(e,n){try{await this.enforceRateLimit();const s=await fetch(`${this.BASE_URL}/cards/${e}/${n}`);if(!s.ok)return null;const i=(await s.json()).prices?.eur;return i?Be.parse(i,"EUR"):null}catch(s){return console.error("Error fetching price from Scryfall:",s),null}}static async getImageUrlById(e){try{await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/${e}`);if(!n.ok)return null;const s=await n.json();return(s.layout==="transform"||s.layout==="modal_dfc"||s.layout==="reversible_card")&&s.card_faces&&s.card_faces.length===2?{front:s.card_faces[0].image_uris?.normal||s.card_faces[0].image_uris?.large||s.card_faces[0].image_uris?.small||"",back:s.card_faces[1].image_uris?.normal||s.card_faces[1].image_uris?.large||s.card_faces[1].image_uris?.small||"",layout:s.layout}:s.image_uris?{front:s.image_uris.normal||s.image_uris.large||s.image_uris.small||"",back:"",layout:s.layout||"normal"}:s.card_faces&&s.card_faces.length>0&&s.card_faces[0].image_uris?{front:s.card_faces[0].image_uris.normal||s.card_faces[0].image_uris.large||s.card_faces[0].image_uris.small||"",back:"",layout:s.layout||"normal"}:{front:s.image_uris?.normal||s.image_uris?.large||s.image_uris?.small||"",back:"",layout:s.layout||"normal"}}catch(n){return console.error("Error fetching image from Scryfall:",n),null}}static async getImageUrlBySetAndNumber(e,n){try{await this.enforceRateLimit();const s=await fetch(`${this.BASE_URL}/cards/${e}/${n}`);if(!s.ok)return null;const r=await s.json();return(r.layout==="transform"||r.layout==="modal_dfc"||r.layout==="reversible_card")&&r.card_faces&&r.card_faces.length===2?{front:r.card_faces[0].image_uris?.normal||r.card_faces[0].image_uris?.large||r.card_faces[0].image_uris?.small||"",back:r.card_faces[1].image_uris?.normal||r.card_faces[1].image_uris?.large||r.card_faces[1].image_uris?.small||"",layout:r.layout}:r.image_uris?{front:r.image_uris.normal||r.image_uris.large||r.image_uris.small||"",back:"",layout:r.layout||"normal"}:r.card_faces&&r.card_faces.length>0&&r.card_faces[0].image_uris?{front:r.card_faces[0].image_uris.normal||r.card_faces[0].image_uris.large||r.card_faces[0].image_uris.small||"",back:"",layout:r.layout||"normal"}:{front:r.image_uris?.normal||r.image_uris?.large||r.image_uris?.small||"",back:"",layout:r.layout||"normal"}}catch(s){return console.error("Error fetching image from Scryfall:",s),null}}static async getByCardmarketId(e){try{await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/cardmarket/${e}`);if(!n.ok){console.error(`Scryfall API error for cardmarket_id ${e}: ${n.status} ${n.statusText}`);try{const s=await n.text();console.error(`Scryfall API error details: ${s}`)}catch{console.error("Could not read error response body")}return null}return await n.json()}catch(n){return console.error("Error fetching card by Cardmarket ID from Scryfall:",n),null}}static async getByCardmarketIds(e){try{if(!e||e.length===0)return[];if(e.length===1){const r=await this.getByCardmarketId(e[0]);return r?[r]:[]}await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/collection`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifiers:e.map(r=>({cardmarket_id:r}))})});if(!n.ok){console.error(`Scryfall API error for batch cardmarket_ids: ${n.status} ${n.statusText}`);try{const r=await n.text();console.error(`Scryfall API error details: ${r}`)}catch{console.error("Could not read error response body")}return await this.getByCardmarketIdsIndividually(e)}return(await n.json()).data||[]}catch(n){return console.error("Error fetching cards by Cardmarket IDs from Scryfall:",n),await this.getByCardmarketIdsIndividually(e)}}static async getPricesByIds(e){try{if(!e||e.length===0)return[];if(e.length===1){const i=await this.getPriceById(e[0]);return i?[{[e[0]]:{eur:i.getCents()/100}}]:[]}await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/collection`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifiers:e.map(i=>({id:i}))})});if(!n.ok){console.error(`Scryfall API error for batch price fetching: ${n.status} ${n.statusText}`);try{const i=await n.text();console.error(`Scryfall API error details: ${i}`)}catch{console.error("Could not read error response body")}return await this.getPricesByIdsIndividually(e)}const s=await n.json(),r=[];if(s.data&&Array.isArray(s.data))for(const i of s.data)i.id&&i.prices&&r.push({[i.id]:{eur:i.prices.eur?parseFloat(i.prices.eur):void 0,eur_foil:i.prices.eur_foil?parseFloat(i.prices.eur_foil):void 0}});return r}catch(n){return console.error("Error fetching prices by Scryfall IDs from Scryfall:",n),await this.getPricesByIdsIndividually(e)}}static async getPricesByIdsIndividually(e){const n=[];for(const s of e)try{const r=await fetch(`${this.BASE_URL}/cards/${s}`);if(r.ok){const i=await r.json();i.prices&&n.push({[s]:{eur:i.prices.eur?parseFloat(i.prices.eur):void 0,eur_foil:i.prices.eur_foil?parseFloat(i.prices.eur_foil):void 0}})}}catch(r){console.error(`Error fetching price for card ${s}:`,r)}return n}static async getByCardmarketIdsIndividually(e){const n=[];for(const s of e){const r=await this.getByCardmarketId(s);r&&n.push(r)}return n}static async hydrateCard(e){try{if(e.scryfall_id){await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/${e.scryfall_id}`);if(n.ok)return await n.json()}if(e.setCode&&e.collectorNumber){await this.enforceRateLimit();const n=await fetch(`${this.BASE_URL}/cards/${e.setCode}/${e.collectorNumber}`);if(n.ok)return await n.json()}if(e.name&&e.setCode){await this.enforceRateLimit();let n=await fetch(`${this.BASE_URL}/cards/named?exact=${encodeURIComponent(e.name)}&set=${encodeURIComponent(e.setCode)}`);if(n.ok)return await n.json();if(e.version&&(await this.enforceRateLimit(),n=await fetch(`${this.BASE_URL}/cards/named?exact=${encodeURIComponent(e.name)}&set=${encodeURIComponent(e.setCode)}&include_variations=true`),n.ok))return await n.json();if(await this.enforceRateLimit(),n=await fetch(`${this.BASE_URL}/cards/named?fuzzy=${encodeURIComponent(e.name)}&set=${encodeURIComponent(e.setCode)}`),n.ok)return await n.json()}return null}catch(n){return console.error("Error hydrating card with Scryfall data:",n),null}}}class XA{static BATCH_SIZE=75;static async syncPrices(e){try{const n=new Date,s=n.toISOString().split("T")[0],r=await Ut.getAll(),i=r.length;let o=0;for(let a=0;a<r.length;a+=this.BATCH_SIZE){const l=r.slice(a,a+this.BATCH_SIZE),c=l.map(u=>u.id);try{const u=await ln.getPricesByIds(c);for(const f of u)for(const[p,g]of Object.entries(f)){if(g.eur!==void 0){const v=Be.parse(g.eur.toString(),"EUR"),w="nonfoil",k={id:`${p}:scryfall:${w}:${s}`,cardId:p,provider:"scryfall",finish:w,date:s,currency:"EUR",priceCent:v.getCents(),asOf:n,createdAt:n};await ge().price_points.put(k)}if(g.eur_foil!==void 0){const v=Be.parse(g.eur_foil.toString(),"EUR"),x={id:`${p}:scryfall:foil:${s}`,cardId:p,provider:"scryfall",finish:"foil",date:s,currency:"EUR",priceCent:v.getCents(),asOf:n,createdAt:n};await ge().price_points.put(x)}o++,e&&e(o,i)}}catch(u){console.error(`Error syncing prices for batch starting at index ${a}:`,u);for(let f=0;f<l.length;f++)o++,e&&e(o,i)}}try{await Gs.createValuationSnapshot(),console.log("Valuation snapshot created after price update")}catch(a){console.error("Error creating valuation snapshot after price update:",a)}}catch(n){throw console.error("Error syncing prices:",n),n}}static async syncPriceForCard(e){try{const n=new Date,s=n.toISOString().split("T")[0],r=await Ut.getById(e);if(!r){console.warn(`Card with ID ${e} not found`);return}const i=await ln.getPricesByIds([r.id]);if(i.length>0){const a=i[0][r.id];if(a.eur!==void 0){const l=Be.parse(a.eur.toString(),"EUR"),u={id:`${r.id}:scryfall:nonfoil:${s}`,cardId:r.id,provider:"scryfall",finish:"nonfoil",date:s,currency:"EUR",priceCent:l.getCents(),asOf:n,createdAt:n};await ge().price_points.put(u)}if(a.eur_foil!==void 0){const l=Be.parse(a.eur_foil.toString(),"EUR"),u={id:`${r.id}:scryfall:foil:${s}`,cardId:r.id,provider:"scryfall",finish:"foil",date:s,currency:"EUR",priceCent:l.getCents(),asOf:n,createdAt:n};await ge().price_points.put(u)}}}catch(n){throw console.error(`Error syncing price for card ${e}:`,n),n}}static async needsPriceUpdate(){try{const n=await ge().price_points.orderBy("asOf").last();if(!n)return!0;const s=new Date,r=new Date(n.asOf);return(s.getTime()-r.getTime())/(1e3*60*60)>=24}catch(e){return console.error("Error checking if price update is needed:",e),!0}}static async needsPriceUpdateForCard(e){try{const n=await $l.getLatestPriceForCard(e);if(!n)return!0;const s=new Date,r=new Date(n.asOf);return(s.getTime()-r.getTime())/(1e3*60*60)>=24}catch(n){return console.error(`Error checking if price update is needed for card ${e}:`,n),!0}}static async getLatestPriceForCard(e){try{const n=await $l.getLatestPriceForCard(e);return n?{price:n.price.getCents(),asOf:n.asOf,provider:n.provider}:null}catch(n){return console.error(`Error getting latest price for card ${e}:`,n),null}}}class pi{static async needsPriceUpdate(){try{const e=await Nr.get("last_price_update_timestamp");if(!e)return!0;const n=Date.now(),s=new Date(e).getTime();return(n-s)/(1e3*60*60)>=24}catch(e){return console.error("Error checking if price update is needed:",e),!0}}static async schedulePriceUpdate(){try{await this.needsPriceUpdate()&&await this.updatePrices()}catch(e){throw console.error("Error scheduling price update:",e),e}}static async updatePrices(){const e=Rr(),n=e.addImport({id:`price-update-${Date.now()}`,type:"pricing",name:"Price Updates",status:"pending",progress:0,totalItems:0,processedItems:0});try{await XA.syncPrices((r,i)=>{e.updateImport(n,{status:"processing",progress:Math.round(r/i*100),totalItems:i,processedItems:r})});const s=new Date().toISOString();await Nr.set("last_price_update_timestamp",s),await Gs.createValuationSnapshot(),e.completeImport(n),console.log(`Prices updated successfully at ${s}`)}catch(s){throw console.error("Error updating prices:",s),e.completeImport(n,s instanceof Error?s.message:"Unknown error"),s}}static async getLastUpdateTime(){try{const e=await Nr.get("last_price_update_timestamp");return e?new Date(e):null}catch(e){return console.error("Error getting last update time:",e),null}}static async getNextUpdateTime(){try{const e=await this.getLastUpdateTime();return e?new Date(e.getTime()+1440*60*1e3):new Date}catch(e){return console.error("Error calculating next update time:",e),null}}}const Bg=fe(null),jg=fe(null),wr=fe(!1);function QA(){const t=r=>r?r.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",e=async()=>{try{Bg.value=await pi.getLastUpdateTime(),jg.value=await pi.getNextUpdateTime()}catch(r){console.error("Error updating price info:",r)}};return{lastUpdate:Bg,nextUpdate:jg,isUpdating:wr,formatDate:t,updatePriceInfo:e,checkAndScheduleUpdate:async()=>{if(!wr.value){wr.value=!0;try{await pi.needsPriceUpdate()&&(await pi.schedulePriceUpdate(),await Gs.createValuationSnapshot()),await e()}catch(r){console.error("Error scheduling price update:",r)}finally{wr.value=!1}}},forceUpdatePrices:async()=>{if(!wr.value){wr.value=!0;try{await pi.updatePrices(),await Gs.createValuationSnapshot(),await e()}catch(r){throw console.error("Error updating prices:",r),r}finally{wr.value=!1}}}}}const JA={class:"home"},ZA={class:"row"},eI={class:"col-lg-9"},tI={class:"card glass-panel mb-4"},nI={class:"card-body"},sI={class:"col-lg-3"},rI={class:"card glass-panel mb-4"},iI={class:"card-body"},oI={class:"small text-muted mb-1"},aI={class:"col-md-3"},lI={class:"d-flex justify-content-between"},cI=["disabled"],uI={class:"card glass-panel"},dI={class:"card-body"},fI={class:"small"},hI={class:"d-flex justify-content-between"},pI={class:"fw-medium"},gI={class:"d-flex justify-content-between"},mI={class:"fw-medium"},yI={class:"d-flex justify-content-between"},vI={class:"row g-4"},bI={class:"col-lg-3 col-md-6"},_I={class:"card glass-panel h-100"},wI={class:"card-body"},xI={class:"col-lg-3 col-md-6"},kI={class:"card glass-panel h-100"},CI={class:"card-body"},SI={class:"col-lg-3 col-md-6"},PI={class:"card glass-panel h-100"},AI={class:"card-body"},II={class:"stat-value text-success"},EI={class:"col-lg-3 col-md-6"},MI={class:"card glass-panel h-100"},OI={class:"card-body"},DI={class:"stat-value text-danger"},TI={class:"row mt-4"},RI={class:"col-12"},$I={class:"card glass-panel"},FI={class:"card-body"},LI={class:"row"},BI={class:"col-md-3"},jI={class:"stat-value text-success"},NI={class:"col-md-3"},zI={class:"stat-value text-danger"},qI={class:"col-md-3"},UI={class:"stat-value text-danger"},WI={class:"col-md-3"},VI={class:"stat-value text-danger"},HI=et({__name:"HomeView",setup(t){const e=tf(),n=wk(),s=xk(),{formatDate:r,checkAndScheduleUpdate:i,forceUpdatePrices:o,lastUpdate:a,nextUpdate:l,isUpdating:c}=QA(),u=fe("€0.00"),f=fe("€0.00"),p=fe("€0.00"),g=fe("€0.00"),v=fe("€0.00"),w=fe("€0.00"),x=fe("€0.00"),k=fe("€0.00"),S=fe("€0.00"),E=fe("€0.00"),D=fe("€0.00"),T=$=>$.format("de-DE"),P=async()=>{try{await e.loadCards(),await n.loadHoldings(),await s.loadTransactions();const $=await Gs.calculatePortfolioValue(),I=await Gs.calculateTotalCostBasis(),Y=await Gs.calculateUnrealizedPnL(),U=await Gs.calculateRealizedPnL();u.value=T($),f.value=T(I),p.value=T(Y),g.value=T(U);const z=await Mr.getTotalRevenue(),pe=await Mr.getTotalCosts(),ye=await Mr.getTotalFees(),ue=await Mr.getTotalShippingCosts("purchase"),_e=await Mr.getTotalShippingCosts("sale"),ke=await Mr.getTotalNetProfit();v.value=T(z),w.value=T(pe),k.value=T(z),S.value=T(pe),E.value=T(ye),D.value=T(ue.subtract(_e)),x.value=T(ke)}catch($){console.error("Error loading dashboard data:",$)}},A=async()=>{try{await o(),await P()}catch($){console.error("Error refreshing prices:",$)}};return Tn(async()=>{await P(),setTimeout(async()=>{await i()},0)}),($,I)=>(j(),W("div",JA,[b("div",ZA,[I[6]||(I[6]=b("div",{class:"col-12"},[b("h1",{class:"mb-4"},"MTG Collection Tracker")],-1)),b("div",eI,[b("div",tI,[b("div",nI,[I[0]||(I[0]=b("h5",{class:"card-title"},"Portfolio Value Over Time",-1)),ze(GA)])])]),b("div",sI,[b("div",rI,[b("div",iI,[I[1]||(I[1]=b("h5",{class:"card-title"},"Price Updates",-1)),b("div",oI," Last: "+te($e(r)($e(a)))+" | Next: "+te($e(r)($e(l))),1),b("div",aI,[b("div",lI,[b("button",{onClick:A,class:"btn btn-glass-panel",disabled:$e(c)},te($e(c)?"Updating...":"Refresh Now"),9,cI)])])])]),b("div",uI,[b("div",dI,[I[5]||(I[5]=b("h5",{class:"card-title"},"Quick Stats",-1)),b("div",fI,[b("div",hI,[I[2]||(I[2]=b("span",{class:"text-muted"},"Portfolio Value:",-1)),b("span",pI,te(u.value),1)]),b("div",gI,[I[3]||(I[3]=b("span",{class:"text-muted"},"Total Cost:",-1)),b("span",mI,te(f.value),1)]),b("div",yI,[I[4]||(I[4]=b("span",{class:"text-muted"},"Net Profit/Loss:",-1)),b("span",{class:At(["fw-medium",parseFloat(x.value)>=0?"text-success":"text-danger"])},te(x.value),3)])])])])])]),b("div",vI,[b("div",bI,[b("div",_I,[b("div",wI,[I[7]||(I[7]=b("h5",{class:"card-title"},"Unrealized P/L",-1)),b("p",{class:At(["stat-value",parseFloat(p.value)>=0?"positive":"negative"])},te(p.value),3)])])]),b("div",xI,[b("div",kI,[b("div",CI,[I[8]||(I[8]=b("h5",{class:"card-title"},"Realized P/L",-1)),b("p",{class:At(["stat-value",parseFloat(g.value)>=0?"positive":"negative"])},te(g.value),3)])])]),b("div",SI,[b("div",PI,[b("div",AI,[I[9]||(I[9]=b("h5",{class:"card-title"},"Total Revenue",-1)),b("p",II,te(v.value),1)])])]),b("div",EI,[b("div",MI,[b("div",OI,[I[10]||(I[10]=b("h5",{class:"card-title"},"Total Costs",-1)),b("p",DI,te(w.value),1)])])])]),b("div",TI,[b("div",RI,[b("div",$I,[b("div",FI,[I[15]||(I[15]=b("h5",{class:"card-title"},"Financial Breakdown",-1)),b("div",LI,[b("div",BI,[I[11]||(I[11]=b("h6",{class:"text-muted"},"Sales Revenue",-1)),b("p",jI,te(k.value),1)]),b("div",NI,[I[12]||(I[12]=b("h6",{class:"text-muted"},"Purchase Costs",-1)),b("p",zI,te(S.value),1)]),b("div",qI,[I[13]||(I[13]=b("h6",{class:"text-muted"},"Fees & Commission",-1)),b("p",UI,te(E.value),1)]),b("div",WI,[I[14]||(I[14]=b("h6",{class:"text-muted"},"Shipping Costs",-1)),b("p",VI,te(D.value),1)])])])])])])]))}}),KI=fn(HI,[["__scopeId","data-v-3555c87b"]]),YI={class:"data-import-view"},GI={class:"nav nav-tabs"},XI={class:"nav-item"},QI={class:"nav-item"},JI={class:"nav-item"},ZI={class:"nav-item"},eE={class:"tab-content pt-3"},tE=et({__name:"DataImportView",setup(t){return(e,n)=>{const s=Si("router-link"),r=Si("router-view");return j(),W("div",YI,[n[4]||(n[4]=b("h1",null,"Data Import",-1)),n[5]||(n[5]=b("p",null,"Import your collection and price data from various sources.",-1)),b("ul",GI,[b("li",XI,[ze(s,{to:"/import/cardmarket",class:"nav-link","active-class":"active"},{default:rt(()=>[...n[0]||(n[0]=[yt(" Cardmarket CSV ",-1)])]),_:1})]),b("li",QI,[ze(s,{to:"/import/mtgjson",class:"nav-link","active-class":"active"},{default:rt(()=>[...n[1]||(n[1]=[yt(" MTGJSON Prices ",-1)])]),_:1})]),b("li",JI,[ze(s,{to:"/import/price-guide",class:"nav-link","active-class":"active"},{default:rt(()=>[...n[2]||(n[2]=[yt(" Cardmarket Price Guide ",-1)])]),_:1})]),b("li",ZI,[ze(s,{to:"/import/manabox",class:"nav-link","active-class":"active"},{default:rt(()=>[...n[3]||(n[3]=[yt(" ManaBox Scans ",-1)])]),_:1})])]),b("div",eE,[ze(r)])])}}}),nE=fn(tE,[["__scopeId","data-v-8b27c0a2"]]);function sE(t){return new Worker("/mtg-pwa/assets/cardmarketCsv-CzsXSO1k.js",{name:t?.name})}const Gt=[];for(let t=0;t<256;++t)Gt.push((t+256).toString(16).slice(1));function rE(t,e=0){return(Gt[t[e+0]]+Gt[t[e+1]]+Gt[t[e+2]]+Gt[t[e+3]]+"-"+Gt[t[e+4]]+Gt[t[e+5]]+"-"+Gt[t[e+6]]+Gt[t[e+7]]+"-"+Gt[t[e+8]]+Gt[t[e+9]]+"-"+Gt[t[e+10]]+Gt[t[e+11]]+Gt[t[e+12]]+Gt[t[e+13]]+Gt[t[e+14]]+Gt[t[e+15]]).toLowerCase()}let Iu;const iE=new Uint8Array(16);function oE(){if(!Iu){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Iu=crypto.getRandomValues.bind(crypto)}return Iu(iE)}const aE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ng={randomUUID:aE};function lE(t,e,n){t=t||{};const s=t.random??t.rng?.()??oE();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,rE(s)}function yo(t,e,n){return Ng.randomUUID&&!t?Ng.randomUUID():lE(t)}const zg={},Eu={foil:"foil","non-foil":"nonfoil",nonfoil:"nonfoil",etched:"etched","etched foil":"etched"},Mu={english:"EN",german:"DE",french:"FR",italian:"IT",spanish:"ES",japanese:"JA",korean:"KO",portuguese:"PT",russian:"RU",chinese:"ZH",hebrew:"HE",latin:"LA",greek:"GR",arabic:"AR"};function _f(t){let e=t.setCode||"";e&&zg[e.toLowerCase()]&&(e=zg[e.toLowerCase()]);let n=(t.number||"").trim().toLowerCase();n=n.replace(/\/\d+$/,"");let s="EN";if(t.lang){const o=t.lang.trim().toUpperCase();Mu[o]?s=Mu[o]:Object.values(Mu).includes(o)&&(s=o)}let r="nonfoil";if(t.finish!==void 0)if(typeof t.finish=="boolean")r=t.finish?"foil":"nonfoil";else{const o=t.finish.trim().toLowerCase();Eu[o]?r=Eu[o]:Object.values(Eu).includes(o)&&(r=o)}let i;return e&&n?i=`${e}:${n}:${s}:${r}`:t.name?i=`name:${t.name.toLowerCase().replace(/\s+/g,"-")}:${s}:${r}`:i=`unknown:${Date.now()}:${s}:${r}`,{cardId:t.cardId,setCode:e,number:n,lang:s,finish:r,fingerprint:i}}function cE(t){const e=t.toLowerCase();return e.includes("foil")&&!e.includes("etched")?"foil":e.includes("etched")?"etched":"nonfoil"}const bn=t=>t.toLowerCase().normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[\s–—-]+/g," ").replace(/[:'"]/g,"").trim();function Ci(t){const e=new Map;for(const n of t)e.set(bn(n.name),n);return{byName:e}}async function uE(t){const e=t.trim(),n=bn(e),s=await qg(),i=(await dE()).get(n);if(i)return console.log(`Set code resolved from alias: ${e} -> ${i}`),i;const o=s.byName.get(n);if(o)return console.log(`Set code resolved from exact match: ${e} -> ${o.code}`),await Sn(n,o.code),o.code;if(/^commander:\s*/i.test(e)&&/: extras$/i.test(e)){const c=e.replace(/^commander:\s*/i,"").replace(/: extras$/i,"").trim(),u=s.byName.get(bn(`${c} Commander`));if(u)return console.log(`Set code resolved from commander + extras nested: ${e} -> ${u.code}`),await Sn(n,u.code),u.code;const f=s.byName.get(bn(c));if(f)return console.log(`Set code resolved from commander + extras nested (base): ${e} -> ${f.code}`),await Sn(n,f.code),f.code}if(/^commander:\s*/i.test(e)){const c=e.replace(/^commander:\s*/i,"").trim(),u=s.byName.get(bn(`${c} Commander`));if(u)return console.log(`Set code resolved from commander rewrite (commander): ${e} -> ${u.code}`),await Sn(n,u.code),u.code;const f=s.byName.get(bn(c));if(f)return console.log(`Set code resolved from commander rewrite (base): ${e} -> ${f.code}`),await Sn(n,f.code),f.code}if(/: extras$/i.test(e)){const c=bn(e.replace(/: extras$/i,"")),u=s.byName.get(c);if(u)return console.log(`Set code resolved from extras suffix: ${e} -> ${u.code}`),await Sn(n,u.code),u.code}if(/^universes beyond:\s*/i.test(e)){const c=e.replace(/^universes beyond:\s*/i,"").trim();if(/: extras$/i.test(c)){const f=bn(c.replace(/: extras$/i,"")),p=s.byName.get(f);if(p)return console.log(`Set code resolved from universes beyond + extras: ${e} -> ${p.code}`),await Sn(n,p.code),p.code}const u=s.byName.get(bn(c));if(u)return console.log(`Set code resolved from universes beyond: ${e} -> ${u.code}`),await Sn(n,u.code),u.code}if(/^magic: the gathering -\s*/i.test(e)){const c=e.replace(/^magic: the gathering -\s*/i,"").trim();if(/: extras$/i.test(c)){const f=bn(c.replace(/: extras$/i,"")),p=s.byName.get(f);if(p)return console.log(`Set code resolved from magic: the gathering - extras: ${e} -> ${p.code}`),await Sn(n,p.code),p.code}const u=s.byName.get(bn(c));if(u)return console.log(`Set code resolved from magic: the gathering -: ${e} -> ${u.code}`),await Sn(n,u.code),u.code}if(/^secret lair drop series:/i.test(e)){const c=e.replace(/^secret lair drop series:/i,"").trim();if(/: extras$/i.test(c)){const f=bn(c.replace(/: extras$/i,"")),p=s.byName.get(f);if(p)return console.log(`Set code resolved from secret lair drop series + extras: ${e} -> ${p.code}`),await Sn(n,p.code),p.code}const u=s.byName.get(bn(c));if(u)return console.log(`Set code resolved from secret lair drop series: ${e} -> ${u.code}`),await Sn(n,u.code),u.code}console.log(`Set code unresolved: ${e}`),await _b();const l=(await qg()).byName.get(n);return l?(console.log(`Set code resolved from fresh exact match: ${e} -> ${l.code}`),l.code):(await Sn(n,null),null)}async function qg(){try{const t=Date.now()-6048e5,n=await ge().settings.get("scryfall_sets_cache");return n&&n.v&&n.v.fetchedAt>t?(console.log("Using cached Scryfall sets data"),Ci(n.v.sets)):(console.log("Refreshing Scryfall sets cache (no cache or old cache)"),await _b())}catch(t){console.error("Error in getSetIndex:",t);try{const n=await ge().settings.get("scryfall_sets_cache");if(n&&n.v)return console.log("Using old cached Scryfall sets data due to error"),Ci(n.v.sets)}catch(e){console.error("Error accessing cached Scryfall sets data:",e)}return console.log("Returning empty Scryfall sets index"),Ci([])}}async function _b(){try{console.log("Fetching Scryfall sets data...");const t=await fetch("https://api.scryfall.com/sets");if(!t.ok)throw new Error(`Failed to fetch sets: ${t.status} ${t.statusText}`);const n=(await t.json()).data||[];return console.log(`Fetched ${n.length} Scryfall sets`),await ge().settings.put({k:"scryfall_sets_cache",v:{sets:n,fetchedAt:Date.now()},createdAt:new Date,updatedAt:new Date}),Ci(n)}catch(t){console.error("Error refreshing Scryfall sets cache:",t);try{const n=await ge().settings.get("scryfall_sets_cache");if(n&&n.v)return console.log("Using old cached Scryfall sets data due to fetch error"),Ci(n.v.sets)}catch(e){console.error("Error accessing cached Scryfall sets data:",e)}return console.log("Returning empty Scryfall sets index due to errors"),Ci([])}}async function dE(){const t=new Map,n=await ge().settings.get("set_code_aliases");if(n&&n.v)for(const[s,r]of Object.entries(n.v))t.set(s,r);return t}async function Sn(t,e){try{const n=bn(t),s=ge(),r=await s.settings.get("set_code_aliases");let i={};r&&r.v&&(i={...r.v}),i[n]=e,await s.settings.put({k:"set_code_aliases",v:i,createdAt:r?.createdAt||new Date,updatedAt:new Date})}catch(n){console.error("Error storing set code alias:",n)}}function fE(t){return cE(t)}function hE(t){return _f({lang:t}).lang}async function pE(t){return await uE(t)}class gE{static normalizeFingerprint=_f;static mapFinish=fE;static normalizeLang=hE;static resolveSetCode=pE}class mE{static async processScans(e){console.log("Starting processScans...");const n=await Rl.getAll();console.log(`Found ${n.length} unprocessed scans`);for(let s=0;s<n.length;s++){const r=n[s];if(console.log(`Processing scan: ${r.id}, fingerprint: ${r.cardFingerprint}`),r.cardId)if(await Ut.getById(r.cardId)){console.log(`Scan ${r.id} already has cardId: ${r.cardId} with existing card, skipping`),e&&e(s+1,n.length);continue}else console.log(`CardId ${r.cardId} exists but card not found in DB, proceeding with processing`);let i=r.cardId,o;if(i&&(console.log(`Using existing cardId: ${i}`),o=await Ut.getById(i)),!o){console.log(`Card not found, need to process fingerprint: ${r.cardFingerprint}`);const a=r.cardFingerprint.split(":");if(console.log(`Fingerprint parts: ${JSON.stringify(a)}`),r.cardFingerprint.startsWith("name:")&&a.length>=2){const l=a[1]?.replace(/-/g," ")||"";console.log(`Processing name-based fingerprint with name: ${l}`);const c=await ln.hydrateCard({name:l});if(c?.id){const u=c.id;if(console.log(`Successfully resolved card by name: ${c.name||"Unknown"}`),i=u,o=await Ut.getById(u),!o){console.log("Card not in DB, creating new card entry");const f=await ln.getImageUrlById(u),p={id:u,name:c.name||"",set:c.set_name||"",setCode:c.set||"",number:c.collector_number||"",lang:c.lang||"en",finish:r.finish||"nonfoil",layout:f?.layout,imageUrl:f?.front,imageUrlBack:f?.back,cardmarketId:c.cardmarket_id,createdAt:new Date,updatedAt:new Date},g=await Ut.add(p);console.log(`Added new card with id: ${g}`),o=p}}else console.error(`Failed to resolve card by name: ${l} (no id returned)`)}else if(a.length>=4){const l=a[0]||"",c=a[1]||"";console.log(`Processing setCode/number-based fingerprint with setCode: ${l}, number: ${c}`);const u=await ln.hydrateCard({setCode:l,collectorNumber:c});if(u?.id){const f=u.id;if(console.log(`Successfully resolved card by setCode and number: ${u.name||"Unknown"}`),i=f,o=await Ut.getById(f),!o){console.log("Card not in DB, creating new card entry");const p=await ln.getImageUrlById(f),g={id:f,name:u.name||"",set:u.set_name||"",setCode:u.set||"",number:u.collector_number||"",lang:u.lang||"en",finish:r.finish||"nonfoil",layout:p?.layout,imageUrl:p?.front,imageUrlBack:p?.back,cardmarketId:u.cardmarket_id,createdAt:new Date,updatedAt:new Date},v=await Ut.add(g);console.log(`Added new card with id: ${v}`),o=g}}else console.error(`Failed to resolve card by setCode: ${l} and number: ${c} (no id returned)`)}else console.error(`Unexpected fingerprint format: ${r.cardFingerprint}`)}if(o&&i){console.log(`Creating card lot for card: ${i}, scan: ${r.id}`);const a={id:`lot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,cardId:i,acquisitionId:r.acquisitionId,quantity:r.quantity,unitCost:0,condition:"near_mint",language:r.language||"en",foil:r.finish==="foil",finish:r.finish||"nonfoil",source:"manabox",purchasedAt:r.scannedAt,createdAt:new Date,updatedAt:new Date},l=await kt.add(a);console.log(`Added new card lot with id: ${l}`),await Rl.update(r.id,{cardId:i,lotId:l}),console.log(`Updated scan ${r.id} with cardId: ${i} and lotId: ${l}`)}else console.log(`No card found or created for scan: ${r.id}, skipping lot creation`);e&&e(s+1,n.length)}console.log("Completed processScans")}}async function yE(t,e,n,s,r,i){try{let o=await Yo.getByExternalRef(s,r);o||(o={id:`acq-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kind:"box",source:s,externalRef:r,currency:"EUR",happenedAt:n,totalPriceCent:e.price,totalFeesCent:e.fees,totalShippingCent:e.shipping,totalCostCent:e.price+e.fees+e.shipping,createdAt:new Date,updatedAt:new Date},await Yo.add(o));const a=o.id,l=[];for(const u of t){const f=_f({name:u.name,setCode:u.expansion,number:u.number,lang:u.language,finish:u.foil});if(await Rl.getByAcquisitionAndExternalRef(a,u.externalRef))continue;const g={cardFingerprint:f.fingerprint,cardId:u.scryfallId,acquisitionId:a,source:u.source,externalRef:u.externalRef,scannedAt:u.scannedAt,quantity:u.quantity,createdAt:new Date,updatedAt:new Date};l.push(g)}const c=[];for(let u=0;u<l.length;u++){const f=l[u],p=await Rl.add({...f,id:`scan-${Date.now()}-${Math.random().toString(36).substr(2,9)}`});c.push(p),i&&i(u+1,l.length)}return await mE.processScans(i),{acquisitionId:a,scanIds:c}}catch(o){throw console.error("Error importing Manabox scans with box cost:",o),o}}async function vE(t){try{const e=[];for(const n of t)if((await Jt.getBySourceRef(n.source,n.externalRef)).length===0){const r={cardId:n.cardId,lotId:n.lotId,quantity:n.quantity,unitPrice:n.unitPrice,fees:n.fees,shipping:n.shipping,currency:n.currency,source:n.source,externalRef:n.externalRef,happenedAt:n.happenedAt,notes:n.notes,relatedTransactionId:n.relatedTransactionId},i=await Jt.add({...r,id:`tx-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kind:"SELL",createdAt:new Date,updatedAt:new Date});e.push(i)}return e}catch(e){throw console.error("Error importing Cardmarket SELLs:",e),e}}async function bE(t,e){try{const n=[],s=[];for(const r of t){const o=(await wp.getAll()).find(a=>a.name===r.name&&a.platform===r.platform);if(o)n.push(o.id);else{const a=`deck_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l={...r,id:a,createdAt:r.createdAt||new Date,updatedAt:r.updatedAt||new Date};await wp.add(l),n.push(l.id)}}for(const r of e)if(!await xp.getByDeckIdAndCardId(r.deckId,r.cardId)){const o={id:`deckcard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,deckId:r.deckId,cardId:r.cardId,lotId:r.lotId,quantity:r.quantity,role:r.role,addedAt:r.addedAt,removedAt:r.removedAt,createdAt:r.createdAt||new Date};await xp.add(o),s.push(r.cardId)}return{deckIds:n,deckCardIds:s}}catch(n){throw console.error("Error importing decks:",n),n}}const{resolveSetCode:Ug}=gE;class vo{static async importCardmarketTransactions(e){const n=Rr(),s=yo();n.addImport({id:s,type:"cardmarket",name:"Cardmarket Transactions",status:"pending",progress:0,totalItems:e.length,processedItems:0});try{const r=new Date;for(let i=0;i<e.length;i++){const o=e[i];n.updateImport(s,{status:"processing",processedItems:i+1,progress:Math.round((i+1)/e.length*100)});const a=`cardmarket:${o.reference}:${o.lineNumber}`;if(await ge().transactions.where("externalRef").equals(a).first())continue;const u=Be.parse(o.amount,"EUR"),f={id:`tx-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kind:u.isPositive()?"SELL":"BUY",quantity:1,unitPrice:u.getCents(),fees:0,shipping:0,currency:"EUR",source:"cardmarket",externalRef:a,happenedAt:new Date(o.date),createdAt:r,updatedAt:r};await Jt.add(f)}n.completeImport(s)}catch(r){throw console.error("Error importing Cardmarket transactions:",r),n.completeImport(s,r.message),r}}static async importCardmarketOrders(e){const n=Rr(),s=yo();n.addImport({id:s,type:"cardmarket",name:"Cardmarket Orders",status:"pending",progress:0,totalItems:e.length,processedItems:0});try{const r=new Date;for(let i=0;i<e.length;i++){const o=e[i];n.updateImport(s,{status:"processing",processedItems:i+1,progress:Math.round((i+1)/e.length*100)});const a=`cardmarket:order:${o.orderId}:${o.lineNumber}`;if(await ge().transactions.where("externalRef").equals(a).first())continue;const u=Be.parse(o.merchandiseValue,"EUR"),f=Be.parse(o.shipmentCosts,"EUR"),p=Be.parse(o.commission,"EUR"),g={id:`order-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kind:o.direction==="sale"?"SELL":"BUY",quantity:parseInt(o.articleCount)||1,unitPrice:Math.round(u.getCents()/(parseInt(o.articleCount)||1)),fees:p.getCents(),shipping:f.getCents(),currency:"EUR",source:"cardmarket",externalRef:a,happenedAt:new Date(o.dateOfPurchase),createdAt:r,updatedAt:r};if(await Jt.add(g),o.direction==="purchase"){const w=await ge().transactions.where("externalRef").startsWith(`cardmarket:article:${o.orderId}:`).toArray();for(const x of w)if(x.lotId){const k=await kt.getById(x.lotId);if(k){const S=parseInt(o.articleCount)||1,E=x.quantity/S,D=Mr.calculateTrueAcquisitionCost(u.getCents()/100,f.getCents()/100,p.getCents()/100,S),T=Math.round(f.getCents()*E/x.quantity),P=Math.round(p.getCents()*E/x.quantity);await kt.update(k.id,{acquisitionPriceCent:D,acquisitionFeesCent:P,acquisitionShippingCent:T,totalAcquisitionCostCent:D+P+T,updatedAt:r})}}}if(o.direction==="sale"){const w=await ge().transactions.where("externalRef").startsWith(`cardmarket:article:${o.orderId}:`).toArray();for(const x of w)if(x.lotId){const k=await kt.getById(x.lotId);if(k){const S=parseInt(o.articleCount)||1,E=x.quantity/S,D=Math.round(u.getCents()/S),T=Math.round(p.getCents()*E/x.quantity),P=Math.round(f.getCents()*E/x.quantity);await kt.update(k.id,{salePriceCent:D,saleFeesCent:T,saleShippingCent:P,totalSaleRevenueCent:D-T+P,updatedAt:r})}}}}n.completeImport(s)}catch(r){throw console.error("Error importing Cardmarket orders:",r),n.completeImport(s,r.message),r}}static async importCardmarketArticles(e){const n=Rr(),s=yo();n.addImport({id:s,type:"cardmarket",name:"Cardmarket Articles",status:"pending",progress:0,totalItems:e.length,processedItems:0});try{const r=new Date;for(let i=0;i<e.length;i++){const o=e[i];n.updateImport(s,{status:"processing",processedItems:i+1,progress:Math.round((i+1)/e.length*100)});const{cardId:a,cardData:l}=await this.resolveCard(o),c=Be.parse(o.price,"EUR");a&&await this.ensureCardInDb(a,l,o);let u;o.direction==="purchase"&&(u=await this.getOrCreateLotForPurchase(a,c,o)),await this.createTransactionForArticle(o,a,u,c,r)}n.completeImport(s)}catch(r){throw console.error("Error importing Cardmarket articles:",r),n.completeImport(s,r.message),r}}static async resolveCard(e){let n=null,s=null;if(e.productId){const r=e.productId.split(" | ").map(i=>i.trim());if(r.length===1)n=await ln.getByCardmarketId(r[0]),console.log(JSON.stringify({product_ids:r,resolved_via:"cardmarket_id",cardmarket_id:r[0],final_uri:`/cards/cardmarket/${r[0]}`}));else if(r.length>1){const i=await ln.getByCardmarketIds(r);i&&i.length>0&&(n=i[0],console.log(JSON.stringify({product_ids:r,resolved_via:"cardmarket_id",cardmarket_id:r[0],final_uri:"/cards/collection"})))}s=n?.id||null}if(!s){const r=await Ug(e.expansion),i=this.extractCollectorNumber(e.name);let o=e.name,a=null;const l=e.name.match(/^(.+?)\s*\((V\.\d+)\)$/i);l&&(o=l[1].trim(),a=l[2]),console.log(JSON.stringify({product_ids:e.productId?e.productId.split(" | ").map(c=>c.trim()):[],resolved_via:"set+cn",set_code:r,collector_number:i,final_uri:r?`/cards/${r}/${i}`:""})),n=await ln.hydrateCard({name:o,setCode:r||e.expansion,collectorNumber:i,version:a}),s=n?.id||null,s||console.log(JSON.stringify({product_ids:e.productId?e.productId.split(" | ").map(c=>c.trim()):[],resolved_via:"none",set_code:null,collector_number:"",final_uri:"",name:e.name,expansion:e.expansion}))}return{cardId:s,cardData:n}}static extractCollectorNumber(e){const n=[/-\s*(\d+[a-zA-Z★]*)\s*-/i,/-\s*([IVXLCDM]+)\s*-/i,/\s+(\d+[a-zA-Z★]*)\s*$/i,/\((\d+[a-zA-Z★]*)\)/i];for(const s of n){const r=e.match(s);if(r)return r[1]}return""}static async ensureCardInDb(e,n,s){if(await Ut.getById(e))await this.updatePriceForCard(e);else{const i=n||await ln.hydrateCard({scryfall_id:e,name:s.name,setCode:s.expansion,collectorNumber:""}),o=await ln.getImageUrlById(e),a={id:e,oracleId:i?.oracle_id||n?.oracle_id||"",name:s.name,set:i?.set_name||n?.set_name||s.expansion,setCode:i?.set||n?.set||await Ug(s.expansion)||"",number:i?.collector_number||n?.collector_number||this.extractCollectorNumber(s.name)||"",lang:i?.lang||n?.lang||"en",finish:"nonfoil",layout:o?.layout||"normal",imageUrl:o?.front||"",imageUrlBack:o?.back||"",cardmarketId:typeof i?.cardmarket_id=="number"?i.cardmarket_id:void 0,createdAt:new Date,updatedAt:new Date};await Ut.add(a),await this.updatePriceForCard(e)}}static async updatePriceForCard(e){try{const n=new Date,s=n.toISOString().split("T")[0],r=`${e}:scryfall:${s}`;if(!await ge().price_points.get(r)){const a=await ln.getPriceById(e);if(a){const l={id:r,cardId:e,provider:"scryfall",finish:"nonfoil",date:n.toISOString().split("T")[0],currency:"EUR",priceCent:a.getCents(),asOf:n,createdAt:n};await ge().price_points.put(l)}}}catch(n){console.error(`Error checking/updating price for existing card ${e}:`,n)}}static async getOrCreateLotForPurchase(e,n,s){const r=new Date,i=`cardmarket:lot:${s.shipmentId}:${s.lineNumber}`,o=await kt.getByExternalRef(i);let a=null;if(o.length>0)a=o[0];else if(e){const l=await kt.getByCardId(e);for(const c of l)if(!(await Jt.getByLotId(c.id)).some(p=>p.kind==="BUY")){a=c;break}}if(a)return await kt.update(a.id,{unitCost:n.getCents(),source:"cardmarket",purchasedAt:new Date(s.dateOfPurchase),updatedAt:r,acquisitionPriceCent:n.getCents(),acquisitionFeesCent:0,acquisitionShippingCent:0,totalAcquisitionCostCent:n.getCents()}),a.id;{const l=`lot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c={id:l,cardId:e||"",quantity:parseInt(s.amount)||1,unitCost:n.getCents(),condition:"",language:"",foil:!1,finish:"nonfoil",source:"cardmarket",currency:"EUR",externalRef:i,purchasedAt:new Date(s.dateOfPurchase),acquisitionPriceCent:n.getCents(),acquisitionFeesCent:0,acquisitionShippingCent:0,totalAcquisitionCostCent:n.getCents(),createdAt:r,updatedAt:r};return await kt.add(c),l}}static async createTransactionForArticle(e,n,s,r,i){const o=`cardmarket:article:${e.shipmentId}:${e.lineNumber}`;if(await ge().transactions.where("externalRef").equals(o).first())return;const c={id:`article-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kind:e.direction==="sale"?"SELL":"BUY",cardId:n||void 0,lotId:s,quantity:parseInt(e.amount)||1,unitPrice:r.getCents(),fees:0,shipping:0,currency:"EUR",source:"cardmarket",externalRef:o,happenedAt:new Date(e.dateOfPurchase),createdAt:i,updatedAt:i};await Jt.add(c)}static async checkForExistingImports(e){const n=[];for(const s of e){const r=`cardmarket:article:${s.shipmentId}:${s.lineNumber}`,o=await ge().transactions.where("externalRef").equals(r).first();n.push({article:s,exists:!!o})}return n}static async importManaboxScansWithBoxCost(e,n,s,r,i){const o=Rr(),a=yo();o.addImport({id:a,type:"manabox",name:"ManaBox Scans",status:"pending",progress:0,totalItems:e.length,processedItems:0});try{const l=await yE(e,n,s,r,i,(c,u)=>{o.updateImport(a,{status:"processing",processedItems:c,progress:Math.round(c/u*100)})});return o.completeImport(a),l}catch(l){throw console.error("Error importing Manabox scans with box cost:",l),o.completeImport(a,l.message),l}}static async importCardmarketSells(e){return await vE(e)}static async importDecks(e,n){return await bE(e,n)}}const _E={class:"cardmarket-wizard"},wE={class:"wizard-progress"},xE={class:"step-number"},kE={class:"step-label"},CE={class:"card"},SE={class:"card-body"},PE={class:"wizard-content"},AE={key:0,class:"step-content"},IE={class:"file-upload-section"},EE={class:"mb-3"},ME={key:0,class:"files-info"},OE={class:"file-list"},DE={class:"file-name"},TE={class:"file-type"},RE={class:"file-size"},$E={key:0,class:"error-messages"},FE={key:1,class:"step-content"},LE={key:0,class:"preview-stats"},BE={class:"stat"},jE={class:"stat-value"},NE={class:"stat"},zE={class:"stat-value"},qE={class:"stat"},UE={class:"stat-value"},WE={key:1,class:"preview-table-container"},VE={class:"preview-table-wrapper"},HE={class:"preview-table"},KE={key:0},YE={key:1},GE={key:2},XE={key:3},QE={key:4},JE={key:5},ZE={key:6},eM={key:7},tM={key:8},nM={key:9},sM={key:10},rM={key:11},iM={key:12},oM={key:13},aM={key:14},lM={key:0},cM={key:1},uM={key:2},dM={key:3},fM={key:4},hM={key:5},pM={key:6},gM={key:7},mM={key:8},yM={key:9},vM={key:10},bM={key:11},_M={key:12},wM={key:13},xM={key:14},kM={key:0},CM=["colspan"],SM={key:2,class:"invalid-rows-section"},PM={class:"invalid-rows"},AM={class:"row-number"},IM={class:"row-errors"},EM={key:0,class:"more-rows"},MM={key:2,class:"step-content"},OM={key:0,class:"conflicts-section"},DM={class:"conflicts-list"},TM={class:"flex-grow-1"},RM={class:"fw-medium"},$M={class:"small text-muted"},FM={key:1,class:"conflicts-section"},LM={class:"conflicts-list"},BM={class:"flex-grow-1"},jM={class:"fw-medium"},NM={class:"small text-muted"},zM={key:3,class:"step-content"},qM={class:"summary-stats"},UM={class:"stat"},WM={class:"stat-value"},VM={class:"stat"},HM={class:"stat-value"},KM={key:0,class:"stat"},YM={class:"stat-value"},GM={class:"summary-details"},XM={class:"summary-grid"},QM={class:"summary-item"},JM={class:"summary-value"},ZM={class:"summary-item"},eO={class:"summary-value"},tO={class:"summary-item"},nO={class:"summary-value"},sO={key:0,class:"import-status error"},rO={class:"wizard-navigation pt-3"},iO=["disabled"],oO=["disabled"],aO=et({__name:"CardmarketImportWizard",setup(t){const e=[{key:"upload",title:"Upload"},{key:"preview",title:"Preview"},{key:"conflicts",title:"Conflicts"},{key:"summary",title:"Summary"}],n=fe(0),s=fe([]),r=fe({}),i=fe({}),o=fe({}),a=fe(!1),l=fe(null),c=fe({}),u=fe([]),f=Z=>{if(Z===0)return"0 Bytes";const ne=1024,X=["Bytes","KB","MB","GB"],Le=Math.floor(Math.log(Z)/Math.log(ne));return parseFloat((Z/Math.pow(ne,Le)).toFixed(2))+" "+X[Le]},p=Z=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(Z/100),g=async Z=>{const X=Z.target.files;if(!(!X||X.length===0)){u.value=[],s.value=Array.from(X);try{for(const Le of s.value){if(!Le.name.endsWith(".csv")){u.value.push(`File ${Le.name} is not a CSV file.`);continue}const Se=await Le.text();r.value[Le.name]=Se,i.value[Le.name]=ue(Le.name)}await v()}catch(Le){u.value.push("Failed to read the files: "+Le.message)}}},v=async()=>{try{o.value={};for(const[Z,ne]of Object.entries(r.value)){const X=i.value[Z];if(X==="unknown"){console.warn(`Skipping unknown file type: ${Z}`);continue}const Le=new sE;let Se="",Ve="sale";switch(X){case"transactions":Se="parseTransactions";break;case"sold-orders":Se="parseOrders",Ve="sale";break;case"purchased-orders":Se="parseOrders",Ve="purchase";break;case"sold-articles":Se="parseArticles",Ve="sale";break;case"purchased-articles":Se="parseArticles",Ve="purchase";break}Le.postMessage({type:Se,data:ne,direction:Ve});const wt=await new Promise((gt,it)=>{Le.onmessage=ae=>{const{type:Oe,result:re,error:Fe}=ae.data;console.log("Worker response type:",Oe),Fe?it(new Error(Fe)):gt(re)},Le.onerror=ae=>{it(ae)}});o.value[X]=wt,Le.terminate()}await _e()}catch(Z){u.value.push("Failed to parse CSV data: "+Z.message)}},w=We(()=>n.value===0?s.value.length>0&&u.value.length===0:!0),x=async()=>{w.value&&(n.value===0&&await v(),n.value<e.length-1&&n.value++)},k=()=>{n.value>0&&n.value--},S=async()=>{if(!a.value){a.value=!0,l.value=null;try{for(const[Z,ne]of Object.entries(o.value)){if(!ne||ne.length===0)continue;const X=pe(ne,Z);switch(Z){case"transactions":await vo.importCardmarketTransactions(X);break;case"sold-orders":case"purchased-orders":await vo.importCardmarketOrders(X);break;case"sold-articles":case"purchased-articles":await vo.importCardmarketArticles(X);break}}l.value="Import completed successfully! Check the status indicator in the top right for details.",setTimeout(()=>{n.value=0,s.value=[],r.value={},i.value={},o.value={},u.value=[],a.value=!1,l.value=null},3e3)}catch(Z){l.value="Failed to import data: "+Z.message,a.value=!1}}},E=Z=>pe(o.value[Z]||[],Z),D=Z=>pe(o.value[Z]||[],Z).filter(X=>ke(Z,X)),T=()=>Object.values(o.value).reduce((Z,ne)=>Z+(ne?.length||0),0),P=()=>{let Z=0;for(const[ne,X]of Object.entries(o.value))X&&(Z+=pe(X,ne).length);return Z},A=Z=>{if(/^\d{2}\.\d{2}\.\d{4} \d{2}:\d{2}:\d{2}$/.test(Z)){const Le=Z.split(" ")[0].split("."),Se=parseInt(Le[0],10),Ve=parseInt(Le[1],10)-1,wt=parseInt(Le[2],10),gt=new Date(wt,Ve,Se);return gt.getFullYear()===wt&&gt.getMonth()===Ve&&gt.getDate()===Se}if(/^\d{2}\.\d{2}\.\d{4}$/.test(Z)){const ne=Z.split("."),X=parseInt(ne[0],10),Le=parseInt(ne[1],10)-1,Se=parseInt(ne[2],10),Ve=new Date(Se,Le,X);return Ve.getFullYear()===Se&&Ve.getMonth()===Le&&Ve.getDate()===X}if(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(Z)){const ne=new Date(Z);return!isNaN(ne.getTime())}if(/^\d{4}-\d{2}-\d{2}$/.test(Z)){const ne=new Date(Z);return!isNaN(ne.getTime())}return!1},$=Z=>{if(Z==null)return!1;if(typeof Z=="number")return Number.isFinite(Z);const ne=String(Z).trim().replace(/[€$£\s]/g,"").replace(",","."),X=Number.parseFloat(ne);return Number.isFinite(X)},I=Z=>{const ne=Number.parseInt(String(Z??"").trim(),10);return Number.isFinite(ne)&&ne>0};function Y(Z){switch(Z){case"transactions":return"Transaction Summary";case"sold-orders":return"Sold Orders";case"purchased-orders":return"Purchased Orders";case"sold-articles":return"Sold Articles";case"purchased-articles":return"Purchased Articles";default:return"Unknown File Type"}}const U=Z=>{switch(Z){case"transactions":return 5;case"sold-orders":case"purchased-orders":return 6;case"sold-articles":case"purchased-articles":return 8;default:return 5}},z=(Z,ne)=>{const X=[];if(!Z.date&&!Z.dateOfPurchase)X.push("Date is required");else{const Le=Z.date||Z.dateOfPurchase;A(Le)||X.push("Invalid date format (expected DD.MM.YYYY or YYYY-MM-DD)")}return ne.includes("articles")?(Z.name||X.push("Card name is required"),Z.expansion||X.push("Expansion/Set is required"),Z.price===void 0||Z.price===null||String(Z.price).trim()===""?X.push("Price is required"):$(Z.price)||X.push("Invalid price format (expected numeric value)"),Z.amount===void 0||Z.amount===null||String(Z.amount).trim()===""?X.push("Quantity is required"):I(Z.amount)||X.push("Invalid quantity (expected positive integer)"),Z.shipmentId||X.push("Order ID is required")):ne.includes("orders")?(Z.dateOfPurchase?A(Z.dateOfPurchase)||X.push("Invalid date format (expected DD.MM.YYYY or YYYY-MM-DD)"):X.push("Date is required"),Z.orderId||X.push("Order ID is required"),Z.articleCount?I(Z.articleCount)||X.push("Invalid article count (expected positive integer)"):X.push("Article count is required"),Z.merchandiseValue===void 0||Z.merchandiseValue===null||String(Z.merchandiseValue).trim()===""?X.push("Merchandise value is required"):$(Z.merchandiseValue)||X.push("Invalid merchandise value format (expected numeric value)")):ne==="transactions"&&(Z.reference||X.push("Reference is required"),Z.amount===void 0||Z.amount===null||String(Z.amount).trim()===""?X.push("Amount is required"):$(Z.amount)||X.push("Invalid amount format (expected numeric value)"),Z.category||X.push("Category is required"),Z.type||X.push("Type is required")),X},pe=(Z,ne="articles")=>Z.filter(X=>z(X,ne).length===0),ye=(Z,ne="articles")=>Z.map((X,Le)=>({index:Le,row:X,errors:z(X,ne)})).filter(X=>X.errors.length>0),ue=Z=>{const ne=Z.toLowerCase();return ne.includes("transaction")?"transactions":ne.includes("sold orders")?"sold-orders":ne.includes("purchased orders")?"purchased-orders":ne.includes("sold articles")?"sold-articles":ne.includes("purchased articles")?"purchased-articles":"unknown"},_e=async()=>{try{c.value={};for(const[Z,ne]of Object.entries(o.value))if(!(!ne||ne.length===0)&&Z.includes("articles")){const X=await vo.checkForExistingImports(ne);for(const Le of X){const Se=`${Z}:${Le.article.shipmentId}:${Le.article.lineNumber}`;c.value[Se]=Le.exists}}}catch(Z){console.error("Error checking for existing imports:",Z)}},ke=(Z,ne)=>{const X=`${Z}:${ne.shipmentId}:${ne.lineNumber}`;return!!c.value[X]};return(Z,ne)=>(j(),W("div",_E,[ne[29]||(ne[29]=b("h1",null,"Cardmarket Import Wizard",-1)),b("div",wE,[(j(),W(Qe,null,It(e,(X,Le)=>b("div",{key:X.key,class:At(["step",{active:n.value===Le,completed:Le<n.value}])},[b("div",xE,te(Le+1),1),b("div",kE,te(X.title),1)],2)),64))]),b("div",CE,[b("div",SE,[b("div",PE,[n.value===0?(j(),W("div",AE,[ne[2]||(ne[2]=Gy('<h2 data-v-4f46dc4c>Upload CSV Files</h2><p data-v-4f46dc4c>Please select all Cardmarket CSV export files to import. You can select multiple files at once.</p><div class="alert alert-info mb-4" data-v-4f46dc4c><h3 class="alert-heading" data-v-4f46dc4c>Where to Get Cardmarket CSV Files</h3><p data-v-4f46dc4c>Cardmarket provides several types of CSV exports. For the best import results, we recommend downloading these files:</p><div class="row" data-v-4f46dc4c><div class="col-md-6" data-v-4f46dc4c><h4 data-v-4f46dc4c>1. Transaction Summary</h4><p data-v-4f46dc4c>Contains financial summary of all your transactions (sales, purchases, fees).</p><p data-v-4f46dc4c><strong data-v-4f46dc4c>Download from:</strong><br data-v-4f46dc4c> Cardmarket → My Account → Transactions → All Transactions → Download CSV</p><p class="mb-1" data-v-4f46dc4c><strong data-v-4f46dc4c>Direct link:</strong></p><a href="https://www.cardmarket.com/de/Magic/Account/Transactions/Details" target="_blank" rel="noopener noreferrer" class="btn btn-sm btn-glass-primary" data-v-4f46dc4c> Go to Transactions Page </a></div><div class="col-md-6" data-v-4f46dc4c><h4 data-v-4f46dc4c>2. Sold Articles</h4><p data-v-4f46dc4c>Contains detailed information about individual items you&#39;ve sold.</p><p data-v-4f46dc4c><strong data-v-4f46dc4c>Download from:</strong><br data-v-4f46dc4c> Cardmarket → My Account → Statistics → Sold Articles → CSV Export</p><p class="mb-1" data-v-4f46dc4c><strong data-v-4f46dc4c>Direct link:</strong></p><a href="https://www.cardmarket.com/de/Magic/Account/Statistics" target="_blank" rel="noopener noreferrer" class="btn btn-sm btn-glass-primary" data-v-4f46dc4c> Go to Statistics Page </a></div></div><div class="row mt-3" data-v-4f46dc4c><div class="col-md-6" data-v-4f46dc4c><h4 data-v-4f46dc4c>3. Purchased Articles</h4><p data-v-4f46dc4c>Contains detailed information about individual items you&#39;ve bought.</p><p data-v-4f46dc4c><strong data-v-4f46dc4c>Download from:</strong><br data-v-4f46dc4c> Cardmarket → My Account → Statistics → Purchased Articles → CSV Export</p><p class="mb-1" data-v-4f46dc4c><strong data-v-4f46dc4c>Direct link:</strong></p><a href="https://www.cardmarket.com/de/Magic/Account/Statistics" target="_blank" rel="noopener noreferrer" class="btn btn-sm btn-glass-primary" data-v-4f46dc4c> Go to Statistics Page </a></div><div class="col-md-6" data-v-4f46dc4c><h4 data-v-4f46dc4c>Optional: Order Details</h4><p data-v-4f46dc4c>Sold Orders and Purchased Orders contain redundant information. Only import if you specifically need order-level details.</p><p data-v-4f46dc4c><strong data-v-4f46dc4c>Download from:</strong><br data-v-4f46dc4c> Cardmarket → My Account → Statistics → Sold/Purchased Orders → CSV Export</p></div></div><div class="mt-3" data-v-4f46dc4c><small class="text-muted" data-v-4f46dc4c><strong data-v-4f46dc4c>Tip:</strong> The most important files are Transaction Summary, Sold Articles, and Purchased Articles. Order files (Sold Orders, Purchased Orders) contain redundant information but can be imported if needed. </small></div></div>',3)),b("div",IE,[b("div",EE,[ne[0]||(ne[0]=b("label",{for:"csv-files",class:"form-label"}," Choose CSV Files ",-1)),b("input",{id:"csv-files",type:"file",accept:".csv",multiple:"",onChange:g,class:"form-control"},null,32)]),s.value.length>0?(j(),W("div",ME,[ne[1]||(ne[1]=b("h3",null,"Uploaded Files",-1)),b("ul",OE,[(j(!0),W(Qe,null,It(s.value,X=>(j(),W("li",{key:X.name,class:"file-item"},[b("span",DE,te(X.name),1),b("span",TE,"("+te(ue(X.name))+")",1),b("span",RE,"- "+te(f(X.size)),1)]))),128))])])):ve("",!0)]),u.value.length>0?(j(),W("div",$E,[(j(!0),W(Qe,null,It(u.value,X=>(j(),W("div",{key:X,class:"error-message"},te(X),1))),128))])):ve("",!0)])):n.value===1?(j(),W("div",FE,[ne[10]||(ne[10]=b("h2",null,"Preview Data",-1)),ne[11]||(ne[11]=b("p",null,"Review the data that will be imported. Check for any issues before proceeding.",-1)),(j(!0),W(Qe,null,It(i.value,(X,Le)=>(j(),W("div",{key:Le,class:"file-preview"},[b("h3",null,te(Y(X)),1),o.value[X]&&o.value[X].length>0?(j(),W("div",LE,[b("div",BE,[b("div",jE,te(o.value[X].length),1),ne[3]||(ne[3]=b("div",{class:"stat-label"},"Total Rows",-1))]),b("div",NE,[b("div",zE,te(pe(o.value[X],X).length),1),ne[4]||(ne[4]=b("div",{class:"stat-label"},"Valid Rows",-1))]),b("div",qE,[b("div",UE,te(ye(o.value[X],X).length),1),ne[5]||(ne[5]=b("div",{class:"stat-label"},"Invalid Rows",-1))])])):ve("",!0),o.value[X]&&o.value[X].length>0?(j(),W("div",WE,[ne[7]||(ne[7]=b("h4",null,"Valid Data Preview",-1)),b("div",VE,[b("table",HE,[b("thead",null,[b("tr",null,[X==="transactions"?(j(),W("th",KE,"Reference")):(j(),W("th",YE,"Line")),ne[6]||(ne[6]=b("th",null,"Date",-1)),X.includes("articles")?(j(),W("th",GE,"Card Name")):ve("",!0),X.includes("articles")?(j(),W("th",XE,"Expansion")):ve("",!0),X.includes("articles")?(j(),W("th",QE,"Price")):ve("",!0),X.includes("articles")?(j(),W("th",JE,"Quantity")):ve("",!0),X.includes("articles")?(j(),W("th",ZE,"Order ID")):ve("",!0),X.includes("articles")?(j(),W("th",eM,"Status")):ve("",!0),X.includes("orders")?(j(),W("th",tM,"Order ID")):ve("",!0),X.includes("orders")?(j(),W("th",nM,"Username")):ve("",!0),X.includes("orders")?(j(),W("th",sM,"Article Count")):ve("",!0),X.includes("orders")?(j(),W("th",rM,"Merchandise Value")):ve("",!0),X==="transactions"?(j(),W("th",iM,"Category")):ve("",!0),X==="transactions"?(j(),W("th",oM,"Type")):ve("",!0),X==="transactions"?(j(),W("th",aM,"Amount")):ve("",!0)])]),b("tbody",null,[(j(!0),W(Qe,null,It(pe(o.value[X],X).slice(0,5),(Se,Ve)=>(j(),W("tr",{key:Ve},[X==="transactions"?(j(),W("td",lM,te(Se.reference),1)):(j(),W("td",cM,te(Se.lineNumber),1)),b("td",null,te(Se.date||Se.dateOfPurchase),1),X.includes("articles")?(j(),W("td",uM,te(Se.name),1)):ve("",!0),X.includes("articles")?(j(),W("td",dM,te(Se.expansion),1)):ve("",!0),X.includes("articles")?(j(),W("td",fM,te(p(parseFloat(String(Se.price).replace(/[€$£\s]/g,"").replace(",","."))*100)),1)):ve("",!0),X.includes("articles")?(j(),W("td",hM,te(Se.amount),1)):ve("",!0),X.includes("articles")?(j(),W("td",pM,te(Se.shipmentId),1)):ve("",!0),X.includes("articles")?(j(),W("td",gM,[b("span",{class:At(ke(X,Se)?"text-success":"text-primary")},te(ke(X,Se)?"Already Imported":"New"),3)])):ve("",!0),X.includes("orders")?(j(),W("td",mM,te(Se.orderId),1)):ve("",!0),X.includes("orders")?(j(),W("td",yM,te(Se.username),1)):ve("",!0),X.includes("orders")?(j(),W("td",vM,te(Se.articleCount),1)):ve("",!0),X.includes("orders")?(j(),W("td",bM,te(p(parseFloat(String(Se.merchandiseValue).replace(/[€$£\s]/g,"").replace(",","."))*100)),1)):ve("",!0),X==="transactions"?(j(),W("td",_M,te(Se.category),1)):ve("",!0),X==="transactions"?(j(),W("td",wM,te(Se.type),1)):ve("",!0),X==="transactions"?(j(),W("td",xM,te(p(parseFloat(String(Se.amount).replace(/[€$£\s]/g,"").replace(",","."))*100)),1)):ve("",!0)]))),128)),pe(o.value[X],X).length>5?(j(),W("tr",kM,[b("td",{colspan:U(X),class:"more-rows-cell"}," ... and "+te(pe(o.value[X],X).length-5)+" more rows ",9,CM)])):ve("",!0)])])])])):ve("",!0),ye(o.value[X],X).length>0?(j(),W("div",SM,[ne[8]||(ne[8]=b("h4",null,"Invalid Rows",-1)),ne[9]||(ne[9]=b("p",null,"The following rows have issues and will be skipped:",-1)),b("div",PM,[(j(!0),W(Qe,null,It(ye(o.value[X],X).slice(0,3),(Se,Ve)=>(j(),W("div",{key:Ve,class:"invalid-row"},[b("div",AM,"Row "+te(Se.row.lineNumber||Se.row.reference),1),b("div",IM,te(Se.errors.join(", ")),1)]))),128)),ye(o.value[X],X).length>3?(j(),W("div",EM," ... and "+te(ye(o.value[X],X).length-3)+" more rows ",1)):ve("",!0)])])):ve("",!0)]))),128))])):n.value===2?(j(),W("div",MM,[ne[18]||(ne[18]=b("h2",null,"Resolve Conflicts",-1)),ne[19]||(ne[19]=b("p",null,"Check for duplicate imports and resolve any conflicts.",-1)),(j(!0),W(Qe,null,It(i.value,(X,Le)=>(j(),W("div",{key:Le,class:"file-conflicts"},[b("h3",null,te(Y(X)),1),X.includes("articles")&&D(X).length>0?(j(),W("div",OM,[ne[13]||(ne[13]=b("h4",null,"Already Imported Articles",-1)),ne[14]||(ne[14]=b("p",null,"The following articles have already been imported and will be skipped:",-1)),b("div",DM,[(j(!0),W(Qe,null,It(D(X),(Se,Ve)=>(j(),W("div",{key:Ve,class:"d-flex justify-content-between align-items-center p-2 bg-light rounded"},[b("div",TM,[b("div",RM,te(Se.name),1),b("div",$M,te(Se.expansion)+" • "+te(Se.amount)+" × "+te(p(parseFloat(String(Se.price).replace(/[€$£\s]/g,"").replace(",","."))*100))+" • Order #"+te(Se.shipmentId),1)]),ne[12]||(ne[12]=b("div",{class:"ms-3"},[b("span",{class:"text-success fw-medium"},"Already Imported")],-1))]))),128))])])):ve("",!0),X.includes("articles")&&E(X).length>0?(j(),W("div",FM,[ne[16]||(ne[16]=b("h4",null,"New Articles to Import",-1)),ne[17]||(ne[17]=b("p",null,"The following articles will be imported:",-1)),b("div",LM,[(j(!0),W(Qe,null,It(E(X).filter(Se=>!ke(X,Se)),(Se,Ve)=>(j(),W("div",{key:Ve,class:"d-flex justify-content-between align-items-center p-2 bg-light rounded"},[b("div",BM,[b("div",jM,te(Se.name),1),b("div",NM,te(Se.expansion)+" • "+te(Se.amount)+" × "+te(p(parseFloat(String(Se.price).replace(/[€$£\s]/g,"").replace(",","."))*100))+" • Order #"+te(Se.shipmentId),1)]),ne[15]||(ne[15]=b("div",{class:"ms-3"},[b("span",{class:"text-primary fw-medium"},"New")],-1))]))),128))])])):ve("",!0)]))),128))])):n.value===3?(j(),W("div",zM,[ne[27]||(ne[27]=b("h2",null,"Import Summary",-1)),ne[28]||(ne[28]=b("p",null,"Review the import summary before finalizing.",-1)),(j(!0),W(Qe,null,It(i.value,(X,Le)=>(j(),W("div",{key:Le,class:"file-summary"},[b("h3",null,te(Y(X)),1),b("div",qM,[b("div",UM,[b("div",WM,te(E(X).length),1),ne[20]||(ne[20]=b("div",{class:"stat-label"},"New Records",-1))]),b("div",VM,[b("div",HM,te(ye(o.value[X]||[],X).length),1),ne[21]||(ne[21]=b("div",{class:"stat-label"},"Invalid Rows",-1))]),X.includes("articles")?(j(),W("div",KM,[b("div",YM,te(D(X).length),1),ne[22]||(ne[22]=b("div",{class:"stat-label"},"Already Imported",-1))])):ve("",!0)])]))),128)),b("div",GM,[ne[26]||(ne[26]=b("h3",null,"Import Details",-1)),b("div",XM,[b("div",QM,[ne[23]||(ne[23]=b("div",{class:"summary-label"},"Files Uploaded",-1)),b("div",JM,te(s.value.length),1)]),b("div",ZM,[ne[24]||(ne[24]=b("div",{class:"summary-label"},"Total Rows Parsed",-1)),b("div",eO,te(T()),1)]),b("div",tO,[ne[25]||(ne[25]=b("div",{class:"summary-label"},"Total Valid Rows",-1)),b("div",nO,te(P()),1)])])]),l.value?(j(),W("div",sO,te(l.value),1)):ve("",!0)])):ve("",!0)])])]),b("div",rO,[n.value>0?(j(),W("button",{key:0,onClick:k,class:"btn btn-secondary"}," Previous ")):ve("",!0),n.value<e.length-1?(j(),W("button",{key:1,onClick:x,class:"btn btn-glass-primary",disabled:!w.value}," Next ",8,iO)):ve("",!0),n.value===e.length-1?(j(),W("button",{key:2,onClick:S,class:"btn btn-glass-primary",disabled:a.value},te(a.value?"Importing...":"Import Data"),9,oO)):ve("",!0)])]))}}),lO=fn(aO,[["__scopeId","data-v-4f46dc4c"]]);var xr={},ms={},kr={},Wg;function wb(){if(Wg)return kr;Wg=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.DefaultSerializer=kr.extendSerializer=void 0;function t(s,r){const i=s.deserialize.bind(s),o=s.serialize.bind(s);return{deserialize(a){return r.deserialize(a,i)},serialize(a){return r.serialize(a,o)}}}kr.extendSerializer=t;const e={deserialize(s){return Object.assign(Error(s.message),{name:s.name,stack:s.stack})},serialize(s){return{__error_marker:"$$error",message:s.message,name:s.name,stack:s.stack}}},n=s=>s&&typeof s=="object"&&"__error_marker"in s&&s.__error_marker==="$$error";return kr.DefaultSerializer={deserialize(s){return n(s)?e.deserialize(s):s},serialize(s){return s instanceof Error?e.serialize(s):s}},kr}var Vg;function ta(){if(Vg)return ms;Vg=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.serialize=ms.deserialize=ms.registerSerializer=void 0;const t=wb();let e=t.DefaultSerializer;function n(i){e=t.extendSerializer(e,i)}ms.registerSerializer=n;function s(i){return e.deserialize(i)}ms.deserialize=s;function r(i){return e.serialize(i)}return ms.serialize=r,ms}var Ou={},ys={},Cr={},Hg;function cO(){if(Hg)return Cr;Hg=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.getBundleURL=Cr.getBaseURL=void 0;let t;function e(){return t||(t=n()),t}Cr.getBundleURL=e;function n(){try{throw new Error}catch(r){const i=(""+r.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(i)return s(i[0])}return"/"}function s(r){return(""+r).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return Cr.getBaseURL=s,Cr}var Kg;function xb(){if(Kg)return ys;Kg=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.isWorkerRuntime=ys.getWorkerImplementation=ys.defaultPoolSize=void 0;const t=cO();ys.defaultPoolSize=typeof navigator<"u"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;const e=a=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(a);function n(a){const l=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(l)}function s(){if(typeof Worker>"u")return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class a extends Worker{constructor(u,f){var p,g;typeof u=="string"&&f&&f._baseURL?u=new URL(u,f._baseURL):typeof u=="string"&&!e(u)&&t.getBundleURL().match(/^file:\/\//i)&&(u=new URL(u,t.getBundleURL().replace(/\/[^\/]+$/,"/")),(!((p=f?.CORSWorkaround)!==null&&p!==void 0)||p)&&(u=n(`importScripts(${JSON.stringify(u)});`))),typeof u=="string"&&e(u)&&(!((g=f?.CORSWorkaround)!==null&&g!==void 0)||g)&&(u=n(`importScripts(${JSON.stringify(u)});`)),super(u,f)}}class l extends a{constructor(u,f){const p=window.URL.createObjectURL(u);super(p,f)}static fromText(u,f){const p=new window.Blob([u],{type:"text/javascript"});return new l(p,f)}}return{blob:l,default:a}}let r;function i(){return r||(r=s()),r}ys.getWorkerImplementation=i;function o(){const a=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!a)}return ys.isWorkerRuntime=o,ys}var Sr={},il={exports:{}},Du,Yg;function uO(){if(Yg)return Du;Yg=1;var t=1e3,e=t*60,n=e*60,s=n*24,r=s*7,i=s*365.25;Du=function(u,f){f=f||{};var p=typeof u;if(p==="string"&&u.length>0)return o(u);if(p==="number"&&isFinite(u))return f.long?l(u):a(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function o(u){if(u=String(u),!(u.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(f){var p=parseFloat(f[1]),g=(f[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*r;case"days":case"day":case"d":return p*s;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function a(u){var f=Math.abs(u);return f>=s?Math.round(u/s)+"d":f>=n?Math.round(u/n)+"h":f>=e?Math.round(u/e)+"m":f>=t?Math.round(u/t)+"s":u+"ms"}function l(u){var f=Math.abs(u);return f>=s?c(u,f,s,"day"):f>=n?c(u,f,n,"hour"):f>=e?c(u,f,e,"minute"):f>=t?c(u,f,t,"second"):u+" ms"}function c(u,f,p,g){var v=f>=p*1.5;return Math.round(u/p)+" "+g+(v?"s":"")}return Du}var Tu,Gg;function dO(){if(Gg)return Tu;Gg=1;function t(e){s.debug=s,s.default=s,s.coerce=c,s.disable=a,s.enable=i,s.enabled=l,s.humanize=uO(),s.destroy=u,Object.keys(e).forEach(f=>{s[f]=e[f]}),s.names=[],s.skips=[],s.formatters={};function n(f){let p=0;for(let g=0;g<f.length;g++)p=(p<<5)-p+f.charCodeAt(g),p|=0;return s.colors[Math.abs(p)%s.colors.length]}s.selectColor=n;function s(f){let p,g=null,v,w;function x(...k){if(!x.enabled)return;const S=x,E=Number(new Date),D=E-(p||E);S.diff=D,S.prev=p,S.curr=E,p=E,k[0]=s.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let T=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(A,$)=>{if(A==="%%")return"%";T++;const I=s.formatters[$];if(typeof I=="function"){const Y=k[T];A=I.call(S,Y),k.splice(T,1),T--}return A}),s.formatArgs.call(S,k),(S.log||s.log).apply(S,k)}return x.namespace=f,x.useColors=s.useColors(),x.color=s.selectColor(f),x.extend=r,x.destroy=s.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(v!==s.namespaces&&(v=s.namespaces,w=s.enabled(f)),w),set:k=>{g=k}}),typeof s.init=="function"&&s.init(x),x}function r(f,p){const g=s(this.namespace+(typeof p>"u"?":":p)+f);return g.log=this.log,g}function i(f){s.save(f),s.namespaces=f,s.names=[],s.skips=[];const p=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const g of p)g[0]==="-"?s.skips.push(g.slice(1)):s.names.push(g)}function o(f,p){let g=0,v=0,w=-1,x=0;for(;g<f.length;)if(v<p.length&&(p[v]===f[g]||p[v]==="*"))p[v]==="*"?(w=v,x=g,v++):(g++,v++);else if(w!==-1)v=w+1,x++,g=x;else return!1;for(;v<p.length&&p[v]==="*";)v++;return v===p.length}function a(){const f=[...s.names,...s.skips.map(p=>"-"+p)].join(",");return s.enable(""),f}function l(f){for(const p of s.skips)if(o(f,p))return!1;for(const p of s.names)if(o(f,p))return!0;return!1}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}return Tu=t,Tu}var Xg;function wf(){return Xg||(Xg=1,(function(t,e){var n={};e.formatArgs=r,e.save=i,e.load=o,e.useColors=s,e.storage=a(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let f=0,p=0;c[0].replace(/%[a-zA-Z%]/g,g=>{g!=="%%"&&(f++,g==="%c"&&(p=f))}),c.splice(p,0,u)}e.log=console.debug||console.log||(()=>{});function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function o(){let c;try{c=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=n.DEBUG),c}function a(){try{return localStorage}catch{}}t.exports=dO()(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(il,il.exports)),il.exports}var fO=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class yc{constructor(e){this._baseObserver=e,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(e=>this._baseObserver.error(e))}error(e){this._baseObserver.error(e)}schedule(e){const n=Promise.all(this._pendingPromises),s=[],r=o=>s.push(o),i=Promise.resolve().then(()=>fO(this,void 0,void 0,function*(){yield n,yield e(r),this._pendingPromises.delete(i);for(const o of s)this._baseObserver.next(o)})).catch(o=>{this._pendingPromises.delete(i),this._baseObserver.error(o)});this._pendingPromises.add(i)}}const kb=()=>typeof Symbol=="function",ua=t=>kb()&&!!Symbol[t],xf=t=>ua(t)?Symbol[t]:"@@"+t;ua("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const hO=xf("iterator"),wd=xf("observable"),Cb=xf("species");function Wl(t,e){const n=t[e];if(n!=null){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}}function io(t){let e=t.constructor;return e!==void 0&&(e=e[Cb],e===null&&(e=void 0)),e!==void 0?e:Ht}function pO(t){return t instanceof Ht}function Ri(t){Ri.log?Ri.log(t):setTimeout(()=>{throw t},0)}function _l(t){Promise.resolve().then(()=>{try{t()}catch(e){Ri(e)}})}function Sb(t){const e=t._cleanup;if(e!==void 0&&(t._cleanup=void 0,!!e))try{if(typeof e=="function")e();else{const n=Wl(e,"unsubscribe");n&&n.call(e)}}catch(n){Ri(n)}}function xd(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function gO(t){const e=t._queue;if(e){t._queue=void 0,t._state="ready";for(const n of e)if(Pb(t,n.type,n.value),t._state==="closed")break}}function Pb(t,e,n){t._state="running";const s=t._observer;try{const r=s?Wl(s,e):void 0;switch(e){case"next":r&&r.call(s,n);break;case"error":if(xd(t),r)r.call(s,n);else throw n;break;case"complete":xd(t),r&&r.call(s);break}}catch(r){Ri(r)}t._state==="closed"?Sb(t):t._state==="running"&&(t._state="ready")}function Ru(t,e,n){if(t._state!=="closed"){if(t._state==="buffering"){t._queue=t._queue||[],t._queue.push({type:e,value:n});return}if(t._state!=="ready"){t._state="buffering",t._queue=[{type:e,value:n}],_l(()=>gO(t));return}Pb(t,e,n)}}class mO{constructor(e,n){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const s=new yO(this);try{this._cleanup=n.call(void 0,s)}catch(r){s.error(r)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(xd(this),Sb(this))}}class yO{constructor(e){this._subscription=e}get closed(){return this._subscription._state==="closed"}next(e){Ru(this._subscription,"next",e)}error(e){Ru(this._subscription,"error",e)}complete(){Ru(this._subscription,"complete")}}class Ht{constructor(e){if(!(this instanceof Ht))throw new TypeError("Observable cannot be called as a function");if(typeof e!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,n,s){return(typeof e!="object"||e===null)&&(e={next:e,error:n,complete:s}),new mO(e,this._subscriber)}pipe(e,...n){let s=this;for(const r of[e,...n])s=r(s);return s}tap(e,n,s){const r=typeof e!="object"||e===null?{next:e,error:n,complete:s}:e;return new Ht(i=>this.subscribe({next(o){r.next&&r.next(o),i.next(o)},error(o){r.error&&r.error(o),i.error(o)},complete(){r.complete&&r.complete(),i.complete()},start(o){r.start&&r.start(o)}}))}forEach(e){return new Promise((n,s)=>{if(typeof e!="function"){s(new TypeError(e+" is not a function"));return}function r(){i.unsubscribe(),n(void 0)}const i=this.subscribe({next(o){try{e(o,r)}catch(a){s(a),i.unsubscribe()}},error(o){s(o)},complete(){n(void 0)}})})}map(e){if(typeof e!="function")throw new TypeError(e+" is not a function");const n=io(this);return new n(s=>this.subscribe({next(r){let i=r;try{i=e(r)}catch(o){return s.error(o)}s.next(i)},error(r){s.error(r)},complete(){s.complete()}}))}filter(e){if(typeof e!="function")throw new TypeError(e+" is not a function");const n=io(this);return new n(s=>this.subscribe({next(r){try{if(!e(r))return}catch(i){return s.error(i)}s.next(r)},error(r){s.error(r)},complete(){s.complete()}}))}reduce(e,n){if(typeof e!="function")throw new TypeError(e+" is not a function");const s=io(this),r=arguments.length>1;let i=!1,o=n;return new s(a=>this.subscribe({next(l){const c=!i;if(i=!0,!c||r)try{o=e(o,l)}catch(u){return a.error(u)}else o=l},error(l){a.error(l)},complete(){if(!i&&!r)return a.error(new TypeError("Cannot reduce an empty sequence"));a.next(o),a.complete()}}))}concat(...e){const n=io(this);return new n(s=>{let r,i=0;function o(a){r=a.subscribe({next(l){s.next(l)},error(l){s.error(l)},complete(){i===e.length?(r=void 0,s.complete()):o(n.from(e[i++]))}})}return o(this),()=>{r&&(r.unsubscribe(),r=void 0)}})}flatMap(e){if(typeof e!="function")throw new TypeError(e+" is not a function");const n=io(this);return new n(s=>{const r=[],i=this.subscribe({next(a){let l;if(e)try{l=e(a)}catch(u){return s.error(u)}else l=a;const c=n.from(l).subscribe({next(u){s.next(u)},error(u){s.error(u)},complete(){const u=r.indexOf(c);u>=0&&r.splice(u,1),o()}});r.push(c)},error(a){s.error(a)},complete(){o()}});function o(){i.closed&&r.length===0&&s.complete()}return()=>{r.forEach(a=>a.unsubscribe()),i.unsubscribe()}})}[wd](){return this}static from(e){const n=typeof this=="function"?this:Ht;if(e==null)throw new TypeError(e+" is not an object");const s=Wl(e,wd);if(s){const r=s.call(e);if(Object(r)!==r)throw new TypeError(r+" is not an object");return pO(r)&&r.constructor===n?r:new n(i=>r.subscribe(i))}if(ua("iterator")){const r=Wl(e,hO);if(r)return new n(i=>{_l(()=>{if(!i.closed){for(const o of r.call(e))if(i.next(o),i.closed)return;i.complete()}})})}if(Array.isArray(e))return new n(r=>{_l(()=>{if(!r.closed){for(const i of e)if(r.next(i),r.closed)return;r.complete()}})});throw new TypeError(e+" is not observable")}static of(...e){const n=typeof this=="function"?this:Ht;return new n(s=>{_l(()=>{if(!s.closed){for(const r of e)if(s.next(r),s.closed)return;s.complete()}})})}static get[Cb](){return this}}kb()&&Object.defineProperty(Ht,Symbol("extensions"),{value:{symbol:wd,hostReportError:Ri},configurable:!0});function Kr(t){typeof t=="function"?t():t&&typeof t.unsubscribe=="function"&&t.unsubscribe()}var vO=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function bO(t){return e=>new Ht(n=>{const s=new yc(n),r=e.subscribe({complete(){s.complete()},error(i){s.error(i)},next(i){s.schedule(o=>vO(this,void 0,void 0,function*(){(yield t(i))&&o(i)}))}});return()=>Kr(r)})}function _O(t){return t&&ua("asyncIterator")&&t[Symbol.asyncIterator]}function wO(t){return t&&ua("iterator")&&t[Symbol.iterator]}var xO=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})},kO=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(i){n[i]=t[i]&&function(o){return new Promise(function(a,l){o=t[i](o),r(a,l,o.done,o.value)})}}function r(i,o,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},o)}};function CO(t){return e=>new Ht(n=>{const s=new yc(n),r=e.subscribe({complete(){s.complete()},error(i){s.error(i)},next(i){s.schedule(o=>xO(this,void 0,void 0,function*(){var a,l;const c=yield t(i);if(wO(c)||_O(c))try{for(var u=kO(c),f;f=yield u.next(),!f.done;){const p=f.value;o(p)}}catch(p){a={error:p}}finally{try{f&&!f.done&&(l=u.return)&&(yield l.call(u))}finally{if(a)throw a.error}}else c.map(p=>o(p))}))}});return()=>Kr(r)})}function SO(t){return new Ht(e=>{let n=0;const s=setInterval(()=>{e.next(n++)},t);return()=>clearInterval(s)})}var PO=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function AO(t){return e=>new Ht(n=>{const s=new yc(n),r=e.subscribe({complete(){s.complete()},error(i){s.error(i)},next(i){s.schedule(o=>PO(this,void 0,void 0,function*(){const a=yield t(i);o(a)}))}});return()=>Kr(r)})}function IO(...t){return t.length===0?Ht.from([]):new Ht(e=>{let n=0;const s=t.map(i=>i.subscribe({error(o){e.error(o),r()},next(o){e.next(o)},complete(){++n===t.length&&(e.complete(),r())}})),r=()=>{s.forEach(i=>Kr(i))};return r})}class Ab extends Ht{constructor(){super(e=>(this._observers.add(e),()=>this._observers.delete(e))),this._observers=new Set}next(e){for(const n of this._observers)n.next(e)}error(e){for(const n of this._observers)n.error(e)}complete(){for(const e of this._observers)e.complete()}}function EO(t){const e=new Ab;let n,s=0;return new Ht(r=>{n||(n=t.subscribe(e));const i=e.subscribe(r);return s++,()=>{s--,i.unsubscribe(),s===0&&(Kr(n),n=void 0)}})}var MO=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(f){o(f)}}function l(u){try{c(s.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function OO(t,e){return n=>new Ht(s=>{let r,i=0;const o=new yc(s),a=n.subscribe({complete(){o.complete()},error(l){o.error(l)},next(l){o.schedule(c=>MO(this,void 0,void 0,function*(){r=yield t(i===0?typeof e>"u"?l:e:r,l,i++),c(r)}))}});return()=>Kr(a)})}const DO=Object.freeze(Object.defineProperty({__proto__:null,Observable:Ht,Subject:Ab,filter:bO,flatMap:CO,interval:SO,map:AO,merge:IO,multicast:EO,scan:OO,unsubscribe:Kr},Symbol.toStringTag,{value:"Module"})),vc=hk(DO);var oo={},Qg;function TO(){if(Qg)return oo;Qg=1,Object.defineProperty(oo,"__esModule",{value:!0}),oo.allSettled=void 0;function t(e){return Promise.all(e.map(n=>{const s=o=>({status:"fulfilled",value:o}),r=o=>({status:"rejected",reason:o}),i=Promise.resolve(n);try{return i.then(s,r)}catch(o){return Promise.reject(o)}}))}return oo.allSettled=t,oo}var $u={},Jg;function RO(){return Jg||(Jg=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PoolEventType=void 0,(function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"})(t.PoolEventType||(t.PoolEventType={}))})($u)),$u}var ao={},Pn={},Zg;function kf(){return Zg||(Zg=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.$worker=Pn.$transferable=Pn.$terminate=Pn.$events=Pn.$errors=void 0,Pn.$errors=Symbol("thread.errors"),Pn.$events=Symbol("thread.events"),Pn.$terminate=Symbol("thread.terminate"),Pn.$transferable=Symbol("thread.transferable"),Pn.$worker=Symbol("thread.worker")),Pn}var em;function Ib(){if(em)return ao;em=1,Object.defineProperty(ao,"__esModule",{value:!0}),ao.Thread=void 0;const t=kf();function e(n){throw Error(n)}return ao.Thread={errors(n){return n[t.$errors]||e("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events(n){return n[t.$events]||e("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate(n){return n[t.$terminate]()}},ao}var tm;function $O(){return tm||(tm=1,(function(t){var e=Sr&&Sr.__awaiter||function(k,S,E,D){function T(P){return P instanceof E?P:new E(function(A){A(P)})}return new(E||(E=Promise))(function(P,A){function $(U){try{Y(D.next(U))}catch(z){A(z)}}function I(U){try{Y(D.throw(U))}catch(z){A(z)}}function Y(U){U.done?P(U.value):T(U.value).then($,I)}Y((D=D.apply(k,S||[])).next())})},n=Sr&&Sr.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pool=t.Thread=t.PoolEventType=void 0;const s=n(wf()),r=vc,i=TO(),o=xb(),a=RO();Object.defineProperty(t,"PoolEventType",{enumerable:!0,get:function(){return a.PoolEventType}});const l=Ib();Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return l.Thread}});let c=1;function u(k){const S=[];for(let E=0;E<k;E++)S.push(E);return S}function f(k){return new Promise(S=>setTimeout(S,k))}function p(k,S){return k.reduce((E,D)=>[...E,...S(D)],[])}function g(k){return k.replace(/\W/g," ").trim().replace(/\s+/g,"-")}function v(k,S){return u(S).map(()=>({init:k(),runningTasks:[]}))}class w{constructor(S,E){this.eventSubject=new r.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const D=typeof E=="number"?{size:E}:E||{},{size:T=o.defaultPoolSize}=D;this.debug=s.default(`threads:pool:${g(D.name||String(c++))}`),this.options=D,this.workers=v(S,T),this.eventObservable=r.multicast(r.Observable.from(this.eventSubject)),Promise.all(this.workers.map(P=>P.init)).then(()=>this.eventSubject.next({type:a.PoolEventType.initialized,size:this.workers.length}),P=>{this.debug("Error while initializing pool worker:",P),this.eventSubject.error(P),this.initErrors.push(P)})}findIdlingWorker(){const{concurrency:S=1}=this.options;return this.workers.find(E=>E.runningTasks.length<S)}runPoolTask(S,E){return e(this,void 0,void 0,function*(){const D=this.workers.indexOf(S)+1;this.debug(`Running task #${E.id} on worker #${D}...`),this.eventSubject.next({type:a.PoolEventType.taskStart,taskID:E.id,workerID:D});try{const T=yield E.run(yield S.init);this.debug(`Task #${E.id} completed successfully`),this.eventSubject.next({type:a.PoolEventType.taskCompleted,returnValue:T,taskID:E.id,workerID:D})}catch(T){this.debug(`Task #${E.id} failed`),this.eventSubject.next({type:a.PoolEventType.taskFailed,taskID:E.id,error:T,workerID:D})}})}run(S,E){return e(this,void 0,void 0,function*(){const D=e(this,void 0,void 0,function*(){const T=()=>{S.runningTasks=S.runningTasks.filter(P=>P!==D)};yield f(0);try{yield this.runPoolTask(S,E)}finally{T(),this.isClosing||this.scheduleWork()}});S.runningTasks.push(D)})}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const S=this.findIdlingWorker();if(!S)return;const E=this.taskQueue.shift();if(!E){this.debug("Task queue is empty"),this.eventSubject.next({type:a.PoolEventType.taskQueueDrained});return}this.run(S,E)}taskCompletion(S){return new Promise((E,D)=>{const T=this.events().subscribe(P=>{P.type===a.PoolEventType.taskCompleted&&P.taskID===S?(T.unsubscribe(),E(P.returnValue)):P.type===a.PoolEventType.taskFailed&&P.taskID===S?(T.unsubscribe(),D(P.error)):P.type===a.PoolEventType.terminated&&(T.unsubscribe(),D(Error("Pool has been terminated before task was run.")))})})}settled(S=!1){return e(this,void 0,void 0,function*(){const E=()=>p(this.workers,P=>P.runningTasks),D=[],T=this.eventObservable.subscribe(P=>{P.type===a.PoolEventType.taskFailed&&D.push(P.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):S&&this.taskQueue.length===0?(yield i.allSettled(E()),D):(yield new Promise((P,A)=>{const $=this.eventObservable.subscribe({next(I){I.type===a.PoolEventType.taskQueueDrained&&($.unsubscribe(),P(void 0))},error:A})}),yield i.allSettled(E()),T.unsubscribe(),D)})}completed(S=!1){return e(this,void 0,void 0,function*(){const E=this.settled(S),D=new Promise((P,A)=>{const $=this.eventObservable.subscribe({next(I){I.type===a.PoolEventType.taskQueueDrained?($.unsubscribe(),P(E)):I.type===a.PoolEventType.taskFailed&&($.unsubscribe(),A(I.error))},error:A})}),T=yield Promise.race([E,D]);if(T.length>0)throw T[0]})}events(){return this.eventObservable}queue(S){const{maxQueuedJobs:E=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const D=this.nextTaskID++,T=this.taskCompletion(D);T.catch(A=>{this.debug(`Task #${D} errored:`,A)});const P={id:D,run:S,cancel:()=>{this.taskQueue.indexOf(P)!==-1&&(this.taskQueue=this.taskQueue.filter(A=>A!==P),this.eventSubject.next({type:a.PoolEventType.taskCanceled,taskID:P.id}))},then:T.then.bind(T)};if(this.taskQueue.length>=E)throw Error(`Maximum number of pool tasks queued. Refusing to queue another one.
This usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.`);return this.debug(`Queueing task #${P.id}...`),this.taskQueue.push(P),this.eventSubject.next({type:a.PoolEventType.taskQueued,taskID:P.id}),this.scheduleWork(),P}terminate(S){return e(this,void 0,void 0,function*(){this.isClosing=!0,S||(yield this.completed(!0)),this.eventSubject.next({type:a.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(E=>e(this,void 0,void 0,function*(){return l.Thread.terminate(yield E.init)})))})}}w.EventType=a.PoolEventType;function x(k,S){return new w(k,S)}x.EventType=a.PoolEventType,t.Pool=x})(Sr)),Sr}var vs={},lo={},nm;function FO(){if(nm)return lo;nm=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.createPromiseWithResolver=void 0;const t=()=>{};function e(){let n=!1,s,r=t;return[new Promise(a=>{n?a(s):r=a}),a=>{n=!0,s=a,r(s)}]}return lo.createPromiseWithResolver=e,lo}var Fu={},sm;function LO(){return sm||(sm=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerEventType=void 0,(function(e){e.internalError="internalError",e.message="message",e.termination="termination"})(t.WorkerEventType||(t.WorkerEventType={}))})(Fu)),Fu}var bs={},co={},rm;function BO(){if(rm)return co;rm=1,Object.defineProperty(co,"__esModule",{value:!0}),co.ObservablePromise=void 0;const t=vc,e=()=>{},n=a=>a,s=a=>Promise.resolve().then(a);function r(a){throw a}function i(a){return a&&typeof a.then=="function"}class o extends t.Observable{constructor(l){super(c=>{const u=this,f=Object.assign(Object.assign({},c),{complete(){c.complete(),u.onCompletion()},error(p){c.error(p),u.onError(p)},next(p){c.next(p),u.onNext(p)}});try{return this.initHasRun=!0,l(f)}catch(p){f.error(p)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(l){this.firstValueSet||(this.firstValue=l,this.firstValueSet=!0)}onError(l){this.state="rejected",this.rejection=l;for(const c of this.rejectionCallbacks)s(()=>c(l))}onCompletion(){this.state="fulfilled";for(const l of this.fulfillmentCallbacks)s(()=>l(this.firstValue))}then(l,c){const u=l||n,f=c||r;let p=!1;return new Promise((g,v)=>{const w=k=>{if(!p){p=!0;try{g(f(k))}catch(S){v(S)}}},x=k=>{try{g(u(k))}catch(S){w(S)}};if(this.initHasRun||this.subscribe({error:w}),this.state==="fulfilled")return g(u(this.firstValue));if(this.state==="rejected")return p=!0,g(f(this.rejection));this.fulfillmentCallbacks.push(x),this.rejectionCallbacks.push(w)})}catch(l){return this.then(void 0,l)}finally(l){const c=l||e;return this.then(u=>(c(),u),()=>c())}static from(l){return i(l)?new o(c=>{const u=p=>{c.next(p),c.complete()},f=p=>{c.error(p)};l.then(u,f)}):super.from(l)}}return co.ObservablePromise=o,co}var Pr={},im;function Vl(){if(im)return Pr;im=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.Transfer=Pr.isTransferDescriptor=void 0;const t=kf();function e(r){return!(!r||typeof r!="object")}function n(r){return r&&typeof r=="object"&&r[t.$transferable]}Pr.isTransferDescriptor=n;function s(r,i){if(!i){if(!e(r))throw Error();i=[r]}return{[t.$transferable]:!0,send:r,transferables:i}}return Pr.Transfer=s,Pr}var Lu={},om;function Eb(){return om||(om=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,(function(e){e.cancel="cancel",e.run="run"})(t.MasterMessageType||(t.MasterMessageType={})),(function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"})(t.WorkerMessageType||(t.WorkerMessageType={}))})(Lu)),Lu}var am;function jO(){if(am)return bs;am=1;var t=bs&&bs.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(bs,"__esModule",{value:!0}),bs.createProxyModule=bs.createProxyFunction=void 0;const e=t(wf()),n=vc,s=ta(),r=BO(),i=Vl(),o=Eb(),a=e.default("threads:master:messages");let l=1;const c=k=>Array.from(new Set(k)),u=k=>k&&k.type===o.WorkerMessageType.error,f=k=>k&&k.type===o.WorkerMessageType.result,p=k=>k&&k.type===o.WorkerMessageType.running;function g(k,S){return new n.Observable(E=>{let D;const T=(P=>{if(a("Message from worker:",P.data),!(!P.data||P.data.uid!==S)){if(p(P.data))D=P.data.resultType;else if(f(P.data))D==="promise"?(typeof P.data.payload<"u"&&E.next(s.deserialize(P.data.payload)),E.complete(),k.removeEventListener("message",T)):(P.data.payload&&E.next(s.deserialize(P.data.payload)),P.data.complete&&(E.complete(),k.removeEventListener("message",T)));else if(u(P.data)){const A=s.deserialize(P.data.error);E.error(A),k.removeEventListener("message",T)}}});return k.addEventListener("message",T),()=>{if(D==="observable"||!D){const P={type:o.MasterMessageType.cancel,uid:S};k.postMessage(P)}k.removeEventListener("message",T)}})}function v(k){if(k.length===0)return{args:[],transferables:[]};const S=[],E=[];for(const D of k)i.isTransferDescriptor(D)?(S.push(s.serialize(D.send)),E.push(...D.transferables)):S.push(s.serialize(D));return{args:S,transferables:E.length===0?E:c(E)}}function w(k,S){return((...E)=>{const D=l++,{args:T,transferables:P}=v(E),A={type:o.MasterMessageType.run,uid:D,method:S,args:T};a("Sending command to run function to worker:",A);try{k.postMessage(A,P)}catch($){return r.ObservablePromise.from(Promise.reject($))}return r.ObservablePromise.from(n.multicast(g(k,D)))})}bs.createProxyFunction=w;function x(k,S){const E={};for(const D of S)E[D]=w(k,D);return E}return bs.createProxyModule=x,bs}var lm;function NO(){if(lm)return vs;lm=1;var t={},e=vs&&vs.__awaiter||function(P,A,$,I){function Y(U){return U instanceof $?U:new $(function(z){z(U)})}return new($||($=Promise))(function(U,z){function pe(_e){try{ue(I.next(_e))}catch(ke){z(ke)}}function ye(_e){try{ue(I.throw(_e))}catch(ke){z(ke)}}function ue(_e){_e.done?U(_e.value):Y(_e.value).then(pe,ye)}ue((I=I.apply(P,A||[])).next())})},n=vs&&vs.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(vs,"__esModule",{value:!0}),vs.spawn=void 0;const s=n(wf()),r=vc,i=ta(),o=FO(),a=kf(),l=LO(),c=jO(),u=s.default("threads:master:messages"),f=s.default("threads:master:spawn"),p=s.default("threads:master:thread-utils"),g=P=>P&&P.type==="init",v=P=>P&&P.type==="uncaughtError",w=typeof process<"u"&&t.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(t.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function x(P,A,$){return e(this,void 0,void 0,function*(){let I;const Y=new Promise((z,pe)=>{I=setTimeout(()=>pe(Error($)),A)}),U=yield Promise.race([P,Y]);return clearTimeout(I),U})}function k(P){return new Promise((A,$)=>{const I=(Y=>{u("Message from worker before finishing initialization:",Y.data),g(Y.data)?(P.removeEventListener("message",I),A(Y.data)):v(Y.data)&&(P.removeEventListener("message",I),$(i.deserialize(Y.data.error)))});P.addEventListener("message",I)})}function S(P,A){return new r.Observable($=>{const I=(U=>{const z={type:l.WorkerEventType.message,data:U.data};$.next(z)}),Y=(U=>{p("Unhandled promise rejection event in thread:",U);const z={type:l.WorkerEventType.internalError,error:Error(U.reason)};$.next(z)});P.addEventListener("message",I),P.addEventListener("unhandledrejection",Y),A.then(()=>{const U={type:l.WorkerEventType.termination};P.removeEventListener("message",I),P.removeEventListener("unhandledrejection",Y),$.next(U),$.complete()})})}function E(P){const[A,$]=o.createPromiseWithResolver();return{terminate:()=>e(this,void 0,void 0,function*(){p("Terminating worker"),yield P.terminate(),$()}),termination:A}}function D(P,A,$,I){const Y=$.filter(U=>U.type===l.WorkerEventType.internalError).map(U=>U.error);return Object.assign(P,{[a.$errors]:Y,[a.$events]:$,[a.$terminate]:I,[a.$worker]:A})}function T(P,A){return e(this,void 0,void 0,function*(){f("Initializing new thread");const $=A&&A.timeout?A.timeout:w,Y=(yield x(k(P),$,`Timeout: Did not receive an init message from worker after ${$}ms. Make sure the worker calls expose().`)).exposed,{termination:U,terminate:z}=E(P),pe=S(P,U);if(Y.type==="function"){const ye=c.createProxyFunction(P);return D(ye,P,pe,z)}else if(Y.type==="module"){const ye=c.createProxyModule(P,Y.methods);return D(ye,P,pe,z)}else{const ye=Y.type;throw Error(`Worker init message states unexpected type of expose(): ${ye}`)}})}return vs.spawn=T,vs}var cm;function zO(){return cm||(cm=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Worker=t.BlobWorker=t.isWorkerRuntime=t.Thread=t.spawn=t.Pool=void 0;const e=xb();Object.defineProperty(t,"isWorkerRuntime",{enumerable:!0,get:function(){return e.isWorkerRuntime}});var n=$O();Object.defineProperty(t,"Pool",{enumerable:!0,get:function(){return n.Pool}});var s=NO();Object.defineProperty(t,"spawn",{enumerable:!0,get:function(){return s.spawn}});var r=Ib();Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return r.Thread}}),t.BlobWorker=e.getWorkerImplementation().blob,t.Worker=e.getWorkerImplementation().default})(Ou)),Ou}var Ar={},Bu,um;function qO(){return um||(um=1,Bu=t=>t?typeof Symbol.observable=="symbol"&&typeof t[Symbol.observable]=="function"?t===t[Symbol.observable]():typeof t["@@observable"]=="function"?t===t["@@observable"]():!1:!1),Bu}var ol={},dm;function UO(){if(dm)return ol;dm=1,Object.defineProperty(ol,"__esModule",{value:!0});const t=function(){const r=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!r)},e=function(r,i){self.postMessage(r,i)},n=function(r){const i=a=>{r(a.data)},o=()=>{self.removeEventListener("message",i)};return self.addEventListener("message",i),o};return ol.default={isWorkerRuntime:t,postMessageToMaster:e,subscribeToMasterMessages:n},ol}var fm;function WO(){return fm||(fm=1,(function(t){var e=Ar&&Ar.__awaiter||function(I,Y,U,z){function pe(ye){return ye instanceof U?ye:new U(function(ue){ue(ye)})}return new(U||(U=Promise))(function(ye,ue){function _e(ne){try{Z(z.next(ne))}catch(X){ue(X)}}function ke(ne){try{Z(z.throw(ne))}catch(X){ue(X)}}function Z(ne){ne.done?ye(ne.value):pe(ne.value).then(_e,ke)}Z((z=z.apply(I,Y||[])).next())})},n=Ar&&Ar.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;const s=n(qO()),r=ta(),i=Vl(),o=Eb(),a=n(UO());var l=ta();Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var c=Vl();Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return c.Transfer}}),t.isWorkerRuntime=a.default.isWorkerRuntime;let u=!1;const f=new Map,p=I=>I&&I.type===o.MasterMessageType.cancel,g=I=>I&&I.type===o.MasterMessageType.run,v=I=>s.default(I)||w(I);function w(I){return I&&typeof I=="object"&&typeof I.subscribe=="function"}function x(I){return i.isTransferDescriptor(I)?{payload:I.send,transferables:I.transferables}:{payload:I,transferables:void 0}}function k(){const I={type:o.WorkerMessageType.init,exposed:{type:"function"}};a.default.postMessageToMaster(I)}function S(I){const Y={type:o.WorkerMessageType.init,exposed:{type:"module",methods:I}};a.default.postMessageToMaster(Y)}function E(I,Y){const{payload:U,transferables:z}=x(Y),pe={type:o.WorkerMessageType.error,uid:I,error:r.serialize(U)};a.default.postMessageToMaster(pe,z)}function D(I,Y,U){const{payload:z,transferables:pe}=x(U),ye={type:o.WorkerMessageType.result,uid:I,complete:Y?!0:void 0,payload:z};a.default.postMessageToMaster(ye,pe)}function T(I,Y){const U={type:o.WorkerMessageType.running,uid:I,resultType:Y};a.default.postMessageToMaster(U)}function P(I){try{const Y={type:o.WorkerMessageType.uncaughtError,error:r.serialize(I)};a.default.postMessageToMaster(Y)}catch(Y){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,Y,`
Original error:`,I)}}function A(I,Y,U){return e(this,void 0,void 0,function*(){let z;try{z=Y(...U)}catch(ye){return E(I,ye)}const pe=v(z)?"observable":"promise";if(T(I,pe),v(z)){const ye=z.subscribe(ue=>D(I,!1,r.serialize(ue)),ue=>{E(I,r.serialize(ue)),f.delete(I)},()=>{D(I,!0),f.delete(I)});f.set(I,ye)}else try{const ye=yield z;D(I,!0,r.serialize(ye))}catch(ye){E(I,r.serialize(ye))}})}function $(I){if(!a.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(u)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(u=!0,typeof I=="function")a.default.subscribeToMasterMessages(Y=>{g(Y)&&!Y.method&&A(Y.uid,I,Y.args.map(r.deserialize))}),k();else if(typeof I=="object"&&I){a.default.subscribeToMasterMessages(U=>{g(U)&&U.method&&A(U.uid,I[U.method],U.args.map(r.deserialize))});const Y=Object.keys(I).filter(U=>typeof I[U]=="function");S(Y)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${I}`);a.default.subscribeToMasterMessages(Y=>{if(p(Y)){const U=Y.uid,z=f.get(U);z&&(z.unsubscribe(),f.delete(U))}})}t.expose=$,typeof self<"u"&&typeof self.addEventListener=="function"&&a.default.isWorkerRuntime()&&(self.addEventListener("error",I=>{setTimeout(()=>P(I.error||I),250)}),self.addEventListener("unhandledrejection",I=>{const Y=I.reason;Y&&typeof Y.message=="string"&&setTimeout(()=>P(Y),250)})),typeof process<"u"&&typeof process.on=="function"&&a.default.isWorkerRuntime()&&(process.on("uncaughtException",I=>{setTimeout(()=>P(I),250)}),process.on("unhandledRejection",I=>{I&&typeof I.message=="string"&&setTimeout(()=>P(I),250)}))})(Ar)),Ar}var hm;function VO(){return hm||(hm=1,(function(t){var e=xr&&xr.__createBinding||(Object.create?(function(a,l,c,u){u===void 0&&(u=c),Object.defineProperty(a,u,{enumerable:!0,get:function(){return l[c]}})}):(function(a,l,c,u){u===void 0&&(u=c),a[u]=l[c]})),n=xr&&xr.__exportStar||function(a,l){for(var c in a)c!=="default"&&!Object.prototype.hasOwnProperty.call(l,c)&&e(l,a,c)};Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.DefaultSerializer=t.expose=t.registerSerializer=void 0;var s=ta();Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return s.registerSerializer}}),n(zO(),t);var r=WO();Object.defineProperty(t,"expose",{enumerable:!0,get:function(){return r.expose}});var i=wb();Object.defineProperty(t,"DefaultSerializer",{enumerable:!0,get:function(){return i.DefaultSerializer}});var o=Vl();Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return o.Transfer}})})(xr)),xr}var HO=VO();const lr=xv(HO);lr.registerSerializer;const Mb=lr.spawn;lr.BlobWorker;lr.DefaultSerializer;lr.Pool;const Ob=lr.Thread,KO=lr.Transfer;lr.Worker;function YO(t){return new Worker("/mtg-pwa/assets/MTGJSONUploadWorker-DaCthxZm.js",{name:t?.name})}var An=Uint8Array,mi=Uint16Array,GO=Int32Array,Db=new An([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tb=new An([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),XO=new An([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Rb=function(t,e){for(var n=new mi(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];for(var r=new GO(n[30]),s=1;s<30;++s)for(var i=n[s];i<n[s+1];++i)r[i]=i-n[s]<<5|s;return{b:n,r}},$b=Rb(Db,2),Fb=$b.b,QO=$b.r;Fb[28]=258,QO[258]=28;var JO=Rb(Tb,0),ZO=JO.b,kd=new mi(32768);for(var St=0;St<32768;++St){var zs=(St&43690)>>1|(St&21845)<<1;zs=(zs&52428)>>2|(zs&13107)<<2,zs=(zs&61680)>>4|(zs&3855)<<4,kd[St]=((zs&65280)>>8|(zs&255)<<8)>>1}var Fo=(function(t,e,n){for(var s=t.length,r=0,i=new mi(e);r<s;++r)t[r]&&++i[t[r]-1];var o=new mi(e);for(r=1;r<e;++r)o[r]=o[r-1]+i[r-1]<<1;var a;if(n){a=new mi(1<<e);var l=15-e;for(r=0;r<s;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],f=o[t[r]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)a[kd[f]>>l]=c}else for(a=new mi(s),r=0;r<s;++r)t[r]&&(a[r]=kd[o[t[r]-1]++]>>15-t[r]);return a}),da=new An(288);for(var St=0;St<144;++St)da[St]=8;for(var St=144;St<256;++St)da[St]=9;for(var St=256;St<280;++St)da[St]=7;for(var St=280;St<288;++St)da[St]=8;var Lb=new An(32);for(var St=0;St<32;++St)Lb[St]=5;var eD=Fo(da,9,1),tD=Fo(Lb,5,1),ju=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},qn=function(t,e,n){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&n},Nu=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},nD=function(t){return(t+7)/8|0},Bb=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new An(t.subarray(e,n))},sD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ln=function(t,e,n){var s=new Error(e||sD[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,Ln),!n)throw s;return s},rD=function(t,e,n,s){var r=t.length,i=0;if(!r||e.f&&!e.l)return n||new An(0);var o=!n,a=o||e.i!=2,l=e.i;o&&(n=new An(r*3));var c=function(nt){var O=n.length;if(nt>O){var L=new An(Math.max(O*2,nt));L.set(n),n=L}},u=e.f||0,f=e.p||0,p=e.b||0,g=e.l,v=e.d,w=e.m,x=e.n,k=r*8;do{if(!g){u=qn(t,f,1);var S=qn(t,f+1,3);if(f+=3,S)if(S==1)g=eD,v=tD,w=9,x=5;else if(S==2){var P=qn(t,f,31)+257,A=qn(t,f+10,15)+4,$=P+qn(t,f+5,31)+1;f+=14;for(var I=new An($),Y=new An(19),U=0;U<A;++U)Y[XO[U]]=qn(t,f+U*3,7);f+=A*3;for(var z=ju(Y),pe=(1<<z)-1,ye=Fo(Y,z,1),U=0;U<$;){var ue=ye[qn(t,f,pe)];f+=ue&15;var E=ue>>4;if(E<16)I[U++]=E;else{var _e=0,ke=0;for(E==16?(ke=3+qn(t,f,3),f+=2,_e=I[U-1]):E==17?(ke=3+qn(t,f,7),f+=3):E==18&&(ke=11+qn(t,f,127),f+=7);ke--;)I[U++]=_e}}var Z=I.subarray(0,P),ne=I.subarray(P);w=ju(Z),x=ju(ne),g=Fo(Z,w,1),v=Fo(ne,x,1)}else Ln(1);else{var E=nD(f)+4,D=t[E-4]|t[E-3]<<8,T=E+D;if(T>r){l&&Ln(0);break}a&&c(p+D),n.set(t.subarray(E,T),p),e.b=p+=D,e.p=f=T*8,e.f=u;continue}if(f>k){l&&Ln(0);break}}a&&c(p+131072);for(var X=(1<<w)-1,Le=(1<<x)-1,Se=f;;Se=f){var _e=g[Nu(t,f)&X],Ve=_e>>4;if(f+=_e&15,f>k){l&&Ln(0);break}if(_e||Ln(2),Ve<256)n[p++]=Ve;else if(Ve==256){Se=f,g=null;break}else{var wt=Ve-254;if(Ve>264){var U=Ve-257,gt=Db[U];wt=qn(t,f,(1<<gt)-1)+Fb[U],f+=gt}var it=v[Nu(t,f)&Le],ae=it>>4;it||Ln(3),f+=it&15;var ne=ZO[ae];if(ae>3){var gt=Tb[ae];ne+=Nu(t,f)&(1<<gt)-1,f+=gt}if(f>k){l&&Ln(0);break}a&&c(p+131072);var Oe=p+wt;if(p<ne){var re=i-ne,Fe=Math.min(ne,Oe);for(re+p<0&&Ln(3);p<Fe;++p)n[p]=s[re+p]}for(;p<Oe;++p)n[p]=n[p-ne]}}e.l=g,e.p=Se,e.b=p,e.f=u,g&&(u=1,e.m=w,e.d=v,e.n=x)}while(!u);return p!=n.length&&o?Bb(n,0,p):n.subarray(0,p)},iD=new An(0),oD=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Ln(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=(t[10]|t[11]<<8)+2);for(var s=(e>>3&1)+(e>>4&1);s>0;s-=!t[n++]);return n+(e&2)},aD=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0};function pm(t,e){var n=oD(t);return n+8>t.length&&Ln(6,"invalid gzip data"),rD(t.subarray(n,-8),{i:2},new An(aD(t)),e)}var Cd=typeof TextDecoder<"u"&&new TextDecoder,lD=0;try{Cd.decode(iD,{stream:!0}),lD=1}catch{}var cD=function(t){for(var e="",n=0;;){var s=t[n++],r=(s>127)+(s>223)+(s>239);if(n+r>t.length)return{s:e,r:Bb(t,n-1)};r?r==3?(s=((s&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|s>>10,56320|s&1023)):r&1?e+=String.fromCharCode((s&31)<<6|t[n++]&63):e+=String.fromCharCode((s&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(s)}};function gm(t,e){var n;if(Cd)return Cd.decode(t);var s=cD(t),r=s.s,n=s.r;return n.length&&Ln(8),r}const zu="mtgjson.idMap.v1",uD="https://mtgjson.com/api/v5/AllIdentifiers.json.gz",dD="https://mtgjson.com/api/v5/AllPrices.json.gz";function mm(t){const e={},n=t?.data??t,s=(r,i)=>{if(!r||!i)return;const o=i.identifiers??i,a=o?.scryfallId,l=o?.scryfallOracleId;a&&(e[a]=r),l&&(e[l]=r)};if(Array.isArray(n))for(const r of n){const i=r?.uuid??r?.cardId??r?.id;s(i,r)}else if(n&&typeof n=="object")for(const[r,i]of Object.entries(n))s(r,i);else throw new Error("[MTGJSONUploadService] Unrecognized AllIdentifiers format (no array/object).");if(Object.keys(e).length===0){const r=n&&typeof n=="object"?Object.keys(n).slice(0,5):[];throw console.warn("[MTGJSONUploadService] AllIdentifiers parsed but no entries found. Sample keys:",r),new Error("[MTGJSONUploadService] Parsed AllIdentifiers but produced an empty id map.")}return e}async function fD(t){try{const p=await Nr.get(zu);if(p&&typeof p=="object")return console.log("[MTGJSONUploadService] Using cached AllIdentifiers id map."),t({type:"downloading-all-identifiers",message:"Using cached AllIdentifiers mapping...",percentage:50}),t({type:"processing-all-identifiers",message:"Processing cached AllIdentifiers mapping...",percentage:75}),t({type:"processing-all-identifiers",message:"AllIdentifiers mapping processed",percentage:100}),p}catch(p){console.warn("[MTGJSONUploadService] Could not read cached id map:",p)}t({type:"downloading-all-identifiers",message:"Downloading AllIdentifiers.json.gz...",percentage:0}),console.log("[MTGJSONUploadService] Downloading AllIdentifiers.json.gz...");const e=await fetch(uD,{mode:"cors"});if(!e.ok)throw new Error(`[MTGJSONUploadService] Failed to fetch AllIdentifiers.json.gz: ${e.status} ${e.statusText}`);const n=e.headers.get("content-length"),s=parseInt(n||"0",10);let r=0;const i=e.body?.getReader(),o=[];if(i&&s)for(;;){const{done:p,value:g}=await i.read();if(p)break;o.push(g),r+=g.length;const v=Math.round(r/s*50);t({type:"downloading-all-identifiers",message:`Downloading AllIdentifiers.json.gz... (${Hl(r)} / ${Hl(s)})`,percentage:v})}else{const p=new Uint8Array(await e.arrayBuffer());t({type:"downloading-all-identifiers",message:"Downloaded AllIdentifiers.json.gz",percentage:50}),t({type:"processing-all-identifiers",message:"Processing AllIdentifiers mapping...",percentage:60});const g=gm(pm(p)),v=JSON.parse(g),w=mm(v);t({type:"processing-all-identifiers",message:"Caching AllIdentifiers mapping...",percentage:80});try{await Nr.set(zu,w)}catch(x){console.warn("[MTGJSONUploadService] Could not cache id map:",x)}return t({type:"processing-all-identifiers",message:"AllIdentifiers mapping processed",percentage:100}),console.log(`[MTGJSONUploadService] Built AllIdentifiers id map with ${Object.keys(w).length} entries.`),w}const a=new Uint8Array(r);let l=0;for(const p of o)a.set(p,l),l+=p.length;t({type:"downloading-all-identifiers",message:"Downloaded AllIdentifiers.json.gz",percentage:50});const c=gm(pm(a)),u=JSON.parse(c);t({type:"processing-all-identifiers",message:"Processing AllIdentifiers mapping...",percentage:60});const f=mm(u);t({type:"processing-all-identifiers",message:"Caching AllIdentifiers mapping...",percentage:80});try{await Nr.set(zu,f)}catch(p){console.warn("[MTGJSONUploadService] Could not cache id map:",p)}return t({type:"processing-all-identifiers",message:"AllIdentifiers mapping processed",percentage:100}),console.log(`[MTGJSONUploadService] Built AllIdentifiers id map with ${Object.keys(f).length} entries.`),f}class hD{static async upload(e,n){console.log(`[MTGJSONUploadService] Starting upload for file: ${e==="auto"?"AUTOMATIC DOWNLOAD":e.name}`);let s=null;try{console.log("[MTGJSONUploadService] Spawning worker..."),s=await Mb(new YO,{timeout:3e5}),console.log("[MTGJSONUploadService] Worker spawned."),console.log("[MTGJSONUploadService] Fetching wanted cards from DB...");const r=await Ut.getAll();console.log(`[MTGJSONUploadService] Found ${r.length} cards.`);const i=await fD(n),o=Array.from(new Set(r.map(c=>i[c.id]||(c.oracleId?i[c.oracleId]:void 0)).filter(Boolean)));console.log(`[MTGJSONUploadService] Resolved ${o.length} MTGJSON UUIDs from ${r.length} cards.`),o.length===0&&console.warn("[MTGJSONUploadService] No MTGJSON UUIDs resolved from local cards. Check that your cards contain Scryfall ids/oracleIds and that AllIdentifiers was parsed correctly.");const a={};for(const c of r){const u=i[c.id]||(c.oracleId?i[c.oracleId]:void 0);u&&(a[u]=c.id)}let l;if(e==="auto"){console.log("[MTGJSONUploadService] Downloading AllPrices.json.gz automatically..."),n({type:"downloading-all-prices",message:"Downloading AllPrices.json.gz...",percentage:0});const c=await fetch(dD,{mode:"cors"});if(!c.ok)throw new Error(`[MTGJSONUploadService] Failed to fetch AllPrices.json.gz: ${c.status} ${c.statusText}`);const u=c.headers.get("content-length"),f=parseInt(u||"0",10);let p=0;const g=c.body?.getReader(),v=[];if(g&&f)for(;;){const{done:S,value:E}=await g.read();if(S)break;v.push(E),p+=E.length;const D=Math.round(p/f*100);n({type:"downloading-all-prices",message:`Downloading AllPrices.json.gz... (${Hl(p)} / ${Hl(f)})`,percentage:D})}else{const S=await c.arrayBuffer(),E=new Blob([S],{type:"application/gzip"});l=new File([E],"AllPrices.json.gz",{type:"application/gzip"})}const w=new Uint8Array(p);let x=0;for(const S of v)w.set(S,x),x+=S.length;const k=new Blob([w],{type:"application/gzip"});l=new File([k],"AllPrices.json.gz",{type:"application/gzip"}),console.log(`[MTGJSONUploadService] Downloaded AllPrices.json.gz (${l.size} bytes)`)}else l=e;console.log("[MTGJSONUploadService] Calling worker.upload()..."),n({type:"importing-price-points",message:"Importing price points...",percentage:0});try{const c=new MessageChannel;await s.setProgressPort(KO(c.port2,[c.port2])),c.port1.onmessage=f=>{const p=f.data;n({type:"importing-price-points",message:`Processing ${p.processedCards}/${p.totalWanted} cards — ${p.writtenPricePoints.toLocaleString()} price points`,percentage:p.percentage})};const u=await s.upload(l,o,a);console.log(`[MTGJSONUploadService] Worker finished processing. ${u.processed} cards processed, ${u.written} price points written.`),n({type:"completed",message:`Import finished! ${u.processed} cards, ${u.written.toLocaleString()} price points.`,percentage:100,processedCards:u.processed,writtenPricePoints:u.written})}catch(c){throw console.error("[MTGJSONUploadService] Worker returned an error:",c),c}}catch(r){throw console.error("[MTGJSONUploadService] An error occurred in the upload service:",r),r}finally{if(s){console.log("[MTGJSONUploadService] Terminating worker.");try{await Ob.terminate(s)}catch(r){console.error("[MTGJSONUploadService] Error terminating worker:",r)}}}}}function Hl(t){if(t===0)return"0 Bytes";const e=1024,n=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,s)).toFixed(2))+" "+n[s]}const pD={class:"mtgjson-wizard"},gD={class:"card"},mD={class:"card-body"},yD={key:0,class:"progress-section"},vD={class:"phase-section mb-3"},bD={class:"progress"},_D=["aria-valuenow"],wD={class:"phase-message mt-1"},xD={key:0,class:"phase-section mb-3"},kD={class:"progress"},CD=["aria-valuenow"],SD={class:"phase-message mt-1"},PD={key:1,class:"phase-section mb-3"},AD={class:"progress"},ID=["aria-valuenow"],ED={class:"phase-message mt-1"},MD={key:1,class:"alert alert-success"},OD={key:2,class:"error-messages"},DD={key:0,class:"mt-2"},TD={class:"wizard-navigation pt-3"},RD=["disabled"],$D=et({__name:"MtgjsonImportWizard",setup(t){const e=fe(!1),n=fe(!1),s=fe(""),r=fe(50),i=fe("Using cached AllIdentifiers mapping..."),o=fe(0),a=fe(""),l=fe(0),c=fe(""),u=fe(0),f=fe([]),p=async()=>{if(!e.value){e.value=!0,n.value=!1,f.value=[],s.value="",r.value=0,i.value="Downloading AllIdentifiers.json.gz...",o.value=0,a.value="",l.value=0,c.value="",u.value=0;try{await hD.upload("auto",g=>{switch(s.value=g.type,g.type){case"downloading-all-identifiers":r.value=g.percentage||0,i.value=g.message;break;case"processing-all-identifiers":r.value=g.percentage||0,i.value=g.message;break;case"downloading-all-prices":o.value=g.percentage||0,a.value=g.message;break;case"importing-price-points":l.value=g.percentage||0,c.value=g.message;break;case"completed":l.value=100,c.value=g.message,u.value=g.writtenPricePoints??0,e.value=!1,n.value=!0;break}})}catch(g){f.value.push("Failed to import MTGJSON data: "+g.message),e.value=!1}}};return(g,v)=>(j(),W("div",pD,[v[5]||(v[5]=b("h1",null,"MTGJSON Price Import",-1)),v[6]||(v[6]=b("p",null,"Import historical price data from MTGJSON. This will populate the price history for your cards for the last 90 days.",-1)),b("div",gD,[b("div",mD,[v[4]||(v[4]=b("div",{class:"info-section mb-4"},[b("p",null,[b("strong",null,'What happens when you click "Import Prices":')]),b("ol",null,[b("li",null,"Download AllIdentifiers.json.gz (~160MB compressed)"),b("li",null,"Download AllPrices.json.gz (~130MB compressed)"),b("li",null,"Process the files to extract price data for your cards"),b("li",null,"Store the price history in your local database")])],-1)),e.value?(j(),W("div",yD,[b("div",vD,[v[0]||(v[0]=b("div",{class:"phase-title mb-1"},"Downloading AllIdentifiers.json.gz",-1)),b("div",bD,[b("div",{class:"progress-bar",role:"progressbar",style:En({width:r.value+"%"}),"aria-valuenow":r.value,"aria-valuemin":"0","aria-valuemax":"100"},te(r.value)+"%",13,_D)]),b("div",wD,te(i.value),1)]),s.value==="downloading-all-prices"||s.value==="importing-price-points"||s.value==="completed"?(j(),W("div",xD,[v[1]||(v[1]=b("div",{class:"phase-title mb-1"},"Downloading AllPrices.json.gz",-1)),b("div",kD,[b("div",{class:"progress-bar",role:"progressbar",style:En({width:o.value+"%"}),"aria-valuenow":o.value,"aria-valuemin":"0","aria-valuemax":"100"},te(o.value)+"%",13,CD)]),b("div",SD,te(a.value),1)])):ve("",!0),s.value==="importing-price-points"||s.value==="completed"?(j(),W("div",PD,[v[2]||(v[2]=b("div",{class:"phase-title mb-1"},"Importing Price Points",-1)),b("div",AD,[b("div",{class:"progress-bar",role:"progressbar",style:En({width:l.value+"%"}),"aria-valuenow":l.value,"aria-valuemin":"0","aria-valuemax":"100"},te(l.value)+"%",13,ID)]),b("div",ED,te(c.value),1)])):ve("",!0)])):ve("",!0),n.value?(j(),W("div",MD," Import finished! Processed "+te(u.value)+" price points. ",1)):ve("",!0),f.value.length>0?(j(),W("div",OD,[(j(!0),W(Qe,null,It(f.value,w=>(j(),W("div",{key:w,class:"error-message"},[yt(te(w)+" ",1),w.includes("Out of Memory")||w.includes("too large")?(j(),W("div",DD,[...v[3]||(v[3]=[b("strong",null,"Solution:",-1),yt(' The MTGJSON file is too large to process in your browser. Please download the smaller "AllPricesToday.json" file from MTGJSON instead, which contains only the latest prices and is much smaller. ',-1)])])):ve("",!0)]))),128))])):ve("",!0),b("div",TD,[b("button",{onClick:p,class:"btn btn-glass-primary",disabled:e.value},te(e.value?"Importing...":"Import Prices"),9,RD)])])])]))}}),FD=fn($D,[["__scopeId","data-v-ff365479"]]);function LD(t){return new Worker("/mtg-pwa/assets/PriceGuideUploadWorker-C8L6STx7.js",{name:t?.name})}class BD{static async upload(e,n){const s=await Mb(new LD,{timeout:3e5});try{const r=await s.upload(e);n(r)}finally{await Ob.terminate(s)}}}const jD={class:"price-guide-wizard"},ND={class:"card"},zD={class:"card-body"},qD={class:"file-upload-section"},UD={class:"mb-3"},WD={key:0,class:"files-info"},VD={class:"file-list"},HD={class:"file-item"},KD={class:"file-name"},YD={class:"file-size"},GD={key:0,class:"progress"},XD=["aria-valuenow"],QD={key:1,class:"alert alert-success"},JD={key:2,class:"error-messages"},ZD={class:"wizard-navigation pt-3"},eT=["disabled"],tT=et({__name:"PriceGuideUploadWizard",setup(t){const e=fe(null),n=fe(!1),s=fe(!1),r=fe(0),i=fe(0),o=fe([]),a=u=>{const p=u.target.files;!p||p.length===0||(e.value=p[0],s.value=!1,i.value=0,o.value=[])},l=async()=>{if(!(!e.value||n.value)){n.value=!0,s.value=!1,o.value=[],r.value=0;try{await BD.upload(e.value,u=>{i.value=u,r.value=100,n.value=!1,s.value=!0})}catch(u){o.value.push("Failed to import Price Guide data: "+u.message),n.value=!1}}},c=u=>{if(u===0)return"0 Bytes";const f=1024,p=["Bytes","KB","MB","GB"],g=Math.floor(Math.log(u)/Math.log(f));return parseFloat((u/Math.pow(f,g)).toFixed(2))+" "+p[g]};return(u,f)=>(j(),W("div",jD,[f[2]||(f[2]=b("h1",null,"Cardmarket Price Guide Import",-1)),f[3]||(f[3]=b("p",null,"Import historical price data from Cardmarket Price Guide.",-1)),f[4]||(f[4]=b("div",{class:"alert alert-info"},[b("h3",{class:"alert-heading"},"Where to get the file"),b("p",null,"You can download the Price Guide CSV from your Cardmarket account.")],-1)),b("div",ND,[b("div",zD,[b("div",qD,[b("div",UD,[f[0]||(f[0]=b("label",{for:"price-guide-file",class:"form-label"}," Choose Price Guide CSV File ",-1)),b("input",{id:"price-guide-file",type:"file",accept:".csv",onChange:a,class:"form-control"},null,32)]),e.value?(j(),W("div",WD,[f[1]||(f[1]=b("h3",null,"Uploaded File",-1)),b("ul",VD,[b("li",HD,[b("span",KD,te(e.value.name),1),b("span",YD,"- "+te(c(e.value.size)),1)])])])):ve("",!0)]),n.value?(j(),W("div",GD,[b("div",{class:"progress-bar",role:"progressbar",style:En({width:r.value+"%"}),"aria-valuenow":r.value,"aria-valuemin":"0","aria-valuemax":"100"},te(r.value)+"%",13,XD)])):ve("",!0),s.value?(j(),W("div",QD," Import finished! Processed "+te(i.value)+" price points. ",1)):ve("",!0),o.value.length>0?(j(),W("div",JD,[(j(!0),W(Qe,null,It(o.value,p=>(j(),W("div",{key:p,class:"error-message"},te(p),1))),128))])):ve("",!0),b("div",ZD,[b("button",{onClick:l,class:"btn btn-glass-primary",disabled:!e.value||n.value},te(n.value?"Importing...":"Import Prices"),9,eT)])])])]))}}),nT=fn(tT,[["__scopeId","data-v-d170427f"]]),sT={class:"manabox-wizard"},rT={class:"wizard-progress"},iT={class:"step-number"},oT={class:"step-label"},aT={class:"card"},lT={class:"card-body"},cT={class:"wizard-content"},uT={key:0,class:"step-content"},dT={class:"mb-3"},fT={class:"mb-3"},hT={key:0,class:"files-info"},pT={class:"file-list"},gT={class:"file-item"},mT={class:"file-name"},yT={class:"file-size"},vT={key:1,class:"error-messages"},bT={key:1,class:"step-content"},_T={key:0,class:"preview-stats"},wT={class:"stat"},xT={class:"stat-value"},kT={class:"stat"},CT={class:"stat-value"},ST={class:"stat"},PT={class:"stat-value"},AT={key:1,class:"preview-table-container"},IT={class:"preview-table-wrapper"},ET={class:"preview-table"},MT={key:0},OT={colspan:6,class:"more-rows-cell"},DT={key:2,class:"invalid-rows-section"},TT={class:"invalid-rows"},RT={class:"row-number"},$T={class:"row-errors"},FT={key:0,class:"more-rows"},LT={key:2,class:"step-content"},BT={class:"summary-stats"},jT={class:"stat"},NT={class:"stat-value"},zT={class:"stat"},qT={class:"stat-value"},UT={key:0,class:"stat"},WT={class:"stat-value"},VT={class:"summary-details"},HT={class:"summary-grid"},KT={class:"summary-item"},YT={class:"summary-value"},GT={class:"summary-item"},XT={class:"summary-value"},QT={class:"summary-item"},JT={class:"summary-value"},ZT={key:0,class:"import-status error"},eR={class:"wizard-navigation pt-3"},tR=["disabled"],nR=["disabled"],sR=et({__name:"ManaBoxImportWizard",setup(t){const e=[{key:"upload",title:"Upload"},{key:"preview",title:"Preview"},{key:"summary",title:"Summary"}],n=fe(0),s=fe(null),r=fe(""),i=fe(0),o=fe([]),a=fe([]),l=fe(!1),c=fe(null),u=We(()=>n.value===0?s.value!==null&&a.value.length===0:!0),f=P=>{if(P===0)return"0 Bytes";const A=1024,$=["Bytes","KB","MB","GB"],I=Math.floor(Math.log(P)/Math.log(A));return parseFloat((P/Math.pow(A,I)).toFixed(2))+" "+$[I]},p=P=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(P/100),g=P=>{const A=[];let $="",I=!1;for(let Y=0;Y<P.length;Y++){const U=P[Y],z=Y<P.length-1?P[Y+1]:"";U==='"'?I&&z==='"'?($+='"',Y++):I=!I:U===","&&!I?(A.push($),$=""):$+=U}return A.push($),A},v=P=>{const A=[];return P.name||A.push("Card name is required"),!P.expansion&&!P.scryfallId&&A.push("Either Expansion or Scryfall ID is required"),P.quantity&&(typeof P.quantity!="number"||P.quantity<=0)&&A.push("Quantity must be a positive number"),A},w=async P=>{const $=P.target.files?.[0];if($){a.value=[],s.value=$;try{r.value=await $.text();const I=r.value.split(/\r?\n/),Y=I[0].split(",").map(z=>z.trim()),U=[];for(let z=1;z<I.length;z++){const pe=I[z].trim();if(!pe)continue;const ye=g(pe);if(ye.length<Y.length)continue;const ue={};for(let _e=0;_e<Y.length;_e++){const ke=Y[_e].toLowerCase(),Z=ye[_e]?ye[_e].trim():"";switch(ke){case"name":ue.name=Z;break;case"set code":case"set":case"expansion":ue.expansion=Z;break;case"collector number":case"number":case"card number":ue.number=Z;break;case"language":case"sprache":ue.language=Z||"en";break;case"foil":ue.foil=Z.toLowerCase()==="foil"||Z.toLowerCase()==="true"||Z.toLowerCase()==="yes";break;case"quantity":case"qty":case"anzahl":ue.quantity=parseInt(Z)||1;break;case"manabox id":ue.id=Z||`manabox-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;break;case"scryfall id":ue.scryfallId=Z;break;case"condition":ue.condition=Z;break;case"purchase price":ue.purchasePrice=Z;break;case"misprint":ue.misprint=Z.toLowerCase()==="true";break;case"altered":ue.altered=Z.toLowerCase()==="true";break;case"purchase price currency":ue.currency=Z||"EUR";break;case"rarity":ue.rarity=Z;break}}ue.name&&(ue.expansion||ue.scryfallId)&&U.push({id:ue.id||`manabox-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:ue.name,expansion:ue.expansion,number:ue.number,language:ue.language||"en",foil:ue.foil||!1,quantity:ue.quantity||1,scannedAt:new Date,source:"manabox",externalRef:`manabox-${ue.id||Date.now()}-${Math.random().toString(36).substr(2,9)}`,scryfallId:ue.scryfallId})}if(U.length===0){a.value.push("No valid rows found in the CSV file");return}o.value=U}catch(I){a.value.push("Failed to read the file: "+I.message)}}},x=We(()=>o.value.filter(P=>v(P).length===0)),k=We(()=>o.value.map((P,A)=>({index:A,row:P,errors:v(P)})).filter(P=>P.errors.length>0)),S=We(()=>Math.round(i.value*100)),E=async()=>{u.value&&(n.value,n.value<e.length-1&&n.value++)},D=()=>{n.value>0&&n.value--},T=async()=>{if(!l.value){l.value=!0,c.value=null;try{const P={price:S.value,fees:0,shipping:0};await vo.importManaboxScansWithBoxCost(x.value,P,new Date,"manabox",`manabox-import-${Date.now()}`),c.value="Import completed successfully! Check the status indicator in the top right for details.",setTimeout(()=>{n.value=0,s.value=null,r.value="",i.value=0,o.value=[],a.value=[],l.value=!1,c.value=null},3e3)}catch(P){c.value="Failed to import data: "+P.message,l.value=!1}}};return(P,A)=>(j(),W("div",sT,[A[25]||(A[25]=b("h1",null,"ManaBox Import Wizard",-1)),b("div",rT,[(j(),W(Qe,null,It(e,($,I)=>b("div",{key:$.key,class:At(["step",{active:n.value===I,completed:I<n.value}])},[b("div",iT,te(I+1),1),b("div",oT,te($.title),1)],2)),64))]),b("div",aT,[b("div",lT,[b("div",cT,[n.value===0?(j(),W("div",uT,[A[5]||(A[5]=b("h2",null,"Upload ManaBox CSV",-1)),A[6]||(A[6]=b("p",null,"Import your ManaBox scan data to track your physical collection.",-1)),b("div",dT,[A[1]||(A[1]=b("label",{for:"manabox-csv",class:"form-label"}," Choose CSV File ",-1)),b("input",{id:"manabox-csv",type:"file",accept:".csv",onChange:w,class:"form-control"},null,32)]),b("div",fT,[A[2]||(A[2]=b("label",{for:"box-price",class:"form-label"}," Box Price (€) ",-1)),Zs(b("input",{id:"box-price",type:"number",step:"0.01","onUpdate:modelValue":A[0]||(A[0]=$=>i.value=$),class:"form-control",placeholder:"Enter the total price of the box"},null,512),[[Wo,i.value,void 0,{number:!0}]]),A[3]||(A[3]=b("div",{class:"form-text"}," Enter the total price paid for the entire box of cards (optional). ",-1))]),s.value?(j(),W("div",hT,[A[4]||(A[4]=b("h3",null,"Uploaded File",-1)),b("ul",pT,[b("li",gT,[b("span",mT,te(s.value.name),1),b("span",yT,"- "+te(f(s.value.size)),1)])])])):ve("",!0),a.value.length>0?(j(),W("div",vT,[(j(!0),W(Qe,null,It(a.value,$=>(j(),W("div",{key:$,class:"error-message"},te($),1))),128))])):ve("",!0)])):n.value===1?(j(),W("div",bT,[A[14]||(A[14]=b("h2",null,"Preview Data",-1)),A[15]||(A[15]=b("p",null,"Review the data that will be imported. Check for any issues before proceeding.",-1)),o.value.length>0?(j(),W("div",_T,[b("div",wT,[b("div",xT,te(o.value.length),1),A[7]||(A[7]=b("div",{class:"stat-label"},"Total Rows",-1))]),b("div",kT,[b("div",CT,te(x.value.length),1),A[8]||(A[8]=b("div",{class:"stat-label"},"Valid Rows",-1))]),b("div",ST,[b("div",PT,te(k.value.length),1),A[9]||(A[9]=b("div",{class:"stat-label"},"Invalid Rows",-1))])])):ve("",!0),o.value.length>0?(j(),W("div",AT,[A[11]||(A[11]=b("h4",null,"Valid Data Preview",-1)),b("div",IT,[b("table",ET,[A[10]||(A[10]=b("thead",null,[b("tr",null,[b("th",null,"Name"),b("th",null,"Expansion"),b("th",null,"Number"),b("th",null,"Language"),b("th",null,"Foil"),b("th",null,"Quantity")])],-1)),b("tbody",null,[(j(!0),W(Qe,null,It(x.value.slice(0,5),($,I)=>(j(),W("tr",{key:I},[b("td",null,te($.name),1),b("td",null,te($.expansion),1),b("td",null,te($.number),1),b("td",null,te($.language),1),b("td",null,te($.foil?"Yes":"No"),1),b("td",null,te($.quantity),1)]))),128)),x.value.length>5?(j(),W("tr",MT,[b("td",OT," ... and "+te(x.value.length-5)+" more rows ",1)])):ve("",!0)])])])])):ve("",!0),k.value.length>0?(j(),W("div",DT,[A[12]||(A[12]=b("h4",null,"Invalid Rows",-1)),A[13]||(A[13]=b("p",null,"The following rows have issues and will be skipped:",-1)),b("div",TT,[(j(!0),W(Qe,null,It(k.value.slice(0,3),($,I)=>(j(),W("div",{key:I,class:"invalid-row"},[b("div",RT,"Row "+te(I+1),1),b("div",$T,te($.errors.join(", ")),1)]))),128)),k.value.length>3?(j(),W("div",FT," ... and "+te(k.value.length-3)+" more rows ",1)):ve("",!0)])])):ve("",!0)])):n.value===2?(j(),W("div",LT,[A[23]||(A[23]=b("h2",null,"Import Summary",-1)),A[24]||(A[24]=b("p",null,"Review the import summary before finalizing.",-1)),b("div",BT,[b("div",jT,[b("div",NT,te(x.value.length),1),A[16]||(A[16]=b("div",{class:"stat-label"},"Cards to Import",-1))]),b("div",zT,[b("div",qT,te(k.value.length),1),A[17]||(A[17]=b("div",{class:"stat-label"},"Invalid Rows",-1))]),i.value>0?(j(),W("div",UT,[b("div",WT,te(p(S.value)),1),A[18]||(A[18]=b("div",{class:"stat-label"},"Box Price",-1))])):ve("",!0)]),b("div",VT,[A[22]||(A[22]=b("h3",null,"Import Details",-1)),b("div",HT,[b("div",KT,[A[19]||(A[19]=b("div",{class:"summary-label"},"File Uploaded",-1)),b("div",YT,te(s.value?.name),1)]),b("div",GT,[A[20]||(A[20]=b("div",{class:"summary-label"},"Total Rows",-1)),b("div",XT,te(o.value.length),1)]),b("div",QT,[A[21]||(A[21]=b("div",{class:"summary-label"},"Valid Rows",-1)),b("div",JT,te(x.value.length),1)])])]),c.value?(j(),W("div",ZT,te(c.value),1)):ve("",!0)])):ve("",!0)])])]),b("div",eR,[n.value>0?(j(),W("button",{key:0,onClick:D,class:"btn btn-secondary"}," Previous ")):ve("",!0),n.value<e.length-1?(j(),W("button",{key:1,onClick:E,class:"btn btn-glass-primary",disabled:!u.value}," Next ",8,tR)):ve("",!0),n.value===e.length-1?(j(),W("button",{key:2,onClick:T,class:"btn btn-glass-primary",disabled:l.value},te(l.value?"Importing...":"Import Data"),9,nR)):ve("",!0)])]))}}),rR=fn(sR,[["__scopeId","data-v-19c50304"]]);class iR{static normalizeFingerprint(e){return{name:e.name.trim().toLowerCase(),setCode:e.setCode.trim().toLowerCase(),collectorNumber:e.collectorNumber.trim().toLowerCase(),finish:e.finish.trim().toLowerCase(),language:e.language.trim().toLowerCase()}}static compareFingerprints(e,n){const s=this.normalizeFingerprint(e),r=this.normalizeFingerprint(n);return s.name===r.name&&s.setCode===r.setCode&&s.collectorNumber===r.collectorNumber&&s.finish===r.finish&&s.language===r.language}static async resolveFingerprint(e){try{const n=await ln.hydrateCard({name:e.name,setCode:e.setCode,collectorNumber:e.collectorNumber});return n&&n.id?n.id:null}catch(n){return console.error("Error resolving fingerprint:",n),null}}}class oR{static async importDeckFromText(e,n){let s,r;try{s=Rr();const i=n.split(`
`).map(o=>o.trim()).filter(o=>o);r=yo(),s.addImport({id:r,type:"deck",name:e,status:"pending",progress:0,totalItems:i.length,processedItems:0})}catch(i){console.warn("Could not initialize import status store:",i),s=null,r=null}try{const i=new Date,o=`deck-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={id:o,platform:"csv",name:e,commander:"",url:"",importedAt:i,createdAt:i,updatedAt:i},l=ge();await l.decks.add(a);const c=n.split(`
`).map(f=>f.trim()).filter(f=>f);if(console.log("Processing deck import:",{deckName:e,lineCount:c.length}),s&&r)try{s.updateImport(r,{status:"processing"})}catch(f){console.warn("Could not update import status:",f)}for(let f=0;f<c.length;f++){const g=c[f].trim();if(!g)continue;if(console.log("Processing line:",g),s&&r)try{s.updateImport(r,{processedItems:f+1,progress:Math.round((f+1)/c.length*100)})}catch(w){console.warn("Could not update import progress:",w)}const v=g.match(/^(\d+)\s+(.+?)\s*\(([^)]+)\)\s*(\d+)(?:\s*\*F\*\s*)?$/i);if(v){const[,w,x,k,S]=v,E=parseInt(w)||1;if(console.log("Parsed card:",{quantity:E,cardName:x,setCode:k,collectorNumber:S}),x&&k&&S){const D={name:x.trim(),setCode:k.trim(),collectorNumber:S.trim(),finish:"nonfoil",language:"en"},T=await iR.resolveFingerprint(D);if(console.log("Resolved card ID:",T),T){const Y=new Date;if(!await Ut.getById(T)){const ye=await ln.hydrateCard({scryfall_id:T,name:x.trim(),setCode:k.trim(),collectorNumber:S.trim()}),ue=await ln.getImageUrlById(T),_e={id:T,oracleId:ye?.oracle_id||"",name:x.trim(),set:ye?.set_name||k.trim(),setCode:ye?.set||k.trim(),number:ye?.collector_number||S.trim(),lang:ye?.lang||"en",finish:"nonfoil",layout:ue?.layout||"normal",imageUrl:ue?.front||"",imageUrlBack:ue?.back||"",createdAt:Y,updatedAt:Y};await Ut.add(_e),console.log("Added new card to database:",_e);try{const ke=await ln.getPriceById(T);if(ke){const Z=Y.toISOString().split("T")[0],X={id:`${T}:scryfall:${Z}`,cardId:T,provider:"scryfall",finish:"nonfoil",date:Y.toISOString().split("T")[0],currency:"EUR",priceCent:ke.getCents(),asOf:Y,createdAt:Y};await ge().price_points.put(X)}}catch(ke){console.error(`Error fetching price for new card ${T}:`,ke)}}const pe=(await kt.getByCardId(T)).reduce((ye,ue)=>{if(!ue.disposedAt||ue.disposedQuantity&&ue.disposedQuantity<ue.quantity){const _e=ue.disposedQuantity?ue.quantity-ue.disposedQuantity:ue.quantity;return ye+_e}return ye},0);if(pe<E){const ye=E-pe,_e={id:`lot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,cardId:T,quantity:ye,unitCost:0,condition:"unknown",language:"en",foil:!1,finish:"nonfoil",source:"deck_import",currency:"EUR",purchasedAt:Y,createdAt:Y,updatedAt:Y};await kt.add(_e),console.log("Added new lot for deck import:",_e)}}let P;const A=await kt.getByCardId(T||"");if(A.length>0){for(const Y of A)if((Y.disposedQuantity?Y.quantity-Y.disposedQuantity:Y.quantity)>=E&&!Y.disposedAt){P=Y.id;break}!P&&A.length>0&&(P=A[0].id)}const $=new Date,I={id:`deckcard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,deckId:o||"unknown-deck",cardId:T||"unknown-card",lotId:P,quantity:typeof E=="number"&&E>0?E:1,role:"main",addedAt:$,createdAt:$};await l.deck_cards.add(I),console.log("Added deck card:",I)}}else console.log("Line did not match expected format:",g)}const u=await l.deck_cards.where("deckId").equals(o).count();if(console.log("Total cards imported:",u),s&&r)try{s.completeImport(r)}catch(f){console.warn("Could not complete import status:",f)}}catch(i){if(console.error("Error importing deck from text:",i),s&&r)try{s.completeImport(r,i.message)}catch(o){console.warn("Could not update import status to failed:",o)}throw i}}static async calculateDeckCoverage(e){try{const s=await ge().deck_cards.where("deckId").equals(e).toArray();let r=0,i=0;for(const a of s){r+=a.quantity;const c=(await kt.getActiveLotsByCardId(a.cardId)).reduce((u,f)=>u+f.quantity,0);i+=Math.min(a.quantity,c)}const o=r>0?Math.round(i/r*100):100;return{totalCards:r,ownedCards:i,coveragePercentage:o}}catch(n){throw console.error("Error calculating deck coverage:",n),n}}}const aR={class:"deck-import"},lR={class:"import-section"},cR={class:"mb-3"},uR={class:"mb-3"},dR=["disabled"],fR={key:0,class:"status-message error"},hR=et({__name:"DeckImportView",setup(t){const e=fe(""),n=fe(""),s=fe(!1),r=fe(null),i=async()=>{if(!e.value.trim()){r.value="Please enter a deck name";return}if(!n.value.trim()){r.value="Please paste your decklist";return}s.value=!0,r.value=null;try{await oR.importDeckFromText(e.value.trim(),n.value.trim()),r.value="Deck import started successfully! Check the status indicator in the top right for progress.",setTimeout(()=>{e.value="",n.value="",s.value=!1,r.value=null},3e3)}catch(o){r.value="Failed to import deck: "+o.message,s.value=!1}};return(o,a)=>(j(),W("div",aR,[a[7]||(a[7]=b("h1",null,"Import Deck",-1)),b("div",lR,[a[4]||(a[4]=b("h2",null,"Moxfield Deck Import",-1)),a[5]||(a[5]=b("p",null,"Copy and paste your decklist from Moxfield to track which cards you own and which you're missing.",-1)),b("div",cR,[a[2]||(a[2]=b("label",{for:"deck-name",class:"form-label"},"Deck Name",-1)),Zs(b("input",{id:"deck-name","onUpdate:modelValue":a[0]||(a[0]=l=>e.value=l),type:"text",placeholder:"Enter a name for your deck",class:"form-control"},null,512),[[Wo,e.value]])]),b("div",uR,[a[3]||(a[3]=b("label",{for:"decklist",class:"form-label"},"Decklist",-1)),Zs(b("textarea",{id:"decklist","onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),placeholder:`Paste your decklist here (e.g., 4 Lightning Bolt
2 Counterspell)`,rows:"10",class:"form-control"},null,512),[[Wo,n.value]])]),b("button",{onClick:i,disabled:s.value,class:"btn btn-glass-primary mb-4"},te(s.value?"Importing...":"Import Deck"),9,dR),r.value?(j(),W("div",fR,te(r.value),1)):ve("",!0),a[6]||(a[6]=b("div",{class:"instructions"},[b("h3",null,"How to copy from Moxfield:"),b("ol",null,[b("li",null,"Open your deck on Moxfield.com"),b("li",null,'Click the "Export" button'),b("li",null,'Select "Text" format'),b("li",null,"Copy the text and paste it here")])],-1))])]))}}),pR=fn(hR,[["__scopeId","data-v-cad749f2"]]),gR={class:"container py-4"},mR={class:"d-flex align-items-center justify-content-between mb-4"},yR={key:0,class:"text-center py-5"},vR={key:1,class:"text-center py-5"},bR={key:2,class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},_R={class:"card h-100 shadow-sm border-0 overflow-hidden position-relative"},wR={class:"card-aspect position-relative overflow-hidden"},xR=["src","alt"],kR={class:"card-body"},CR=["title"],SR={class:"d-flex align-items-center justify-content-between mb-2"},PR={key:0,class:"badge bg-info text-dark text-uppercase"},AR={class:"text-muted"},IR={class:"fw-semibold"},ER=et({__name:"DecksView",setup(t){const e=fe([]),n=fe(!0),s=fe({}),r=fe({}),i=c=>c?new Date(c).toLocaleDateString():"—",o=c=>s.value[c]??0,a=c=>r.value[c];return Tn(async()=>{try{const c=ge(),u=await c.decks.toArray();e.value=u;const f=u.map(async g=>{const v=await c.deck_cards.where("deckId").equals(g.id).count();return[g.id,v]}),p=u.map(async g=>{if(!g.faceCardId)return[g.id,null];const v=await c.cards.get(g.faceCardId);return[g.id,v?{id:v.id,name:v.name,imageUrl:v.imageUrl}:null]});(await Promise.all(f)).forEach(([g,v])=>s.value[g]=v),(await Promise.all(p)).forEach(([g,v])=>{v?r.value[g]=v:delete r.value[g]})}catch(c){console.error("Error loading decks:",c)}finally{n.value=!1}}),(c,u)=>{const f=Si("router-link");return j(),W("div",gR,[b("div",mR,[u[1]||(u[1]=b("h1",{class:"h3 mb-0"},"Decks",-1)),ze(f,{to:"/import/deck",class:"btn btn-glass-primary"},{default:rt(()=>[...u[0]||(u[0]=[yt(" Import Deck ",-1)])]),_:1})]),n.value?(j(),W("div",yR,[...u[2]||(u[2]=[b("div",{class:"spinner-border",role:"status","aria-hidden":"true"},null,-1),b("div",{class:"mt-2"},"Loading decks…",-1)])])):e.value.length===0?(j(),W("div",vR,[u[4]||(u[4]=b("p",{class:"text-muted mb-3"},"You haven't imported any decks yet.",-1)),ze(f,{to:"/import/deck",class:"btn btn-glass-primary"},{default:rt(()=>[...u[3]||(u[3]=[yt(" Import Your First Deck ",-1)])]),_:1})])):(j(),W("div",bR,[(j(!0),W(Qe,null,It(e.value,p=>(j(),W("div",{key:p.id,class:"col"},[b("div",_R,[b("div",wR,[b("img",{src:a(p.id)?.imageUrl,alt:a(p.id)?.name||"Face card",class:"w-100 h-100 d-block img-fit-cover rounded-4"},null,8,xR)]),b("div",kR,[b("h2",{class:"h5 mb-1 text-truncate",title:p.name},te(p.name),9,CR),b("div",SR,[p.platform?(j(),W("span",PR,te(p.platform),1)):ve("",!0),b("small",AR,te(i(p.importedAt)),1)]),b("div",IR,te(o(p.id))+" cards",1),ze(f,{class:"stretched-link",to:`/decks/${p.id}`,"aria-label":"Open deck"},null,8,["to"])])])]))),128))]))])}}}),MR=fn(ER,[["__scopeId","data-v-0821a712"]]);function jb(t,e){const n=typeof t=="string"&&!e?`${t}Context`:e,s=Symbol(n);return[o=>{const a=Mn(s,o);if(a||a===null)return a;throw new Error(`Injection \`${s.toString()}\` not found. Component must be used within ${Array.isArray(t)?`one of the following components: ${t.join(", ")}`:`\`${t}\``}`)},o=>(Po(s,o),o)]}function nr(){let t=document.activeElement;if(t==null)return null;for(;t!=null&&t.shadowRoot!=null&&t.shadowRoot.activeElement!=null;)t=t.shadowRoot.activeElement;return t}function Nb(t,e,n){const s=n.originalEvent.target,r=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),s.dispatchEvent(r)}function Cf(t){return t?t.flatMap(e=>e.type===Qe?Cf(e.children):[e]):[]}const[OR,WB]=jb("ConfigProvider");function zb(t){return Ld()?(Jm(t),!0):!1}function DR(t){let e=!1,n;const s=ec(!0);return(...r)=>(e||(n=s.run(()=>t(...r)),e=!0),n)}function TR(t){let e=0,n,s;const r=()=>{e-=1,s&&e<=0&&(s.stop(),n=void 0,s=void 0)};return(...i)=>(e+=1,s||(s=ec(!0),n=s.run(()=>t(...i))),zb(r),n)}const Yr=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const RR=t=>typeof t<"u",$R=Object.prototype.toString,FR=t=>$R.call(t)==="[object Object]",ym=LR();function LR(){var t,e;return Yr&&((t=window?.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window?.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window?.navigator.userAgent))}function BR(t){return cs()}function qu(t){return Array.isArray(t)?t:[t]}function jR(t,e){BR()&&ic(t,e)}function NR(t,e,n){return Kt(t,e,{...n,immediate:!0})}const Sf=Yr?window:void 0;function bc(t){var e;const n=as(t);return(e=n?.$el)!=null?e:n}function qb(...t){const e=[],n=()=>{e.forEach(a=>a()),e.length=0},s=(a,l,c,u)=>(a.addEventListener(l,c,u),()=>a.removeEventListener(l,c,u)),r=We(()=>{const a=qu(as(t[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),i=NR(()=>{var a,l;return[(l=(a=r.value)==null?void 0:a.map(c=>bc(c)))!=null?l:[Sf].filter(c=>c!=null),qu(as(r.value?t[1]:t[0])),qu($e(r.value?t[2]:t[1])),as(r.value?t[3]:t[2])]},([a,l,c,u])=>{if(n(),!a?.length||!l?.length||!c?.length)return;const f=FR(u)?{...u}:u;e.push(...a.flatMap(p=>l.flatMap(g=>c.map(v=>s(p,g,v,f)))))},{flush:"post"}),o=()=>{i(),n()};return zb(n),o}function zR(){const t=nc(!1),e=cs();return e&&Tn(()=>{t.value=!0},e),t}function qR(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function UR(...t){let e,n,s={};t.length===3?(e=t[0],n=t[1],s=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,n=t[0],s=t[1]):(e=t[0],n=t[1]):(e=!0,n=t[0]);const{target:r=Sf,eventName:i="keydown",passive:o=!1,dedupe:a=!1}=s,l=qR(e);return qb(r,i,u=>{u.repeat&&as(a)||l(u)&&n(u)},o)}function WR(t){return JSON.parse(JSON.stringify(t))}function VR(t,e,n,s={}){var r,i,o;const{clone:a=!1,passive:l=!1,eventName:c,deep:u=!1,defaultValue:f,shouldEmit:p}=s,g=cs(),v=n||g?.emit||((r=g?.$emit)==null?void 0:r.bind(g))||((o=(i=g?.proxy)==null?void 0:i.$emit)==null?void 0:o.bind(g?.proxy));let w=c;w=w||`update:${e.toString()}`;const x=E=>a?typeof a=="function"?a(E):WR(E):E,k=()=>RR(t[e])?x(t[e]):f,S=E=>{p?p(E)&&v(w,E):v(w,E)};if(l){const E=k(),D=fe(E);let T=!1;return Kt(()=>t[e],P=>{T||(T=!0,D.value=x(P),un(()=>T=!1))}),Kt(D,P=>{!T&&(P!==t[e]||u)&&S(P)},{deep:u}),D}else return We({get(){return k()},set(E){S(E)}})}function Uu(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function Sd(t,e,n=".",s){if(!Uu(e))return Sd(t,{},n,s);const r=Object.assign({},e);for(const i in t){if(i==="__proto__"||i==="constructor")continue;const o=t[i];o!=null&&(s&&s(r,i,o,n)||(Array.isArray(o)&&Array.isArray(r[i])?r[i]=[...o,...r[i]]:Uu(o)&&Uu(r[i])?r[i]=Sd(o,r[i],(n?`${n}.`:"")+i.toString(),s):r[i]=o))}return r}function HR(t){return(...e)=>e.reduce((n,s)=>Sd(n,s,"",t),{})}const KR=HR(),YR=TR(()=>{const t=fe(new Map),e=fe(),n=We(()=>{for(const o of t.value.values())if(o)return!0;return!1}),s=OR({scrollBody:fe(!0)});let r=null;const i=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=e.value??"",ym&&r?.(),e.value=void 0};return Kt(n,(o,a)=>{if(!Yr)return;if(!o){a&&i();return}e.value===void 0&&(e.value=document.body.style.overflow);const l=window.innerWidth-document.documentElement.clientWidth,c={padding:l,margin:0},u=s.scrollBody?.value?typeof s.scrollBody.value=="object"?KR({padding:s.scrollBody.value.padding===!0?l:s.scrollBody.value.padding,margin:s.scrollBody.value.margin===!0?l:s.scrollBody.value.margin},c):c:{padding:0,margin:0};l>0&&(document.body.style.paddingRight=typeof u.padding=="number"?`${u.padding}px`:String(u.padding),document.body.style.marginRight=typeof u.margin=="number"?`${u.margin}px`:String(u.margin),document.documentElement.style.setProperty("--scrollbar-width",`${l}px`),document.body.style.overflow="hidden"),ym&&(r=qb(document,"touchmove",f=>XR(f),{passive:!1})),un(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),t});function GR(t){const e=Math.random().toString(36).substring(2,7),n=YR();n.value.set(e,t);const s=We({get:()=>n.value.get(e)??!1,set:r=>n.value.set(e,r)});return jR(()=>{n.value.delete(e)}),s}function Ub(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const n=t.parentNode;return!(n instanceof Element)||n.tagName==="BODY"?!1:Ub(n)}}function XR(t){const e=t||window.event,n=e.target;return n instanceof Element&&Ub(n)?!1:e.touches.length>1?!0:(e.preventDefault&&e.cancelable&&e.preventDefault(),!1)}function Pf(t){const e=cs(),n=e?.type.emits,s={};return n?.length||console.warn(`No emitted event found. Please check component: ${e?.type.__name}`),n?.forEach(r=>{s[ul(On(r))]=(...i)=>t(r,...i)}),s}function us(){const t=cs(),e=fe(),n=We(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:bc(e)),s=Object.assign({},t.exposed),r={};for(const o in t.props)Object.defineProperty(r,o,{enumerable:!0,configurable:!0,get:()=>t.props[o]});if(Object.keys(s).length>0)for(const o in s)Object.defineProperty(r,o,{enumerable:!0,configurable:!0,get:()=>s[o]});Object.defineProperty(r,"$el",{enumerable:!0,configurable:!0,get:()=>t.vnode.el}),t.exposed=r;function i(o){e.value=o,o&&(Object.defineProperty(r,"$el",{enumerable:!0,configurable:!0,get:()=>o instanceof Element?o:o.$el}),t.exposed=r)}return{forwardRef:i,currentRef:e,currentElement:n}}var QR=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ui=new WeakMap,al=new WeakMap,ll={},Wu=0,Wb=function(t){return t&&(t.host||Wb(t.parentNode))},JR=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=Wb(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},ZR=function(t,e,n,s){var r=JR(e,Array.isArray(t)?t:[t]);ll[n]||(ll[n]=new WeakMap);var i=ll[n],o=[],a=new Set,l=new Set(r),c=function(f){!f||a.has(f)||(a.add(f),c(f.parentNode))};r.forEach(c);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(p){if(a.has(p))u(p);else try{var g=p.getAttribute(s),v=g!==null&&g!=="false",w=(ui.get(p)||0)+1,x=(i.get(p)||0)+1;ui.set(p,w),i.set(p,x),o.push(p),w===1&&v&&al.set(p,!0),x===1&&p.setAttribute(n,"true"),v||p.setAttribute(s,"true")}catch(k){console.error("aria-hidden: cannot operate on ",p,k)}})};return u(e),a.clear(),Wu++,function(){o.forEach(function(f){var p=ui.get(f)-1,g=i.get(f)-1;ui.set(f,p),i.set(f,g),p||(al.has(f)||f.removeAttribute(s),al.delete(f)),g||f.removeAttribute(n)}),Wu--,Wu||(ui=new WeakMap,ui=new WeakMap,al=new WeakMap,ll={})}},e2=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=QR(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),ZR(s,r,n,"aria-hidden")):function(){return null}};function t2(t){let e;Kt(()=>bc(t),n=>{n?e=e2(n):e&&e()}),Fi(()=>{e&&e()})}function vm(t,e="reka"){return`${e}-${q0?.()}`}function n2(t,e){const n=fe(t);function s(i){return e[n.value][i]??n.value}return{state:n,dispatch:i=>{n.value=s(i)}}}function s2(t,e){const n=fe({}),s=fe("none"),r=fe(t),i=t.value?"mounted":"unmounted";let o;const a=e.value?.ownerDocument.defaultView??Sf,{state:l,dispatch:c}=n2(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),u=x=>{if(Yr){const k=new CustomEvent(x,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(k)}};Kt(t,async(x,k)=>{const S=k!==x;if(await un(),S){const E=s.value,D=cl(e.value);x?(c("MOUNT"),u("enter"),D==="none"&&u("after-enter")):D==="none"||D==="undefined"||n.value?.display==="none"?(c("UNMOUNT"),u("leave"),u("after-leave")):k&&E!==D?(c("ANIMATION_OUT"),u("leave")):(c("UNMOUNT"),u("after-leave"))}},{immediate:!0});const f=x=>{const k=cl(e.value),S=k.includes(x.animationName),E=l.value==="mounted"?"enter":"leave";if(x.target===e.value&&S&&(u(`after-${E}`),c("ANIMATION_END"),!r.value)){const D=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",o=a?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=D)})}x.target===e.value&&k==="none"&&c("ANIMATION_END")},p=x=>{x.target===e.value&&(s.value=cl(e.value))},g=Kt(e,(x,k)=>{x?(n.value=getComputedStyle(x),x.addEventListener("animationstart",p),x.addEventListener("animationcancel",f),x.addEventListener("animationend",f)):(c("ANIMATION_END"),o!==void 0&&a?.clearTimeout(o),k?.removeEventListener("animationstart",p),k?.removeEventListener("animationcancel",f),k?.removeEventListener("animationend",f))},{immediate:!0}),v=Kt(l,()=>{const x=cl(e.value);s.value=l.value==="mounted"?x:"none"});return Fi(()=>{g(),v()}),{isPresent:We(()=>["mounted","unmountSuspended"].includes(l.value))}}function cl(t){return t&&getComputedStyle(t).animationName||"none"}var Vb=et({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(t,{slots:e,expose:n}){const{present:s,forceMount:r}=Vd(t),i=fe(),{isPresent:o}=s2(s,i);n({present:o});let a=e.default({present:o.value});a=Cf(a||[]);const l=cs();if(a&&a?.length>1){const c=l?.parent?.type.name?`<${l.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${c}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(u=>`  - ${u}`).join(`
`)].join(`
`))}return()=>r.value||s.value||o.value?As(e.default({present:o.value})[0],{ref:c=>{const u=bc(c);return typeof u?.hasAttribute>"u"||(u?.hasAttribute("data-reka-popper-content-wrapper")?i.value=u.firstElementChild:i.value=u),u}}):null}});const r2=et({name:"PrimitiveSlot",inheritAttrs:!1,setup(t,{attrs:e,slots:n}){return()=>{if(!n.default)return null;const s=Cf(n.default()),r=s.findIndex(l=>l.type!==Hn);if(r===-1)return s;const i=s[r];delete i.props?.ref;const o=i.props?ls(e,i.props):e,a=ir({...i,props:{}},o);return s.length===1?a:(s[r]=a,s)}}}),i2=["area","img","input"],fa=et({name:"Primitive",inheritAttrs:!1,props:{asChild:{type:Boolean,default:!1},as:{type:[String,Object],default:"div"}},setup(t,{attrs:e,slots:n}){const s=t.asChild?"template":t.as;return typeof s=="string"&&i2.includes(s)?()=>As(s,e):s!=="template"?()=>As(t.as,e,{default:n.default}):()=>As(r2,e,{default:n.default})}}),[cr,o2]=jb("DialogRoot");var a2=et({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:e}){const n=t,r=VR(n,"open",e,{defaultValue:n.defaultOpen,passive:n.open===void 0}),i=fe(),o=fe(),{modal:a}=Vd(n);return o2({open:r,modal:a,openModal:()=>{r.value=!0},onOpenChange:l=>{r.value=l},onOpenToggle:()=>{r.value=!r.value},contentId:"",titleId:"",descriptionId:"",triggerElement:i,contentElement:o}),(l,c)=>xn(l.$slots,"default",{open:$e(r),close:()=>r.value=!1})}}),l2=a2,c2=et({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const e=t;us();const n=cr();return(s,r)=>(j(),en($e(fa),ls(e,{type:s.as==="button"?"button":void 0,onClick:r[0]||(r[0]=i=>$e(n).onOpenChange(!1))}),{default:rt(()=>[xn(s.$slots,"default")]),_:3},16,["type"]))}}),u2=c2;const d2="dismissableLayer.pointerDownOutside",f2="dismissableLayer.focusOutside";function Hb(t,e){const n=e.closest("[data-dismissable-layer]"),s=t.dataset.dismissableLayer===""?t:t.querySelector("[data-dismissable-layer]"),r=Array.from(t.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(n&&(s===n||r.indexOf(s)<r.indexOf(n)))}function h2(t,e,n=!0){const s=e?.value?.ownerDocument??globalThis?.document,r=fe(!1),i=fe(()=>{});return Pi(o=>{if(!Yr||!as(n))return;const a=async c=>{const u=c.target;if(!(!e?.value||!u)){if(Hb(e.value,u)){r.value=!1;return}if(c.target&&!r.value){let g=function(){Nb(d2,t,p)};var f=g;const p={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",i.value),i.value=g,s.addEventListener("click",i.value,{once:!0})):g()}else s.removeEventListener("click",i.value);r.value=!1}},l=window.setTimeout(()=>{s.addEventListener("pointerdown",a)},0);o(()=>{window.clearTimeout(l),s.removeEventListener("pointerdown",a),s.removeEventListener("click",i.value)})}),{onPointerDownCapture:()=>{as(n)&&(r.value=!0)}}}function p2(t,e,n=!0){const s=e?.value?.ownerDocument??globalThis?.document,r=fe(!1);return Pi(i=>{if(!Yr||!as(n))return;const o=async a=>{if(!e?.value)return;await un(),await un();const l=a.target;!e.value||!l||Hb(e.value,l)||a.target&&!r.value&&Nb(f2,t,{originalEvent:a})};s.addEventListener("focusin",o),i(()=>s.removeEventListener("focusin",o))}),{onFocusCapture:()=>{as(n)&&(r.value=!0)},onBlurCapture:()=>{as(n)&&(r.value=!1)}}}const _s=Vr({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set});var g2=et({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(t,{emit:e}){const n=t,s=e,{forwardRef:r,currentElement:i}=us(),o=We(()=>i.value?.ownerDocument??globalThis.document),a=We(()=>_s.layersRoot),l=We(()=>i.value?Array.from(a.value).indexOf(i.value):-1),c=We(()=>_s.layersWithOutsidePointerEventsDisabled.size>0),u=We(()=>{const v=Array.from(a.value),[w]=[..._s.layersWithOutsidePointerEventsDisabled].slice(-1),x=v.indexOf(w);return l.value>=x}),f=h2(async v=>{const w=[..._s.branches].some(x=>x?.contains(v.target));!u.value||w||(s("pointerDownOutside",v),s("interactOutside",v),await un(),v.defaultPrevented||s("dismiss"))},i),p=p2(v=>{[..._s.branches].some(x=>x?.contains(v.target))||(s("focusOutside",v),s("interactOutside",v),v.defaultPrevented||s("dismiss"))},i);UR("Escape",v=>{l.value===a.value.size-1&&(s("escapeKeyDown",v),v.defaultPrevented||s("dismiss"))});let g;return Pi(v=>{i.value&&(n.disableOutsidePointerEvents&&(_s.layersWithOutsidePointerEventsDisabled.size===0&&(g=o.value.body.style.pointerEvents,o.value.body.style.pointerEvents="none"),_s.layersWithOutsidePointerEventsDisabled.add(i.value)),a.value.add(i.value),v(()=>{n.disableOutsidePointerEvents&&_s.layersWithOutsidePointerEventsDisabled.size===1&&(o.value.body.style.pointerEvents=g)}))}),Pi(v=>{v(()=>{i.value&&(a.value.delete(i.value),_s.layersWithOutsidePointerEventsDisabled.delete(i.value))})}),(v,w)=>(j(),en($e(fa),{ref:$e(r),"as-child":v.asChild,as:v.as,"data-dismissable-layer":"",style:En({pointerEvents:c.value?u.value?"auto":"none":void 0}),onFocusCapture:$e(p).onFocusCapture,onBlurCapture:$e(p).onBlurCapture,onPointerdownCapture:$e(f).onPointerDownCapture},{default:rt(()=>[xn(v.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),m2=g2;const y2=DR(()=>fe([]));function v2(){const t=y2();return{add(e){const n=t.value[0];e!==n&&n?.pause(),t.value=bm(t.value,e),t.value.unshift(e)},remove(e){t.value=bm(t.value,e),t.value[0]?.resume()}}}function bm(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function b2(t){return t.filter(e=>e.tagName!=="A")}const Vu="focusScope.autoFocusOnMount",Hu="focusScope.autoFocusOnUnmount",_m={bubbles:!1,cancelable:!0};function _2(t,{select:e=!1}={}){const n=nr();for(const s of t)if(Ws(s,{select:e}),nr()!==n)return!0}function w2(t){const e=Kb(t),n=wm(e,t),s=wm(e.reverse(),t);return[n,s]}function Kb(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function wm(t,e){for(const n of t)if(!x2(n,{upTo:e}))return n}function x2(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function k2(t){return t instanceof HTMLInputElement&&"select"in t}function Ws(t,{select:e=!1}={}){if(t&&t.focus){const n=nr();t.focus({preventScroll:!0}),t!==n&&k2(t)&&e&&t.select()}}var C2=et({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(t,{emit:e}){const n=t,s=e,{currentRef:r,currentElement:i}=us(),o=fe(null),a=v2(),l=Vr({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});Pi(u=>{if(!Yr)return;const f=i.value;if(!n.trapped)return;function p(x){if(l.paused||!f)return;const k=x.target;f.contains(k)?o.value=k:Ws(o.value,{select:!0})}function g(x){if(l.paused||!f)return;const k=x.relatedTarget;k!==null&&(f.contains(k)||Ws(o.value,{select:!0}))}function v(x){f.contains(o.value)||Ws(f)}document.addEventListener("focusin",p),document.addEventListener("focusout",g);const w=new MutationObserver(v);f&&w.observe(f,{childList:!0,subtree:!0}),u(()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",g),w.disconnect()})}),Pi(async u=>{const f=i.value;if(await un(),!f)return;a.add(l);const p=nr();if(!f.contains(p)){const v=new CustomEvent(Vu,_m);f.addEventListener(Vu,w=>s("mountAutoFocus",w)),f.dispatchEvent(v),v.defaultPrevented||(_2(b2(Kb(f)),{select:!0}),nr()===p&&Ws(f))}u(()=>{f.removeEventListener(Vu,x=>s("mountAutoFocus",x));const v=new CustomEvent(Hu,_m),w=x=>{s("unmountAutoFocus",x)};f.addEventListener(Hu,w),f.dispatchEvent(v),setTimeout(()=>{v.defaultPrevented||Ws(p??document.body,{select:!0}),f.removeEventListener(Hu,w),a.remove(l)},0)})});function c(u){if(!n.loop&&!n.trapped||l.paused)return;const f=u.key==="Tab"&&!u.altKey&&!u.ctrlKey&&!u.metaKey,p=nr();if(f&&p){const g=u.currentTarget,[v,w]=w2(g);v&&w?!u.shiftKey&&p===w?(u.preventDefault(),n.loop&&Ws(v,{select:!0})):u.shiftKey&&p===v&&(u.preventDefault(),n.loop&&Ws(w,{select:!0})):p===g&&u.preventDefault()}}return(u,f)=>(j(),en($e(fa),{ref_key:"currentRef",ref:r,tabindex:"-1","as-child":u.asChild,as:u.as,onKeydown:c},{default:rt(()=>[xn(u.$slots,"default")]),_:3},8,["as-child","as"]))}}),S2=C2;function P2(t){return t?"open":"closed"}var A2=et({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const n=t,s=e,r=cr(),{forwardRef:i,currentElement:o}=us();return r.titleId||=vm(void 0,"reka-dialog-title"),r.descriptionId||=vm(void 0,"reka-dialog-description"),Tn(()=>{r.contentElement=o,nr()!==document.body&&(r.triggerElement.value=nr())}),(a,l)=>(j(),en($e(S2),{"as-child":"",loop:"",trapped:n.trapFocus,onMountAutoFocus:l[5]||(l[5]=c=>s("openAutoFocus",c)),onUnmountAutoFocus:l[6]||(l[6]=c=>s("closeAutoFocus",c))},{default:rt(()=>[ze($e(m2),ls({id:$e(r).contentId,ref:$e(i),as:a.as,"as-child":a.asChild,"disable-outside-pointer-events":a.disableOutsidePointerEvents,role:"dialog","aria-describedby":$e(r).descriptionId,"aria-labelledby":$e(r).titleId,"data-state":$e(P2)($e(r).open.value)},a.$attrs,{onDismiss:l[0]||(l[0]=c=>$e(r).onOpenChange(!1)),onEscapeKeyDown:l[1]||(l[1]=c=>s("escapeKeyDown",c)),onFocusOutside:l[2]||(l[2]=c=>s("focusOutside",c)),onInteractOutside:l[3]||(l[3]=c=>s("interactOutside",c)),onPointerDownOutside:l[4]||(l[4]=c=>s("pointerDownOutside",c))}),{default:rt(()=>[xn(a.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),Yb=A2,I2=et({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const n=t,s=e,r=cr(),i=Pf(s),{forwardRef:o,currentElement:a}=us();return t2(a),(l,c)=>(j(),en(Yb,ls({...n,...$e(i)},{ref:$e(o),"trap-focus":$e(r).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:c[0]||(c[0]=u=>{u.defaultPrevented||(u.preventDefault(),$e(r).triggerElement.value?.focus())}),onPointerDownOutside:c[1]||(c[1]=u=>{const f=u.detail.originalEvent,p=f.button===0&&f.ctrlKey===!0;(f.button===2||p)&&u.preventDefault()}),onFocusOutside:c[2]||(c[2]=u=>{u.preventDefault()})}),{default:rt(()=>[xn(l.$slots,"default")]),_:3},16,["trap-focus"]))}}),E2=I2,M2=et({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const n=t,r=Pf(e);us();const i=cr(),o=fe(!1),a=fe(!1);return(l,c)=>(j(),en(Yb,ls({...n,...$e(r)},{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:c[0]||(c[0]=u=>{u.defaultPrevented||(o.value||$e(i).triggerElement.value?.focus(),u.preventDefault()),o.value=!1,a.value=!1}),onInteractOutside:c[1]||(c[1]=u=>{u.defaultPrevented||(o.value=!0,u.detail.originalEvent.type==="pointerdown"&&(a.value=!0));const f=u.target;$e(i).triggerElement.value?.contains(f)&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&a.value&&u.preventDefault()})}),{default:rt(()=>[xn(l.$slots,"default")]),_:3},16))}}),O2=M2,D2=et({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(t,{emit:e}){const n=t,s=e,r=cr(),i=Pf(s),{forwardRef:o}=us();return(a,l)=>(j(),en($e(Vb),{present:a.forceMount||$e(r).open.value},{default:rt(()=>[$e(r).modal.value?(j(),en(E2,ls({key:0,ref:$e(o)},{...n,...$e(i),...a.$attrs}),{default:rt(()=>[xn(a.$slots,"default")]),_:3},16)):(j(),en(O2,ls({key:1,ref:$e(o)},{...n,...$e(i),...a.$attrs}),{default:rt(()=>[xn(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),T2=D2,R2=et({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const e=cr();return GR(!0),us(),(n,s)=>(j(),en($e(fa),{as:n.as,"as-child":n.asChild,"data-state":$e(e).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:rt(()=>[xn(n.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),$2=R2,F2=et({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const e=cr(),{forwardRef:n}=us();return(s,r)=>$e(e)?.modal.value?(j(),en($e(Vb),{key:0,present:s.forceMount||$e(e).open.value},{default:rt(()=>[ze($2,ls(s.$attrs,{ref:$e(n),as:s.as,"as-child":s.asChild}),{default:rt(()=>[xn(s.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):ve("v-if",!0)}}),L2=F2,B2=et({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const e=zR();return(n,s)=>$e(e)||n.forceMount?(j(),en(B0,{key:0,to:n.to,disabled:n.disabled,defer:n.defer},[xn(n.$slots,"default")],8,["to","disabled","defer"])):ve("v-if",!0)}}),j2=B2,N2=et({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const e=t;return(n,s)=>(j(),en($e(j2),t0(Yy(e)),{default:rt(()=>[xn(n.$slots,"default")]),_:3},16))}}),z2=N2,q2=et({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(t){const e=t,n=cr();return us(),(s,r)=>(j(),en($e(fa),ls(e,{id:$e(n).titleId}),{default:rt(()=>[xn(s.$slots,"default")]),_:3},16,["id"]))}}),U2=q2;/*!
* chartjs-plugin-annotation v3.1.0
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2024 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const xm={modes:{point(t,e){return wl(t,e,{intersect:!0})},nearest(t,e,n){return H2(t,e,n)},x(t,e,n){return wl(t,e,{intersect:n.intersect,axis:"x"})},y(t,e,n){return wl(t,e,{intersect:n.intersect,axis:"y"})}}};function Af(t,e,n){return(xm.modes[n.mode]||xm.modes.nearest)(t,e,n)}function W2(t,e,n){return n!=="x"&&n!=="y"?t.inRange(e.x,e.y,"x",!0)||t.inRange(e.x,e.y,"y",!0):t.inRange(e.x,e.y,n,!0)}function V2(t,e,n){return n==="x"?{x:t.x,y:e.y}:n==="y"?{x:e.x,y:t.y}:e}function wl(t,e,n){return t.filter(s=>n.intersect?s.inRange(e.x,e.y):W2(s,e,n.axis))}function H2(t,e,n){let s=Number.POSITIVE_INFINITY;return wl(t,e,n).reduce((r,i)=>{const o=i.getCenterPoint(),a=V2(e,o,n.axis),l=Oi(e,a);return l<s?(r=[i],s=l):l===s&&r.push(i),r},[]).sort((r,i)=>r._index-i._index).slice(0,1)}function Gr(t,e,n){const s=Math.cos(n),r=Math.sin(n),i=e.x,o=e.y;return{x:i+s*(t.x-i)-r*(t.y-o),y:o+r*(t.x-i)+s*(t.y-o)}}const K2=(t,e)=>e>t||t.length>e.length&&t.slice(0,e.length)===e,Lr=.001,_c=(t,e,n)=>Math.min(n,Math.max(e,t)),Gb=(t,e)=>t.value>=t.start-e&&t.value<=t.end+e;function Y2(t,e,n){for(const s of Object.keys(t))t[s]=_c(t[s],e,n);return t}function G2(t,e,n,s){return!t||!e||n<=0?!1:Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=Math.pow(n+s,2)}function Xb(t,{x:e,y:n,x2:s,y2:r},i,{borderWidth:o,hitTolerance:a}){const l=(o+a)/2,c=t.x>=e-l-Lr&&t.x<=s+l+Lr,u=t.y>=n-l-Lr&&t.y<=r+l+Lr;return i==="x"?c:(i==="y"||c)&&u}function Qb(t,{rect:e,center:n},s,{rotation:r,borderWidth:i,hitTolerance:o}){const a=Gr(t,n,Vt(-r));return Xb(a,e,s,{borderWidth:i,hitTolerance:o})}function Xr(t,e){const{centerX:n,centerY:s}=t.getProps(["centerX","centerY"],e);return{x:n,y:s}}function X2(t,e,n,s=!0){const r=n.split(".");let i=0;for(const o of e.split(".")){const a=r[i++];if(parseInt(o,10)<parseInt(a,10))break;if(K2(a,o)){if(s)throw new Error(`${t} v${n} is not supported. v${e} or newer is required.`);return!1}}return!0}const Jb=t=>typeof t=="string"&&t.endsWith("%"),Zb=t=>parseFloat(t)/100,e_=t=>_c(Zb(t),0,1),uo=(t,e)=>({x:t,y:e,x2:t,y2:e,width:0,height:0}),Q2={box:t=>uo(t.centerX,t.centerY),doughnutLabel:t=>uo(t.centerX,t.centerY),ellipse:t=>({centerX:t.centerX,centerY:t.centerX,radius:0,width:0,height:0}),label:t=>uo(t.centerX,t.centerY),line:t=>uo(t.x,t.y),point:t=>({centerX:t.centerX,centerY:t.centerY,radius:0,width:0,height:0}),polygon:t=>uo(t.centerX,t.centerY)};function If(t,e){return e==="start"?0:e==="end"?t:Jb(e)?e_(e)*t:t/2}function or(t,e,n=!0){return typeof e=="number"?e:Jb(e)?(n?e_(e):Zb(e))*t:t}function J2(t,e){const{x:n,width:s}=t,r=e.textAlign;return r==="center"?n+s/2:r==="end"||r==="right"?n+s:n}function t_(t,e,{borderWidth:n,position:s,xAdjust:r,yAdjust:i},o){const a=Ze(o),l=e.width+(a?o.width:0)+n,c=e.height+(a?o.height:0)+n,u=Ef(s),f=km(t.x,l,r,u.x),p=km(t.y,c,i,u.y);return{x:f,y:p,x2:f+l,y2:p+c,width:l,height:c,centerX:f+l/2,centerY:p+c/2}}function Ef(t,e="center"){return Ze(t)?{x:Je(t.x,e),y:Je(t.y,e)}:(t=Je(t,e),{x:t,y:t})}const n_=(t,e)=>t&&t.autoFit&&e<1;function s_(t,e){const n=t.font,s=Ct(n)?n:[n];return n_(t,e)?s.map(function(r){const i=Lt(r);return i.size=Math.floor(r.size*e),i.lineHeight=r.lineHeight,Lt(i)}):s.map(r=>Lt(r))}function r_(t){return t&&(Dn(t.xValue)||Dn(t.yValue))}function km(t,e,n=0,s){return t-If(e,s)+n}function Bi(t,e,n){const s=n.init;if(s){if(s===!0)return o_(e,n)}else return;return Z2(t,e,n)}function i_(t,e,n){let s=!1;return e.forEach(r=>{wn(t[r])?(s=!0,n[r]=t[r]):Dn(n[r])&&delete n[r]}),s}function o_(t,e){const n=e.type||"line";return Q2[n](t)}function Z2(t,e,n){const s=pt(n.init,[{chart:t,properties:e,options:n}]);if(s===!0)return o_(e,n);if(Ze(s))return s}const Ku=new Map,e$=t=>isNaN(t)||t<=0,t$=t=>t.reduce(function(e,n){return e+=n.string,e},"");function wc(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]"}}function xc(t,{x:e,y:n},s){s&&(t.translate(e,n),t.rotate(Vt(s)),t.translate(-e,-n))}function Ms(t,e){if(e&&e.borderWidth)return t.lineCap=e.borderCapStyle||"butt",t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.lineJoin=e.borderJoinStyle||"miter",t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,!0}function ji(t,e){t.shadowColor=e.backgroundShadowColor,t.shadowBlur=e.shadowBlur,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY}function kc(t,e){const n=e.content;if(wc(n))return{width:or(n.width,e.width),height:or(n.height,e.height)};const s=s_(e),r=e.textStrokeWidth,i=Ct(n)?n:[n],o=i.join()+t$(s)+r+(t._measureText?"-spriting":"");return Ku.has(o)||Ku.set(o,i$(t,i,s,r)),Ku.get(o)}function a_(t,e,n){const{x:s,y:r,width:i,height:o}=e;t.save(),ji(t,n);const a=Ms(t,n);t.fillStyle=n.backgroundColor,t.beginPath(),zl(t,{x:s,y:r,w:i,h:o,radius:Y2(xi(n.borderRadius),0,Math.min(i,o)/2)}),t.closePath(),t.fill(),a&&(t.shadowColor=n.borderShadowColor,t.stroke()),t.restore()}function l_(t,e,n,s){const r=n.content;if(wc(r)){t.save(),t.globalAlpha=l$(n.opacity,r.style.opacity),t.drawImage(r,e.x,e.y,e.width,e.height),t.restore();return}const i=Ct(r)?r:[r],o=s_(n,s),a=n.color,l=Ct(a)?a:[a],c=J2(e,n),u=e.y+n.textStrokeWidth/2;t.save(),t.textBaseline="middle",t.textAlign=n.textAlign,n$(t,n)&&o$(t,{x:c,y:u},i,o),a$(t,{x:c,y:u},i,{fonts:o,colors:l}),t.restore()}function n$(t,e){if(e.textStrokeWidth>0)return t.lineJoin="round",t.miterLimit=2,t.lineWidth=e.textStrokeWidth,t.strokeStyle=e.textStrokeColor,!0}function s$(t,e,n,s){const{radius:r,options:i}=e,o=i.pointStyle,a=i.rotation;let l=(a||0)*af;if(wc(o)){t.save(),t.translate(n,s),t.rotate(l),t.drawImage(o,-o.width/2,-o.height/2,o.width,o.height),t.restore();return}e$(r)||r$(t,{x:n,y:s,radius:r,rotation:a,style:o,rad:l})}function r$(t,{x:e,y:n,radius:s,rotation:r,style:i,rad:o}){let a,l,c,u;switch(t.beginPath(),i){default:t.arc(e,n,s,0,Wt),t.closePath();break;case"triangle":t.moveTo(e+Math.sin(o)*s,n-Math.cos(o)*s),o+=jl,t.lineTo(e+Math.sin(o)*s,n-Math.cos(o)*s),o+=jl,t.lineTo(e+Math.sin(o)*s,n-Math.cos(o)*s),t.closePath();break;case"rectRounded":u=s*.516,c=s-u,a=Math.cos(o+Bn)*c,l=Math.sin(o+Bn)*c,t.arc(e-a,n-l,u,o-ut,o-Zt),t.arc(e+l,n-a,u,o-Zt,o),t.arc(e+a,n+l,u,o,o+Zt),t.arc(e-l,n+a,u,o+Zt,o+ut),t.closePath();break;case"rect":if(!r){c=Math.SQRT1_2*s,t.rect(e-c,n-c,2*c,2*c);break}o+=Bn;case"rectRot":a=Math.cos(o)*s,l=Math.sin(o)*s,t.moveTo(e-a,n-l),t.lineTo(e+l,n-a),t.lineTo(e+a,n+l),t.lineTo(e-l,n+a),t.closePath();break;case"crossRot":o+=Bn;case"cross":a=Math.cos(o)*s,l=Math.sin(o)*s,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"star":a=Math.cos(o)*s,l=Math.sin(o)*s,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a),o+=Bn,a=Math.cos(o)*s,l=Math.sin(o)*s,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"line":a=Math.cos(o)*s,l=Math.sin(o)*s,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l);break;case"dash":t.moveTo(e,n),t.lineTo(e+Math.cos(o)*s,n+Math.sin(o)*s);break}t.fill()}function i$(t,e,n,s){t.save();const r=e.length;let i=0,o=s;for(let a=0;a<r;a++){const l=n[Math.min(a,n.length-1)];t.font=l.string;const c=e[a];i=Math.max(i,t.measureText(c).width+s),o+=l.lineHeight}return t.restore(),{width:i,height:o}}function o$(t,{x:e,y:n},s,r){t.beginPath();let i=0;s.forEach(function(o,a){const l=r[Math.min(a,r.length-1)],c=l.lineHeight;t.font=l.string,t.strokeText(o,e,n+c/2+i),i+=c}),t.stroke()}function a$(t,{x:e,y:n},s,{fonts:r,colors:i}){let o=0;s.forEach(function(a,l){const c=i[Math.min(l,i.length-1)],u=r[Math.min(l,r.length-1)],f=u.lineHeight;t.beginPath(),t.font=u.string,t.fillStyle=c,t.fillText(a,e,n+f/2+o),o+=f,t.fill()})}function l$(t,e){const n=qr(t)?t:e;return qr(n)?_c(n,0,1):1}const c_=["left","bottom","top","right"];function c$(t,e){const{pointX:n,pointY:s,options:r}=e,i=r.callout,o=i&&i.display&&p$(e,i);if(!o||m$(e,i,o))return;if(t.save(),t.beginPath(),!Ms(t,i))return t.restore();const{separatorStart:l,separatorEnd:c}=u$(e,o),{sideStart:u,sideEnd:f}=f$(e,o,l);(i.margin>0||r.borderWidth===0)&&(t.moveTo(l.x,l.y),t.lineTo(c.x,c.y)),t.moveTo(u.x,u.y),t.lineTo(f.x,f.y);const p=Gr({x:n,y:s},e.getCenterPoint(),Vt(-e.rotation));t.lineTo(p.x,p.y),t.stroke(),t.restore()}function u$(t,e){const{x:n,y:s,x2:r,y2:i}=t,o=d$(t,e);let a,l;return e==="left"||e==="right"?(a={x:n+o,y:s},l={x:a.x,y:i}):(a={x:n,y:s+o},l={x:r,y:a.y}),{separatorStart:a,separatorEnd:l}}function d$(t,e){const{width:n,height:s,options:r}=t,i=r.callout.margin+r.borderWidth/2;return e==="right"?n+i:e==="bottom"?s+i:-i}function f$(t,e,n){const{y:s,width:r,height:i,options:o}=t,a=o.callout.start,l=h$(e,o.callout);let c,u;return e==="left"||e==="right"?(c={x:n.x,y:s+or(i,a)},u={x:c.x+l,y:c.y}):(c={x:n.x+or(r,a),y:n.y},u={x:c.x,y:c.y+l}),{sideStart:c,sideEnd:u}}function h$(t,e){const n=e.side;return t==="left"||t==="top"?-n:n}function p$(t,e){const n=e.position;return c_.includes(n)?n:g$(t,e)}function g$(t,e){const{x:n,y:s,x2:r,y2:i,width:o,height:a,pointX:l,pointY:c,centerX:u,centerY:f,rotation:p}=t,g={x:u,y:f},v=e.start,w=or(o,v),x=or(a,v),k=[n,n+w,n+w,r],S=[s+x,i,s,i],E=[];for(let D=0;D<4;D++){const T=Gr({x:k[D],y:S[D]},g,Vt(p));E.push({position:c_[D],distance:Oi(T,{x:l,y:c})})}return E.sort((D,T)=>D.distance-T.distance)[0].position}function m$(t,e,n){const{pointX:s,pointY:r}=t,i=e.margin;let o=s,a=r;return n==="left"?o+=i:n==="right"?o-=i:n==="top"?a+=i:n==="bottom"&&(a-=i),t.inRange(o,a)}const Cm={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function $i(t,e,n){return e=typeof e=="number"?e:t.parse(e),Yt(e)?t.getPixelForValue(e):n}function Wr(t,e,n){const s=e[n];if(s||n==="scaleID")return s;const r=n.charAt(0),i=Object.values(t).filter(o=>o.axis&&o.axis===r);return i.length?i[0].id:r}function u_(t,e){if(t){const n=t.options.reverse,s=$i(t,e.min,n?e.end:e.start),r=$i(t,e.max,n?e.start:e.end);return{start:s,end:r}}}function d_(t,e){const{chartArea:n,scales:s}=t,r=s[Wr(s,e,"xScaleID")],i=s[Wr(s,e,"yScaleID")];let o=n.width/2,a=n.height/2;return r&&(o=$i(r,e.xValue,r.left+r.width/2)),i&&(a=$i(i,e.yValue,i.top+i.height/2)),{x:o,y:a}}function Mf(t,e){const n=t.scales,s=n[Wr(n,e,"xScaleID")],r=n[Wr(n,e,"yScaleID")];if(!s&&!r)return{};let{left:i,right:o}=s||t.chartArea,{top:a,bottom:l}=r||t.chartArea;const c=Sm(s,{min:e.xMin,max:e.xMax,start:i,end:o});i=c.start,o=c.end;const u=Sm(r,{min:e.yMin,max:e.yMax,start:l,end:a});return a=u.start,l=u.end,{x:i,y:a,x2:o,y2:l,width:o-i,height:l-a,centerX:i+(o-i)/2,centerY:a+(l-a)/2}}function f_(t,e){if(!r_(e)){const n=Mf(t,e);let s=e.radius;(!s||isNaN(s))&&(s=Math.min(n.width,n.height)/2,e.radius=s);const r=s*2,i=n.centerX+e.xAdjust,o=n.centerY+e.yAdjust;return{x:i-s,y:o-s,x2:i+s,y2:o+s,centerX:i,centerY:o,width:r,height:r,radius:s}}return v$(t,e)}function y$(t,e){const{scales:n,chartArea:s}=t,r=n[e.scaleID],i={x:s.left,y:s.top,x2:s.right,y2:s.bottom};return r?b$(r,i,e):_$(n,i,e),i}function h_(t,e){const n=Mf(t,e);return n.initProperties=Bi(t,n,e),n.elements=[{type:"label",optionScope:"label",properties:k$(t,n,e),initProperties:n.initProperties}],n}function v$(t,e){const n=d_(t,e),s=e.radius*2;return{x:n.x-e.radius+e.xAdjust,y:n.y-e.radius+e.yAdjust,x2:n.x+e.radius+e.xAdjust,y2:n.y+e.radius+e.yAdjust,centerX:n.x+e.xAdjust,centerY:n.y+e.yAdjust,radius:e.radius,width:s,height:s}}function Sm(t,e){const n=u_(t,e)||e;return{start:Math.min(n.start,n.end),end:Math.max(n.start,n.end)}}function b$(t,e,n){const s=$i(t,n.value,NaN),r=$i(t,n.endValue,s);t.isHorizontal()?(e.x=s,e.x2=r):(e.y=s,e.y2=r)}function _$(t,e,n){for(const s of Object.keys(Cm)){const r=t[Wr(t,n,s)];if(r){const{min:i,max:o,start:a,end:l,startProp:c,endProp:u}=Cm[s],f=u_(r,{min:n[i],max:n[o],start:r[a],end:r[l]});e[c]=f.start,e[u]=f.end}}}function w$({properties:t,options:e},n,s,r){const{x:i,x2:o,width:a}=t;return p_({start:i,end:o,borderWidth:e.borderWidth},{position:s.x,padding:{start:r.left,end:r.right},adjust:e.label.xAdjust,size:n.width})}function x$({properties:t,options:e},n,s,r){const{y:i,y2:o,height:a}=t;return p_({start:i,end:o,borderWidth:e.borderWidth},{position:s.y,padding:{start:r.top,end:r.bottom},adjust:e.label.yAdjust,size:n.height})}function p_(t,e){const{start:n,end:s,borderWidth:r}=t,{position:i,padding:{start:o,end:a},adjust:l}=e,c=s-r-n-o-a-e.size;return n+r/2+l+If(c,i)}function k$(t,e,n){const s=n.label;s.backgroundColor="transparent",s.callout.display=!1;const r=Ef(s.position),i=dn(s.padding),o=kc(t.ctx,s),a=w$({properties:e,options:n},o,r,i),l=x$({properties:e,options:n},o,r,i),c=o.width+i.width,u=o.height+i.height;return{x:a,y:l,x2:a+c,y2:l+u,width:c,height:u,centerX:a+c/2,centerY:l+u/2,rotation:s.rotation}}const Pd=["enter","leave"],Of=Pd.concat("click");function C$(t,e,n){e.listened=i_(n,Of,e.listeners),e.moveListened=!1,Pd.forEach(s=>{wn(n[s])&&(e.moveListened=!0)}),(!e.listened||!e.moveListened)&&e.annotations.forEach(s=>{!e.listened&&wn(s.click)&&(e.listened=!0),e.moveListened||Pd.forEach(r=>{wn(s[r])&&(e.listened=!0,e.moveListened=!0)})})}function S$(t,e,n){if(t.listened)switch(e.type){case"mousemove":case"mouseout":return P$(t,e,n);case"click":return A$(t,e,n)}}function P$(t,e,n){if(!t.moveListened)return;let s;e.type==="mousemove"?s=Af(t.visibleElements,e,n.interaction):s=[];const r=t.hovered;t.hovered=s;const i={state:t,event:e};let o=Pm(i,"leave",r,s);return Pm(i,"enter",s,r)||o}function Pm({state:t,event:e},n,s,r){let i;for(const o of s)r.indexOf(o)<0&&(i=g_(o.options[n]||t.listeners[n],o,e)||i);return i}function A$(t,e,n){const s=t.listeners,r=Af(t.visibleElements,e,n.interaction);let i;for(const o of r)i=g_(o.options.click||s.click,o,e)||i;return i}function g_(t,e,n){return pt(t,[e.$context,n])===!0}const Kl=["afterDraw","beforeDraw"];function I$(t,e,n){const s=e.visibleElements;e.hooked=i_(n,Kl,e.hooks),e.hooked||s.forEach(r=>{e.hooked||Kl.forEach(i=>{wn(r.options[i])&&(e.hooked=!0)})})}function Am(t,e,n){if(t.hooked){const s=e.options[n]||t.hooks[n];return pt(s,[e.$context])}}function E$(t,e,n){const s=R$(t.scales,e,n);let r=Im(e,s,"min","suggestedMin");r=Im(e,s,"max","suggestedMax")||r,r&&wn(e.handleTickRangeOptions)&&e.handleTickRangeOptions()}function M$(t,e){for(const n of t)D$(n,e)}function Im(t,e,n,s){if(Yt(e[n])&&!O$(t.options,n,s)){const r=t[n]!==e[n];return t[n]=e[n],r}}function O$(t,e,n){return Dn(t[e])||Dn(t[n])}function D$(t,e){for(const n of["scaleID","xScaleID","yScaleID"]){const s=Wr(e,t,n);s&&!e[s]&&T$(t,n)&&console.warn(`No scale found with id '${s}' for annotation '${t.id}'`)}}function T$(t,e){if(e==="scaleID")return!0;const n=e.charAt(0);for(const s of["Min","Max","Value"])if(Dn(t[n+s]))return!0;return!1}function R$(t,e,n){const s=e.axis,r=e.id,i=s+"ScaleID",o={min:Je(e.min,Number.NEGATIVE_INFINITY),max:Je(e.max,Number.POSITIVE_INFINITY)};for(const a of n)a.scaleID===r?Em(a,e,["value","endValue"],o):Wr(t,a,i)===r&&Em(a,e,[s+"Min",s+"Max",s+"Value"],o);return o}function Em(t,e,n,s){for(const r of n){const i=t[r];if(Dn(i)){const o=e.parse(i);s.min=Math.min(s.min,o),s.max=Math.max(s.max,o)}}}class Ni extends kn{inRange(e,n,s,r){const{x:i,y:o}=Gr({x:e,y:n},this.getCenterPoint(r),Vt(-this.options.rotation));return Xb({x:i,y:o},this.getProps(["x","y","x2","y2"],r),s,this.options)}getCenterPoint(e){return Xr(this,e)}draw(e){e.save(),xc(e,this.getCenterPoint(),this.options.rotation),a_(e,this,this.options),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return h_(e,n)}}Ni.id="boxAnnotation";Ni.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,hitTolerance:0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};Ni.defaultRoutes={borderColor:"color",backgroundColor:"color"};Ni.descriptors={label:{_fallback:!0}};class Cc extends kn{inRange(e,n,s,r){return Qb({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],r),center:this.getCenterPoint(r)},s,{rotation:this.rotation,borderWidth:0,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return Xr(this,e)}draw(e){const n=this.options;!n.display||!n.content||(N$(e,this),e.save(),xc(e,this.getCenterPoint(),this.rotation),l_(e,this,n,this._fitRatio),e.restore())}resolveElementProperties(e,n){const s=$$(e,n);if(!s)return{};const{controllerMeta:r,point:i,radius:o}=L$(e,n,s);let a=kc(e.ctx,n);const l=B$(a,o);n_(n,l)&&(a={width:a.width*l,height:a.height*l});const{position:c,xAdjust:u,yAdjust:f}=n,p=t_(i,a,{borderWidth:0,position:c,xAdjust:u,yAdjust:f});return{initProperties:Bi(e,p,n),...p,...r,rotation:n.rotation,_fitRatio:l}}}Cc.id="doughnutLabelAnnotation";Cc.defaults={autoFit:!0,autoHide:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderColor:"transparent",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:0,color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,spacing:1,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0};Cc.defaultRoutes={};function $$(t,e){return t.getSortedVisibleDatasetMetas().reduce(function(n,s){const r=s.controller;return r instanceof DS&&F$(t,e,s.data)&&(!n||r.innerRadius<n.controller.innerRadius)&&r.options.circumference>=90?s:n},void 0)}function F$(t,e,n){if(!e.autoHide)return!0;for(let s=0;s<n.length;s++)if(!n[s].hidden&&t.getDataVisibility(s))return!0}function L$({chartArea:t},e,n){const{left:s,top:r,right:i,bottom:o}=t,{innerRadius:a,offsetX:l,offsetY:c}=n.controller,u=(s+i)/2+l,f=(r+o)/2+c,p={left:Math.max(u-a,s),right:Math.min(u+a,i),top:Math.max(f-a,r),bottom:Math.min(f+a,o)},g={x:(p.left+p.right)/2,y:(p.top+p.bottom)/2},v=e.spacing+e.borderWidth/2,w=a-v,x=g.y>f,k=x?r+v:o-v,S=j$(k,u,f,w);return{controllerMeta:{_centerX:u,_centerY:f,_radius:w,_counterclockwise:x,...S},point:g,radius:Math.min(a,Math.min(p.right-p.left,p.bottom-p.top)/2)}}function B$({width:t,height:e},n){const s=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return n*2/s}function j$(t,e,n,s){const r=Math.pow(n-t,2),i=Math.pow(s,2),o=e*-2,a=Math.pow(e,2)+r-i,l=Math.pow(o,2)-4*a;if(l<=0)return{_startAngle:0,_endAngle:Wt};const c=(-o-Math.sqrt(l))/2,u=(-o+Math.sqrt(l))/2;return{_startAngle:pd({x:e,y:n},{x:c,y:t}).angle,_endAngle:pd({x:e,y:n},{x:u,y:t}).angle}}function N$(t,e){const{_centerX:n,_centerY:s,_radius:r,_startAngle:i,_endAngle:o,_counterclockwise:a,options:l}=e;t.save();const c=Ms(t,l);t.fillStyle=l.backgroundColor,t.beginPath(),t.arc(n,s,r,i,o,a),t.closePath(),t.fill(),c&&t.stroke(),t.restore()}class ha extends kn{inRange(e,n,s,r){return Qb({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],r),center:this.getCenterPoint(r)},s,{rotation:this.rotation,borderWidth:this.options.borderWidth,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return Xr(this,e)}draw(e){const n=this.options,s=!Dn(this._visible)||this._visible;!n.display||!n.content||!s||(e.save(),xc(e,this.getCenterPoint(),this.rotation),c$(e,this),a_(e,this,n),l_(e,z$(this),n),e.restore())}resolveElementProperties(e,n){let s;if(r_(n))s=d_(e,n);else{const{centerX:a,centerY:l}=Mf(e,n);s={x:a,y:l}}const r=dn(n.padding),i=kc(e.ctx,n),o=t_(s,i,n,r);return{initProperties:Bi(e,o,n),pointX:s.x,pointY:s.y,...o,rotation:n.rotation}}}ha.id="labelAnnotation";ha.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};ha.defaultRoutes={borderColor:"color"};function z$({x:t,y:e,width:n,height:s,options:r}){const i=r.borderWidth/2,o=dn(r.padding);return{x:t+o.left+i,y:e+o.top+i,width:n-o.left-o.right-r.borderWidth,height:s-o.top-o.bottom-r.borderWidth}}const Df=(t,e,n)=>({x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}),Ad=(t,e,n)=>Df(e,n,Math.abs((t-e.y)/(n.y-e.y))).x,Mm=(t,e,n)=>Df(e,n,Math.abs((t-e.x)/(n.x-e.x))).y,bo=t=>t*t,q$=(t,e,{x:n,y:s,x2:r,y2:i},o)=>o==="y"?{start:Math.min(s,i),end:Math.max(s,i),value:e}:{start:Math.min(n,r),end:Math.max(n,r),value:t},Om=(t,e,n,s)=>(1-s)*(1-s)*t+2*(1-s)*s*e+s*s*n,Id=(t,e,n,s)=>({x:Om(t.x,e.x,n.x,s),y:Om(t.y,e.y,n.y,s)}),Dm=(t,e,n,s)=>2*(1-s)*(e-t)+2*s*(n-e),Tm=(t,e,n,s)=>-Math.atan2(Dm(t.x,e.x,n.x,s),Dm(t.y,e.y,n.y,s))+.5*ut;class pa extends kn{inRange(e,n,s,r){const i=(this.options.borderWidth+this.options.hitTolerance)/2;if(s!=="x"&&s!=="y"){const o={mouseX:e,mouseY:n},{path:a,ctx:l}=this;if(a){Ms(l,this.options),l.lineWidth+=this.options.hitTolerance;const{chart:u}=this.$context,f=e*u.currentDevicePixelRatio,p=n*u.currentDevicePixelRatio,g=l.isPointInStroke(a,f,p)||Ed(this,o,r);return l.restore(),g}const c=bo(i);return H$(this,o,c,r)||Ed(this,o,r)}return U$(this,{mouseX:e,mouseY:n},s,{hitSize:i,useFinalPosition:r})}getCenterPoint(e){return Xr(this,e)}draw(e){const{x:n,y:s,x2:r,y2:i,cp:o,options:a}=this;if(e.save(),!Ms(e,a))return e.restore();ji(e,a);const l=Math.sqrt(Math.pow(r-n,2)+Math.pow(i-s,2));if(a.curve&&o)return eF(e,this,o,l),e.restore();const{startOpts:c,endOpts:u,startAdjust:f,endAdjust:p}=m_(this),g=Math.atan2(i-s,r-n);e.translate(n,s),e.rotate(g),e.beginPath(),e.moveTo(0+f,0),e.lineTo(l-p,0),e.shadowColor=a.borderShadowColor,e.stroke(),Md(e,0,f,c),Md(e,l,-p,u),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){const s=y$(e,n),{x:r,y:i,x2:o,y2:a}=s,l=W$(s,e.chartArea),c=l?V$({x:r,y:i},{x:o,y:a},e.chartArea):{x:r,y:i,x2:o,y2:a,width:Math.abs(o-r),height:Math.abs(a-i)};if(c.centerX=(o+r)/2,c.centerY=(a+i)/2,c.initProperties=Bi(e,c,n),n.curve){const f={x:c.x,y:c.y},p={x:c.x2,y:c.y2};c.cp=Z$(c,n,Oi(f,p))}const u=K$(e,c,n.label);return u._visible=l,c.elements=[{type:"label",optionScope:"label",properties:u,initProperties:c.initProperties}],c}}pa.id="lineAnnotation";const Rm={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};pa.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},Rm),fill:!1,length:12,start:Object.assign({},Rm),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,hitTolerance:0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},ha.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};pa.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};pa.defaultRoutes={borderColor:"color"};function U$(t,{mouseX:e,mouseY:n},s,{hitSize:r,useFinalPosition:i}){const o=q$(e,n,t.getProps(["x","y","x2","y2"],i),s);return Gb(o,r)||Ed(t,{mouseX:e,mouseY:n},i,s)}function W$({x:t,y:e,x2:n,y2:s},{top:r,right:i,bottom:o,left:a}){return!(t<a&&n<a||t>i&&n>i||e<r&&s<r||e>o&&s>o)}function $m({x:t,y:e},n,{top:s,right:r,bottom:i,left:o}){return t<o&&(e=Mm(o,{x:t,y:e},n),t=o),t>r&&(e=Mm(r,{x:t,y:e},n),t=r),e<s&&(t=Ad(s,{x:t,y:e},n),e=s),e>i&&(t=Ad(i,{x:t,y:e},n),e=i),{x:t,y:e}}function V$(t,e,n){const{x:s,y:r}=$m(t,e,n),{x:i,y:o}=$m(e,t,n);return{x:s,y:r,x2:i,y2:o,width:Math.abs(i-s),height:Math.abs(o-r)}}function H$(t,{mouseX:e,mouseY:n},s=Lr,r){const{x:i,y:o,x2:a,y2:l}=t.getProps(["x","y","x2","y2"],r),c=a-i,u=l-o,f=bo(c)+bo(u),p=f===0?-1:((e-i)*c+(n-o)*u)/f;let g,v;return p<0?(g=i,v=o):p>1?(g=a,v=l):(g=i+p*c,v=o+p*u),bo(e-g)+bo(n-v)<=s}function Ed(t,{mouseX:e,mouseY:n},s,r){const i=t.label;return i.options.display&&i.inRange(e,n,r,s)}function K$(t,e,n){const s=n.borderWidth,r=dn(n.padding),i=kc(t.ctx,n),o=i.width+r.width+s,a=i.height+r.height+s;return G$(e,n,{width:o,height:a,padding:r},t.chartArea)}function Y$(t){const{x:e,y:n,x2:s,y2:r}=t,i=Math.atan2(r-n,s-e);return i>ut/2?i-ut:i<ut/-2?i+ut:i}function G$(t,e,n,s){const{width:r,height:i,padding:o}=n,{xAdjust:a,yAdjust:l}=e,c={x:t.x,y:t.y},u={x:t.x2,y:t.y2},f=e.rotation==="auto"?Y$(t):Vt(e.rotation),p=X$(r,i,f),g=Q$(t,e,{labelSize:p,padding:o},s),v=t.cp?Id(c,t.cp,u,g):Df(c,u,g),w={size:p.w,min:s.left,max:s.right,padding:o.left},x={size:p.h,min:s.top,max:s.bottom,padding:o.top},k=Lm(v.x,w)+a,S=Lm(v.y,x)+l;return{x:k-r/2,y:S-i/2,x2:k+r/2,y2:S+i/2,centerX:k,centerY:S,pointX:v.x,pointY:v.y,width:r,height:i,rotation:Ev(f)}}function X$(t,e,n){const s=Math.cos(n),r=Math.sin(n);return{w:Math.abs(t*s)+Math.abs(e*r),h:Math.abs(t*r)+Math.abs(e*s)}}function Q$(t,e,n,s){let r;const i=J$(t,s);return e.position==="start"?r=Fm({w:t.x2-t.x,h:t.y2-t.y},n,e,i):e.position==="end"?r=1-Fm({w:t.x-t.x2,h:t.y-t.y2},n,e,i):r=If(1,e.position),r}function Fm(t,e,n,s){const{labelSize:r,padding:i}=e,o=t.w*s.dx,a=t.h*s.dy,l=o>0&&(r.w/2+i.left-s.x)/o,c=a>0&&(r.h/2+i.top-s.y)/a;return _c(Math.max(l,c),0,.25)}function J$(t,e){const{x:n,x2:s,y:r,y2:i}=t,o=Math.min(r,i)-e.top,a=Math.min(n,s)-e.left,l=e.bottom-Math.max(r,i),c=e.right-Math.max(n,s);return{x:Math.min(a,c),y:Math.min(o,l),dx:a<=c?1:-1,dy:o<=l?1:-1}}function Lm(t,e){const{size:n,min:s,max:r,padding:i}=e,o=n/2;return n>r-s?(r+s)/2:(s>=t-i-o&&(t=s+i+o),r<=t+i+o&&(t=r-i-o),t)}function m_(t){const e=t.options,n=e.arrowHeads&&e.arrowHeads.start,s=e.arrowHeads&&e.arrowHeads.end;return{startOpts:n,endOpts:s,startAdjust:Bm(t,n),endAdjust:Bm(t,s)}}function Bm(t,e){if(!e||!e.display)return 0;const{length:n,width:s}=e,r=t.options.borderWidth/2,i={x:n,y:s+r};return Math.abs(Ad(0,i,{x:0,y:r}))}function Md(t,e,n,s){if(!s||!s.display)return;const{length:r,width:i,fill:o,backgroundColor:a,borderColor:l}=s,c=Math.abs(e-r)+n;t.beginPath(),ji(t,s),Ms(t,s),t.moveTo(c,-i),t.lineTo(e+n,0),t.lineTo(c,i),o===!0?(t.fillStyle=a||l,t.closePath(),t.fill(),t.shadowColor="transparent"):t.shadowColor=s.borderShadowColor,t.stroke()}function Z$(t,e,n){const{x:s,y:r,x2:i,y2:o,centerX:a,centerY:l}=t,c=Math.atan2(o-r,i-s),u=Ef(e.controlPoint,0),f={x:a+or(n,u.x,!1),y:l+or(n,u.y,!1)};return Gr(f,{x:a,y:l},c)}function jm(t,{x:e,y:n},{angle:s,adjust:r},i){!i||!i.display||(t.save(),t.translate(e,n),t.rotate(s),Md(t,0,-r,i),t.restore())}function eF(t,e,n,s){const{x:r,y:i,x2:o,y2:a,options:l}=e,{startOpts:c,endOpts:u,startAdjust:f,endAdjust:p}=m_(e),g={x:r,y:i},v={x:o,y:a},w=Tm(g,n,v,0),x=Tm(g,n,v,1)-ut,k=Id(g,n,v,f/s),S=Id(g,n,v,1-p/s),E=new Path2D;t.beginPath(),E.moveTo(k.x,k.y),E.quadraticCurveTo(n.x,n.y,S.x,S.y),t.shadowColor=l.borderShadowColor,t.stroke(E),e.path=E,e.ctx=t,jm(t,k,{angle:w,adjust:f},c),jm(t,S,{angle:x,adjust:p},u)}class ga extends kn{inRange(e,n,s,r){const i=this.options.rotation,o=(this.options.borderWidth+this.options.hitTolerance)/2;if(s!=="x"&&s!=="y")return tF({x:e,y:n},this.getProps(["width","height","centerX","centerY"],r),i,o);const{x:a,y:l,x2:c,y2:u}=this.getProps(["x","y","x2","y2"],r),f=s==="y"?{start:l,end:u}:{start:a,end:c},p=Gr({x:e,y:n},this.getCenterPoint(r),Vt(-i));return p[s]>=f.start-o-Lr&&p[s]<=f.end+o+Lr}getCenterPoint(e){return Xr(this,e)}draw(e){const{width:n,height:s,centerX:r,centerY:i,options:o}=this;e.save(),xc(e,this.getCenterPoint(),o.rotation),ji(e,this.options),e.beginPath(),e.fillStyle=o.backgroundColor;const a=Ms(e,o);e.ellipse(r,i,s/2,n/2,ut/2,0,2*ut),e.fill(),a&&(e.shadowColor=o.borderShadowColor,e.stroke()),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return h_(e,n)}}ga.id="ellipseAnnotation";ga.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,label:Object.assign({},Ni.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};ga.defaultRoutes={borderColor:"color",backgroundColor:"color"};ga.descriptors={label:{_fallback:!0}};function tF(t,e,n,s){const{width:r,height:i,centerX:o,centerY:a}=e,l=r/2,c=i/2;if(l<=0||c<=0)return!1;const u=Vt(n||0),f=Math.cos(u),p=Math.sin(u),g=Math.pow(f*(t.x-o)+p*(t.y-a),2),v=Math.pow(p*(t.x-o)-f*(t.y-a),2);return g/Math.pow(l+s,2)+v/Math.pow(c+s,2)<=1.0001}class Sc extends kn{inRange(e,n,s,r){const{x:i,y:o,x2:a,y2:l,width:c}=this.getProps(["x","y","x2","y2","width"],r),u=(this.options.borderWidth+this.options.hitTolerance)/2;return s!=="x"&&s!=="y"?G2({x:e,y:n},this.getCenterPoint(r),c/2,u):Gb(s==="y"?{start:o,end:l,value:n}:{start:i,end:a,value:e},u)}getCenterPoint(e){return Xr(this,e)}draw(e){const n=this.options,s=n.borderWidth;if(n.radius<.1)return;e.save(),e.fillStyle=n.backgroundColor,ji(e,n);const r=Ms(e,n);s$(e,this,this.centerX,this.centerY),r&&!wc(n.pointStyle)&&(e.shadowColor=n.borderShadowColor,e.stroke()),e.restore(),n.borderWidth=s}resolveElementProperties(e,n){const s=f_(e,n);return s.initProperties=Bi(e,s,n),s}}Sc.id="pointAnnotation";Sc.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};Sc.defaultRoutes={borderColor:"color",backgroundColor:"color"};class Pc extends kn{inRange(e,n,s,r){if(s!=="x"&&s!=="y")return this.options.radius>=.1&&this.elements.length>1&&sF(this.elements,e,n,r);const i=Gr({x:e,y:n},this.getCenterPoint(r),Vt(-this.options.rotation)),o=this.elements.map(c=>s==="y"?c.bY:c.bX),a=Math.min(...o),l=Math.max(...o);return i[s]>=a&&i[s]<=l}getCenterPoint(e){return Xr(this,e)}draw(e){const{elements:n,options:s}=this;e.save(),e.beginPath(),e.fillStyle=s.backgroundColor,ji(e,s);const r=Ms(e,s);let i=!0;for(const o of n)i?(e.moveTo(o.x,o.y),i=!1):e.lineTo(o.x,o.y);e.closePath(),e.fill(),r&&(e.shadowColor=s.borderShadowColor,e.stroke()),e.restore()}resolveElementProperties(e,n){const s=f_(e,n),{sides:r,rotation:i}=n,o=[],a=2*ut/r;let l=i*af;for(let c=0;c<r;c++,l+=a){const u=nF(s,n,l);u.initProperties=Bi(e,s,n),o.push(u)}return s.elements=o,s}}Pc.id="polygonAnnotation";Pc.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};Pc.defaultRoutes={borderColor:"color",backgroundColor:"color"};function nF({centerX:t,centerY:e},{radius:n,borderWidth:s,hitTolerance:r},i){const o=(s+r)/2,a=Math.sin(i),l=Math.cos(i),c={x:t+a*n,y:e-l*n};return{type:"point",optionScope:"point",properties:{x:c.x,y:c.y,centerX:c.x,centerY:c.y,bX:t+a*(n+o),bY:e-l*(n+o)}}}function sF(t,e,n,s){let r=!1,i=t[t.length-1].getProps(["bX","bY"],s);for(const o of t){const a=o.getProps(["bX","bY"],s);a.bY>n!=i.bY>n&&e<(i.bX-a.bX)*(n-a.bY)/(i.bY-a.bY)+a.bX&&(r=!r),i=a}return r}const sr={box:Ni,doughnutLabel:Cc,ellipse:ga,label:ha,line:pa,point:Sc,polygon:Pc};Object.keys(sr).forEach(t=>{Dt.describe(`elements.${sr[t].id}`,{_fallback:"plugins.annotation.common"})});const rF={update:Object.assign},iF=Of.concat(Kl),Nm=(t,e)=>Ze(e)?Dd(t,e):t,Od=t=>t==="color"||t==="font";function Tf(t="line"){return sr[t]?t:(console.warn(`Unknown annotation type: '${t}', defaulting to 'line'`),"line")}function oF(t,e,n,s){const r=lF(t,n.animations,s),i=e.annotations,o=dF(e.elements,i);for(let a=0;a<i.length;a++){const l=i[a],c=y_(o,a,l.type),u=l.setContext(uF(t,c,o,l)),f=c.resolveElementProperties(t,u);f.skip=aF(f),"elements"in f&&(cF(c,f.elements,u,r),delete f.elements),Dn(c.x)||Object.assign(c,f),Object.assign(c,f.initProperties),f.options=v_(u),r.update(c,f)}}function aF(t){return isNaN(t.x)||isNaN(t.y)}function lF(t,e,n){return n==="reset"||n==="none"||n==="resize"?rF:new yf(t,e)}function cF(t,e,n,s){const r=t.elements||(t.elements=[]);r.length=e.length;for(let i=0;i<e.length;i++){const o=e[i],a=o.properties,l=y_(r,i,o.type,o.initProperties),c=n[o.optionScope].override(o);a.options=v_(c),s.update(l,a)}}function y_(t,e,n,s){const r=sr[Tf(n)];let i=t[e];return(!i||!(i instanceof r))&&(i=t[e]=new r,Object.assign(i,s)),i}function v_(t){const e=sr[Tf(t.type)],n={};n.id=t.id,n.type=t.type,n.drawTime=t.drawTime,Object.assign(n,Dd(t,e.defaults),Dd(t,e.defaultRoutes));for(const s of iF)n[s]=t[s];return n}function Dd(t,e){const n={};for(const s of Object.keys(e)){const r=e[s],i=t[s];Od(s)&&Ct(i)?n[s]=i.map(o=>Nm(o,r)):n[s]=Nm(i,r)}return n}function uF(t,e,n,s){return e.$context||(e.$context=Object.assign(Object.create(t.getContext()),{element:e,get elements(){return n.filter(r=>r&&r.options)},id:s.id,type:"annotation"}))}function dF(t,e){const n=e.length,s=t.length;if(s<n){const r=n-s;t.splice(s,0,...new Array(r))}else s>n&&t.splice(n,s-n);return t}var fF="3.1.0";const Vs=new Map,zm=t=>t.type!=="doughnutLabel",hF=Of.concat(Kl);var pF={id:"annotation",version:fF,beforeRegister(){X2("chart.js","4.0",tr.version)},afterRegister(){tr.register(sr)},afterUnregister(){tr.unregister(sr)},beforeInit(t){Vs.set(t,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(t,e,n){const s=Vs.get(t),r=s.annotations=[];let i=n.annotations;Ze(i)?Object.keys(i).forEach(o=>{const a=i[o];Ze(a)&&(a.id=o,r.push(a))}):Ct(i)&&r.push(...i),M$(r.filter(zm),t.scales)},afterDataLimits(t,e){const n=Vs.get(t);E$(t,e.scale,n.annotations.filter(zm).filter(s=>s.display&&s.adjustScaleRange))},afterUpdate(t,e,n){const s=Vs.get(t);C$(t,s,n),oF(t,s,n,e.mode),s.visibleElements=s.elements.filter(r=>!r.skip&&r.options.display),I$(t,s,n)},beforeDatasetsDraw(t,e,n){fo(t,"beforeDatasetsDraw",n.clip)},afterDatasetsDraw(t,e,n){fo(t,"afterDatasetsDraw",n.clip)},beforeDatasetDraw(t,e,n){fo(t,e.index,n.clip)},beforeDraw(t,e,n){fo(t,"beforeDraw",n.clip)},afterDraw(t,e,n){fo(t,"afterDraw",n.clip)},beforeEvent(t,e,n){const s=Vs.get(t);S$(s,e.event,n)&&(e.changed=!0)},afterDestroy(t){Vs.delete(t)},getAnnotations(t){const e=Vs.get(t);return e?e.elements:[]},_getAnnotationElementsAtEventForMode(t,e,n){return Af(t,e,n)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"},colors:{properties:["backgroundColor","borderColor"],type:"color"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:t=>!hF.includes(t)&&t!=="init",annotations:{_allKeys:!1,_fallback:(t,e)=>`elements.${sr[Tf(e.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:Od,_fallback:!0},_indexable:Od}},additionalOptionScopes:[""]};function fo(t,e,n){const{ctx:s,chartArea:r}=t,i=Vs.get(t);n&&aa(s,r);const o=gF(i.visibleElements,e).sort((a,l)=>a.element.options.z-l.element.options.z);for(const a of o)mF(s,r,i,a);n&&la(s)}function gF(t,e){const n=[];for(const s of t)if(s.options.drawTime===e&&n.push({element:s,main:!0}),s.elements&&s.elements.length)for(const r of s.elements)r.options.display&&r.options.drawTime===e&&n.push({element:r});return n}function mF(t,e,n,s){const r=s.element;s.main?(Am(n,r,"beforeDraw"),r.draw(t,e),Am(n,r,"afterDraw")):r.draw(t,e)}const yF={style:{height:"200px"}},vF=et({__name:"PriceHistoryChart",props:{pricePoints:{},transactions:{}},setup(t){tr.register(pb,gb,ib,ca,db,hb,cb,pF);const e=t,n={"mtgjson.cardmarket":3,"cardmarket.priceguide":2,scryfall:1},s=We(()=>{const o=g=>{try{return new Date(g).toISOString().slice(0,10)}catch{return}},a={nonfoil:{},foil:{}};for(const g of e.pricePoints??[]){const v=g.finish||"nonfoil";if(v==="etched")continue;const w=g.date??(g.asOf?o(g.asOf):void 0);if(!w)continue;const x=n[g.provider??""]??0,k=g.asOf?new Date(g.asOf).getTime():0,S=(g.priceCent??0)/100,E=a[v],D=E[w];(!D||x>D.rank||x===D.rank&&k>D.asOfTs)&&(E[w]={value:S,rank:x,asOfTs:k})}const l=new Set([...Object.keys(a.nonfoil),...Object.keys(a.foil)]),c=Array.from(l).sort((g,v)=>g.localeCompare(v)),u=c.map(g=>a.nonfoil[g]?.value??null),f=c.map(g=>a.foil[g]?.value??null);return{labels:c.map(g=>new Date(g).toLocaleDateString()),nonfoil:u,foil:f}}),r=We(()=>({labels:s.value.labels,datasets:[{label:"Regular",backgroundColor:"rgba(13,110,253,0.15)",borderColor:"#0d6efd",pointRadius:0,data:s.value.nonfoil,fill:!1,tension:.2},{label:"Foil",backgroundColor:"rgba(32,201,151,0.15)",borderColor:"#20c997",pointRadius:0,data:s.value.foil,fill:!1,tension:.2}]})),i=We(()=>{const o=(e.transactions??[]).map(a=>({type:"line",yMin:new Be(a.unitPrice,a.currency).getDecimal(),yMax:new Be(a.unitPrice,a.currency).getDecimal(),borderColor:/buy/i.test(a.kind)?"green":"red",borderWidth:2,borderDash:[5,5],label:{content:`${a.kind} @ ${new Be(a.unitPrice,a.currency).format("de-DE")}`,enabled:!1}}));return{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},scales:{y:{ticks:{callback(a){return typeof a=="number"?new Be(a*100,"EUR").format("de-DE"):a}}},x:{ticks:{maxRotation:0,autoSkip:!0}}},plugins:{legend:{display:!0},tooltip:{callbacks:{label(a){const l=a.parsed.y;return`${a.dataset.label}: ${new Be(Math.round((l??0)*100),"EUR").format("de-DE")}`}}},annotation:{annotations:o}},elements:{line:{spanGaps:!0}}}});return(o,a)=>(j(),W("div",null,[b("div",yF,[ze($e(bb),{data:r.value,options:i.value},null,8,["data","options"])])]))}}),bF={class:"card-image-container position-relative overflow-hidden rounded",style:{"padding-bottom":"140%"}},_F={key:1,class:"placeholder-image card-img-top position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"},wF={class:"card-body"},xF={class:"card-title fs-6 fw-medium mb-1"},kF={class:"card-text small text-muted mb-2"},CF={class:"ms-auto"},SF={key:0,class:"badge rounded-pill bg-primary-subtle text-primary-emphasis"},PF={key:1,class:"badge rounded-pill bg-success-subtle text-success-emphasis"},AF={key:2,class:"small text-muted fst-italic"},IF={key:3,class:"small text-muted fst-italic"},EF={class:"modal-dialog modal-dialog-centered modal-lg"},MF={class:"modal-content glass"},OF={class:"modal-header py-2"},DF={class:"modal-body py-3"},TF={class:"row g-3 align-items-start"},RF={class:"col-lg-5"},$F={class:"card-inner",style:{"padding-bottom":"140%"}},FF={class:"card-front"},LF={key:1,class:"placeholder-image w-100 h-100 rounded-4 position-relative"},BF={class:"card-back"},jF=["src"],NF={class:"row row-cols-2 g-2 small mt-3 mb-0 meta-grid"},zF={class:"col text-end fw-semibold"},qF={class:"col text-end fw-semibold"},UF={class:"col text-end fw-semibold"},WF={class:"col text-end fw-semibold"},VF={class:"col text-end"},HF=["href"],KF=["href"],YF={key:1,class:"text-muted"},GF={class:"col-lg-7"},XF={class:"d-flex justify-content-between align-items-center mb-3"},QF={class:"ms-auto d-flex gap-2 align-items-center"},JF={key:0,class:"badge rounded-pill bg-primary-subtle text-primary-emphasis"},ZF={key:1,class:"badge rounded-pill bg-success-subtle text-success-emphasis"},eL={key:2,class:"small text-muted fst-italic"},tL={key:3,class:"small text-muted fst-italic"},nL={key:0,class:"mb-3"},sL={key:1,class:"mb-3"},rL={class:"d-flex gap-3 small"},iL={class:"mt-2 border rounded-3 p-2 small",style:{"max-height":"30vh",overflow:"auto"}},oL={class:"row g-2 align-items-center"},aL={class:"col-6 col-md-3"},lL={class:"fw-medium"},cL={class:"col-6 col-md-3"},uL={class:"fw-medium"},dL={class:"col-6 col-md-3"},fL={class:"fw-medium"},hL={key:0,class:"col-6 col-md-3"},pL={class:"fw-medium"},gL={key:2},mL={class:"mt-2 small",style:{"max-height":"30vh",overflow:"auto"}},yL={class:"flex-grow-1"},vL={class:"fw-medium"},bL={class:"text-muted"},_L={class:"fw-semibold"},wL=et({inheritAttrs:!0,__name:"CardComponent",props:{card:{},disableModal:{type:Boolean}},setup(t){const e=tf(),n=We(()=>e.getLatestNonfoil(r.card.id)),s=We(()=>e.getLatestFoil(r.card.id)),r=t,i=fe(!1),o=We(()=>e.loadingPrices),a=fe([]),l=fe([]),c=fe([]),u=fe(!1),f=fe(!1),p=We(()=>l.value?[...l.value].sort((P,A)=>new Date(A.happenedAt).getTime()-new Date(P.happenedAt).getTime()):[]),g=We(()=>!a.value||a.value.length===0?0:a.value.reduce((P,A)=>{if(!A.disposedAt||A.disposedQuantity&&A.disposedQuantity<A.quantity){const $=A.disposedQuantity?A.quantity-A.disposedQuantity:A.quantity;return P+$}return P},0)),v=async()=>{i.value=!0,await E(),c.value=await e.getPriceHistory(r.card.id)},w=()=>{i.value=!1},x=P=>new Date(P).toLocaleDateString(),k=(P,A)=>new Be(P,A).format("de-DE"),S=P=>{P.target===P.currentTarget&&w()},E=async()=>{try{a.value=await kt.getByCardId(r.card.id),l.value=await Jt.getByCardId(r.card.id)}catch(P){console.error("Error loading card details:",P)}},D=P=>P.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),T=P=>P.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");return(P,A)=>(j(),W(Qe,null,[b("div",{class:"card h-100 card-item",onClick:A[0]||(A[0]=$=>!r.disableModal&&v())},[b("div",bF,[P.card.imageUrl?(j(),W("div",{key:0,class:"card-img-top position-absolute top-0 start-0 w-100 h-100",style:En({backgroundImage:`url(${P.card.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4)):(j(),W("div",_F,[...A[4]||(A[4]=[b("span",{class:"text-muted"},"Missing Image",-1)])]))]),b("div",wF,[b("h3",xF,te(P.card.name),1),b("p",kF,te(P.card.set)+" #"+te(P.card.number),1),b("div",CF,[n.value?(j(),W("span",SF," Regular: "+te(n.value.format("de-DE")),1)):ve("",!0),s.value?(j(),W("span",PF," Foil: "+te(s.value.format("de-DE")),1)):ve("",!0),!n.value&&!s.value&&o.value?(j(),W("span",AF," Loading… ")):!n.value&&!s.value?(j(),W("span",IF," Price unavailable ")):ve("",!0)])])]),ze($e(l2),{open:i.value,"onUpdate:open":A[3]||(A[3]=$=>i.value=$)},{default:rt(()=>[ze($e(z2),null,{default:rt(()=>[ze($e(L2),{class:"modal-backdrop fade show"}),ze($e(T2),{class:"modal d-block compact-modal",onClick:S,onEscapeKeyDown:w},{default:rt(()=>[b("div",EF,[b("div",MF,[b("div",OF,[ze($e(U2),{class:"modal-title h5 mb-0"},{default:rt(()=>[yt(te(P.card.name),1)]),_:1}),ze($e(u2),{"as-child":""},{default:rt(()=>[...A[5]||(A[5]=[b("button",{type:"button",class:"btn-close","aria-label":"Close"},null,-1)])]),_:1})]),b("div",DF,[b("div",TF,[b("div",RF,[b("div",{class:At(["card-flipper position-relative",{"is-flipped":u.value}])},[b("div",$F,[b("div",FF,[P.card.imageUrl?(j(),W("div",{key:0,class:"w-100 h-100 rounded-4",style:En({backgroundImage:`url(${P.card.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4)):(j(),W("div",LF,[...A[6]||(A[6]=[b("div",{class:"position-absolute top-50 start-50 translate-middle"},[b("span",{class:"text-muted"},"Missing Image")],-1)])]))]),b("div",BF,[P.card.imageUrlBack?(j(),W("div",{key:0,class:"w-100 h-100 rounded-4",style:En({backgroundImage:`url(${P.card.imageUrlBack})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4)):ve("",!0)])]),P.card.layout==="transform"||P.card.layout==="modal_dfc"||P.card.layout==="reversible_card"||P.card.imageUrl&&P.card.imageUrlBack?(j(),W("button",{key:0,onClick:A[1]||(A[1]=$=>u.value=!u.value),class:"btn btn-sm btn-dark flip-button"}," Flip ")):ve("",!0)],2),b("img",{src:P.card.imageUrlBack,style:{display:"none"}},null,8,jF),b("dl",NF,[A[7]||(A[7]=b("dt",{class:"col text-muted"},"Set",-1)),b("dd",zF,te(P.card.set)+" ("+te(P.card.setCode)+")",1),A[8]||(A[8]=b("dt",{class:"col text-muted"},"Number",-1)),b("dd",qF,"#"+te(P.card.number),1),A[9]||(A[9]=b("dt",{class:"col text-muted"},"Language",-1)),b("dd",UF,te(P.card.lang),1),A[10]||(A[10]=b("dt",{class:"col text-muted"},"Finish",-1)),b("dd",WF,te(P.card.finish),1),A[11]||(A[11]=b("dt",{class:"col text-muted"},"Links",-1)),b("dd",VF,[b("a",{href:`https://scryfall.com/card/${P.card.setCode}/${P.card.number}`,target:"_blank",rel:"noopener noreferrer",class:"link-primary text-decoration-none me-2"}," Scryfall ",8,HF),P.card.cardmarketId?(j(),W("a",{key:0,href:`https://www.cardmarket.com/en/Magic/Products/Singles/${D(P.card.set)}/${T(P.card.name)}?language=1&minCondition=4`,target:"_blank",rel:"noopener noreferrer",class:"link-warning text-decoration-none"}," Cardmarket ",8,KF)):(j(),W("span",YF,"Cardmarket ID missing"))])])]),b("div",GF,[b("div",XF,[A[12]||(A[12]=b("h3",{class:"h6 mb-0"},"Current Price",-1)),b("div",QF,[n.value?(j(),W("span",JF," Regular: "+te(n.value.format("de-DE")),1)):ve("",!0),s.value?(j(),W("span",ZF," Foil: "+te(s.value.format("de-DE")),1)):ve("",!0),!n.value&&!s.value&&o.value?(j(),W("span",eL," Loading… ")):!n.value&&!s.value?(j(),W("span",tL," Price unavailable ")):ve("",!0)])]),c.value&&c.value.length>0?(j(),W("div",nL,[A[13]||(A[13]=b("h3",{class:"h6 mb-2"},"Price History",-1)),ze(vF,{"price-points":c.value,transactions:l.value},null,8,["price-points","transactions"])])):ve("",!0),a.value&&a.value.length?(j(),W("div",sL,[A[23]||(A[23]=b("h3",{class:"h6 mb-2"},"Your Collection",-1)),b("div",rL,[b("div",null,[A[14]||(A[14]=b("span",{class:"text-muted"},"Lots:",-1)),A[15]||(A[15]=yt()),b("strong",null,te(a.value.length),1)]),b("div",null,[A[16]||(A[16]=b("span",{class:"text-muted"},"Cards:",-1)),A[17]||(A[17]=yt()),b("strong",null,te(g.value),1)])]),a.value.length>2?(j(),W("button",{key:0,class:"btn btn-link btn-sm p-0 mt-1",onClick:A[2]||(A[2]=$=>f.value=!f.value)},te(f.value?"Hide details":"Show details"),1)):ve("",!0),Zs(b("div",iL,[(j(!0),W(Qe,null,It(a.value,$=>(j(),W("div",{key:$.id,class:"border rounded p-2 mb-2"},[b("div",oL,[b("div",aL,[A[18]||(A[18]=b("span",{class:"text-muted"},"Qty:",-1)),A[19]||(A[19]=yt()),b("span",lL,te($.quantity),1)]),b("div",cL,[A[20]||(A[20]=b("span",{class:"text-muted"},"Unit Cost:",-1)),b("span",uL,te(k($.unitCost,$.currency||"EUR")),1)]),b("div",dL,[A[21]||(A[21]=b("span",{class:"text-muted"},"Purchased:",-1)),b("span",fL,te(x($.purchasedAt)),1)]),$.disposedQuantity?(j(),W("div",hL,[A[22]||(A[22]=b("span",{class:"text-muted"},"Disposed:",-1)),b("span",pL,te($.disposedQuantity),1)])):ve("",!0)])]))),128))],512),[[Gw,f.value]])])):ve("",!0),l.value&&l.value.length?(j(),W("div",gL,[A[24]||(A[24]=b("h3",{class:"h6 mb-2"},"Transaction History",-1)),b("div",mL,[(j(!0),W(Qe,null,It(p.value,$=>(j(),W("div",{key:$.id,class:At(["tx-item d-flex align-items-center gap-2 p-2 mb-2 rounded border",{buy:/buy/i.test($.kind),sell:/sell/i.test($.kind)}])},[b("span",{class:At(["badge me-1",/buy/i.test($.kind)?"bg-success-subtle text-success-emphasis":"bg-danger-subtle text-danger-emphasis"])},te($.kind),3),b("div",yL,[b("div",vL,te(x($.happenedAt)),1),b("div",bL,"Qty: "+te($.quantity),1)]),b("div",_L,te(k($.unitPrice,$.currency)),1)],2))),128))])])):ve("",!0)])])])])])]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),b_=fn(wL,[["__scopeId","data-v-f31e99ea"]]),xL={class:"container py-4"},kL={key:0,class:"text-center py-5"},CL={key:1,class:"text-center py-5"},SL={key:2},PL={class:"d-flex align-items-center justify-content-between mb-3"},AL={class:"d-flex gap-2"},IL={class:"card shadow-sm mb-4"},EL={class:"card-body"},ML={class:"d-flex align-items-start justify-content-between"},OL={class:"w-100"},DL={key:1,class:"d-flex align-items-center flex-nowrap gap-2"},TL={class:"input-group input-group-lg w-auto",style:{"max-width":"480px"}},RL={class:"d-flex flex-wrap align-items-center gap-2 mt-2"},$L={key:0,class:"badge text-uppercase bg-info text-dark"},FL={class:"text-muted"},LL={key:1,class:"text-success d-inline-flex align-items-center"},BL={key:0,class:"alert alert-warning mt-3 py-2 mb-0"},jL={key:0,class:"text-center py-5 text-muted"},NL={key:1,class:"row row-cols-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 row-cols-xxl-6 g-3"},zL=["onClick"],qL={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success",title:"Face card"},UL={class:"modal-dialog"},WL={class:"modal-content"},VL={class:"modal-body"},HL={class:"mb-0"},KL={class:"modal-footer"},YL=["disabled"],GL=["disabled"],XL={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},QL={key:4,class:"modal-backdrop fade show"},JL="https://placehold.co/200x280?text=Card+Image",ZL=et({__name:"DeckDetailView",setup(t){const e=ef(),n=yv(),s=fe(null),r=fe([]),i=fe({}),o=fe(!0),a=fe(!1),l=fe(""),c=fe(null),u=fe(!1),f=fe(!1),p=fe(!1),g=We(()=>s.value?.faceCardId?w(s.value.faceCardId):null),v=U=>U?new Date(U).toLocaleDateString():"—",w=U=>i.value[U]||{id:U,name:"Unknown Card",set:"Unknown Set",setCode:"???",number:"???",lang:"en",finish:"nonfoil",imageUrl:JL},x=()=>{s.value&&(a.value=!0,l.value=s.value.name,un(()=>{c.value?.focus(),c.value?.select()}))},k=async()=>{if(!s.value){a.value=!1;return}const U=l.value.trim();if(!U||U===s.value.name){a.value=!1;return}try{await ge().decks.update(s.value.id,{name:U}),s.value.name=U}catch(z){console.error("Error updating deck title:",z),alert("Failed to update deck title. Please try again.")}finally{a.value=!1}},S=()=>{a.value=!1,l.value=s.value?.name??""},E=()=>{u.value=!u.value},D=async U=>{await T(U),u.value=!1},T=async U=>{if(s.value)try{await ge().decks.update(s.value.id,{faceCardId:U}),s.value.faceCardId=U}catch(z){console.error("Error updating face card:",z),alert("Failed to update face card. Please try again.")}},P=async()=>{if(s.value)try{await ge().decks.update(s.value.id,{faceCardId:void 0}),s.value.faceCardId=void 0}catch(U){console.error("Error clearing face card:",U),alert("Failed to clear face card. Please try again.")}},A=()=>{f.value=!0},$=()=>{p.value||(f.value=!1)},I=async()=>{if(!(!s.value||p.value)){p.value=!0;try{const U=ge();await U.deck_cards.where("deckId").equals(s.value.id).delete(),await U.decks.delete(s.value.id),$(),n.push("/decks")}catch(U){console.error("Error deleting deck:",U),alert("Failed to delete deck. Please try again.")}finally{p.value=!1}}};return Tn(async()=>{try{const U=e.params.id,z=ge(),pe=await z.decks.get(U);if(!pe)return;s.value=pe,l.value=pe.name;const ye=await z.deck_cards.where("deckId").equals(U).toArray();r.value=ye;const ue=ye.map(_e=>_e.cardId).filter(Boolean);if(ue.length){const _e=await z.cards.where("id").anyOf(ue).toArray();i.value=Object.fromEntries(_e.map(ke=>[ke.id,ke]))}}catch(U){console.error("Error loading deck:",U)}finally{o.value=!1}}),(U,z)=>{const pe=Si("router-link");return j(),W("div",xL,[o.value?(j(),W("div",kL,[...z[1]||(z[1]=[b("div",{class:"spinner-border",role:"status","aria-hidden":"true"},null,-1),b("div",{class:"mt-2"},"Loading deck…",-1)])])):s.value?(j(),W("div",SL,[b("div",PL,[ze(pe,{to:"/decks",class:"btn btn-link px-0"},{default:rt(()=>[...z[4]||(z[4]=[yt(" ← Back to Decks ",-1)])]),_:1}),b("div",AL,[b("button",{onClick:E,class:At(["btn",u.value?"btn-glass-warning":"btn-glass-primary"])},te(u.value?"Cancel Select Mode":"Select Face Card"),3),s.value.faceCardId?(j(),W("button",{key:0,onClick:P,class:"btn btn-glass-secondary"}," Remove Face Card ")):ve("",!0),b("button",{onClick:A,class:"btn btn-glass-danger"}," Delete Deck ")])]),b("div",IL,[b("div",EL,[b("div",ML,[b("div",OL,[a.value?(j(),W("div",DL,[b("div",TL,[Zs(b("input",{ref_key:"titleInput",ref:c,"onUpdate:modelValue":z[0]||(z[0]=ye=>l.value=ye),onKeyup:[Qh(k,["enter"]),Qh(S,["esc"])],type:"text",class:"form-control",placeholder:"Deck title"},null,544),[[Wo,l.value]]),b("button",{onClick:k,class:"btn btn-glass-primary"},"Save"),b("button",{onClick:S,class:"btn btn-outline-secondary"},"Cancel")])])):(j(),W("h1",{key:0,onClick:x,class:"h3 mb-2 editable",title:"Click to edit title"},[yt(te(s.value.name)+" ",1),z[5]||(z[5]=b("span",{class:"ms-2 small text-muted"},"✏️",-1))])),b("div",RL,[s.value.platform?(j(),W("span",$L,te(s.value.platform),1)):ve("",!0),b("small",FL,"Imported: "+te(v(s.value.importedAt)),1),g.value?(j(),W("small",LL,[...z[6]||(z[6]=[b("span",{class:"me-1"},"★",-1),yt(" Face card set ",-1)])])):ve("",!0)])])]),u.value?(j(),W("div",BL," Select mode is active — click a card below to set it as the face card. ")):ve("",!0)])]),b("div",null,[z[8]||(z[8]=b("h2",{class:"h5 mb-3"},"Cards in Deck",-1)),r.value.length===0?(j(),W("div",jL," No cards found in this deck. ")):(j(),W("div",NL,[(j(!0),W(Qe,null,It(r.value,ye=>(j(),W("div",{key:ye.id,class:"col"},[b("div",{class:At(["position-relative h-100",{"border border-success rounded":ye.cardId===s.value.faceCardId,"cursor-pointer":u.value}]),role:"button",onClick:ue=>u.value?D(ye.cardId):null},[ze(b_,{card:w(ye.cardId),"disable-modal":u.value},null,8,["card","disable-modal"]),ye.cardId===s.value.faceCardId?(j(),W("span",qL,[...z[7]||(z[7]=[yt(" ★ ",-1),b("span",{class:"visually-hidden"},"Face card",-1)])])):ve("",!0)],10,zL)]))),128))]))])])):(j(),W("div",CL,[z[3]||(z[3]=b("p",{class:"mb-3"},"Deck not found.",-1)),ze(pe,{to:"/decks",class:"btn btn-outline-secondary"},{default:rt(()=>[...z[2]||(z[2]=[yt("← Back to Decks",-1)])]),_:1})])),f.value?(j(),W("div",{key:3,class:"modal fade show",tabindex:"-1",style:{display:"block"},"aria-modal":"true",role:"dialog","aria-labelledby":"deleteDeckLabel",onClick:ml($,["self"])},[b("div",UL,[b("div",WL,[b("div",{class:"modal-header"},[z[9]||(z[9]=b("h5",{id:"deleteDeckLabel",class:"modal-title"},"Delete this deck?",-1)),b("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:$})]),b("div",VL,[b("p",HL,[z[10]||(z[10]=yt(" You’re about to delete ",-1)),b("strong",null,te(s.value?.name),1),z[11]||(z[11]=yt(". This action cannot be undone. ",-1))])]),b("div",KL,[b("button",{class:"btn btn-outline-secondary",disabled:p.value,onClick:$}," Cancel ",8,YL),b("button",{class:"btn btn-danger",disabled:p.value,onClick:I},[p.value?(j(),W("span",XL)):ve("",!0),z[12]||(z[12]=yt(" Delete ",-1))],8,GL)])])])])):ve("",!0),f.value?(j(),W("div",QL)):ve("",!0)])}}}),eB=fn(ZL,[["__scopeId","data-v-384c03ec"]]),tB={key:0,class:"pagination-controls"},nB={class:"pagination justify-content-center"},sB=["onClick"],rB={class:"pagination-info text-center mt-2"},iB=et({__name:"PaginationComponent",props:{currentPage:{},totalItems:{},itemsPerPage:{},maxVisiblePages:{}},emits:["update:currentPage"],setup(t,{emit:e}){const n=t,s=e,r=We(()=>Math.ceil(n.totalItems/n.itemsPerPage)),i=We(()=>n.maxVisiblePages||5),o=We(()=>{const u=[],f=Math.floor(i.value/2);let p=Math.max(1,n.currentPage-f),g=Math.min(r.value,p+i.value-1);g-p+1<i.value&&(p=Math.max(1,g-i.value+1));for(let v=p;v<=g;v++)u.push(v);return u}),a=We(()=>(n.currentPage-1)*n.itemsPerPage),l=We(()=>n.currentPage*n.itemsPerPage),c=u=>{u>=1&&u<=r.value&&u!==n.currentPage&&s("update:currentPage",u)};return(u,f)=>r.value>1?(j(),W("nav",tB,[b("ul",nB,[b("li",{class:At(["page-item",{disabled:u.currentPage===1}])},[b("a",{class:"page-link",href:"#",onClick:f[0]||(f[0]=ml(p=>c(u.currentPage-1),["prevent"]))},"Previous")],2),(j(!0),W(Qe,null,It(o.value,p=>(j(),W("li",{key:p,class:At(["page-item",{active:p===u.currentPage}])},[b("a",{class:"page-link",href:"#",onClick:ml(g=>c(p),["prevent"])},te(p),9,sB)],2))),128)),b("li",{class:At(["page-item",{disabled:u.currentPage===r.value}])},[b("a",{class:"page-link",href:"#",onClick:f[1]||(f[1]=ml(p=>c(u.currentPage+1),["prevent"]))},"Next")],2)]),b("div",rB," Showing "+te(a.value+1)+"-"+te(Math.min(l.value,u.totalItems))+" of "+te(u.totalItems)+" items ",1)])):ve("",!0)}}),oB=fn(iB,[["__scopeId","data-v-7b87ee6f"]]),aB={class:"cards-view"},lB={class:"header"},cB={class:"controls"},uB={class:"search-box"},dB={class:"sort-controls"},fB={class:"page-size-controls"},hB={key:0,class:"loading"},pB={key:1,class:"empty-state"},gB={key:0},mB={key:1},yB={key:2},vB={class:"row g-4"},bB=et({__name:"CardsView",setup(t){const e=tf(),n=ef(),s=yv(),r=fe(""),i=fe("name"),o=fe("asc"),a=fe(parseInt(n.query.page)||1),l=fe(parseInt(n.query.itemsPerPage)||24);Kt(()=>n.query,g=>{a.value=parseInt(g.page)||1,l.value=parseInt(g.itemsPerPage)||24}),Kt([a,l],()=>{const g={};a.value!==1&&(g.page=a.value.toString()),l.value!==24&&(g.itemsPerPage=l.value.toString()),r.value&&(g.search=r.value),i.value!=="name"&&(g.sortBy=i.value),o.value!=="asc"&&(g.sortDirection=o.value),s.replace({query:g})});const c=We(()=>{const g=e.getAllCards;if(!r.value)return g;const v=r.value.toLowerCase();return g.filter(w=>w.name.toLowerCase().includes(v)||w.set.toLowerCase().includes(v)||w.number.includes(v))}),u=We(()=>{const g=[...c.value];return g.sort((v,w)=>{let x=0;switch(i.value){case"name":x=v.name.localeCompare(w.name);break;case"set":x=v.set.localeCompare(w.set);break;case"price":{const k=e.getCardPrice(v.id)?.getCents()??0,S=e.getCardPrice(w.id)?.getCents()??0;x=k-S}break;case"owned":x=0;break;default:x=v.name.localeCompare(w.name)}return o.value==="asc"?x:-x}),g}),f=We(()=>{const g=(a.value-1)*l.value,v=g+l.value;return u.value.slice(g,v)}),p=g=>{a.value=g,window.scrollTo({top:0,behavior:"smooth"})};return Tn(()=>{n.query.search&&(r.value=n.query.search),n.query.sortBy&&(i.value=n.query.sortBy),n.query.sortDirection&&(o.value=n.query.sortDirection),e.loadCards(),setTimeout(()=>{e.loadCardPrices()},0)}),(g,v)=>(j(),W("div",aB,[b("div",lB,[b("div",cB,[b("div",uB,[Zs(b("input",{"onUpdate:modelValue":v[0]||(v[0]=w=>r.value=w),type:"text",placeholder:"Search cards...",class:"form-control"},null,512),[[Wo,r.value]])]),b("div",dB,[Zs(b("select",{"onUpdate:modelValue":v[1]||(v[1]=w=>i.value=w),class:"form-select"},[...v[4]||(v[4]=[b("option",{value:"name"},"Name",-1),b("option",{value:"set"},"Set",-1),b("option",{value:"price"},"Price",-1),b("option",{value:"owned"},"Owned Quantity",-1)])],512),[[Gh,i.value]]),b("button",{onClick:v[2]||(v[2]=w=>o.value=o.value==="asc"?"desc":"asc"),class:"btn btn-glass-primary"},te(o.value==="asc"?"↑":"↓"),1)]),b("div",fB,[v[6]||(v[6]=b("label",{for:"itemsPerPage",class:"form-label me-2"},"Items per page:",-1)),Zs(b("select",{id:"itemsPerPage","onUpdate:modelValue":v[3]||(v[3]=w=>l.value=w),class:"form-select",style:{width:"auto"}},[...v[5]||(v[5]=[b("option",{value:12},"12",-1),b("option",{value:24},"24",-1),b("option",{value:48},"48",-1),b("option",{value:96},"96",-1)])],512),[[Gh,l.value]])])])]),$e(e).loading||$e(e).loadingPrices?(j(),W("div",hB," Loading cards and prices... ")):u.value.length===0?(j(),W("div",pB,[r.value?(j(),W("p",gB,"No cards match your search.")):(j(),W("p",mB,"You don't have any cards in your collection yet."))])):(j(),W("div",yB,[b("div",vB,[(j(!0),W(Qe,null,It(f.value,w=>(j(),W("div",{key:w.id,class:"col-xl-2 col-lg-3 col-md-4 col-sm-6"},[ze(b_,{card:w},null,8,["card"])]))),128))]),ze(oB,{"current-page":a.value,"total-items":u.value.length,"items-per-page":l.value,"onUpdate:currentPage":p},null,8,["current-page","total-items","items-per-page"])]))]))}}),_B=fn(bB,[["__scopeId","data-v-9526db4f"]]),wB=[{path:"/",name:"home",component:KI},{path:"/import",component:nE,children:[{path:"",name:"import",redirect:"/import/cardmarket"},{path:"cardmarket",name:"import-cardmarket",component:lO},{path:"mtgjson",name:"import-mtgjson",component:FD},{path:"price-guide",name:"import-price-guide",component:nT},{path:"manabox",name:"import-manabox",component:rR}]},{path:"/import/deck",name:"deck-import",component:pR},{path:"/decks",name:"decks",component:MR},{path:"/decks/:id",name:"deck-detail",component:eB,props:!0},{path:"/cards",name:"cards",component:_B}],xB=A1({history:n1("/mtg-pwa/"),routes:wB}),kB="modulepreload",CB=function(t){return"/mtg-pwa/"+t},qm={},SB=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){let c=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};var o=c;document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");r=c(n.map(u=>{if(u=CB(u),u in qm)return;qm[u]=!0;const f=u.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":kB,f||(g.as="script"),g.crossOrigin="",g.href=u,l&&g.setAttribute("nonce",l),document.head.appendChild(g),f)return new Promise((v,w)=>{g.addEventListener("load",v),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return r.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function PB(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const c=async(f=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await SB(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-CwtvwXb3.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/mtg-pwa/sw.js",{scope:"/mtg-pwa/",type:"classic"})).catch(f=>{o?.(f)}),!a)return;a.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),a.addEventListener("installed",f=>{f.isUpdate||s?.()}),a.register({immediate:e}).then(f=>{i?i("/mtg-pwa/sw.js",f):r?.(f)}).catch(f=>{o?.(f)})}}return l=u(),c}PB({immediate:!0,onRegistered(t){console.log("SW registered",t)},onRegisterError(t){console.error("SW registration error",t)}});const __=xx(dk),AB=R1();__.use(AB);async function IB(){try{await _p}catch(t){if(t instanceof Error&&t.name==="UpgradeError"&&t.message.includes("Not yet support for changing primary key"))console.warn("Database schema error detected. Attempting to recreate database..."),await Ko.delete("MtgTrackerDb"),await _p;else throw t}__.use(xB).mount("#app");try{setTimeout(async()=>{await pi.schedulePriceUpdate()},1e3)}catch(t){console.error("Error initializing automatic price updates:",t instanceof Error?t:new Error(String(t)))}}IB();
