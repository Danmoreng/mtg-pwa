/* _glass.scss */

:root { --glass-sat: 120%; }

/* Optional: subtle noise to avoid banding on translucent surfaces */
$noise: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'>\
<filter id='n'><feTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='4' stitchTiles='stitch'/></filter>\
<rect width='60' height='60' filter='url(#n)' opacity='.025'/></svg>");

@mixin glass-surface($bg: var(--glass-bg), $blur: var(--glass-blur), $shadow: var(--glass-shadow)) {
  background: $bg;
  backdrop-filter: blur($blur) saturate(var(--glass-sat));
  -webkit-backdrop-filter: blur($blur) saturate(var(--glass-sat));
  box-shadow: $shadow;
  position: relative;
  border: 1px solid var(--glass-border);
  /* liquid highlight rim */
  &::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    background: linear-gradient(180deg, var(--glass-highlight), transparent 40%),
    $noise;
    opacity: .6;
  }
}

/* Generic utility */
.glass {
  @include glass-surface(var(--glass-bg));
}

.glass-strong {
  @include glass-surface(var(--glass-bg-strong));
}

/* Elevation utilities (MD3) */
.elevation-1 {
  box-shadow: var(--elev-1) !important;
}

.elevation-2 {
  box-shadow: var(--elev-2) !important;
}

.elevation-3 {
  box-shadow: var(--elev-3) !important;
}

.elevation-4 {
  box-shadow: var(--elev-4) !important;
}

.elevation-5 {
  box-shadow: var(--elev-5) !important;
}

/* Component hooks */
.card.glass,
.modal-content.glass,
.dropdown-menu.glass {
  @include glass-surface();
  --bs-card-bg: transparent; /* let the translucent bg show */
  --bs-dropdown-bg: transparent;
}

.navbar.glass {
  @include glass-surface();
  --bs-navbar-padding-y: .6rem;
  --bs-navbar-brand-font-weight: 600;
  --bs-navbar-color: var(--color-text);
  --bs-navbar-hover-color: var(--color-text);
}

/* MD3 button variants */
.btn-tonal {
  color: color-mix(in hsl, var(--color-text) 92%, black 8%);
  background: color-mix(in hsl, var(--color-primary) 18%, var(--surface-2) 82%);
  border: 1px solid color-mix(in hsl, var(--color-primary) 24%, transparent);
  box-shadow: var(--elev-1);
}

.btn-tonal:hover {
  box-shadow: var(--elev-2);
}

.btn-elevated {
  background: var(--surface-0);
  border: 1px solid var(--color-border);
  box-shadow: var(--elev-2);
}

.btn-elevated:hover {
  box-shadow: var(--elev-3);
}

/* Prefers reduced transparency: fall back to solid surfaces */
@media (prefers-reduced-transparency: reduce) {
  .glass, .glass-strong, .navbar.glass, .card.glass, .modal-content.glass, .dropdown-menu.glass {
    background: var(--surface-2) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
}
