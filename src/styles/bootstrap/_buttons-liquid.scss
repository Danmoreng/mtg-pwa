/* _buttons-glass-enhanced.scss â€” Lightbulb / Refraction Edition
   Drop-in replacement for your current file. Focus: colored shadow, glassier lens, and a
   "bulb turning on" hover with subtle refraction/caustics.
*/

/* ---------- Theme knobs ---------- */
:root,
[data-bs-theme="light"],
[data-theme="light"] {
  --btn-glass-blur: 8px;
  --btn-glass-sat: 150%;

  /* Color infusion amounts */
  --glass-plate: 30%;
  --glass-plate-hover: 52%;
  --glass-plate-active: 58%;
  --glass-border: 72%;
  --glass-border-hover: 80%;
  --glass-border-active: 84%;

  /* Text and base accents */
  --btn-glass-text-color: #1f3e61;
  --btn-glass-bg-gradient: linear-gradient(135deg, rgba(255, 255, 255, 0.45) 0%, rgba(255, 255, 255, 0.2) 100%);

  /* Colored outer shadows (computed from --glass-color) */
  --btn-shadow-alpha: 28%;
  --btn-shadow-alpha-hover: 40%;
  --btn-shadow-alpha-active: 28%;

  /* Lens overlays */
  --btn-glare-bg: linear-gradient(110deg, rgba(255,255,255,0) 32%, rgba(255,255,255,0.75) 50%, rgba(255,255,255,0) 68%);
  --btn-lens-top: linear-gradient(180deg, rgba(255,255,255,.55) 0%, rgba(255,255,255,.25) 12%, rgba(255,255,255,0) 46%);
  --btn-lens-bottom: radial-gradient(110% 160% at 50% 135%, rgba(0,0,0,.12) 0%, rgba(0,0,0,0) 52%);
  --btn-lens-rim: radial-gradient(100% 140% at 50% 50%, rgba(255,255,255,.35) 0%, rgba(255,255,255,.12) 22%, rgba(255,255,255,0) 55%);

  --btn-caustics-opacity: .12;
  --btn-glow-opacity: .9;
}

[data-bs-theme="dark"],
[data-theme="dark"] {
  --btn-glass-blur: 10px;
  --btn-glass-sat: 120%;

  --glass-plate: 20%;
  --glass-plate-hover: 32%;
  --glass-plate-active: 38%;
  --glass-border: 58%;
  --glass-border-hover: 64%;
  --glass-border-active: 70%;

  --btn-glass-text-color: #f9fafb;
  --btn-glass-bg-gradient: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 100%);

  --btn-shadow-alpha: 26%;
  --btn-shadow-alpha-hover: 36%;
  --btn-shadow-alpha-active: 26%;

  --btn-lens-top: linear-gradient(180deg, rgba(255,255,255,.22) 0%, rgba(255,255,255,.10) 14%, rgba(255,255,255,0) 50%);
  --btn-lens-bottom: radial-gradient(110% 160% at 50% 135%, rgba(0,0,0,.30) 0%, rgba(0,0,0,0) 55%);
  --btn-lens-rim: radial-gradient(100% 140% at 50% 50%, rgba(255,255,255,.18) 0%, rgba(255,255,255,.08) 24%, rgba(255,255,255,0) 58%);

  --btn-caustics-opacity: .08;
  --btn-glow-opacity: .8;
}

/* ---------- Base glass for all .btn-glass-* ---------- */
.btn[class*="btn-glass-"] {
  position: relative;
  isolation: isolate;
  overflow: hidden;
  background-clip: padding-box;
  border-radius: var(--bs-btn-border-radius, .75rem);
  color: var(--btn-glass-text-color);

  --_plate: var(--glass-plate);
  --_border: var(--glass-border);

  /* Tinted base */
  background-color: color-mix(in hsl, var(--glass-color, currentColor) var(--_plate), transparent);

  /* Layer stack: gradient, lens overlays, caustics, noise */
  background-image: var(--btn-glass-bg-gradient);
  background-size: cover;
  background-position: center;

  /* Crisp border using theme color */
  border: 1px solid color-mix(in hsl, var(--glass-color, currentColor) var(--_border), transparent);

  /* Colored outer shadow + subtle insets for thickness */
  box-shadow: var(--elev-1), 0 0 8px color-mix(in hsl, var(--glass-color, currentColor) 20%, transparent);

  /* Glass effect */
  backdrop-filter: blur(var(--btn-glass-blur)) saturate(var(--btn-glass-sat));
  -webkit-backdrop-filter: blur(var(--btn-glass-blur)) saturate(var(--btn-glass-sat));

  transition:
          transform .22s cubic-bezier(.22,.61,.36,1),
          box-shadow .22s cubic-bezier(.22,.61,.36,1),
          background-color .18s ease,
          border-color .18s ease,
          opacity .2s ease;
  z-index: 0;
}

.btn[class*="btn-glass-"] > * { position: relative; z-index: 1; }

/* ---------- Interaction states ---------- */
.btn[class*="btn-glass-"]:hover {
  --_plate: var(--glass-plate-hover);
  --_border: var(--glass-border-hover);
  background-color: color-mix(in hsl, var(--glass-color, currentColor) var(--_plate), transparent);
  border-color: color-mix(in hsl, var(--glass-color, currentColor) var(--_border), transparent);
  box-shadow: var(--elev-2), 0 0 12px color-mix(in hsl, var(--glass-color, currentColor) 30%, transparent);
  transform: translateY(-2px);
}

.btn[class*="btn-glass-"]:active,
.btn[class*="btn-glass-"].active,
.show > .btn[class*="btn-glass-"].dropdown-toggle {
  --_plate: var(--glass-plate-active);
  --_border: var(--glass-border-active);
  background-color: color-mix(in hsl, var(--glass-color, currentColor) var(--_plate), transparent);
  border-color: color-mix(in hsl, var(--glass-color, currentColor) var(--_border), transparent);
  box-shadow: var(--elev-1), 0 0 8px color-mix(in hsl, var(--glass-color, currentColor) 20%, transparent);
  transform: scale(.98) translateY(0);
}

/* Focus ring */
.btn[class*="btn-glass-"]:focus-visible,
.btn-check:focus-visible + .btn[class*="btn-glass-"] {
  outline: 2px solid color-mix(in hsl, var(--glass-color, currentColor) 80%, transparent);
  outline-offset: 2px;
}

/* Reduced transparency */
@media (prefers-reduced-transparency: reduce) {
  .btn[class*="btn-glass-"] {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .btn[class*="btn-glass-"] { transition: none; }
  .btn[class*="btn-glass-"]::before,
  .btn[class*="btn-glass-"]::after { transition: none; animation: none; }
}

/* ---------- Bootstrap integration & variants ---------- */
@mixin make-btn-glass-variant($name, $color) {
  $label: color-contrast($color);
  .btn-glass-#{$name} {
    --glass-color: #{$color};
    --bs-btn-color: #{$label};
    --bs-btn-bg: transparent;
    --bs-btn-border-color: transparent;
    --bs-btn-hover-bg: transparent;
    --bs-btn-active-bg: transparent;
  }
}

@each $name, $color in $theme-colors {
  @include make-btn-glass-variant($name, $color);
}
